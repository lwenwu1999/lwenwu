{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to MkDocs"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"Docker/","text":"Docker\u6982\u8ff0 Docker\u662f\u4e00\u4e2a\u7528\u4e8e\u5f00\u53d1\uff0c\u53d1\u5e03\u548c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u653e\u5e73\u53f0\u3002Docker\u4f7f\u60a8\u80fd\u591f\u5c06\u5e94\u7528\u7a0b\u5e8f\u4e0e\u57fa\u7840\u67b6\u6784\u5206\u5f00\uff0c\u4ece\u800c\u53ef\u4ee5\u5feb\u901f\u4ea4\u4ed8\u8f6f\u4ef6\u3002\u501f\u52a9Docker\uff0c\u60a8\u53ef\u4ee5\u4ee5\u4e0e\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\u76f8\u540c\u7684\u65b9\u5f0f\u6765\u7ba1\u7406\u57fa\u7840\u67b6\u6784\u3002\u901a\u8fc7\u5229\u7528Docker\u7684\u65b9\u6cd5\u6765\u5feb\u901f\u4ea4\u4ed8\uff0c\u6d4b\u8bd5\u548c\u90e8\u7f72\u4ee3\u7801\uff0c\u60a8\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u7f16\u5199\u4ee3\u7801\u548c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u8fd0\u884c\u4ee3\u7801\u4e4b\u95f4\u7684\u5ef6\u8fdf\u3002 Docker\u5e73\u53f0 Docker\u63d0\u4f9b\u4e86\u5728\u677e\u6563\u9694\u79bb\u7684\u73af\u5883\uff08\u79f0\u4e3a\u5bb9\u5668\uff09\u4e2d\u6253\u5305\u548c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u7684\u529f\u80fd\u3002\u9694\u79bb\u548c\u5b89\u5168\u6027\u4f7f\u60a8\u53ef\u4ee5\u5728\u7ed9\u5b9a\u4e3b\u673a\u4e0a\u540c\u65f6\u8fd0\u884c\u591a\u4e2a\u5bb9\u5668\u3002\u5bb9\u5668\u662f\u8f7b\u91cf\u7ea7\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u9700\u8981\u7ba1\u7406\u7a0b\u5e8f\u7684\u989d\u5916\u8d1f\u8f7d\uff0c\u800c\u662f\u76f4\u63a5\u5728\u4e3b\u673a\u7684\u5185\u6838\u4e2d\u8fd0\u884c\u3002\u8fd9\u610f\u5473\u7740\u4e0e\u4f7f\u7528\u865a\u62df\u673a\u76f8\u6bd4\uff0c\u5728\u7ed9\u5b9a\u7684\u786c\u4ef6\u7ec4\u5408\u4e0a\u53ef\u4ee5\u8fd0\u884c\u66f4\u591a\u7684\u5bb9\u5668\u3002\u60a8\u751a\u81f3\u53ef\u4ee5\u5728\u5b9e\u9645\u4e0a\u662f\u865a\u62df\u673a\u7684\u4e3b\u673a\u4e2d\u8fd0\u884cDocker\u5bb9\u5668\uff01 Docker\u63d0\u4f9b\u4e86\u5de5\u5177\u548c\u5e73\u53f0\u6765\u7ba1\u7406\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\uff1a \u4f7f\u7528\u5bb9\u5668\u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f\u53ca\u5176\u652f\u6301\u7ec4\u4ef6\u3002 \u5bb9\u5668\u6210\u4e3a\u5206\u53d1\u548c\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f\u7684\u5355\u5143\u3002 \u51c6\u5907\u5c31\u7eea\u540e\uff0c\u53ef\u4ee5\u5c06\u5e94\u7528\u7a0b\u5e8f\u4f5c\u4e3a\u5bb9\u5668\u6216\u534f\u8c03\u670d\u52a1\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883\u4e2d\u3002\u65e0\u8bba\u60a8\u7684\u751f\u4ea7\u73af\u5883\u662f\u672c\u5730\u6570\u636e\u4e2d\u5fc3\uff0c\u4e91\u63d0\u4f9b\u5546\u8fd8\u662f\u4e24\u8005\u7684\u6df7\u5408\uff0c\u5176\u5de5\u4f5c\u539f\u7406\u90fd\u76f8\u540c\u3002 Docker\u5f15\u64ce Docker Engine \u662f\u5177\u6709\u4ee5\u4e0b\u4e3b\u8981\u7ec4\u4ef6\u7684\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\uff1a \u670d\u52a1\u5668\u662f\u4e00\u79cd\u957f\u671f\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u79f0\u4e3a\u5b88\u62a4\u7a0b\u5e8f\u8fdb\u7a0b\uff08 dockerd \u547d\u4ee4\uff09\u3002 REST API\uff0c\u5b83\u6307\u5b9a\u7a0b\u5e8f\u53ef\u4ee5\u7528\u6765\u4e0e\u5b88\u62a4\u7a0b\u5e8f\u8fdb\u884c\u901a\u4fe1\u5e76\u6307\u793a\u5176\u64cd\u4f5c\u7684\u63a5\u53e3\u3002 \u547d\u4ee4\u884c\u754c\u9762\uff08CLI\uff09\u5ba2\u6237\u7aef\uff08 docker \u547d\u4ee4\uff09\u3002 CLI\u4f7f\u7528Docker REST API\u901a\u8fc7\u811a\u672c\u6216\u76f4\u63a5CLI\u547d\u4ee4\u63a7\u5236\u6216\u4e0eDocker\u5b88\u62a4\u7a0b\u5e8f\u4ea4\u4e92\u3002\u8bb8\u591a\u5176\u4ed6Docker\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f7f\u7528\u57fa\u7840API\u548cCLI\u3002 \u5b88\u62a4\u7a0b\u5e8f\u521b\u5efa\u548c\u7ba1\u7406Docker \u5bf9\u8c61 \uff0c\u4f8b\u5982\u56fe\u50cf\uff0c\u5bb9\u5668\uff0c\u7f51\u7edc\u548c\u5377\u3002 \u6ce8\u610f \uff1aDocker\u5df2\u83b7\u5f97\u5f00\u6e90Apache 2.0\u8bb8\u53ef\u8bc1\u7684\u8bb8\u53ef\u3002 \u6211\u53ef\u4ee5\u5c06Docker\u7528\u4e8e\u4ec0\u4e48\uff1f \u5feb\u901f\uff0c\u4e00\u81f4\u5730\u4ea4\u4ed8\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f Docker\u901a\u8fc7\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u63d0\u4f9b\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u7684\u672c\u5730\u5bb9\u5668\u5728\u6807\u51c6\u5316\u73af\u5883\u4e2d\u5de5\u4f5c\uff0c\u4ece\u800c\u7b80\u5316\u4e86\u5f00\u53d1\u751f\u547d\u5468\u671f\u3002\u5bb9\u5668\u975e\u5e38\u9002\u5408\u6301\u7eed\u96c6\u6210\u548c\u6301\u7eed\u4ea4\u4ed8\uff08CI / CD\uff09\u5de5\u4f5c\u6d41\u7a0b\u3002 \u8bf7\u8003\u8651\u4ee5\u4e0b\u793a\u4f8b\u65b9\u6848\uff1a \u60a8\u7684\u5f00\u53d1\u4eba\u5458\u5728\u672c\u5730\u7f16\u5199\u4ee3\u7801\uff0c\u5e76\u4f7f\u7528Docker\u5bb9\u5668\u4e0e\u540c\u4e8b\u5171\u4eab\u4ed6\u4eec\u7684\u5de5\u4f5c\u3002 \u4ed6\u4eec\u4f7f\u7528Docker\u5c06\u5176\u5e94\u7528\u7a0b\u5e8f\u63a8\u9001\u5230\u6d4b\u8bd5\u73af\u5883\u4e2d\uff0c\u5e76\u6267\u884c\u81ea\u52a8\u548c\u624b\u52a8\u6d4b\u8bd5\u3002 \u5f53\u5f00\u53d1\u4eba\u5458\u53d1\u73b0\u9519\u8bef\u65f6\uff0c\u4ed6\u4eec\u53ef\u4ee5\u5728\u5f00\u53d1\u73af\u5883\u4e2d\u5bf9\u5176\u8fdb\u884c\u4fee\u590d\uff0c\u7136\u540e\u5c06\u5176\u91cd\u65b0\u90e8\u7f72\u5230\u6d4b\u8bd5\u73af\u5883\u4e2d\u4ee5\u8fdb\u884c\u6d4b\u8bd5\u548c\u9a8c\u8bc1\u3002 \u6d4b\u8bd5\u5b8c\u6210\u540e\uff0c\u5c06\u4fee\u8865\u7a0b\u5e8f\u63a8\u9001\u7ed9\u751f\u4ea7\u73af\u5883\u5c31\u50cf\u5c06\u66f4\u65b0\u7684\u6620\u50cf\u63a8\u9001\u5230\u751f\u4ea7\u73af\u5883\u4e00\u6837\u7b80\u5355\u3002 \u54cd\u5e94\u5f0f\u90e8\u7f72\u548c\u6269\u5c55 Docker\u57fa\u4e8e\u5bb9\u5668\u7684\u5e73\u53f0\u5141\u8bb8\u9ad8\u5ea6\u53ef\u79fb\u690d\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002Docker\u5bb9\u5668\u53ef\u4ee5\u5728\u5f00\u53d1\u4eba\u5458\u7684\u672c\u5730\u7b14\u8bb0\u672c\u7535\u8111\u4e0a\uff0c\u6570\u636e\u4e2d\u5fc3\u4e2d\u7684\u7269\u7406\u6216\u865a\u62df\u673a\uff0c\u4e91\u63d0\u4f9b\u5546\u6216\u6df7\u5408\u73af\u5883\u4e2d\u8fd0\u884c\u3002 Docker\u7684\u53ef\u79fb\u690d\u6027\u548c\u8f7b\u91cf\u7ea7\u7684\u7279\u6027\u8fd8\u4f7f\u60a8\u53ef\u4ee5\u8f7b\u677e\u5730\u52a8\u6001\u7ba1\u7406\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5e76\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u6307\u793a\u5b9e\u65f6\u6269\u5c55\u6216\u62c6\u9664\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u3002 \u5728\u540c\u4e00\u786c\u4ef6\u4e0a\u8fd0\u884c\u66f4\u591a\u5de5\u4f5c\u8d1f\u8f7d Docker\u8f7b\u5de7\u5feb\u901f\u3002\u5b83\u4e3a\u57fa\u4e8e\u865a\u62df\u673a\u7ba1\u7406\u7a0b\u5e8f\u7684\u865a\u62df\u673a\u63d0\u4f9b\u4e86\u53ef\u884c\u4e14\u7ecf\u6d4e\u9ad8\u6548\u7684\u66ff\u4ee3\u65b9\u6848\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u5229\u7528\u66f4\u591a\u7684\u8ba1\u7b97\u80fd\u529b\u6765\u5b9e\u73b0\u4e1a\u52a1\u76ee\u6807\u3002Docker\u975e\u5e38\u9002\u5408\u9ad8\u5bc6\u5ea6\u73af\u5883\u4ee5\u53ca\u4e2d\u5c0f\u578b\u90e8\u7f72\uff0c\u800c\u60a8\u9700\u8981\u7528\u66f4\u5c11\u7684\u8d44\u6e90\u505a\u66f4\u591a\u7684\u4e8b\u60c5\u3002 Docker\u67b6\u6784 Docker\u4f7f\u7528\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u67b6\u6784\uff08C/S\uff09\u3002Docker \u5ba2\u6237\u7aef \u4e0eDocker \u5b88\u62a4\u8fdb\u7a0b \u8fdb\u884c\u5bf9\u8bdd\uff0c\u8be5 \u5b88\u62a4\u8fdb\u7a0b \u5b8c\u6210\u4e86\u6784\u5efa\uff0c\u8fd0\u884c\u548c\u5206\u53d1Docker\u5bb9\u5668\u7684\u7e41\u91cd\u5de5\u4f5c\u3002Docker\u5ba2\u6237\u7aef\u548c\u5b88\u62a4\u7a0b\u5e8f \u53ef\u4ee5 \u5728\u540c\u4e00\u7cfb\u7edf\u4e0a\u8fd0\u884c\uff0c\u6216\u8005\u60a8\u53ef\u4ee5\u5c06Docker\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u8fdc\u7a0bDocker\u5b88\u62a4\u7a0b\u5e8f\u3002Docker\u5ba2\u6237\u7aef\u548c\u5b88\u62a4\u7a0b\u5e8f\u5728UNIX\u5957\u63a5\u5b57\u6216\u7f51\u7edc\u63a5\u53e3\u4e0a\u4f7f\u7528REST API\u8fdb\u884c\u901a\u4fe1\u3002 Docker\u5b88\u62a4\u7a0b\u5e8f Docker\u5b88\u62a4\u7a0b\u5e8f\uff08 dockerd \uff09\u4fa6\u542cDocker API\u8bf7\u6c42\u5e76\u7ba1\u7406Docker\u5bf9\u8c61\uff0c\u4f8b\u5982\u56fe\u50cf\uff0c\u5bb9\u5668\uff0c\u7f51\u7edc\u548c\u5377\u3002\u5b88\u62a4\u7a0b\u5e8f\u8fd8\u53ef\u4ee5\u4e0e\u5176\u4ed6\u5b88\u62a4\u7a0b\u5e8f\u901a\u4fe1\u4ee5\u7ba1\u7406Docker\u670d\u52a1\u3002 Docker\u5ba2\u6237\u7aef Docker\u5ba2\u6237\u7aef\uff08 docker \uff09\u662f\u8bb8\u591aDocker\u7528\u6237\u4e0eDocker\u4ea4\u4e92\u7684\u4e3b\u8981\u65b9\u5f0f\u3002\u5f53\u60a8\u4f7f\u7528\u8bf8\u5982\u4e4b\u7c7b\u7684\u547d\u4ee4\u65f6 docker run \uff0c\u5ba2\u6237\u7aef\u4f1a\u5c06\u8fd9\u4e9b\u547d\u4ee4\u53d1\u9001\u5230 dockerd \uff0c\u4ee5\u6267\u884c\u8fd9\u4e9b\u547d\u4ee4\u3002\u8be5 docker \u547d\u4ee4\u4f7f\u7528Docker API\u3002Docker\u5ba2\u6237\u7aef\u53ef\u4ee5\u4e0e\u591a\u4e2a\u5b88\u62a4\u7a0b\u5e8f\u901a\u4fe1\u3002 Docker\u6ce8\u518c\u8868 Docker \u6ce8\u518c\u8868 \u5b58\u50a8Docker\u6620\u50cf\u3002Docker Hub\u662f\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u4f7f\u7528\u7684\u516c\u5171\u6ce8\u518c\u8868\uff0c\u5e76\u4e14\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDocker\u5df2\u914d\u7f6e\u4e3a\u5728Docker Hub\u4e0a\u67e5\u627e\u6620\u50cf\u3002\u60a8\u751a\u81f3\u53ef\u4ee5\u8fd0\u884c\u81ea\u5df1\u7684\u79c1\u4eba\u6ce8\u518c\u8868\u3002 \u4f7f\u7528 docker pull \u6216 docker run \u547d\u4ee4\u65f6\uff0c\u6240\u9700\u7684\u56fe\u50cf\u5c06\u4ece\u914d\u7f6e\u7684\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u3002\u4f7f\u7528\u8be5 docker push \u547d\u4ee4\u65f6\uff0c\u4f1a\u5c06\u6620\u50cf\u63a8\u9001\u5230\u914d\u7f6e\u7684\u6ce8\u518c\u8868\u3002 \u5bb9\u5668\u662f\u56fe\u50cf\u7684\u53ef\u8fd0\u884c\u5b9e\u4f8b\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528Docker API\u6216CLI\u521b\u5efa\uff0c\u542f\u52a8\uff0c\u505c\u6b62\uff0c\u79fb\u52a8\u6216\u5220\u9664\u5bb9\u5668\u3002\u60a8\u53ef\u4ee5\u5c06\u5bb9\u5668\u8fde\u63a5\u5230\u4e00\u4e2a\u6216\u591a\u4e2a\u7f51\u7edc\uff0c\u5c06\u5b58\u50a8\u8fde\u63a5\u5230\u5b83\uff0c\u751a\u81f3\u6839\u636e\u5176\u5f53\u524d\u72b6\u6001\u521b\u5efa\u4e00\u4e2a\u65b0\u6620\u50cf\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bb9\u5668\u4e0e\u5176\u4ed6\u5bb9\u5668\u53ca\u5176\u4e3b\u673a\u4e4b\u95f4\u7684\u9694\u79bb\u5ea6\u76f8\u5bf9\u8f83\u9ad8\u3002\u60a8\u53ef\u4ee5\u63a7\u5236\u5bb9\u5668\u7684\u7f51\u7edc\uff0c\u5b58\u50a8\u6216\u5176\u4ed6\u57fa\u7840\u5b50\u7cfb\u7edf\u4e0e\u5176\u4ed6\u5bb9\u5668\u6216\u4e0e\u4e3b\u673a\u7684\u9694\u79bb\u7a0b\u5ea6\u3002 \u5bb9\u5668\u7531\u5176\u6620\u50cf\u4ee5\u53ca\u5728\u521b\u5efa\u6216\u542f\u52a8\u65f6\u4e3a\u5176\u63d0\u4f9b\u7684\u4efb\u4f55\u914d\u7f6e\u9009\u9879\u5b9a\u4e49\u3002\u5220\u9664\u5bb9\u5668\u540e\uff0c\u672a\u5b58\u50a8\u5728\u6c38\u4e45\u6027\u5b58\u50a8\u4e2d\u7684\u72b6\u6001\u66f4\u6539\u5c06\u6d88\u5931\u3002 \u6bd4\u8f83\u5bb9\u5668\u548c\u865a\u62df\u673a \u5bb9\u5668\u548c\u865a\u62df\u673a\u5177\u6709\u76f8\u4f3c\u7684\u8d44\u6e90\u9694\u79bb\u548c\u5206\u914d\u4f18\u52bf\uff0c\u4f46\u529f\u80fd\u4e0d\u540c\uff0c\u56e0\u4e3a\u5bb9\u5668\u865a\u62df\u5316\u64cd\u4f5c\u7cfb\u7edf\u800c\u4e0d\u662f\u786c\u4ef6\u3002\u66f4\u65b9\u4fbf\u643a\u5e26\uff0c\u6548\u7387\u66f4\u9ad8\u3002 \u5bb9\u5668 \u5bb9\u5668\u662f\u5e94\u7528\u5c42\u7684\u62bd\u8c61\uff0c\u5b83\u5c06\u4ee3\u7801\u548c\u4f9d\u8d56\u9879\u6253\u5305\u5728\u4e00\u8d77\u3002\u591a\u4e2a\u5bb9\u5668\u53ef\u4ee5\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u8fd0\u884c\uff0c\u5e76\u4e0e\u5176\u4ed6\u5bb9\u5668\u5171\u4eab\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff0c\u6bcf\u4e2a\u5bb9\u5668\u90fd\u4f5c\u4e3a\u7528\u6237\u7a7a\u95f4\u4e2d\u7684\u72ec\u7acb\u8fdb\u7a0b\u8fd0\u884c\u3002\u5bb9\u5668\u6bd4\u865a\u62df\u673a\u5360\u7528\u66f4\u5c11\u7684\u7a7a\u95f4\uff08\u5bb9\u5668\u6620\u50cf\u7684\u5927\u5c0f\u901a\u5e38\u662f\u51e0\u5341MB\uff09\uff0c\u53ef\u4ee5\u5904\u7406\u66f4\u591a\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u9700\u8981\u66f4\u5c11\u7684\u865a\u62df\u673a\u548c\u64cd\u4f5c\u7cfb\u7edf\u3002 \u865a\u62df\u673a \u865a\u62df\u673a\uff08vm\uff09\u662f\u7269\u7406\u786c\u4ef6\u7684\u62bd\u8c61\uff0c\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u8f6c\u6362\u6210\u591a\u53f0\u670d\u52a1\u5668\u3002hypervisor\u5141\u8bb8\u591a\u4e2avm\u5728\u4e00\u53f0\u673a\u5668\u4e0a\u8fd0\u884c\u3002\u6bcf\u4e2a\u865a\u62df\u673a\u90fd\u5305\u542b\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b8c\u6574\u526f\u672c\u3001\u5e94\u7528\u7a0b\u5e8f\u3001\u5fc5\u8981\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u5e93\u2014\u5360\u7528\u4e86\u6570\u5341GB\u7684\u7a7a\u95f4\u3002vm\u7684\u542f\u52a8\u901f\u5ea6\u4e5f\u5f88\u6162\u3002 Docker\u4e3a\u4ec0\u4e48\u6bd4VM\u5feb\uff1f 1.Docker\u6709\u7740\u6bd4\u865a\u62df\u673a\u66f4\u5c11\u7684\u62bd\u8c61\u5c42\u3002 2.Docker\u5229\u7528\u7684\u662f\u5bbf\u4e3b\u673a\u7684\u5185\u6838\uff0cVM\u9700\u8981\u5b8c\u6574Guest OS\u3002 \u65b0\u5efa\u4e00\u4e2a\u5bb9\u5668\u65f6\uff0cDocker\u4e0d\u9700\u8981\u50cf\u865a\u62df\u673a\u4e00\u6837\u91cd\u65b0\u52a0\u8f7d\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff0c\u907f\u514d\u5f15\u5bfc\u3002 \u865a\u62df\u673a\u52a0\u8f7dGuest OS\u662f\u5206\u949f\u7ea7\u522b\uff0cDocker\u5229\u7528\u5bbf\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\uff0c\u79d2\u7ea7\u3002 \u5e95\u5c42\u6280\u672f Docker\u7528 Go\u7f16\u7a0b\u8bed\u8a00 \u7f16\u5199\uff0c\u5e76\u5229\u7528Linux\u5185\u6838\u7684\u591a\u4e2a\u529f\u80fd\u6765\u4ea4\u4ed8\u5176\u529f\u80fd\u3002 \u547d\u540d\u7a7a\u95f4 Docker\u4f7f\u7528\u4e00\u79cd\u79f0\u4e3a namespaces \u63d0\u4f9b \u5bb9\u5668 \u7684\u9694\u79bb\u5de5\u4f5c\u533a\u7684\u6280\u672f\u3002\u8fd0\u884c\u5bb9\u5668\u65f6\uff0cDocker\u4f1a\u4e3a\u8be5\u5bb9\u5668\u521b\u5efa\u4e00\u7ec4 \u540d\u79f0\u7a7a\u95f4 \u3002 \u8fd9\u4e9b\u540d\u79f0\u7a7a\u95f4\u63d0\u4f9b\u4e86\u4e00\u5c42\u9694\u79bb\u3002\u5bb9\u5668\u7684\u6bcf\u4e2a\u65b9\u9762\u90fd\u5728\u5355\u72ec\u7684\u540d\u79f0\u7a7a\u95f4\u4e2d\u8fd0\u884c\uff0c\u5e76\u4e14\u5176\u8bbf\u95ee\u4ec5\u9650\u4e8e\u8be5\u540d\u79f0\u7a7a\u95f4\u3002 Docker Engine\u5728Linux\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u540d\u79f0\u7a7a\u95f4\uff1a \u7684 pid \u547d\u540d\u7a7a\u95f4\uff1a \u8fdb\u7a0b\u9694\u79bb\uff08PID\uff1a\u8fdb\u7a0bID\uff09\u3002 \u8be5 net \u547d\u540d\u7a7a\u95f4\uff1a \u7ba1\u7406\u7f51\u7edc\u63a5\u53e3\uff08NET\uff1a\u7f51\u7edc\uff09\u3002 \u8be5 ipc \u547d\u540d\u7a7a\u95f4\uff1a \u7ba1\u7406\u8bbf\u95eeIPC\u8d44\u6e90\uff08IPC\uff1a\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff09\u3002 \u8be5 mnt \u547d\u540d\u7a7a\u95f4\uff1a \u7ba1\u7406\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u70b9\uff08MNT\uff1a\u6469\uff09\u3002 \u8be5 uts \u547d\u540d\u7a7a\u95f4\uff1a \u9694\u79bb\u5185\u6838\u548c\u7248\u672c\u6807\u8bc6\u7b26\u3002\uff08UTS\uff1aUnix\u65f6\u95f4\u5171\u4eab\u7cfb\u7edf\uff09\u3002 \u5bf9\u7167\u7ec4 Linux\u4e0a\u7684Docker\u5f15\u64ce\u8fd8\u4f9d\u8d56\u4e8e\u53e6\u4e00\u79cd\u79f0\u4e3a \u63a7\u5236\u7ec4 \uff08 cgroups \uff09\u7684\u6280\u672f\u3002cgroup\u5c06\u5e94\u7528\u7a0b\u5e8f\u9650\u5236\u4e3a\u4e00\u7ec4\u7279\u5b9a\u7684\u8d44\u6e90\u3002\u63a7\u5236\u7ec4\u5141\u8bb8Docker Engine\u5c06\u53ef\u7528\u7684\u786c\u4ef6\u8d44\u6e90\u5171\u4eab\u7ed9\u5bb9\u5668\uff0c\u5e76\u6709\u9009\u62e9\u5730\u5b9e\u65bd\u9650\u5236\u548c\u7ea6\u675f\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u9650\u5236\u7279\u5b9a\u5bb9\u5668\u53ef\u7528\u7684\u5185\u5b58\u3002 \u8054\u5408\u6587\u4ef6\u7cfb\u7edf \u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u6216UnionFS\u662f\u901a\u8fc7\u521b\u5efa\u56fe\u5c42\u8fdb\u884c\u64cd\u4f5c\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f7f\u5176\u975e\u5e38\u8f7b\u4fbf\u4e14\u5feb\u901f\u3002Docker Engine\u4f7f\u7528UnionFS\u4e3a\u5bb9\u5668\u63d0\u4f9b\u6784\u5efa\u6a21\u5757\u3002Docker Engine\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2aUnionFS\u53d8\u4f53\uff0c\u5305\u62ecAUFS\uff0cbtrfs\uff0cvfs\u548cDeviceMapper\u3002 \u5bb9\u5668\u683c\u5f0f Docker Engine\u5c06\u540d\u79f0\u7a7a\u95f4\uff0c\u63a7\u5236\u7ec4\u548cUnionFS\u7ec4\u5408\u5230\u4e00\u4e2a\u79f0\u4e3a\u5bb9\u5668\u683c\u5f0f\u7684\u5305\u88c5\u5668\u4e2d\u3002\u9ed8\u8ba4\u5bb9\u5668\u683c\u5f0f\u4e3a libcontainer \u3002\u5c06\u6765\uff0cDocker\u53ef\u4ee5\u901a\u8fc7\u4e0eBSD Jails\u6216Solaris Zones\u7b49\u6280\u672f\u96c6\u6210\u6765\u652f\u6301\u5176\u4ed6\u5bb9\u5668\u683c\u5f0f\u3002 \u5b89\u88c5Docker Docker\u6587\u6863\uff1a https://docs.docker.com/get-docker/ \u5b89\u88c5Docker\u5f15\u64ce \u5148\u51b3\u6761\u4ef6\uff1a \u64cd\u4f5c\u7cfb\u7edf\u8981\u6c42\uff1a\u8981\u5b89\u88c5Docker\u5f15\u64ce\uff0c\u9700\u8981CentOS 7\u7684\u7ef4\u62a4\u7248\u672c\u3002\u4e0d\u652f\u6301\u6216\u6d4b\u8bd5\u5b58\u6863\u7248\u672c\u3002 \u5fc5\u987b\u542f\u7528centos-extras\u5b58\u50a8\u5e93\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8be5\u5b58\u50a8\u5e93\u662f\u542f\u7528\u7684\uff0c\u4f46\u662f\u5982\u679c\u60a8\u5df2\u7ecf\u7981\u7528\u4e86\u5b83\uff0c\u5219\u9700\u8981\u91cd\u65b0\u542f\u7528\u5b83\u3002 \u5b89\u88c5gcc\u76f8\u5173\u73af\u5883 yum -y install gcc yum -y install gcc-c++ 1.\u5378\u8f7d\u65e7\u7248\u672c yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine \u5982\u679cyum\u62a5\u544a\u6ca1\u6709\u5b89\u88c5\u8fd9\u4e9b\u5305\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002 /var/lib/docker/\u7684\u5185\u5bb9\uff0c\u5305\u62ec\u955c\u50cf\u3001\u5bb9\u5668\u3001\u5377\u548c\u7f51\u7edc\u3002Docker\u5f15\u64ce\u5305\u73b0\u5728\u79f0\u4e3aDocker -ce 2.\u5b89\u88c5\u57fa\u7840\u5305 yum install -y yum-utils \u5b89\u88c5 yum-utils \u5305(\u5b83\u63d0\u4f9b yum-config-manager \u5b9e\u7528\u5de5\u5177)\u5e76\u8bbe\u7f6e\u7a33\u5b9a\u5b58\u50a8\u5e93\u3002 3.\u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93 \u9ed8\u8ba4\u56fd\u5916\u6e90\uff1a yum-config-manager \\ --add-repo \\ https://download.docker.com/linux/centos/docker-ce.repo \u963f\u91cc\u4e91\uff1a yum-config-manager \\ --add-repo \\ http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo 4.\u66f4\u65b0yum\u8f6f\u4ef6\u5305\u7d22\u5f15 yum makecache fast 5.\u5b89\u88c5 Docker\u5f15\u64ce yum install docker-ce docker-ce-cli containerd.io \u5b89\u88c5\u7279\u5b9a\u7248\u672c\u7684Docker\uff1a yum install docker-ce-<VERSION_STRING> docker-ce-cli-<VERSION_STRING> containerd.io 6.\u542f\u52a8\u5e76\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8 systemctl start docker systemctl enable docker \u5224\u65ad\u662f\u5426\u5b89\u88c5\u6210\u529f\uff1a [root@localhost ~]# docker version Client: Docker Engine - Community Version: **19.03.13** API version: 1.40 Go version: **go1.13.15** Git commit: 4484c46d9d Built: Wed Sep 16 17:03:45 2020 OS/Arch: linux/amd64 Experimental: false **Server: Docker Engine - Community** Engine: Version: 19.03.13 API version: 1.40 (minimum version 1.12) Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:02:21 2020 OS/Arch: **linux/amd64** Experimental: false containerd: Version: 1.3.7 GitCommit: 8fba4e9a7d01810a393d5d25a3621dc101981175 runc: Version: 1.0.0-rc10 GitCommit: dc9208a3303feef5b3839f4323d9beb36df0a9dd docker-init: Version: 0.18.0 GitCommit: fec3683 [root@localhost ~]# 7.\u6d4b\u8bd5hello-world \u901a\u8fc7\u8fd0\u884c hello-world \u955c\u50cf\u6765\u9a8c\u8bc1 Docker Engine \u5b89\u88c5\u662f\u5426\u6b63\u786e\u3002 docker run hello-world [root@localhost ~]# docker run hello-world Unable to find image 'hello-world:latest' locally #\u5bfb\u627e\u955c\u50cf latest: Pulling from library/hello-world #\u4ecelibrary\u8fdc\u7a0b\u62c9\u53d6hello-world\u955c\u50cf 0e03bdcc26d7: Pull complete Digest: sha256:8c5aeeb6a5f3ba4883347d3747a7249f491766ca1caa47e5da5dfcf6b9b717c0 Status: Downloaded newer image for hello-world:latest Hello from Docker! #Docker\u5b89\u88c5\u6210\u529f This message shows that your installation appears to be working correctly. To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub. (amd64) 3. The Docker daemon created a new container from that image which runs the executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it to your terminal. To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bash Share images, automate workflows, and more with a free Docker ID: https://hub.docker.com/ For more examples and ideas, visit: https://docs.docker.com/get-started/ 8.\u67e5\u770bhello-world\u955c\u50cf [root@localhost ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE hello-world latest bf756fb1ae65 9 months ago 13.3kB [root@localhost ~]# 9.\u5378\u8f7d Docker \u5f15\u64ce \u5378\u8f7d Docker Engine\u3001 CLI \u548c Containerd \u8f6f\u4ef6\u5305: yum remove docker-ce docker-ce-cli containerd.io \u4e0d\u4f1a\u81ea\u52a8\u5220\u9664\u4e3b\u673a\u4e0a\u7684\u6620\u50cf\u3001\u5bb9\u5668\u3001\u5377\u6216\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u3002\u60a8\u5fc5\u987b\u624b\u52a8\u5220\u9664\u4efb\u4f55\u5df2\u7f16\u8f91\u7684\u914d\u7f6e\u6587\u4ef6\u3002\u5220\u9664\u6240\u6709\u955c\u50cf\uff0c\u5bb9\u5668\u548c\u5377: rm -rf /var/lib/docker \u914d\u7f6e\u963f\u91cc\u4e91\u955c\u50cf\u52a0\u901f 1.\u627e\u5230\u955c\u50cf\u52a0\u901f\u5668 2.\u914d\u7f6e\u955c\u50cf\u52a0\u901f\u5668 \u9488\u5bf9Docker\u5ba2\u6237\u7aef\u7248\u672c\u5927\u4e8e 1.10.0 \u7684\u7528\u6237 \u60a8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539daemon\u914d\u7f6e\u6587\u4ef6/etc/docker/daemon.json\u6765\u4f7f\u7528\u52a0\u901f\u5668 sudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json <<-'EOF' { \"registry-mirrors\": [\"https://gnxq79wc.mirror.aliyuncs.com\"] } EOF sudo systemctl daemon-reload sudo systemctl restart docker \u56de\u987ehello-world\u4e86\u89e3Docker\u8fd0\u884c\u539f\u7406 \u5e95\u5c42\u539f\u7406 1.Docker\u662f\u600e\u4e48\u5de5\u4f5c\u7684\uff1f Docker\u662f\u4e00\u4e2aClient-Server\u7ed3\u6784\u7684\u7cfb\u7edf\uff0cDocker\u7684\u5b88\u62a4\u8fdb\u7a0b\u8fd0\u884c\u5728\u670d\u52a1\u5668\u4e0a\u3002\u901a\u8fc7Socket\u5ba2\u6237\u7aef\u8bbf\u95ee\uff01 Docker\u547d\u4ee4 \u5e2e\u52a9\u547d\u4ee4 docker version \u663e\u793aDocker\u7248\u672c\u4fe1\u606f [root@localhost ~]# docker version Client: Docker Engine - Community Version: 19.03.13 API version: 1.40 Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:03:45 2020 OS/Arch: linux/amd64 Experimental: false Server: Docker Engine - Community Engine: Version: 19.03.13 API version: 1.40 (minimum version 1.12) Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:02:21 2020 OS/Arch: linux/amd64 Experimental: false containerd: Version: 1.3.7 GitCommit: 8fba4e9a7d01810a393d5d25a3621dc101981175 runc: Version: 1.0.0-rc10 GitCommit: dc9208a3303feef5b3839f4323d9beb36df0a9dd docker-init: Version: 0.18.0 GitCommit: fec3683 [root@localhost ~]# docker info \u663e\u793adocker\u7684\u7cfb\u7edf\u4fe1\u606f\uff0c\u5305\u62ec\u955c\u50cf\u548c\u5bb9\u5668\u7684\u6570\u91cf\u3002 [root@localhost ~]# docker info Client: Debug Mode: false Server: Containers: 1 Running: 0 Paused: 0 Stopped: 1 Images: 1 Server Version: 19.03.13 Storage Driver: overlay2 Backing Filesystem: xfs Supports d_type: true Native Overlay Diff: true Logging Driver: json-file Cgroup Driver: cgroupfs Plugins: Volume: local Network: bridge host ipvlan macvlan null overlay Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog Swarm: inactive Runtimes: runc Default Runtime: runc Init Binary: docker-init containerd version: 8fba4e9a7d01810a393d5d25a3621dc101981175 runc version: dc9208a3303feef5b3839f4323d9beb36df0a9dd init version: fec3683 Security Options: seccomp Profile: default Kernel Version: 3.10.0-1127.19.1.el7.x86_64 Operating System: CentOS Linux 7 (Core) OSType: linux Architecture: x86_64 CPUs: 1 Total Memory: 1.777GiB Name: localhost.localdomain ID: 4ARA:NX4Y:7DM7:IGVR:XQNU:PNSQ:SDFN:44U2:VINY:2OMR:VDKO:2SKU Docker Root Dir: /var/lib/docker Debug Mode: false Registry: https://index.docker.io/v1/ Labels: Experimental: false Insecure Registries: 127.0.0.0/8 Registry Mirrors: https://gnxq79wc.mirror.aliyuncs.com/ Live Restore Enabled: false [root@localhost ~]# docker \u547d\u4ee4 --help \u5e2e\u52a9\u547d\u4ee4 https://docs.docker.com/ \u547d\u4ee4\uff1ahttps://docs.docker.com/engine/reference/commandline/ \u955c\u50cf\u547d\u4ee4 docker images \u67e5\u770b\u6240\u6709\u672c\u5730\u4e3b\u673a\u4e0a\u7684\u955c\u50cf [root@localhost ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE hello-world latest bf756fb1ae65 10 months ago 13.3kB #\u89e3\u91ca REPOSITORY \u955c\u50cf\u4ed3\u5e93\u6e90 TAG \u955c\u50cf\u7684\u6807\u7b7e IMAGE ID \u955c\u50cf\u7684ID CREATED \u955c\u50cf\u7684\u521b\u5efa\u65f6\u95f4 SIZE \u955c\u50cf\u7684\u5927\u5c0f Options\u9009\u9879 [root@localhost ~]# docker images --help Usage: docker images [OPTIONS] [REPOSITORY[:TAG]] List images Options: -a, --all Show all images (default hides intermediate images) --digests Show digests #\u683c\u5f0f\u5316 -f, --filter filter Filter output based on conditions provided #\u8fc7\u6ee4 --format string Pretty-print images using a Go template --no-trunc Don't truncate output -q, --quiet Only show numeric IDs \u89e3\u91ca -a \u5217\u51fa\u6240\u6709\u955c\u50cf -q \u53ea\u663e\u793a\u955c\u50cf\u7684ID [root@localhost ~]# docker images -a REPOSITORY TAG IMAGE ID CREATED SIZE hello-world latest bf756fb1ae65 10 months ago 13.3kB [root@localhost ~]# docker images -aq bf756fb1ae65 [root@localhost ~]# \u641c\u7d22\u547d\u4ee4 \u7f51\u9875\u641c\u7d22 https://hub.docker.com/ docker search docker search --help [root@localhost ~]# docker search --help Usage: docker search [OPTIONS] TERM Search the Docker Hub for images Options: -f, --filter filter Filter output based on conditions provided --format string Pretty-print search using a Go template --limit int Max number of search results (default 25) --no-trunc Don't truncate output [root@localhost ~]# \u4f8b\u5982\uff1a --filter=STARS=3000 #\u8fc7\u6ee4\u51fa\u955c\u50cf\u6536\u85cf\u5927\u4e8e3000\u7684 [root@localhost ~]# docker search mysql --filter=STARS=3000 NAME DESCRIPTION STARS OFFICIAL AUTOMATED mysql MySQL is a widely used, open-source relation\u2026 10115 [OK] mariadb MariaDB is a community-developed fork of MyS\u2026 3715 [OK] [root@localhost ~]# \u4e0b\u8f7d\u547d\u4ee4 docker pull [root@localhost ~]# docker pull --help Usage: docker pull [OPTIONS] NAME[:TAG|@DIGEST] Pull an image or a repository from a registry Options: -a, --all-tags Download all tagged images in the repository --disable-content-trust Skip image verification (default true) --platform string Set platform if server is multi-platform capable -q, --quiet Suppress verbose output [root@localhost ~]# [root@localhost ~]# docker pull mysql Using default tag: latest #\u5982\u679c\u4e0d\u5199tag:\uff0c\u9ed8\u8ba4\u4e0b\u8f7d\u6700\u65b0\u7684\u7248\u672c latest: Pulling from library/mysql bb79b6b2107f: Pull complete #\u5206\u5c42\u4e0b\u8f7d\uff0cdocker image\u7684\u6838\u5fc3\uff1a\u8054\u5408\u6587\u4ef6\u7cfb\u7edf 49e22f6fb9f7: Pull complete 842b1255668c: Pull complete 9f48d1f43000: Pull complete c693f0615bce: Pull complete 8a621b9dbed2: Pull complete 0807d32aef13: Pull complete a56aca0feb17: Pull complete de9d45fd0f07: Pull complete 1d68a49161cc: Pull complete d16d318b774e: Pull complete 49e112c55976: Pull complete Digest: sha256:8c17271df53ee3b843d6e16d46cff13f22c9c04d6982eb15a9a47bd5c9ac7e2d #\u7b7e\u540d Status: Downloaded newer image for mysql:latest docker.io/library/mysql:latest #\u771f\u5b9e\u5730\u5740 [root@localhost ~] docker pull mysql=docker pull docker.io/library/mysql:latest #\u7b49\u4ef7 \u6307\u5b9a\u4e0b\u8f7d\u7248\u672c docker pull \u955c\u50cf\u540d:tag \u6ce8\uff1a\u6307\u5b9a\u4e0b\u8f7d\u7684\u7248\u672c\u5fc5\u987b\u662f\u5b58\u5728\u7684\u3002 \u8054\u5408\u6587\u4ef6\u7cfb\u7edf\uff0c\u516c\u7528\u6587\u4ef6\u4e0d\u5728\u4e0b\u8f7d\u6781\u5927\u51cf\u5c11\u5360\u7528\u5b58\u50a8 \u6bd4\u8f83\uff1a [root@localhost ~]# docker pull mysql Using default tag: latest latest: Pulling from library/mysql bb79b6b2107f: Pull complete 49e22f6fb9f7: Pull complete 842b1255668c: Pull complete 9f48d1f43000: Pull complete c693f0615bce: Pull complete 8a621b9dbed2: Pull complete 0807d32aef13: Pull complete a56aca0feb17: Pull complete de9d45fd0f07: Pull complete 1d68a49161cc: Pull complete d16d318b774e: Pull complete 49e112c55976: Pull complete Digest: sha256:8c17271df53ee3b843d6e16d46cff13f22c9c04d6982eb15a9a47bd5c9ac7e2d Status: Downloaded newer image for mysql:latest docker.io/library/mysql:latest [root@localhost ~]# docker pull mysql:5.7 5.7: Pulling from library/mysql bb79b6b2107f: Already exists 49e22f6fb9f7: Already exists 842b1255668c: Already exists 9f48d1f43000: Already exists c693f0615bce: Already exists 8a621b9dbed2: Already exists 0807d32aef13: Already exists f15d42f48bd9: Pull complete 098ceecc0c8d: Pull complete b6fead9737bc: Pull complete 351d223d3d76: Pull complete Digest: sha256:4d2b34e99c14edb99cdd95ddad4d9aa7ea3f2c4405ff0c3509a29dc40bcb10ef Status: Downloaded newer image for mysql:5.7 docker.io/library/mysql:5.7 [root@localhost ~]# \u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf \u5220\u9664\u955c\u50cf\u547d\u4ee4 docker rmi -f id docker rmi -f id1 id2 id3 #\u5220\u9664\u591a\u4e2a\u6307\u5b9a\u7684\u5bb9\u5668\u955c\u50cf \u901a\u8fc7ID\u5220\u9664\u955c\u50cf/\u901a\u8fc7TAG\u5220\u9664\u955c\u50cf \u518d\u6b21\u67e5\u770b\uff0cmysql 5.7\u5df2\u88ab\u5220\u9664\uff0c\u53ea\u5220\u9664\u4e86\u90e8\u5206\u5c42\u3002 \u5220\u9664\u5168\u90e8\u5bb9\u5668\u955c\u50cf docker rmi -f $(docker images -aq) \u5bb9\u5668\u547d\u4ee4 \u6709\u4e86\u955c\u50cf\u624d\u53ef\u4ee5\u521b\u5efa\u5bb9\u5668\uff0c\u4e0b\u8f7d\u4e00\u4e2acentos\u955c\u50cf\u6765\u6d4b\u8bd5\u5b66\u4e60 \u4e0b\u8f7d\u955c\u50cf docker pull centos \u65b0\u5efa\u5bb9\u5668\u5e76\u542f\u52a8 docker run [\u53ef\u9009\u53c2\u6570] image \u53c2\u6570\u8bf4\u660e --name='Name' \u5bb9\u5668\u540d\u5b57\uff0c\u7528\u6765\u533a\u5206\u5bb9\u5668 -d \u540e\u53f0\u65b9\u5f0f\u8fd0\u884c -it \u4f7f\u7528\u4ea4\u4e92\u65b9\u5f0f\u8fd0\u884c\uff0c\u8fdb\u5165\u5bb9\u5668\u67e5\u770b\u5185\u5bb9 -p \u6307\u5b9a\u5bb9\u5668\u7684\u7aef\u53e3 -p 8080:8080 \u200b -p \u4e3b\u673a\u7aef\u53e3\u6620\u5c04\uff1a\u5bb9\u5668\u7aef\u53e3\uff08\u5e38\u7528\uff09 \u200b -p \u76f4\u63a5\u5bb9\u5668\u7aef\u53e3 -P \u968f\u673a\u6307\u5b9a\u7aef\u53e3\uff08\u5927\u5199\uff09 \u67e5\u770bdocker run\u5e2e\u52a9\u547d\u4ee4 docker run --help \u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf docker images \u6d4b\u8bd5\u542f\u52a8\u5e76\u8fdb\u5165\u5bb9\u5668 docker run -it centos /bin/bash #\u4e3b\u673a\u540d\u79f0\u53d8\u66f4 cd / ls \u67e5\u770b\u5bb9\u5668\u5185\u7684centos \u4ece\u5bb9\u5668\u4e2d\u9000\u56de\u4e3b\u673a exit #\u76f4\u63a5\u505c\u6b62\u5e76\u9000\u51fa \u5217\u51fa\u8fd0\u884c\u6b63\u5728\u7684\u5bb9\u5668 docker ps \u5217\u51fa\u6240\u6709\u8fd0\u884c\u8fc7\u7684\u5bb9\u5668 docker ps -a \u663e\u793a\u6700\u8fd1\u521b\u5efa\u7684\u5bb9\u5668 docker ps -a -n=1 \u663e\u793a\u6240\u6709\u8fd0\u884c\u5bb9\u5668\u7684\u7f16\u53f7 docker ps -aq \u9000\u51fa\u5bb9\u5668 exit \u76f4\u63a5\u505c\u6b62\u5e76\u9000\u51fa Ctrl+P+Q \u5bb9\u5668\u4e0d\u505c\u6b62\u9000\u51fa \u5220\u9664\u5bb9\u5668\u955c\u50cf docker rm ID #\u5220\u9664\u6307\u5b9a\u7684\u5bb9\u5668\u955c\u50cf\uff0c\u4e0d\u80fd\u5220\u9664\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u955c\u50cf docker rm -f $(docker ps -aq) #\u5220\u9664\u6240\u6709\u7684\u5bb9\u5668\u955c\u50cf docker ps -a -q|xargs docker rm -f #\u5220\u9664\u6240\u6709\u7684\u5bb9\u5668\u955c\u50cf centos8\u62a5\u9519 \u542f\u52a8\u505c\u6b62\u5bb9\u5668 \u542f\u52a8 docker start ID \u91cd\u542f docker restart ID \u505c\u6b62\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u5bb9\u5668 docker stop ID \u5f3a\u5236\u505c\u6b62\u5f53\u524d\u8fd0\u884c\u5bb9\u5668 docker kill ID \u540e\u53f0\u542f\u52a8 docker run -d \u955c\u50cf\u540d \u95ee\u9898\uff1a 1.Docker\u5bb9\u5668\u4f7f\u7528\u540e\u53f0\u8fd0\u884c\uff0c\u5c31\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u524d\u53f0\u8fdb\u7a0b\uff0cDocker\u53d1\u73b0\u6ca1\u6709\u524d\u53f0\u5e94\u7528\uff0c\u5c31\u4f1a\u81ea\u52a8\u505c\u6b62 2.\u4f8b\uff1anginx,\u5bb9\u5668\u542f\u52a8\u540e\uff0c\u53d1\u73b0\u81ea\u5df1\u6ca1\u6709\u63d0\u4f9b\u670d\u52a1\uff0c\u5c31\u4f1a\u7acb\u523b\u505c\u6b62\uff0c\u5c31\u662f\u6ca1\u6709\u7a0b\u5e8f\u4e86 \u67e5\u770b\u65e5\u5fd7 docker logs \u67e5\u770b\u5e2e\u52a9\u547d\u4ee4 docker logs --help \u9996\u5148\u542f\u52a8\u5bb9\u5668\u955c\u50cf docker run -it centos /bin/bash \u5199\u4e00\u70b9\u811a\u672c docker run -d centos /bin/sh -c \"while true;do echo test;sleep 1;done\" \u67e5\u770b\u65e5\u5fd7 docker logs -tf ID \u67e5\u770b\u5177\u4f53\u884c\u7684\u65e5\u5fd7 docker logs -tf --tail N ID \u8fdb\u7a0b\u4fe1\u606f docker top ID docker top ID \u5bb9\u5668\u4fe1\u606f docker inspect ID \u5e2e\u52a9\u547d\u4ee4 Args:\u4f20\u9012\u7684\u53c2\u6570 pid:\u8fdb\u7a0b Mounts:\u6302\u8f7d\u4fe1\u606f Env:\u73af\u5883\u53d8\u91cf [root@localhost ~]# docker inspect 072d6fb47015 [ { \"Id\": \"072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056\", \"Created\": \"2020-11-02T04:44:44.123849543Z\", \"Path\": \"/bin/bash\", \"Args\": [], \"State\": { \"Status\": \"running\", \"Running\": true, \"Paused\": false, \"Restarting\": false, \"OOMKilled\": false, \"Dead\": false, \"Pid\": 2448, \"ExitCode\": 0, \"Error\": \"\", \"StartedAt\": \"2020-11-02T04:44:44.305600406Z\", \"FinishedAt\": \"0001-01-01T00:00:00Z\" }, \"Image\": \"sha256:0d120b6ccaa8c5e149176798b3501d4dd1885f961922497cd0abef155c869566\", \"ResolvConfPath\": \"/var/lib/docker/containers/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056/resolv.conf\", \"HostnamePath\": \"/var/lib/docker/containers/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056/hostname\", \"HostsPath\": \"/var/lib/docker/containers/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056/hosts\", \"LogPath\": \"/var/lib/docker/containers/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056-json.log\", \"Name\": \"/wonderful_carson\", \"RestartCount\": 0, \"Driver\": \"overlay2\", \"Platform\": \"linux\", \"MountLabel\": \"\", \"ProcessLabel\": \"\", \"AppArmorProfile\": \"\", \"ExecIDs\": null, \"HostConfig\": { \"Binds\": null, \"ContainerIDFile\": \"\", \"LogConfig\": { \"Type\": \"json-file\", \"Config\": {} }, \"NetworkMode\": \"default\", \"PortBindings\": {}, \"RestartPolicy\": { \"Name\": \"no\", \"MaximumRetryCount\": 0 }, \"AutoRemove\": false, \"VolumeDriver\": \"\", \"VolumesFrom\": null, \"CapAdd\": null, \"CapDrop\": null, \"Capabilities\": null, \"Dns\": [], \"DnsOptions\": [], \"DnsSearch\": [], \"ExtraHosts\": null, \"GroupAdd\": null, \"IpcMode\": \"private\", \"Cgroup\": \"\", \"Links\": null, \"OomScoreAdj\": 0, \"PidMode\": \"\", \"Privileged\": false, \"PublishAllPorts\": false, \"ReadonlyRootfs\": false, \"SecurityOpt\": null, \"UTSMode\": \"\", \"UsernsMode\": \"\", \"ShmSize\": 67108864, \"Runtime\": \"runc\", \"ConsoleSize\": [ 0, 0 ], \"Isolation\": \"\", \"CpuShares\": 0, \"Memory\": 0, \"NanoCpus\": 0, \"CgroupParent\": \"\", \"BlkioWeight\": 0, \"BlkioWeightDevice\": [], \"BlkioDeviceReadBps\": null, \"BlkioDeviceWriteBps\": null, \"BlkioDeviceReadIOps\": null, \"BlkioDeviceWriteIOps\": null, \"CpuPeriod\": 0, \"CpuQuota\": 0, \"CpuRealtimePeriod\": 0, \"CpuRealtimeRuntime\": 0, \"CpusetCpus\": \"\", \"CpusetMems\": \"\", \"Devices\": [], \"DeviceCgroupRules\": null, \"DeviceRequests\": null, \"KernelMemory\": 0, \"KernelMemoryTCP\": 0, \"MemoryReservation\": 0, \"MemorySwap\": 0, \"MemorySwappiness\": null, \"OomKillDisable\": false, \"PidsLimit\": null, \"Ulimits\": null, \"CpuCount\": 0, \"CpuPercent\": 0, \"IOMaximumIOps\": 0, \"IOMaximumBandwidth\": 0, \"MaskedPaths\": [ \"/proc/asound\", \"/proc/acpi\", \"/proc/kcore\", \"/proc/keys\", \"/proc/latency_stats\", \"/proc/timer_list\", \"/proc/timer_stats\", \"/proc/sched_debug\", \"/proc/scsi\", \"/sys/firmware\" ], \"ReadonlyPaths\": [ \"/proc/bus\", \"/proc/fs\", \"/proc/irq\", \"/proc/sys\", \"/proc/sysrq-trigger\" ] }, \"GraphDriver\": { \"Data\": { \"LowerDir\": \"/var/lib/docker/overlay2/31c0a7dadc6ab0aac8610ef1cbc6453a7deb07b7e4041eb13d0fde9ffcc1fca2-init/diff:/var/lib/docker/overlay2/a3eea815ce2e49aeb13672555a2278994bc4d4510b0e7d8418f5966573d90b7b/diff\", \"MergedDir\": \"/var/lib/docker/overlay2/31c0a7dadc6ab0aac8610ef1cbc6453a7deb07b7e4041eb13d0fde9ffcc1fca2/merged\", \"UpperDir\": \"/var/lib/docker/overlay2/31c0a7dadc6ab0aac8610ef1cbc6453a7deb07b7e4041eb13d0fde9ffcc1fca2/diff\", \"WorkDir\": \"/var/lib/docker/overlay2/31c0a7dadc6ab0aac8610ef1cbc6453a7deb07b7e4041eb13d0fde9ffcc1fca2/work\" }, \"Name\": \"overlay2\" }, \"Mounts\": [], \"Config\": { \"Hostname\": \"072d6fb47015\", \"Domainname\": \"\", \"User\": \"\", \"AttachStdin\": true, \"AttachStdout\": true, \"AttachStderr\": true, \"Tty\": true, \"OpenStdin\": true, \"StdinOnce\": true, \"Env\": [ \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" ], \"Cmd\": [ \"/bin/bash\" ], \"Image\": \"centos\", \"Volumes\": null, \"WorkingDir\": \"\", \"Entrypoint\": null, \"OnBuild\": null, \"Labels\": { \"org.label-schema.build-date\": \"20200809\", \"org.label-schema.license\": \"GPLv2\", \"org.label-schema.name\": \"CentOS Base Image\", \"org.label-schema.schema-version\": \"1.0\", \"org.label-schema.vendor\": \"CentOS\" } }, \"NetworkSettings\": { \"Bridge\": \"\", \"SandboxID\": \"8b6a572d50123d07c047632ddc336df8a9f717e485a09e5b469d572a435514ce\", \"HairpinMode\": false, \"LinkLocalIPv6Address\": \"\", \"LinkLocalIPv6PrefixLen\": 0, \"Ports\": {}, \"SandboxKey\": \"/var/run/docker/netns/8b6a572d5012\", \"SecondaryIPAddresses\": null, \"SecondaryIPv6Addresses\": null, \"EndpointID\": \"c75a2ed0b7f7a7de7315f9c0ce8d1a77324949ae192f5ca4d8a0040ec1581738\", \"Gateway\": \"172.17.0.1\", \"GlobalIPv6Address\": \"\", \"GlobalIPv6PrefixLen\": 0, \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"\", \"MacAddress\": \"02:42:ac:11:00:02\", \"Networks\": { \"bridge\": { \"IPAMConfig\": null, \"Links\": null, \"Aliases\": null, \"NetworkID\": \"697346d198aa6d39088da36bf3aa32eee7ef70ae170fa52118cb7ed8cc8993f6\", \"EndpointID\": \"c75a2ed0b7f7a7de7315f9c0ce8d1a77324949ae192f5ca4d8a0040ec1581738\", \"Gateway\": \"172.17.0.1\", \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"\", \"GlobalIPv6Address\": \"\", \"GlobalIPv6PrefixLen\": 0, \"MacAddress\": \"02:42:ac:11:00:02\", \"DriverOpts\": null } } } } ] [root@localhost ~]# \u8fdb\u5165\u8fd0\u884c\u5bb9\u5668 \u901a\u5e38\u5bb9\u5668\u90fd\u662f\u4f7f\u7528\u540e\u53f0\u65b9\u5f0f\u8fd0\u884c\uff0c\u9700\u8981\u8fdb\u5165\u5bb9\u5668\uff0c\u4fee\u6539\u4e00\u4e9b\u914d\u7f6e docker exec docker exec -it \u5bb9\u5668ID bashshell \u6d4b\u8bd5 [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 072d6fb47015 centos \"/bin/bash\" 6 hours ago Up 6 hours wonderful_carson [root@localhost ~]# docker exec -it 072d6fb47015 /bin/bash [root@072d6fb47015 /]# ls bin etc lib lost+found mnt proc run srv tmp var dev home lib64 media opt root sbin sys usr [root@072d6fb47015 /]# ps -ef UID PID PPID C STIME TTY TIME CMD root 1 0 0 05:52 pts/0 00:00:00 /bin/bash root 16 0 0 10:25 pts/1 00:00:00 /bin/bash root 30 16 0 10:26 pts/1 00:00:00 ps -ef [root@072d6fb47015 /]# docker attach docker attach \u5bb9\u5668ID \u6bd4\u8f83: docker exec \u8fdb\u5165\u5bb9\u5668\u540e\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff0c\u53ef\u4ee5\u5728\u91cc\u9762\u64cd\u4f5c\uff08\u5e38\u7528\uff09 docker attach \u8fdb\u5165\u5bb9\u5668\u6b63\u5728\u6267\u884c\u7684\u7ec8\u7aef\uff0c\u4e0d\u4f1a\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b\uff01 \u4ece\u5bb9\u5668\u5185\u62f7\u8d1d\u6587\u4ef6\u5230\u4e3b\u673a docker cp docker cp \u5bb9\u5668ID:\u5bb9\u5668\u5185\u8def\u5f84 \u4e3b\u673a\u8def\u5f84 [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 072d6fb47015 centos \"/bin/bash\" 6 hours ago Up 6 hours wonderful_carson #\u8fdb\u5165docker\u5bb9\u5668\u5185\u90e8 [root@localhost ~]# docker attach 072d6fb47015 [root@072d6fb47015 /]# cd /home/ [root@072d6fb47015 home]# ls #\u5728\u5bb9\u5668\u5185\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6 [root@072d6fb47015 home]# touch test.txt [root@072d6fb47015 home]# ls test.txt #\u9000\u51fa\u5bb9\u5668\u8fdb\u884c\u62f7\u8d1d\u6d4b\u8bd5\uff0c\u9000\u51fa\u4e0d\u5f71\u54cd\u6587\u4ef6\u7684\u62f7\u8d1d [root@072d6fb47015 home]# exit exit #\u5c06\u6587\u4ef6\u62f7\u8d1d\u5230\u4e3b\u673a\u4e0a [root@localhost ~]# docker cp 072d6fb47015:/home/test.txt /home/ [root@localhost ~]# cd /home/ [root@localhost home]# ls test.txt [root@localhost home]# \u5c0f\u7ed3 attach Attach to a running container #\u5f53\u524dshe 11 \u4e0battach\u8fde\u63a5\u6307\u5b9a\u8fd0\u884c\u955c\u50cf build Bui1dan image from a Docker file #\u901a\u8fc7Docker file\u5b9a\u5236\u955c\u50cf commit Create a new image from a container changes #\u63d0\u4ea4\u5f53\u524d\u5bb9\u5668\u4e3a\u65b0\u7684\u955c\u50cf cp Copyfiles/fo1ders from the containers filesystem to the host path #\u4ece\u5bb9\u5668\u4e2d\u62f7\u8d1d\u6307\u5b9a\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u5230\u5bbf\u4e3b\u673a\u4e2d create Create a new container #\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5bb9\u5668\uff0c \u540crun\uff0c \u4f46\u4e0d\u542f\u52a8\u5bb9\u5668 diff Inspect changes on a container's filesystem #\u67e5\u770bdocker\u5bb9\u5668\u53d8\u5316 events Get real time events from the server #\u4ecedocker\u670d\u52a1\u83b7\u53d6\u5bb9\u5668\u5b9e\u65f6\u4e8b\u4ef6 exec Run a command in an existing container #\u5728\u5df2\u5b58\u5728\u7684\u5bb9\u5668\u4e0a\u8fd0\u884c\u547d\u4ee4 export Stream the contents of a container as at ar archive #\u5bfc\u51fa\u5bb9\u5668\u7684\u5185\u5bb9\u6d41\u4f5c\u4e3a\u4e00\u4e2atar\u5f52\u6863\u6587\u4ef6[\u5bf9\u5e94 import] history show the history of an image #\u5c55\u793a\u4e00\u4e2a\u955c\u50cf\u5f62\u6210\u5386\u53f2 images List images #\u5217\u51fa\u7cfb\u7edf\u5f53\u524d\u955c\u50cf import create a new filesystem image from the contents of at arba 11 #\u4ecetar\u5305\u4e2d\u7684\u5185\u5bb9\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u7cfb \u7edf\u6620\u50cf[\u5bf9\u5e94export] info Display system-wide information #\u663e\u793a\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f inspect Return 1ow-1eve 1 information on a container #\u67e5\u770b\u5bb9\u5668\u8be6\u7ec6\u4fe1\u606f kill kill a running container #ki ll\u6307\u5b9adocker\u5bb9\u5668 load Load an image from at ar archive #\u4ece\u4e00\u4e2atar\u5305\u4e2d\u52a0\u8f7d\u4e00\u4e2a\u955c\u50cf[\u5bf9\u5e94save] login Register or Login to the docker registry server #\u6ce8\u518c\u6216\u8005\u767b\u9646\u4e00\u4e2adocker\u6e90\u670d\u52a1\u5668 logout Logout from a Docker registry server #\u4ece\u5f53\u524dDocker registry\u9000\u51fa logs Fetch the 1ogsofa container #\u8f93\u51fa\u5f53\u524d\u5bb9\u5668\u65e5\u5fd7\u4fe1\u606f port Lookup the pub1ic-facing port which is NAT-ed to PRIVATE_PORT #\u67e5\u770b\u6620\u5c04\u7aef\u53e3\u5bf9\u5e94\u7684\u5bb9\u5668\u5185\u90e8\u6e90\u7aef \u53e3 pause Pause a 11 processes within a container #\u6682\u505c\u5bb9\u5668 ps List containers #\u5217\u51fa\u5bb9\u5668\u5217\u8868 pull Pullanimageora repository from the docker registry server #\u4ecedocker\u955c\u50cf\u6e90\u670d\u52a1\u5668\u62c9\u53d6\u6307\u5b9a\u955c\u50cf\u6216\u8005\u5e93\u955c\u50cf push Push an image or a repository to the docker registry server #\u63a8\u9001\u6307\u5b9a\u955c\u50cf\u6216\u8005\u5e93\u955c\u50cf\u81f3docker\u6e90\u670d\u52a1\u5668 restart Restart a running container #\u91cd\u542f\u8fd0\u884c\u7684\u5bb9\u5668 rm Remove one or more containers #\u79fb\u9664\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5bb9\u5668 rmi Remove one or more images #\u79fb\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u955c\u50cf[\u65e0\u5bb9\u5668\u4f7f\u7528\u8be5\u955c\u50cf\u624d\u53ef\u5220\u9664\uff0c\u5426\u5219\u9700\u5220\u9664\u76f8\u5173\u5bb9 \u5668\u624d\u53ef\u7ee7\u7eed\u6216-f\u5f3a\u5236\u5220\u9664] run Run a command in a new container #\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5bb9\u5668\u5e76\u8fd0\u884c\u4e00\u4e2a\u547d\u4ee4 save Save an image to at ar archive #\u4fdd\u5b58\u4e00\u4e2a\u955c\u50cf\u4e3a\u4e00\u4e2atar\u5305[\u5bf9\u5e941oad] search Search for an image on the Docker Hub #\u5728docker hub\u4e2d\u641c\u7d22\u955c\u50cf start Start a stopped containers #\u542f\u52a8\u5bb9\u5668 stop Stop a running containers #\u505c\u6b62\u5bb9\u5668 tag Tagan image into a repository #\u7ed9\u6e90\u4e2d\u955c\u50cf\u6253\u6807\u7b7e top Lookup the running processes of a container #\u67e5\u770b\u5bb9\u5668\u4e2d\u8fd0\u884c\u7684\u8fdb\u7a0b\u4fe1\u606f un pause Un pause a paused container #\u53d6\u6d88\u6682\u505c\u5bb9\u5668 version Show the docker version information #\u67e5\u770bdocker\u7248\u672c\u53f7 wait Block until a container stops\uff0c then print its exitcode #\u622a\u53d6\u5bb9\u5668\u505c\u6b62\u65f6\u7684\u9000\u51fa\u72b6\u6001\u503c \u90e8\u7f72Nginx \u641c\u7d22\u955c\u50cf \u7f51\u9875\u641c\u7d22\u955c\u50cf \u5efa\u8bae\u5728docker hub\u8fdb\u884c\u641c\u7d22\uff0c\u53ef\u4ee5\u770b\u5230\u5e2e\u52a9\u6587\u6863\u3002 \u6253\u5f00\u67e5\u770b\u955c\u50cf\u8be6\u7ec6\u4fe1\u606f \u547d\u4ee4\u641c\u7d22\u955c\u50cf docker search nginx \u4e0b\u8f7d\u955c\u50cf docker pull nginx \u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf docker images \u542f\u52a8\u955c\u50cf docker run -d --name=nginx01 -p 3344:80 nginx -d #\u540e\u53f0\u8fd0\u884c --name #\u7ed9\u5bb9\u5668\u8d77\u540d -p #\u66b4\u9732\u7aef\u53e3\uff08\u5bbf\u4e3b\u673a\u7aef\u53e3\uff1a\u5bb9\u5668\u5185\u90e8\u7aef\u53e3\uff09 \u67e5\u770b\u8fd0\u884c\u5bb9\u5668 docker ps \u8bf7\u6c42\u6d4b\u8bd5 curl localhost:3344 \u8fdb\u5165\u5bb9\u5668 docker exec -it nginx01 /bin/bash \u8fdb\u5165\u5bb9\u5668\uff0c\u641c\u7d22nginx,\u67e5\u770bnginx\u914d\u7f6e\u6587\u4ef6\uff0c\u9000\u51fa\u5bb9\u5668\uff0c\u505c\u6b62\u5bb9\u5668\uff0c\u518d\u6b21\u8bbf\u95ee\u6d4b\u8bd5 [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STAT 370ce844910c nginx \"/docker-entrypoint.\u2026\" 17 minutes ago Up 1 [root@localhost ~]# docker exec -it nginx01 /bin/bash root@370ce844910c:/# whereis nginx nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx root@370ce844910c:/# cd /etc/nginx/ root@370ce844910c:/etc/nginx# ls conf.d koi-utf mime.types nginx.conf uwsgi_params fastcgi_params koi-win modules scgi_params win-utf root@370ce844910c:/etc/nginx# exit exit [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 370ce844910c nginx \"/docker-entrypoint.\u2026\" 19 minutes ago Up 19 minutes 0.0.0.0:3344->80/tcp nginx01 [root@localhost ~]# docker stop 370ce844910c 370ce844910c [root@localhost ~]# \u505c\u6b62\u5bb9\u5668\u540e\u4fbf\u65e0\u6cd5\u8bbf\u95eenginx \u90e8\u7f72tomcat \u641c\u7d22\u955c\u50cf \u5b98\u65b9\u4f7f\u7528\uff1a \u6d4b\u8bd5\u4f7f\u7528\uff1a\u7528\u5b8c\u5373\u5220\u9664\u5bb9\u5668 docker run -it --rm toncat:9.0 \u5bb9\u5668\u5220\u9664\uff0c\u955c\u50cf\u8fd8\u5728 \u4e0b\u8f7d\u955c\u50cf docker pull tomcat \u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf docker images \u542f\u52a8\u955c\u50cf \u4ee5\u540e\u53f0\u7684\u65b9\u5f0f\u542f\u52a8 docker run -d -p 3355:8080 --name=tomcat01 tomcat \u8bbf\u95ee\u6d4b\u8bd5 \u6d4b\u8bd5\u8bbf\u95ee\u6ca1\u6709\u95ee\u9898\uff0c\u5c11\u4e1c\u897f \u8fdb\u5165\u5bb9\u5668 docker exec -it tomcat01 /bin/bash \u95ee\u9898\uff1a \u547d\u4ee4\u7f3a\u5c11 webapps\u76ee\u5f55\u6ca1\u6709\u6587\u4ef6 \u539f\u56e0\uff1a \u963f\u91cc\u4e91\u955c\u50cf\u539f\u56e0\uff0c\u9ed8\u8ba4\u6700\u5c0f\u7684\u955c\u50cf\uff0c \u6240\u6709\u4e0d\u5fc5\u8981\u7684\u90fd\u5220\u9664\u6389\uff0c\u4fdd\u8bc1\u6700\u5c0f\u53ef\u8fd0\u884c\u7684\u73af\u5883\u3002 \u89e3\u51b3\u8bbf\u95ee webapps\u6587\u4ef6\u88ab\u653e\u5728\u4e86webapps.dist\u76ee\u5f55\u4e2d\uff0c\u62f7\u8d1dwebapps.dist\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u5230webapps\u4e2d\uff0c\u518d\u6b21\u5237\u65b0\u6d4b\u8bd5\u8bbf\u95ee\u3002 \u518d\u6b21\u6d4b\u8bd5 \u90e8\u7f72es+kibana \u5168\u6587\u641c\u7d22\u5f15\u64ceelasticsearch \u641c\u7d22\u955c\u50cf es: \u66b4\u9732\u7684\u7aef\u53e3\u5f88\u591a \u5341\u5206\u7684\u8017\u5185\u5b58 --net somenetwork \u7f51\u7edc \u4e0b\u8f7d\u542f\u52a8\u955c\u50cf docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" elasticsearch:7.6.2 \u67e5\u770b\u8fd0\u884c\u5bb9\u5668 docker ps \u67e5\u770bCPU\u5185\u5b58\u72b6\u6001 \u5185\u5b58\u5360\u7528\u8f83\u9ad8 docker stats \u8bf7\u6c42\u6d4b\u8bd5 curl localhost:9200 \u589e\u52a0\u5185\u5b58\u9650\u5236 \u5173\u95ed\u5bb9\u5668\uff0c\u589e\u52a0\u5185\u5b58\u9650\u5236\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 -e:\u73af\u5883\u914d\u7f6e\u4fee\u6539 docker ps docker stop ID \u4fee\u6539\u914d\u7f6e\u518d\u6b21\u542f\u52a8 docker run -d --name elasticsearch02 -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" -e ES_JAVA_OPTS=\"-Xms64m -Xmx512m\" elasticsearch:7.6.2 \u518d\u6b21\u67e5\u770b\u72b6\u6001 \u8bf7\u6c42\u6d4b\u8bd5 curl localhost:9200 \u4f7f\u7528kibana\u8fde\u63a5elasticsearch portainer\u53ef\u89c6\u5316 Docker\u56fe\u5f62\u5316\u754c\u9762\u7ba1\u7406\u5de5\u5177\uff01\u63d0\u4f9b\u4e00\u4e2a\u540e\u53f0\u9762\u677f\u4f9b\u6211\u4eec\u64cd\u4f5c\uff01 \u4e0b\u8f7d\u8fd0\u884c\u955c\u50cf docker run -d -p 8088:9000 \\ --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer \u8bbf\u95ee\u6d4b\u8bd5 curl localhost:8088 \u7f51\u9875\u8bbf\u95ee http://IP:8088 \u8bbe\u7f6e\u5bc6\u7801\uff0c\u521b\u5efa\u7528\u6237\u3002\u9009\u62e9LOCAL\u6570\u636e\u3002 \u8fdb\u5165\u9762\u677f Docker\u955c\u50cf\u8bb2\u89e3 \u955c\u50cf\u662f\u4ec0\u4e48\uff1f \u955c\u50cf\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u3001\u53ef\u6267\u884c\u7684\u72ec\u7acb\u8f6f\u4ef6\u5305\uff0c\u7528\u6765\u6253\u5305\u8f6f\u4ef6\u8fd0\u884c\u73af\u5883\u548c\u57fa\u4e8e\u8fd0\u884c\u73af\u5883\u5f00\u53d1\u7684\u8f6f\u4ef6\uff0c\u5b83\u5305\u542b\u8fd0\u884c\u67d0\u4e2a\u8f6f\u4ef6\u6240\u9700\u7684\u6240\u6709\u5185\u5bb9\uff0c\u5305\u62ec\u4ee3\u7801\u3001\u8fd0\u884c\u65f6\u3001\u5e93\u3001\u73af\u5883\u53d8\u91cf\u548c\u914d\u7f6e\u6587\u4ef6\u3002 \u6240\u6709\u7684\u5e94\u7528\uff0c \u76f4\u63a5\u6253\u5305\u6210docker\u955c\u50cf\uff0c \u5c31\u53ef\u4ee5\u76f4\u63a5\u8dd1\u8d77\u6765! \u5982\u4f55\u5f97\u5230\u955c\u50cf\uff1f \u4ece\u8fdc\u7a0b\u4ed3\u5e93\u4e0b\u8f7d \u670b\u53cb\u62f7\u8d1d\u7ed9\u4f60 \u81ea\u5df1\u5236\u4f5c\u4e00\u4e2a\u955c\u50cfDocker File UnionFS\u8054\u5408\u6587\u4ef6\u7cfb\u7edf \u6211\u4eec\u4e0b\u8f7d\u7684\u65f6\u5019\u770b\u5230\u7684\u4e00\u5c42\u4e00\u5c42\u5c31\u662f\u5206\u5c42\u4e0b\u8f7d\uff01 UnionFS(\u8054\u5408\u6587\u4ef6\u7cfb\u7edf) \uff1aUnion\u6587\u4ef6\u7cfb\u7edf(UnionFS) \u662f\u4e00\u79cd\u5206\u5c42\u3001\u8f7b\u91cf\u7ea7\u5e76\u4e14\u9ad8\u6027\u80fd\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c \u5b83\u652f\u6301\u5bf9\u6587\u4ef6\u7cfb\u7edf\u7684\u4fee\u6539\u4f5c\u4e3a\u4e00\u6b21\u63d0\u4ea4\u6765\u4e00\u5c42\u5c42\u7684\u53e0\u52a0\uff0c\u540c\u65f6\u53ef\u4ee5\u5c06\u4e0d\u540c\u76ee\u5f55\u6302\u8f7d\u5230\u540c\u4e00\u4e2a\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u4e0b(unite several directories into a single virtual filesystem) \u3002Union\u6587\u4ef6\u7cfb\u7edf\u662fDocker\u955c\u50cf\u7684\u57fa\u7840\u3002\u955c\u50cf\u53ef\u4ee5\u901a\u8fc7\u5206\u5c42\u6765\u8fdb\u884c\u7ee7\u627f\uff0c \u57fa\u4e8e\u57fa\u7840\u955c\u50cf(\u6ca1\u6709\u7236\u955c\u50cf) \uff0c \u53ef\u4ee5\u5236\u4f5c\u5404\u79cd\u5177\u4f53\u7684\u5e94\u7528\u955c\u50cf\u3002 \u7279\u6027\uff1a\u4e00\u6b21\u540c\u65f6\u52a0\u8f7d\u591a\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f46\u4ece\u5916\u9762\u770b\u8d77\u6765\uff0c\u53ea\u80fd\u770b\u5230\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff0c\u8054\u5408\u52a0\u8f7d\u4f1a\u628a\u5404\u5c42\u6587\u4ef6\u7cfb\u7edf\u53e0\u52a0\u8d77\u6765\uff0c\u8fd9\u6837\u6700\u7ec8\u7684 \u6587\u4ef6\u7cfb\u7edf\u4f1a\u5305\u542b\u6240\u6709\u5e95\u5c42\u7684\u6587\u4ef6\u548c\u76ee\u5f55 \u3002 Docker\u955c\u50cf\u52a0\u8f7d\u539f\u7406 docker\u7684\u955c\u50cf\u5b9e\u9645\u4e0a\u7531\u4e00\u5c42\u4e00\u5c42\u7684\u6587\u4ef6\u7cfb\u7edf\u7ec4\u6210\uff0c \u8fd9\u79cd\u5c42\u7ea7\u7684\u6587\u4ef6\u7cfb\u7edfUnionFS\u3002 bootfs(boot file system) \u4e3b\u8981\u5305\u542bbootloader\u548ckernel\uff0cbootloader\u4e3b\u8981\u662f\u5f15\u5bfc\u52a0\u8f7dkernel\uff0c Linux\u521a\u542f\u52a8\u65f6\u4f1a\u52a0\u8f7dbootfs\u6587\u4ef6\u7cfb\u7edf\uff0c\u5728Docker\u955c\u50cf\u7684\u6700\u5e95\u5c42\u662fbootfs\u3002\u8fd9\u4e00\u5c42\u4e0e\u6211\u4eec\u5178\u578b\u7684Linux/Unix\u7cfb\u7edf\u662f\u4e00\u6837\u7684\uff0c \u5305\u542bboot\u52a0\u8f7d\u5668\u548c\u5185\u6838\u3002\u5f53boot\u52a0\u8f7d\u5b8c\u6210\u4e4b\u540e\u6574\u4e2a\u5185\u6838\u5c31\u90fd\u5728\u5185\u5b58\u4e2d\u4e86\uff0c \u6b64\u65f6\u5185\u5b58\u7684\u4f7f\u7528\u6743\u5df2\u7531bootfs\u8f6c\u4ea4\u7ed9\u5185\u6838\uff0c \u6b64\u65f6\u7cfb\u7edf\u4e5f\u4f1a\u5378\u8f7dbootfs\u3002 rootfs(root file system) \uff0c\u5728bootfs\u4e4b\u4e0a\u3002\u5305\u542b\u7684\u5c31\u662f\u5178\u578bLinux\u7cfb\u7edf\u4e2d\u7684/dev\uff0c/proc\uff0c/bin\uff0c/etc\u7b49\u6807\u51c6\u76ee\u5f55\u548c\u6587\u4ef6\u3002rootfs\u5c31\u662f\u5404\u79cd\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\uff0c \u6bd4\u5982Ubuntu\uff0c Centos\u7b49\u7b49\u3002 \u5e73\u65f6\u6211\u4eec\u5b89\u88c5\u8fdb\u865a\u62df\u673a\u7684CentOS\u90fd\u662f\u597d\u51e0\u4e2aG\uff0c \u4e3a\u4ec0\u4e48Docker\u8fd9\u91cc\u624d200M? \u5bf9\u4e8e\u4e00\u4e2a\u7cbe\u7b80\u7684OS,rootfs\u53ef\u4ee5\u5f88\u5c0f\uff0c\u53ea\u9700\u8981\u5305\u542b\u6700\u57fa\u672c\u7684\u547d\u4ee4,\u5de5\u5177\u548c\u7a0b\u5e8f\u5e93\u5c31\u53ef\u4ee5\u4e86\uff0c \u56e0\u4e3a\u5e95\u5c42\u76f4\u63a5\u7528Host\u7684kernel\uff0c \u81ea\u5df1\u53ea\u9700\u8981\u63d0\u4f9brootfs\u5c31\u53ef\u4ee5\u4e86\u3002\u7531\u6b64\u53ef\u89c1\u5bf9\u4e8e\u4e0d\u540c\u7684linux\u53d1\u884c\u7248\uff0c bootfs\u57fa\u672c\u662f\u4e00\u81f4\u7684,rootfs\u4f1a\u6709\u5dee\u522b,\u56e0\u6b64\u4e0d\u540c\u7684\u53d1\u884c\u7248\u53ef\u4ee5\u516c\u7528 bootfs\u3002 \u5e95\u5c42\u5f15\u5bfc\u4e0d\u53d8 \u865a\u62df\u673a\u5206\u949f\u7ea7\u522b\uff0c\u5bb9\u5668\u79d2\u7ea7\u3002 \u5206\u5c42\u7684\u955c\u50cf \u6211\u4eec\u53ef\u4ee5\u53bb\u4e0b\u8f7d\u4e00\u4e2a\u955c\u50cf\uff0c\u6ce8\u610f\u89c2\u5bdf\u4e0b\u8f7d\u7684\u65e5\u5fd7\u8f93\u51fa\uff0c\u53ef\u4ee5\u770b\u5230\u662f\u4e00\u5c42\u4e00\u5c42\u7684\u5728\u4e0b\u8f7d! \u601d\u8003\uff1a\u4e3a\u4ec0\u4e48Docker\u955c\u50cf\u8981\u91c7\u7528\u8fd9\u79cd\u5206\u5c42\u7684\u7ed3\u6784\u5462? \u6700\u5927\u7684\u597d\u5904\uff0c\u83ab\u8fc7\u4e8e\u662f\u8d44\u6e90\u5171\u4eab!\u6bd4\u5982\u6709\u591a\u4e2a\u955c\u50cf\u90fd\u4ece\u76f8\u540c\u7684Base\u955c\u50cf\u6784\u5efa\u800c\u6765,\u90a3\u4e48\u5bbf\u4e3b\u673a\u53ea\u9700\u5728\u78c1\u76d8\u4e0a\u4fdd\u7559\u4e00\u4efdbase\u955c\u50cf,\u540c\u65f6\u5185\u5b58\u4e2d\u4e5f\u53ea\u9700\u8981\u52a0\u8f7d\u4e00\u4efdbase\u955c\u50cf,\u8fd9\u6837\u5c31\u53ef\u4ee5\u4e3a\u6240\u6709\u7684\u5bb9\u5668\u670d\u52a1\u4e86, \u800c\u4e14\u955c\u50cf\u7684\u6bcf\u4e00\u5c42\u90fd\u53ef\u4ee5\u88ab\u5171\u4eab\u3002 \u67e5\u770b\u955c\u50cf\u5206\u5c42\u7684\u65b9\u5f0f\u53ef\u4ee5\u901a\u8fc7docker image inspect\u547d\u4ee4! [root@localhost ~]# docker image inspect redis:latest [ //...... \"RootFS\": { \"Type\": \"layers\", \"Layers\": [ \"sha256:d0fe97fa8b8cefdffcef1d62b65aba51a6c87b6679628a2b50fc6a7a579f764c\", \"sha256:832f21763c8e6b070314e619ebb9ba62f815580da6d0eaec8a1b080bd01575f7\", \"sha256:223b15010c47044b6bab9611c7a322e8da7660a8268949e18edde9c6e3ea3700\", \"sha256:6a9976a8f40851f45dc8c68a04b130e90522f46bb7e8403c6e7eb4331674f213\", \"sha256:c875a9fc3ec72b140e325e1a1b3b57d299b91811e8288a07c6b788b0d7cba185\", \"sha256:d9364cb75b1a364fbcb97b2f51332fc012ae0321e18c3fd3811f5e5a9f8a2d0e\" ] }, \"Metadata\": { \"LastTagTime\": \"0001-01-01T00:00:00Z\" } } ] \u7406\u89e3\uff1a \u6240\u6709\u7684Docker\u955c\u50cf\u90fd\u8d77\u59cb\u4e8e\u4e00\u4e2a\u57fa\u7840\u955c\u50cf\u5c42\uff0c\u5f53\u8fdb\u884c\u4fee\u6539\u6216\u589e\u52a0\u65b0\u7684\u5185\u5bb9\u65f6\uff0c\u5c31\u4f1a\u5728\u5f53\u524d\u955c\u50cf\u5c42\u4e4b\u4e0a\u521b\u5efa\u65b0\u7684\u955c\u50cf\u5c42\u3002\u4e3e\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5047\u5982\u57fa\u4e8eUbuntu Linux 16.04\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\uff0c\u8fd9\u5c31\u662f\u65b0\u955c\u50cf\u7684\u7b2c\u4e00\u5c42\uff1b\u5982\u679c\u5728\u8be5\u955c\u50cf\u4e2d\u6dfb\u52a0Python\u5305\u5c31\u4f1a\u5728\u57fa\u7840\u955c\u50cf\u5c42\u4e4b\u4e0a\u521b\u5efa\u7b2c\u4e8c\u4e2a\u955c\u50cf\u5c42\uff1b\u5982\u679c\u7ee7\u7eed\u6dfb\u52a0\u4e00\u4e2a\u5b89\u5168\u8865\u4e01\uff0c\u5c31\u4f1a\u521b\u5efa\u7b2c\u4e09\u4e2a\u955c\u50cf\u5c42\u3002\u8be5\u955c\u50cf\u5f53\u524d\u5df2\u7ecf\u5305\u542b3\u4e2a\u955c\u50cf\u5c42\uff0c\u5982\u4e0b\u56fe\u6240\u793a(\u8fd9\u53ea\u662f\u4e00\u4e2a\u7528\u4e8e\u6f14\u793a\u7684\u5f88\u7b80\u5355\u7684\u4f8b\u5b50)\u3002 \u5728\u6dfb\u52a0\u989d\u5916\u7684\u955c\u50cf\u5c42\u7684\u540c\u65f6\uff0c\u955c\u50cf\u59cb\u7ec8\u4fdd\u6301\u662f\u5f53\u524d\u6240\u6709\u955c\u50cf\u7684\u7ec4\u5408\uff0c\u7406\u89e3\u8fd9\u4e00\u70b9\u975e\u5e38\u91cd\u8981\u3002\u4e0b\u56fe\u4e2d\u4e3e\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u6bcf\u4e2a\u955c\u50cf\u5c42\u5305\u542b3\u4e2a\u6587\u4ef6\uff0c\u800c\u955c\u50cf\u5305\u542b\u4e86\u6765\u81ea\u4e24\u4e2a\u955c\u50cf\u5c42\u76846\u4e2a\u6587\u4ef6\u3002 \u4e0a\u56fe\u4e2d\u7684\u955c\u50cf\u5c42\u8ddf\u4e4b\u524d\u56fe\u4e2d\u7684\u7565\u6709\u533a\u522b\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u4fbf\u4e8e\u5c55\u793a\u6587\u4ef6\u3002 \u4e0b\u56fe\u4e2d\u5c55\u793a\u4e86\u4e00\u4e2a\u7a0d\u5fae\u590d\u6742\u7684\u4e09\u5c42\u955c\u50cf\uff0c\u5728\u5916\u90e8\u770b\u6765\u6574\u4e2a\u955c\u50cf\u53ea\u67096\u4e2a\u6587\u4ef6\uff0c\u8fd9\u662f\u56e0\u4e3a\u6700\u4e0a\u5c42\u4e2d\u7684\u6587\u4ef67\u662f\u6587\u4ef65\u7684\u4e00\u4e2a\u66f4\u65b0\u7248\u672c\u3002 \u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0a\u5c42\u955c\u50cf\u5c42\u4e2d\u7684\u6587\u4ef6\u8986\u76d6\u4e86\u5e95\u5c42\u955c\u50cf\u5c42\u4e2d\u7684\u6587\u4ef6\u3002\u8fd9\u6837\u5c31\u4f7f\u5f97\u6587\u4ef6\u7684\u66f4\u65b0\u7248\u672c\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u955c\u50cf\u5c42\u6dfb\u52a0\u5230\u955c\u50cf\u5f53\u4e2d\u3002 Docker\u901a\u8fc7\u5b58\u50a8\u5f15\u64ce(\u65b0\u7248\u672c\u91c7\u7528\u5feb\u7167\u673a\u5236) \u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u955c\u50cf\u5c42\u5806\u6808\uff0c \u5e76\u4fdd\u8bc1\u591a\u955c\u50cf\u5c42\u5bf9\u5916\u5c55\u793a\u4e3a\u7edf\u4e00\u7684\u6587\u4ef6\u7cfb\u7edf\u3002 Linux\u4e0a\u53ef\u7528\u7684\u5b58\u50a8\u5f15\u64ce\u6709AUFS\u3001 Overlay2\u3001Device Mapper\u3001Btrfs\u4ee5\u53caZFS\u3002\u987e\u540d\u601d\u4e49\uff0c \u6bcf\u79cd\u5b58\u50a8\u5f15\u64ce\u90fd\u57fa\u4e8eLinux\u4e2d\u5bf9\u5e94\u7684\u6587\u4ef6\u7cfb\u7edf\u6216\u8005\u5757\u8bbe\u5907\u6280\u672f\uff0c\u5e76\u4e14\u6bcf\u79cd\u5b58\u50a8\u5f15\u64ce\u90fd\u6709\u5176\u72ec\u6709\u7684\u6027\u80fd\u7279\u70b9\u3002 Docker\u5728Windows\u4e0a\u4ec5\u652f\u6301windows filter\u4e00\u79cd\u5b58\u50a8\u5f15\u64ce\uff0c \u8be5\u5f15\u64ce\u57fa\u4e8eNTFS\u6587\u4ef6\u7cfb\u7edf\u4e4b\u4e0a\u5b9e\u73b0\u4e86\u5206\u5c42\u548cCoW[1] \u3002 \u4e0b\u56fe\u5c55\u793a\u4e86\u4e0e\u7cfb\u7edf\u663e\u793a\u76f8\u540c\u7684\u4e09\u5c42\u955c\u50cf\u3002\u6240\u6709\u955c\u50cf\u5c42\u5806\u53e0\u5e76\u5408\u5e76\uff0c\u5bf9\u5916\u63d0\u4f9b\u7edf\u4e00\u7684\u89c6\u56fe\u3002 \u7279\u70b9 Docker\u955c\u50cf\u90fd\u662f\u53ea\u8bfb\u7684\uff0c \u5f53\u5bb9\u5668\u542f\u52a8\u65f6\uff0c \u4e00\u4e2a\u65b0\u7684\u53ef\u5199\u5c42\u88ab\u52a0\u8f7d\u5230\u955c\u50cf\u7684\u9876\u90e8 \u8fd9\u4e00\u5c42\u5c31\u662f\u6211\u4eec\u901a\u5e38\u8bf4\u7684\u5bb9\u5668\u5c42\uff0c\u5bb9\u5668\u4e4b\u4e0b\u7684\u90fd\u53eb\u955c\u50cf\u5c42! \u6ce8\uff1a\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u57fa\u4e8e\u5bb9\u5668\u5c42\u3002 \u5982\u4f55\u63d0\u4ea4\u4e00\u4e2a\u81ea\u5df1\u7684\u955c\u50cf\uff1f commit\u63d0\u4ea4\u955c\u50cf \u63d0\u4ea4\u4fee\u6539\u7684\u5bb9\u5668\u6210\u4e3a\u4e00\u4e2a\u65b0\u7684\u526f\u672c docker commit docker commit -m=\"\u63d0\u4ea4\u7684\u63cf\u8ff0\u4fe1\u606f\" -a=\"\u4f5c\u8005\" ID\u76ee\u6807\u955c\u50cf\u540d:[TAG] \u67e5\u770b\u955c\u50cf docker images \u4ea4\u4e92\u6a21\u5f0f\u542f\u52a8 docker run -it -p 8080:8080 tomcat \u65b0\u5f00\u7a97\u53e3 \u67e5\u770b\u8fd0\u884c\u5bb9\u5668 docker ps \u8fdb\u5165\u8fd0\u884c\u7684\u5bb9\u5668 docker exec -it ID /bin/bash \u4fee\u6539\u5bb9\u5668\u5185\u5bb9 \u542f\u52a8\u9ed8\u8ba4\u7684tamcat \u53d1\u73b0\u8fd9\u4e2a\u9ed8\u8ba4\u7684tamcat\u662f\u6ca1\u6709webapps\u5e94\u7528\uff0c\u955c\u50cf\u7684\u539f\u56e0\uff0c\u5b98\u65b9\u955c\u50cf\u9ed8\u8ba4webapps\u4e0b\u9762\u662f\u6ca1\u6709\u6587\u4ef6\u7684\u3002 \u81ea\u5df1\u62f7\u8d1d\u8fdb\u53bb\u57fa\u672c\u6587\u4ef6 \u5c06\u4fee\u6539\u7684\u5bb9\u5668\u6253\u5305 docker commit -m=\"\u63d0\u4ea4\u7684\u63cf\u8ff0\u4fe1\u606f\" -a=\"\u4f5c\u8005\" ID \u76ee\u6807\u955c\u50cf\u540d:[TAG\u7248\u672c] -a=\"\u4f5c\u8005\" -m=\"\u63cf\u8ff0\" docker commit -a=\"lwenwu\" -m=\"add webapps app\" 444facacd961 tomcat02:1.0 \u67e5\u770b\u6253\u5305\u597d\u7684\u955c\u50cf docker images \u6bd4\u539f\u6765\u7684\u955c\u50cf\u5927\u4e86\u4e00\u4e9b\uff0c\u53ef\u4ee5\u76f4\u63a5\u542f\u52a8\u8fd0\u884c\u3002 \u5bb9\u5668\u6570\u636e\u5377 \u4ec0\u4e48\u662f\u5bb9\u5668\u6570\u636e\u5377\uff1f docker\u7684\u7406\u5ff5\u56de\u987e \u5c06\u5e94\u7528\u548c\u73af\u5883\u6253\u5305\u6210\u4e00\u4e2a\u955c\u50cf! \u6570\u636e?\u5982\u679c\u6570\u636e\u90fd\u5728\u5bb9\u5668\u4e2d\uff0c\u90a3\u4e48\u6211\u4eec\u5bb9\u5668\u5220\u9664\uff0c\u6570\u636e\u5c31\u4f1a\u4e22\u5931!\u9700\u6c42\uff1a\u6570\u636e\u53ef\u4ee5\u6301\u4e45\u5316 MySQL\uff0c\u5bb9\u5668\u5220\u4e86\uff0c\u5220\u5e93\u8dd1\u8def!\u9700\u6c42\uff1aMySQL\u6570\u636e\u53ef\u4ee5\u5b58\u50a8\u5728\u672c\u5730! \u5bb9\u5668\u4e4b\u95f4\u53ef\u4ee5\u6709\u4e00\u4e2a\u6570\u636e\u5171\u4eab\u7684\u6280\u672f!Docker\u5bb9\u5668\u4e2d\u4ea7\u751f\u7684\u6570\u636e\uff0c\u540c\u6b65\u5230\u672c\u5730!\u8fd9\u5c31\u662f\u5377\u6280\u672f!\u76ee\u5f55\u7684\u6302\u8f7d\uff0c\u5c06\u6211\u4eec\u5bb9\u5668\u5185\u7684\u76ee\u5f55\uff0c\u6302\u8f7d\u5230Linux\u4e0a\u9762! \u603b\u7ed3\u4e00\u53e5\u8bdd\uff1a\u5bb9\u5668\u7684\u6301\u4e45\u5316\u548c\u540c\u6b65\u64cd\u4f5c\uff01\u5bb9\u5668\u95f4\u4e5f\u662f\u53ef\u4ee5\u6570\u636e\u5377\u5171\u4eab\u7684\uff01 \u4f7f\u7528\u6570\u636e\u5377 \u4f7f\u7528\u547d\u4ee4\u6302\u8f7d -v docker run -it -v \u4e3b\u673a\u76ee\u5f55\uff1a\u5bb9\u5668\u76ee\u5f55 docker run -it -v /home/test:/home centos /bin/bash \u67e5\u770b\u5bb9\u5668\u6302\u8f7d\u4fe1\u606f \u65b0\u5f00\u7a97\u53e3\uff0c\u5728\u4e3b\u673a\u76ee\u5f55\u4e0b\u67e5\u770b docker inspect ID \u6d4b\u8bd5\u6587\u4ef6\u540c\u6b65 \u53cc\u5411\u7ed1\u5b9a\uff0c\u81ea\u52a8\u540c\u6b65\u3002 \u5bb9\u5668\u5220\u9664\uff0c\u6570\u636e\u4e0d\u4f1a\u4e22\u5931\u3002 \u53cc\u5411\u6d4b\u8bd5 \u5bb9\u5668\u9000\u51fa\uff0c\u5bbf\u4e3b\u673a\u4e0a\u4fee\u6539\u6587\u4ef6\u6d4b\u8bd5\u540c\u6b65 exit \u5bbf\u4e3b\u673a\u4e0a\u4fee\u6539\u5b8c\u6587\u4ef6\u540e\uff0c\u5f00\u542f\u5bb9\u5668\uff0c\u8fdb\u5165\u5bb9\u5668 docker start ID docker attach ID \u8fdb\u5165\u76ee\u5f55\uff0c\u67e5\u770b\u6570\u636e\u3002 \u5b9e\u6218MySQL \u641c\u7d22\u955c\u50cf docker search mysql \u4e0b\u8f7d\u955c\u50cf docker pull mysql:5.7 \u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf \u542f\u52a8\u5bb9\u5668 \u5b89\u88c5\u542f\u52a8mysql,\u9700\u8981\u8bbe\u7f6e\u5bc6\u7801\u3002 \u5b98\u65b9\u8bf4\u660e\uff1a \u540e\u53f0\u8fd0\u884c docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 -d:\u540e\u53f0\u8fd0\u884c -p:\u7aef\u53e3\u6620\u5c04 -v:\u6570\u636e\u5377\u6302\u8f7d -e:\u73af\u5883\u914d\u7f6e --name:\u5bb9\u5668\u540d\u79f0 \u8fde\u63a5\u6d4b\u8bd5 \u542f\u52a8\u6210\u529f\uff0c\u6211\u4eec\u5728\u672c\u5730\u4f7f\u7528sqlyog\u8fdb\u884c\u6d4b\u8bd5,\u65b0\u5efa\u8fde\u63a5\u3002 sqlyog-\u8fde\u63a5\u5230\u670d\u52a1\u5668\u76843310----3310\u548c\u5bb9\u5668\u5185\u76843306\u6620\u5c04\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u8fde\u63a5\u4e0a\u4e86! \u5bbf\u4e3b\u673a\u786e\u8ba4\u76ee\u5f55 sqlyog\u4e0a\u521b\u5efa\u6570\u636e\u5e93\u6d4b\u8bd5 \u521b\u5efatest\u6570\u636e\u5e93 \u4e3b\u673a\u6d4b\u8bd5\u4f20\u8f93 \u67e5\u770b\u6620\u5c04\u7684\u6570\u636e\u662f\u5426OK! \u914d\u7f6e\u672c\u5730\u4fee\u6539 \u5bb9\u5668\u4e2dMySQL\u914d\u7f6e\u76f4\u63a5\u5728\u672c\u5730/home/conf\u4e0b\u8fdb\u884c\u914d\u7f6e\uff0c\u914d\u7f6e\u524d\u5e94\u5148\u5c06\u5bb9\u5668\u4e2d\u7684\u914d\u7f6e\u62f7\u8d1d\u5230\u4e3b\u673a\u914d\u7f6e\u76ee\u5f55\u3002 \u5220\u9664\u6d4b\u8bd5 \u5220\u9664\u5bb9\u5668\uff0c\u5bb9\u5668\u6570\u636e\u4e22\u5931\uff0c\u67e5\u770b\u672c\u5730\u6570\u636e\u3002 docker rm -f mysql01 \u67e5\u770b\u8fd0\u884c\u7684\u5bb9\u5668 docker ps \u5df2\u7ecf\u6ca1\u6709mysql01\u5bb9\u5668 \u53d1\u73b0\uff0c\u6211\u4eec\u6302\u8f7d\u5230\u672c\u5730\u7684\u6570\u636e\u5377\u4f9d\u65e7\u6ca1\u6709\u4e22\u5931\uff0c\u8fd9\u5c31\u5b9e\u73b0\u4e86\u5bb9\u5668\u6570\u636e\u6301\u4e45\u5316\u529f\u80fd! \u5177\u540d\u3001\u533f\u540d\u3001\u6307\u5b9a\u8def\u5f84\u6302\u8f7d \u533f\u540d\u6302\u8f7d -v \u76f4\u63a5\u6307\u5b9a\u5bb9\u5668\u5185\u8def\u5f84 docker run -d -P --name nginx01 -v /etc/nginx nginx \u67e5\u770b\u5377\u5e2e\u52a9\u4fe1\u606f docker volume --help \u67e5\u770b\u6240\u6709\u5377 volume name\u4e3a\u968f\u673a\u6570\u5b57 ac173af98840fdb2c146eada65ebb0de10c9b402b4701e76a7f52fd83bf1556b e831e07007d636fef22472ca81d64eccbdc5e1dab6d550e15d39b84a2e30988f \u5177\u540d\u6302\u8f7d \u547d\u4ee4\u5377 \u901a\u8fc7 -v \u5377\u540d\uff1a\u5bb9\u5668\u5185\u8def\u5f84 docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx \u67e5\u770b\u6240\u6709\u5377 docker volume ls \u67e5\u770b\u5377\u4f4d\u7f6e docker volume inspect juming-nginx \u8fdb\u5165\u5377 \u6240\u6709\u7684docker\u5bb9\u5668\u5185\u7684\u5377\uff0c\u6ca1\u6709\u6307\u5b9a\u76ee\u5f55\u7684\u60c5\u51b5\u4e0b\u90fd\u662f\u5728 /var/lib/docker/volumes/xxxx/_data \u6211\u4eec\u901a\u8fc7\u5177\u540d\u6302\u8f7d\u53ef\u4ee5\u65b9\u4fbf\u7684\u627e\u5230\u6211\u4eec\u7684\u4e00\u4e2a\u5377\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4f7f\u7528\u5177\u540d\u6302\u8f7d\u3002 \u5982\u4f55\u786e\u5b9a\u662f\u5177\u540d\u6302\u8f7d\u8fd8\u662f\u533f\u540d\u6302\u8f7d\uff0c\u8fd8\u662f\u6307\u5b9a\u8def\u5f84\u6302\u8f7d\uff1f -v \u5bb9\u5668\u5185\u8def\u5f84 #\u533f\u540d\u6302\u8f7d -v \u5377\u540d\uff1a\u5bb9\u5668\u5185\u8def\u5f84 #\u5177\u540d\u6302\u8f7d -v \u4e3b\u673a\u8def\u5f84:\u5bb9\u5668\u5185\u8def\u5f84 #\u6307\u5b9a\u8def\u5f84\u6302\u8f7d \u62d3\u5c55\uff1a #\u901a\u8fc7-v\u5bb9\u5668\u5185\u8def\u5f84\uff1aro/rw \u53ef\u6539\u53d8\u8bfb\u5199\u6743\u9650 ro readonly #\u53ea\u8bfb rw readwrite #\u53ef\u8bfb\u53ef\u5199 #\u4e00\u65e6\u8fd9\u4e2a\u8bbe\u7f6e\u4e86\u5bb9\u5668\u6743\u9650\uff0c\u5bb9\u5668\u5bf9\u6211\u4eec\u6302\u8f7d\u51fa\u6765\u7684\u5185\u5bb9\u5c31\u6709\u9650\u5b9a\u4e86! docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx #ro \u53ea\u8981\u770b\u5230ro\u5c31\u8bf4\u660e\u8fd9\u4e2a\u8def\u5f84\u53ea\u80fd\u901a\u8fc7\u5bbf\u4e3b\u673a\u6765\u64cd\u4f5c\uff0c\u5bb9\u5668\u5185\u90e8\u662f\u65e0\u6cd5\u64cd\u4f5c\u7684! \u6307\u5b9a\u8def\u5f84\u6302\u8f7d -v \u4e3b\u673a\u8def\u5f84:\u5bb9\u5668\u5185\u8def\u5f84 #\u6307\u5b9a\u8def\u5f84\u6302\u8f7d DockerFile DockerFile\u5236\u4f5c\u955c\u50cf \u8fdb\u5165/home \u521b\u5efadocker-test-volume\u76ee\u5f55 \u8fdb\u5165docker-test-volume\u76ee\u5f55\uff0c\u521b\u5efadockerfile\u6587\u4ef6\uff08\u540d\u5b57\u53ef\u968f\u610f\uff0c\u5efa\u8bae\u7528dockerfile\uff09 \u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff1a \u6307\u4ee4\u90fd\u5927\u5199\uff0c\u53c2\u6570\u5c0f\u5199 FROM centos VOLUME [\"volume01\",\"volume02\"] CMD echo \"-----------end------------\" CMD /bin/bash \u6bcf\u4e2a\u547d\u4ee4\uff0c\u5c31\u76f8\u5f53\u4e8e\u955c\u50cf\u7684\u4e00\u5c42\u3002 \u6784\u5efa\u955c\u50cf build \u6784\u5efa -f \u811a\u672c\u6587\u4ef6\u5730\u5740 -t \u751f\u4ea7 \u6587\u4ef6\u540d \u6700\u540e\u9700\u8981.\u70b9 docker build -f /home/docker-test-volume/dockerfile1 -t lwemwu/centos . \u5206\u5c42\u6784\u5efa \u67e5\u770b\u955c\u50cf docker images \u542f\u52a8\u955c\u50cf docker run -it ID /bin/bash \u8fd9\u4e2a\u76ee\u5f55\u5c31\u662f\u6211\u4eec\u751f\u6210\u955c\u50cf\u7684\u65f6\u5019\u81ea\u52a8\u6302\u8f7d\u7684\u6570\u636e\u5377\u76ee\u5f55\u3002 \u8fd9\u4e2a\u5377\u548c\u5916\u90e8\u4e00\u5b9a\u6709\u4e00\u4e2a\u540c\u6b65\u7684\u76ee\u5f55\u3002 \u5bb9\u5668\u5185\u90e8\u521b\u5efa\u6587\u4ef6 \u5916\u90e8\u4e00\u5b9a\u6709\u4e00\u4e2a\u540c\u6b65\u7684\u76ee\u5f55\u3002 \u9000\u51fa\u5bb9\u5668 \u5bbf\u4e3b\u673a\u67e5\u770b \u67e5\u770b\u8fd0\u884c\u5bb9\u5668 docker ps -a \u67e5\u770b\u5bb9\u5668\u8be6\u7ec6\u4fe1\u606f docker inspect id \u8fdb\u5165\u6302\u8f7d\u8def\u5f84\uff0c\u67e5\u770b\u672c\u5730\u6570\u636e\u662f\u5426\u88ab\u540c\u6b65\u8fc7\u6765\u3002 \u6d4b\u8bd5\u4e00\u4e0b\u521a\u624d\u7684\u6587\u4ef6\u662f\u5426\u540c\u6b65\u51fa\u53bb\u4e86! \u8fd9\u79cd\u65b9\u5f0f\u6211\u4eec\u672a\u6765\u4f7f\u7528\u7684\u5341\u5206\u591a\uff0c\u56e0\u4e3a\u6211\u4eec\u901a\u5e38\u4f1a\u6784\u5efa\u81ea\u5df1\u7684\u955c\u50cf! \u5047\u8bbe\u6784\u5efa\u955c\u50cf\u65f6\u5019\u6ca1\u6709\u6302\u8f7d\u5377\uff0c\u8981\u624b\u52a8\u955c\u50cf\u6302\u8f7d-v\u5377\u540d\uff1a\u5bb9\u5668\u5185\u8def\u5f84!| \u6570\u636e\u5377\u5bb9\u5668 \u5bb9\u5668\u95f4\u6570\u636e\u540c\u6b65 \u542f\u52a83\u4e2a\u5bb9\u5668\uff0c\u901a\u8fc7\u6211\u4eec\u521a\u624d\u81ea\u5df1\u6784\u5efa\u7684\u955c\u50cf\u542f\u52a8\u3002 \u67e5\u770b\u5bb9\u5668 docker images \u542f\u52a8Docker01 docker run -it --name docker01 lwemwu/centos Ctrl+P+Q\u9000\u51fa\u5bb9\u5668 \u7ee7\u7eed\u8fd0\u884c \u542f\u52a8Docker02 docker run -it --name docker02 --volumes-from docker01 lwemwu/centos \u6d4b\u8bd5\u540c\u6b65 \u5728Docker01\u4e2d\u589e\u52a0\u6587\u4ef6docker01,\u5230Docker02\u67e5\u770b\u6570\u636e\u540c\u6b65\u3002 docker attach docker01(ID) \u8fdb\u5165docker02\u67e5\u770b\u3002 docker01\u521b\u5efa\u7684\u6587\u4ef6\u5728docker02\u4e0a\u540c\u6b65\u4e86\u8fc7\u6765\u3002 \u542f\u52a8Docker03 docker run -it --name docker03 --volumes-from docker01 lwemwu/centos \u5230docker02\u67e5\u770bvolume01\u6570\u636e\u3002 \u603b\u7ed3\uff1a\u901a\u8fc7--volumes-from\u53ef\u4ee5\u5b9e\u73b0\u5bb9\u5668\u95f4\u7684\u6570\u636e\u5171\u4eab\u3002 \u5220\u9664\u5bb9\u5668\u6d4b\u8bd5\u6570\u636e docker ps -a \u5220\u9664\u5bb9\u5668 docker rm -f ID docker01\u5df2\u88ab\u5220\u9664 \u8fdb\u5165docker02\u3001docker01\u67e5\u770b\u6570\u636e\u662f\u5426\u8fd8\u5728\uff1f \u6570\u636e\u672a\u4e22\u5931\uff0c\u53ef\u4ee5\u8bbf\u95ee\u3002 \u591a\u4e2amysql\u6570\u636e\u540c\u6b65 docker run -d -p 3310:3306 -v /etc/mysql/conf.d -v var/lib/mysql --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7 docker run -d -p 3310:3306 -e MYSQL_ROOT_PASSWORD=123456 --name mysql02 --volumes-from mysql01 mysql:5.7 \u5b9e\u73b0\u5bb9\u5668\u6570\u636e\u540c\u6b65 \u7ed3\u8bba\uff1a \u5bb9\u5668\u4e4b\u95f4\u914d\u7f6e\u4fe1\u606f\u7684\u4f20\u9012\uff0c\u6570\u636e\u5377\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u4e00\u76f4\u6301\u7eed\u5230\u6ca1\u6709\u5bb9\u5668\u4f7f\u7528\u4e3a\u6b62\u3002 \u4f46\u662f\u4e00\u65e6\u4f60\u6301\u4e45\u5316\u5230\u4e86\u672c\u5730\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u672c\u5730\u7684\u6570\u636e\u662f\u4e0d\u4f1a\u5220\u9664\u7684! Docker File\u4ecb\u7ecd docker file\u662f\u7528\u6765\u6784\u5efadok cer\u955c\u50cf\u7684\u6587\u4ef6!\u547d\u4ee4\u53c2\u6570\u811a\u672c! \u6784\u5efa\u6b65\u9aa4\uff1a 1\u3001\u7f16\u5199\u4e00\u4e2adocker file\u6587\u4ef6 2\u3001docker build\u6784\u5efa\u6210\u4e3a\u4e00\u4e2a\u955c\u50cf 3\u3001docker run\u8fd0\u884c\u955c\u50cf 4\u3001docker push\u53d1\u5e03\u955c\u50cf(Docker Hub\u3001\u963f\u91cc\u4e91\u955c\u50cf\u4ed3\u5e93!) Docker Hub\u641c\u7d22\u955c\u50cfcentos \u9009\u62e91\u4e2a\u7248\u672c\u70b9\u51fb\u540e\u8fdb\u5165Github \u8df3\u8f6c\u540e\u7684\u8def\u5f84\u5c31\u662fDockerfile FROM scratch ADD centos-7-x86_64-docker.tar.xz / LABEL \\ org.label-schema.schema-version=\"1.0\" \\ org.label-schema.name=\"CentOS Base Image\" \\ org.label-schema.vendor=\"CentOS\" \\ org.label-schema.license=\"GPLv2\" \\ org.label-schema.build-date=\"20200809\" \\ org.opencontainers.image.title=\"CentOS Base Image\" \\ org.opencontainers.image.vendor=\"CentOS\" \\ org.opencontainers.image.licenses=\"GPL-2.0-only\" \\ org.opencontainers.image.created=\"2020-08-09 00:00:00+01:00\" CMD [\"/bin/bash\"] \u5f88\u591a\u5b98\u65b9\u955c\u50cf\u90fd\u662f\u57fa\u7840\u5305\uff0c\u5f88\u591a\u529f\u80fd\u6ca1\u6709\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u81ea\u5df1\u642d\u5efa\u81ea\u5df1\u7684\u955c\u50cf! \u5b98\u65b9\u65e2\u7136\u53ef\u4ee5\u5236\u4f5c\u955c\u50cf\uff0c\u90a3\u6211\u4eec\u4e5f\u53ef\u4ee5! Docker File\u6784\u5efa\u8fc7\u7a0b \u57fa\u7840\u77e5\u8bc6\uff1a 1\u3001\u6bcf\u4e2a\u4fdd\u7559\u5173\u952e\u5b57(\u6307\u4ee4)\u90fd\u662f\u5fc5\u987b\u662f\u5927\u5199\u5b57\u6bcd 2\u3001\u6267\u884c\u4ece\u4e0a\u5230\u4e0b\u987a\u5e8f\u6267\u884c 3\u3001#\u8868\u793a\u6ce8\u91ca 4\u3001\u6bcf\u4e00\u4e2a\u6307\u4ee4\u90fd\u4f1a\u521b\u5efa\u63d0\u4ea4\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42\uff0c\u5e76\u63d0\u4ea4! dockerfile\u662f\u9762\u5411\u5f00\u53d1\u7684\uff0c\u6211\u4eec\u4ee5\u540e\u8981\u53d1\u5e03\u9879\u76ee\uff0c\u505a\u955c\u50cf\uff0c\u5c31\u9700\u8981\u7f16\u5199dockerfile\u6587\u4ef6\uff0c \u8fd9\u4e2a\u6587\u4ef6\u5341\u5206\u7b80\u5355! Docker\u955c\u50cf\u9010\u6e10\u6210\u4e3a\u4f01\u4e1a\u4ea4\u4ed8\u7684\u6807\u51c6\uff0c\u5fc5\u987b\u8981\u638c\u63e1! \u6b65\u9aa4\uff1a DockerFile\uff1a\u6784\u5efa\u6587\u4ef6\uff0c \u5b9a\u4e49\u4e86\u4e00\u5207\u7684\u6b65\u9aa4\uff0c \u6e90\u4ee3\u7801 Dockerlmages\uff1a\u901a\u8fc7Docker File\u6784\u5efa\u751f\u6210\u7684\u955c\u50cf\uff0c \u6700\u7ec8\u53d1\u5e03\u548c\u8fd0\u884c\u7684\u4ea7\u54c1! Docker\u5bb9\u5668\uff1a\u5bb9\u5668\u5c31\u662f\u955c\u50cf\u8fd0\u884c\u8d77\u6765\u63d0\u4f9b\u670d\u52a1\u7684 \u5f00\u53d1\uff0c\u90e8\u7f72\uff0c\u8fd0\u7ef4\u3002\u3002\u3002\u7f3a\u4e00\u4e0d\u53ef! Docker File\u6307\u4ee4 FROM #\u57fa\u7840\u955c\u955c\u50cf\uff0c\u4e00\u5207\u4ece\u8fd9\u91cc\u5f00\u59cb\u6784\u5efa MAINTAINER #\u955c\u50cf\u662f\u8c01\u5199\u7684\uff0c\u59d3\u540d+\u90ae\u7bb1 RUN #\u955c\u50cf\u6784\u5efa\u7684\u65f6\u5019\u9700\u8981\u8fd0\u884c\u7684\u547d\u4ee4 ADD #\u6b65\u9aa4\uff1atomcat\u955c\u50cf\uff0c \u8fd9\u4e2atomcat\u538b\u7f29\u5305!\u6dfb\u52a0\u5185\u5bb9 WORKDIR #\u955c\u50cf\u7684\u5de5\u4f5c\u76ee\u5f55 VOLUME #\u6302\u8f7d\u7684\u76ee\u5f55 EXPOSE #\u66b4\u9732\u7aef\u53e3\u914d\u7f6e CMD #\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u751f\u6548\uff0c\u53ef\u88ab\u66ff\u4ee3 ENTRYPOINT #\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4 ON BUILD #\u5f53\u6784\u5efa\u4e00\u4e2a\u88ab\u7ee7\u627fDocker File\u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u8fd0\u884cON BUILD \u7684\u6307\u4ee4\u3002\u89e6\u53d1\u6307\u4ee4\u3002 COPY #\u7c7b\u4f3cADD\uff0c \u5c06\u6211\u4eec\u6587\u4ef6\u62f7\u8d1d\u5230\u955c\u50cf\u4e2d ENV #\u6784\u5efa\u7684\u65f6\u5019\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf! \u5b9e\u6218\u6d4b\u8bd5 Docker Hub\u4e2d99%\u955c\u50cf\u90fd\u662f\u4ece\u8fd9\u4e2a\u57fa\u7840\u955c\u50cf\u8fc7\u6765\u7684FROM scratch\uff0c \u7136\u540e\u914d\u7f6e\u9700\u8981\u7684\u8f6f\u4ef6\u548c\u914d\u7f6e\u6765\u8fdb\u884c\u7684\u6784\u5efa\u3002 \u6784\u5efa\u81ea\u5df1\u7684\u955c\u50cf \u9ed8\u8ba4\u7684centos\u955c\u50cf\u53ea\u5305\u542b\u4e86\u6700\u57fa\u7840\u7684\u4e1c\u897f \u7f16\u5199dockerfile\u914d\u7f6e\u6587\u4ef6 \u521b\u5efa/data\u76ee\u5f55\uff0c\u518d\u521b\u5efadockerfile\u76ee\u5f55\uff0c\u7528\u6765\u4e13\u95e8\u5b58\u653edockerfile\u6587\u4ef6\u3002 \u7f16\u5199\u4e00\u4e2adockerfile\u6587\u4ef6\uff0c\u547d\u540d\u4e3adockerfile-centos FROM centos MAINTAINER lwenwu<lwenwu1999@qq.com> ENV MYPATH /usr/local WORKDIR $MYPATH RUN yum -y install vim RUN yum -y install net-tools EXPOSE 80 CMD echo $MYPATH CMD echo \"-------end--------\" CMD /bin/bash \u901a\u8fc7dockerfile\u6587\u4ef6\u6784\u5efa\u955c\u50cf docker build -f /data/dockerfile/dockerfile-centos -t mycentos:0.1 . [root@localhost dockerfile]# docker build -f /data/dockerfile/dockerfile-centos -t mycentos:0.1 . Sending build context to Docker daemon 2.048kB #\u53d1\u9001build\u4fe1\u606f Step 1/10 : FROM centos ---> 0d120b6ccaa8 #\u62ff\u5230\u57fa\u7840\u955c\u50cf\uff0c\u8ddfdocker images\u4e0b\u7684ID\u76f8\u540c\uff0c\u590d\u7528\u57fa\u7840\u955c\u50cf Step 2/10 : MAINTAINER lwenwu<lwenwu1999@qq.com> #\u7ef4\u62a4\u8005\u4fe1\u606f ---> Running in 26a8e7585dcd Removing intermediate container 26a8e7585dcd ---> df741b928f75 Step 3/10 : ENV MYPATH /usr/local ---> Running in 7b723400348d Removing intermediate container 7b723400348d ---> fc0f488845c1 Step 4/10 : WORKDIR $MYPATH ---> Running in 94198e6a23cb Removing intermediate container 94198e6a23cb ---> df3275a301cf Step 5/10 : RUN yum -y install vim #\u4e0b\u8f7dvim ---> Running in 48e8afc0df08 CentOS-8 - AppStream 605 kB/s | 5.8 MB 00:09 CentOS-8 - Base 2.2 MB/s | 2.2 MB 00:00 CentOS-8 - Extras 10 kB/s | 8.1 kB 00:00 Dependencies resolved. ================================================================================ Package Arch Version Repository Size ================================================================================ Installing: vim-enhanced x86_64 2:8.0.1763-13.el8 AppStream 1.4 M Installing dependencies: gpm-libs x86_64 1.20.7-15.el8 AppStream 39 k vim-common x86_64 2:8.0.1763-13.el8 AppStream 6.3 M vim-filesystem noarch 2:8.0.1763-13.el8 AppStream 48 k which x86_64 2.21-12.el8 BaseOS 49 k Transaction Summary ================================================================================ Install 5 Packages Total download size: 7.8 M Installed size: 31 M Downloading Packages: (1/5): gpm-libs-1.20.7-15.el8.x86_64.rpm 51 kB/s | 39 kB 00:00 (2/5): vim-filesystem-8.0.1763-13.el8.noarch.rp 314 kB/s | 48 kB 00:00 (3/5): vim-enhanced-8.0.1763-13.el8.x86_64.rpm 1.3 MB/s | 1.4 MB 00:01 (4/5): which-2.21-12.el8.x86_64.rpm 314 kB/s | 49 kB 00:00 (5/5): vim-common-8.0.1763-13.el8.x86_64.rpm 1.8 MB/s | 6.3 MB 00:03 -------------------------------------------------------------------------------- Total 1.7 MB/s | 7.8 MB 00:04 #\u4e0b\u8f7d\u8b66\u544a\uff0c\u6ca1\u4ec0\u4e48\u95ee\u9898 warning: /var/cache/dnf/AppStream-02e86d1c976ab532/packages/gpm-libs-1.20.7-15.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY CentOS-8 - AppStream 158 kB/s | 1.6 kB 00:00 Importing GPG key 0x8483C65D: Userid : \"CentOS (CentOS Official Signing Key) <security@centos.org>\" Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D From : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial Key imported successfully Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : which-2.21-12.el8.x86_64 1/5 Installing : vim-filesystem-2:8.0.1763-13.el8.noarch 2/5 Installing : vim-common-2:8.0.1763-13.el8.x86_64 3/5 Installing : gpm-libs-1.20.7-15.el8.x86_64 4/5 Running scriptlet: gpm-libs-1.20.7-15.el8.x86_64 4/5 Installing : vim-enhanced-2:8.0.1763-13.el8.x86_64 5/5 Running scriptlet: vim-enhanced-2:8.0.1763-13.el8.x86_64 5/5 Running scriptlet: vim-common-2:8.0.1763-13.el8.x86_64 5/5 Verifying : gpm-libs-1.20.7-15.el8.x86_64 1/5 Verifying : vim-common-2:8.0.1763-13.el8.x86_64 2/5 Verifying : vim-enhanced-2:8.0.1763-13.el8.x86_64 3/5 Verifying : vim-filesystem-2:8.0.1763-13.el8.noarch 4/5 Verifying : which-2.21-12.el8.x86_64 5/5 Installed: gpm-libs-1.20.7-15.el8.x86_64 vim-common-2:8.0.1763-13.el8.x86_64 vim-enhanced-2:8.0.1763-13.el8.x86_64 vim-filesystem-2:8.0.1763-13.el8.noarch which-2.21-12.el8.x86_64 Complete! #\u7f16\u8bd1\u6210\u529f Removing intermediate container 48e8afc0df08 ---> 3e3387c3a894 Step 6/10 : RUN yum -y install net-tools #\u4e0b\u8f7dnet-tools ---> Running in 90f391b8fe89 Last metadata expiration check: 0:00:12 ago on Thu Nov 5 13:18:48 2020. Dependencies resolved. ================================================================================ Package Architecture Version Repository Size ================================================================================ Installing: net-tools x86_64 2.0-0.51.20160912git.el8 BaseOS 323 k Transaction Summary ================================================================================ Install 1 Package Total download size: 323 k Installed size: 1.0 M Downloading Packages: net-tools-2.0-0.51.20160912git.el8.x86_64.rpm 1.4 MB/s | 323 kB 00:00 -------------------------------------------------------------------------------- Total 184 kB/s | 323 kB 00:01 Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : net-tools-2.0-0.51.20160912git.el8.x86_64 1/1 Running scriptlet: net-tools-2.0-0.51.20160912git.el8.x86_64 1/1 Verifying : net-tools-2.0-0.51.20160912git.el8.x86_64 1/1 Installed: net-tools-2.0-0.51.20160912git.el8.x86_64 Complete! #\u53c8\u7f16\u8bd1\u6210\u529f Removing intermediate container 90f391b8fe89 ---> da4ad4cd2938 Step 7/10 : EXPOSE 80 ---> Running in 96f829f08850 Removing intermediate container 96f829f08850 ---> 3d2d0365e5c7 Step 8/10 : CMD echo $MYPATH ---> Running in 00344184eafe Removing intermediate container 00344184eafe ---> 005ee0708a17 Step 9/10 : CMD echo \"-------end--------\" ---> Running in c7019a9bcfd9 Removing intermediate container c7019a9bcfd9 ---> c964b172bf9e Step 10/10 : CMD /bin/bash ---> Running in 9900c5470588 Removing intermediate container 9900c5470588 ---> f804e311e9aa Successfully built f804e311e9aa Successfully tagged mycentos:0.1 #\u6784\u5efa\u5b8c\u6210 [root@localhost dockerfile]# \u6d4b\u8bd5\u8fd0\u884c \u67e5\u770b\u6784\u5efa\u7684\u955c\u50cf \u8fd0\u884c\u6784\u5efa\u7684\u5bb9\u5668 docker run -it mycentos:0.1 #\u4f7f\u7528\u955c\u50cf\u540d\u79f0\u8981\u52a0\u7248\u672c\u53f7,\u5426\u5219\u4f1a\u4e0b\u8f7d\u6700\u65b0\u7684\u955c\u50cf \u6784\u5efa\u7684\u955c\u50cfvim ifconfig\u547d\u4ee4\u53ef\u4ee5\u4f7f\u7528\uff0c\u5de5\u4f5c\u76ee\u5f55\u4e3a\u914d\u7f6e\u7684/usr/local \u67e5\u770b\u955c\u50cf\u6784\u5efa\u5386\u53f2 docker history ID \u67e5\u770b\u5b98\u65b9\u955c\u50cf\u662f\u5982\u4f55\u6784\u5efa\u7684 \u901a\u8fc7\u67e5\u770b\u5b98\u65b9\u955c\u50cf\u7684\u6784\u5efa\u5386\u53f2\u53ef\u4ee5\u5b66\u4e60\u955c\u50cf\u662f\u5982\u4f55\u6784\u5efa\u7684\u3002 CMD\u548cENTRYPOINT\u533a\u522b CMD #\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u751f\u6548\uff0c\u53ef\u88ab\u66ff\u4ee3 ENTRYPOINT #\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4 \u6d4b\u8bd5CMD \u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u6267\u884c \u8fdb\u5165dockerfile\u76ee\u5f55\uff0c\u7f16\u5199dockerfile-cmd-test\u6587\u4ef6 \u6784\u5efa\u955c\u50cf docker build -f dockerfile-cmd-test -t cmdtest . \u6267\u884c\u955c\u50cf\uff0cls -a\u547d\u4ee4\u751f\u6548 docker run ID \u8ffd\u52a0-l\u547d\u4ee4\u53c2\u6570\u6d4b\u8bd5, docker: Error response from daemon: OCI runtime create failed: container_linux.go:349: starting container process caused \"exec: \\\"-l\\\": executable file not found in $PATH\": unknown. \u8ffd\u52a0\u7684-l\u547d\u4ee4\u66ff\u6362\u4e86CMD[\"ls\"\"-a\"]\u547d\u4ee4\uff0c-l\u4e0d\u662f\u547d\u4ee4\uff0c\u6240\u4ee5\u62a5\u9519\u3002 \u547d\u4ee4\u88ab\u66ff\u6362 \u6d4b\u8bd5ENTRYPOINT \u8fdb\u5165dockerfile\u76ee\u5f55\uff0c\u7f16\u5199dockerfile-entrypoint-test\u6587\u4ef6 \u6784\u5efa\u955c\u50cf docker build -f dockerfile-entrypoint-test -t entrytest . \u6267\u884c\u955c\u50cf\uff0cls -a\u547d\u4ee4\u751f\u6548 docker run ID \u8ffd\u52a0-l\u547d\u4ee4\u53c2\u6570\u6d4b\u8bd5 docker run 4c60442a1328 -l \u8ffd\u52a0-l\u751f\u6548 \u4e0d\u4f1a\u66ff\u6362\u6389dockerfile\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u3002 \u5b9e\u6218Tomcat\u955c\u50cf TomCat\u76ee\u5f55\u7ed3\u6784\u8bf4\u660e #TomCat\u76ee\u5f55\u7ed3\u6784\u8bf4\u660e\uff1a bin\uff1a\u8be5\u76ee\u5f55\u5b58\u653eTomCat\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e38\u7528\u7684\u6709startup.bat\u548cshutdown.bat\u6587\u4ef6\uff0cstartup.bat\u7528\u6765\u542f\u52a8Tomcat\uff0cshutdown.bat\u7528\u6765\u505c\u6b62Tomcat\uff1b conf\uff1aTomCat\u670d\u52a1\u5668\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u8981\u6709server.xml\uff08\u914d\u7f6e\u670d\u52a1\u5668\u4fe1\u606f\uff0c\u5982\u4fee\u6539\u7aef\u53e3\u53f7\uff0c\u6dfb\u52a0\u865a\u62df\u4e3b\u673a\u7b49\uff09\u3001tomcat-users.xml\uff08TomCat\u7528\u6237\u4e0e\u89d2\u8272\u4fe1\u606f\uff0c\u5bf9TomCat\u540e\u53f0\u7ba1\u7406\uff09\u548cweb.xml\uff08Web\u9879\u76ee\u90e8\u7f72\u63cf\u8ff0\u7b26\u6587\u4ef6\uff09\uff1b lib\uff1aTomcat\u6240\u9700\u7684jar\u5305\uff1b logs\uff1a\u5b58\u653eTomCat\u7684\u65e5\u5fd7\u6587\u4ef6\uff1b temp\uff1a\u5b58\u653eTomcat\u7684\u4e34\u65f6\u6587\u4ef6\uff1b webapps\uff1a\u5b58\u653e\u6240\u90e8\u7f72\u7684Web\u9879\u76ee\uff1b work\uff1a\u5b58\u653eWeb\u9879\u76ee\u90e8\u7f72\u8fd0\u884c\u65f6\u751f\u6210\u7684\u6587\u4ef6\uff0c\u5982java\u548cclass\u6587\u4ef6\uff1b RUNNING.txt\uff1a\u53ef\u67e5\u770b\u5982\u4f55\u914d\u7f6eTomCat\u73af\u5883\u53d8\u91cf\u3002 #TomCat\u914d\u7f6e\u73af\u5883\u53d8\u91cf Tomcat\u662fJava\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e0d\u76f4\u63a5\u4f7f\u7528\u73af\u5883\u53d8\u91cf\u3002 \u73af\u5883\u53d8\u91cf\u7531Tomcat\u542f\u52a8\u811a\u672c\u4f7f\u7528\u3002\u811a\u672c\u4f7f\u7528 \u73af\u5883\u53d8\u91cf\u6765\u51c6\u5907\u542f\u52a8Tomcat\u7684\u547d\u4ee4\u3002 \uff083.1\uff09\u8bbe\u7f6eCATALINA_HOME\uff08\u5fc5\u586b\uff09\u548cCATALINA_BASE\uff08\u53ef\u9009\uff09 CATALINA_HOME\u73af\u5883\u53d8\u91cf\u5e94\u8bbe\u7f6e\u4e3a Tomcat\u201c\u4e8c\u8fdb\u5236\u201d\u5206\u53d1\u7684\u6839\u76ee\u5f55\u3002 Tomcat\u542f\u52a8\u811a\u672c\u5177\u6709\u4e00\u4e9b\u903b\u8f91\u6765\u8bbe\u7f6e\u6b64\u53d8\u91cf \u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u6839\u636e\u542f\u52a8\u811a\u672c\u7684\u4f4d\u7f6e\u81ea\u52a8\u8fdb\u884c \u5728* nix\u4e2d\u548cWindows\u7684\u5f53\u524d\u76ee\u5f55\u4e2d\u3002\u8be5\u903b\u8f91\u53ef\u80fd\u4e0d\u8d77\u4f5c\u7528\u5728\u6240\u6709\u60c5\u51b5\u4e0b\uff0c\u5efa\u8bae\u663e\u5f0f\u8bbe\u7f6e\u53d8\u91cf\u3002 CATALINA_BASE\u73af\u5883\u53d8\u91cf\u6307\u5b9a\u6839\u7684\u4f4d\u7f6e Tomcat\u201c\u6d3b\u52a8\u914d\u7f6e\u201d\u7684\u76ee\u5f55\u3002\u5b83\u662f\u53ef\u9009\u7684\u3002\u5b83\u9ed8\u8ba4\u7b49\u4e8eCATALINA_HOME\u3002 #jdk\u76ee\u5f55\u7ed3\u6784\u8bf4\u660e bin\u76ee\u5f55\uff1aJava\u5de5\u5177\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5305\u62ec: java\u3001Java\u7f16\u8bd1\u5668javac\u3001\u53cd\u7f16\u8bd1.class\u6587\u4ef6javap\u3001\u5bc6\u94a5\u7ba1\u7406\u5de5\u5177keytool\u3001Java\u6587\u6863\u5de5\u5177javadoc\u7b49\u3002 COPYRIGHT\u6587\u4ef6\uff1a\u7248\u6743\u4fe1\u606f\u3002 db\u76ee\u5f55\uff1aJava\u5b9e\u73b0\u7684\u6570\u636e\u5e93\u3002 include\u76ee\u5f55\uff1a.h\u5934\u6587\u4ef6\uff0cC\u8bed\u8a00\u5f00\u53d1\u65f6\u7528\u5230\u7684\u5934\u6587\u4ef6\u3002\u6bd4\u5982jni.h\u662f\u5f00\u53d1jni\u7a0b\u5e8f\u65f6\u5fc5\u987b\u5f15\u7528\u7684\u5934\u6587\u4ef6\u3002 lib\u76ee\u5f55\uff1a Java\u7c7b\u5e93\uff0c\u6211\u4eec\u7ecf\u5e38\u770b\u5230\u7684dt.jar\u548ctools.jar\u5c31\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u3002 src.zip\u6587\u4ef6\uff1aJava\u7c7b\u5e93\u6e90\u7801\uff0c\u5305\u62ec\u4e86rt.jar\u5e93\u4e2d\u7684\u5173\u952e\u90e8\u5206\uff1b\u9664\u4e86Java\u7c7b\u5e93\uff0c\u8fd8\u5305\u542b\u4e86\u542f\u52a8\u5668\uff08launcher\uff09\u7684\u6e90\u7801\uff08C\u8bed\u8a00\u5b9e\u73b0\uff09\u3002 jre\u76ee\u5f55\uff1aJava\u8fd0\u884c\u73af\u5883\u3002 #jdk\u914d\u7f6e\u73af\u5883\u53d8\u91cf JDK\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u9996\u5148\u8981\u914d\u7f6eJAVA_HOME\u53d8\u91cf\uff0cJAVA_HOME\u53d8\u91cf\u6307\u5411JDK\u7684\u5b89\u88c5\u76ee\u5f55\uff0c\u914d\u7f6eJAVA_HOME\u4e3b\u8981\u76ee\u7684\u662f\uff1a \uff081\uff09\u914d\u7f6e\u5176\u5b83JDK\u73af\u5883\u53d8\u91cf\u65f6\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u5f15\u7528JDK\u7684\u5b89\u88c5\u76ee\u5f55\u3002 \uff082\uff09JDK\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u9700\u8981\u914d\u7f6ePath\u73af\u5883\u53d8\u91cf\uff0c\u4ee5\u65b9\u4fbf\u5f00\u53d1\u8005\u8fd0\u884cJava\u7f16\u8bd1\u5668\u7b49\u7a0b\u5e8f\u3002\u5f00\u53d1\u8005\u4e0d\u7ba1\u662f\u7528\u96c6\u6210\u5f00\u53d1\u5de5\u5177\u8fd8\u662f\u6587\u672c\u7f16\u8f91\u5de5\u5177\u7f16\u5199Java\u7a0b\u5e8f\u65f6\uff0c\u5f53\u96c6\u6210\u5f00\u53d1\u5de5\u5177\u8c03\u7528Java\u7f16\u8bd1\u5668\u6216\u7528\u6237\u5728Windows \u547d\u4ee4\u884c\u7a97\u53e3\u8f93\u5165\u547d\u4ee4\u8fd0\u884cJava\u7f16\u8bd1\u5668\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981\u4ecePath\u73af\u5883\u53d8\u91cf\u83b7\u53d6Java\u7f16\u8bd1\u5668\u7b49\u7a0b\u5e8f\u6240\u5728\u76ee\u5f55\u5e76\u542f\u52a8\u8fd0\u884c\u3002\u4f8b\u5982\uff1a\u5047\u8bbeJava\u96c6\u6210\u5f00\u53d1\u5de5\u5177\u6216Windows \u547d\u4ee4\u884c\u7a97\u53e3\u7684\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u548cJava\u7f16\u8bd1\u5668\u6240\u5728\u76ee\u5f55\u4e0d\u540c\uff0c\u5f00\u53d1\u8005\u53c8\u6ca1\u6709\u5728path\u73af\u5883\u53d8\u91cf\u4e2d\u914d\u7f6eJava\u7f16\u8bd1\u5668\u6240\u5728\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u627e\u4e0d\u5230Java\u7f16\u8bd1\u5668\u7a0b\u5e8f\uff0c\u4e5f\u5c31\u65e0\u6cd5\u542f\u52a8Java\u7f16\u8bd1\u5668\u7a0b\u5e8f\u8fdb\u884c\u7f16\u8bd1\u5de5\u4f5c\u3002 \uff083\uff09Java\u6e90\u4ee3\u7801\u88ab\u88ab\u7f16\u8bd1\u540e\u5f62\u6210\u6269\u5c55\u540d\u4e3a\u201c.class\u201d\u7684\u6587\u4ef6\uff0cJVM\uff08Java\u865a\u62df\u673a\uff09\u8fd0\u884cJava \u7a0b\u5e8f\u65f6\uff0c\u9700\u8981\u52a0\u8f7d\u5df2\u88ab\u7f16\u8bd1\u7684\u201c.class\u201d\u7684\u6587\u4ef6\u4ee5\u53ca\u8be5\u201c.class\u201d\u6587\u4ef6\u5bfc\u5165\u7684\u5176\u5b83\u7c7b\uff08\u5982Java\u7684System\u7c7b\uff09\u3002\u8bbe\u7f6eCLASSPATH\u7684\u76ee\u7684\u5c31\u662f\u8ba9JVM\u80fd\u591f\u901a\u8fc7CLASSPATH\u8bbe\u7f6e\u7684\u8def\u5f84\u627e\u5230\u8fd9\u4e9b\u7c7b\u6587\u4ef6 ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar \u544a\u8bc9jvm\u8981\u4f7f\u7528\u6216\u6267\u884c\u7684class\u653e\u5728\u4ec0\u4e48\u8def\u5f84\u4e0a\uff0c\u4fbf\u4e8eJVM\u52a0\u8f7dclass\u6587\u4ef6\uff0c.;\u8868\u793a\u5f53\u524d\u8def\u5f84\uff0ctools.jar\u548cdt.jar\u4e3a\u7c7b\u5e93\u8def\u5f84\u3002 CLASSPATH\u8be6\u89e3\uff1a tools.jar \u5de5\u5177\u7c7b\u5e93(\u7f16\u8bd1\u548c\u8fd0\u884c\u7b49)\uff0c\u5b83\u8ddf\u6211\u4eec\u7a0b\u5e8f\u4e2d\u7528\u5230\u7684\u57fa\u7840\u7c7b\u5e93\u6ca1\u6709\u5173\u7cfb\u3002\u6211\u4eec\u6ce8\u610f\u5230\u5728Path\u4e2d\u53d8\u91cf\u503cbin\u76ee\u5f55\u4e0b\u7684\u5404\u4e2aexe\u5de5\u5177\u7684\u5927\u5c0f\u90fd\u5f88\u5c0f\uff0c\u4e00\u822c\u90fd\u572827KB\u5de6\u53f3\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u5b9e\u9645\u4e0a\u4ec5\u4ec5\u76f8\u5f53\u4e8e\u662f\u4e00\u5c42\u4ee3\u7801\u7684\u5305\u88c5\uff0c\u8fd9\u4e9b\u5de5\u5177\u7684\u5b9e\u73b0\u6240\u8981\u7528\u5230\u7684\u7c7b\u5e93\u90fd\u5728tools.jar\u4e2d\uff0c\u7528\u538b\u7f29\u8f6f\u4ef6\u6253\u5f00tools.jar,\u4f60\u4f1a\u53d1\u73b0\u6709\u5f88\u591a\u6587\u4ef6\u662f\u548cbin\u76ee\u5f55\u4e0b\u7684exe\u5de5\u5177\u76f8\u5bf9\u6027\u7684\uff0c\u67e5\u770b\u56fe\u4e00\u3002\u5f53\u7136\uff0c\u5982\u679ctools.jar\u7684\u529f\u80fd\u53ea\u6709\u8fd9\u4e9b\u7684\u8bdd\uff0c\u90a3\u4e48\u6211\u4eec\u6839\u672c\u4e0d\u7528\u628a\u5b83\u52a0\u5165\u5230CLASSPATH\u53d8\u91cf\u4e2d\uff0c\u56e0\u4e3abin\u76ee\u5f55\u4e0b\u7684\u5de5\u5177\u81ea\u5df1\u53ef\u4ee5\u5b8c\u6210\u5bf9\u8fd9\u4e9b\u7c7b\u5e93\u7684\u8c03\u7528\uff0c\u56e0\u6b64tools.jar\u5e94\u8be5\u8fd8\u6709\u5176\u4ed6\u7684\u529f\u80fd\u3002\u5728\u91cc\u9762\u8fd8\u53ef\u4ee5\u770b\u5230\u6709Applet\u548cRMI\u7b49\u76f8\u5173\u7684\u6587\u4ef6\uff0c\u56e0\u6b64tools.jar\u5e94\u8be5\u8fd8\u662f\u8fdc\u7a0b\u8c03\u7528\u7b49\u5fc5\u987b\u7684jar\u5305\u3002tools.jar\u7684\u5176\u4ed6\u4f5c\u7528\u53ef\u4ee5\u67e5\u770b\u5176\u4ed6\u8d44\u6599\u3002 dt.jar \u8fd0\u884c\u73af\u5883\u7c7b\u5e93\uff0c\u4e3b\u8981\u662fSwing\u5305\uff0c\u8fd9\u4e00\u70b9\u901a\u8fc7\u7528\u538b\u7f29\u8f6f\u4ef6\u6253\u5f00dt.jar\u4e5f\u53ef\u4ee5\u770b\u5230\u3002\u5982\u679c\u5728\u5f00\u53d1\u65f6\u5019\u6ca1\u6709\u7528\u5230Swing\u5305\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e0d\u7528\u5c06dt.jar\u6dfb\u52a0\u5230CLASSPATH\u53d8\u91cf\u4e2d\u3002 CLASSPATH\u4e2d\u7684\u7c7b\u5e93\u662f\u7531Application ClassLoader\u6216\u8005\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u7c7b\u52a0\u8f7d\u5668\u6765\u52a0\u8f7d\u7684\uff0c\u8fd9\u91cc\u5f53\u7136\u4e0d\u80fd\u5305\u62ec\u57fa\u7840\u7c7b\u5e93\uff0c\u5982\u679c\u5305\u62ec\u57fa\u7840\u7c7b\u5e93\u7684\u8bdd\uff0c\u5e76\u7528\u4e24\u4e2a\u4e0d\u540c\u7684\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\u53bb\u52a0\u8f7d\u8be5\u57fa\u7840\u7c7b\uff0c\u90a3\u5b83\u5f97\u5230\u7684\u8be5\u57fa\u7840\u7c7b\u5c31\u4e0d\u662f\u552f\u4e00\u7684\u4e86\uff0c\u8fd9\u6837\u4fbf\u4e0d\u80fd\u4fdd\u8bc1Java\u7c7b\u7684\u5b89\u5168\u6027\u3002 \u57fa\u672c\u7c7b\u5e93\u548c\u6269\u5c55\u7c7b\u5e93rt.jar \u57fa\u672c\u7c7b\u5e93\u662f\u6240\u6709\u7684 import java.* \u5f00\u5934\u7684\u7c7b\uff0c\u5728 %JAVA_HOME%\\jre\\lib \u76ee\u5f55\u4e0b\uff08\u5982\u5176\u4e2d\u7684 rt.jar\u3001resource.jar \uff09\uff0c\u7c7b\u52a0\u8f7d\u673a\u5236\u63d0\u5230\uff0c\u8be5\u76ee\u5f55\u4e0b\u7684\u7c7b\u4f1a\u7531 Bootstrap ClassLoader \u81ea\u52a8\u52a0\u8f7d\uff0c\u5e76\u901a\u8fc7\u4eb2\u59d4\u6d3e\u6a21\u578b\u4fdd\u8bc1\u4e86\u57fa\u7840\u7c7b\u5e93\u53ea\u4f1a\u88abBootstrap ClassLoader\u52a0\u8f7d\uff0c\u8fd9\u4e5f\u5c31\u4fdd\u8bc1\u4e86\u57fa\u7840\u7c7b\u7684\u552f\u4e00\u6027\u3002 \u6269\u5c55\u7c7b\u5e93\u662f\u6240\u6709\u7684 import javax.* \u5f00\u5934\u7684\u7c7b\uff0c\u5728 %JAVA_HOME%\\jre\\lib\\ext \u76ee\u5f55\u4e0b\uff0c\u8be5\u76ee\u5f55\u4e0b\u7684\u7c7b\u662f\u7531Extension ClassLoader \u81ea\u52a8\u52a0\u8f7d\uff0c\u4e0d\u9700\u8981\u6211\u4eec\u6307\u5b9a\u3002 \u51c6\u5907\u955c\u50cf\u6587\u4ef6 \u51c6\u5907\u955c\u50cf\u6587\u4ef6\u3001tomcat\u538b\u7f29\u5305\u3001jdk\u538b\u7f29\u5305\u3002 apache-tomcat-9.0.39.tar jdk-8u271-linux-x64.tar \u7f16\u5199Dockerfile\u6587\u4ef6 \u5b98\u65b9\u547d\u540d\uff1aDockerfile\uff0cbuild\u4f1a\u81ea\u52a8\u5bfb\u627e\u8fd9\u4e2a\u6587\u4ef6\uff0c\u5c31\u4e0d\u9700\u8981-f\u6307\u5b9a\u4e86\uff01 \u5bb9\u5668\u5185\u90e8/usr/local\u76ee\u5f55\u4e0b\u5c31\u4f1a\u770b\u5230readme.txt\u8fd9\u4e2a\u6587\u4ef6 \u5c06\u538b\u7f29\u5305\u6dfb\u52a0\u8fdb\u53bb \u8ddf\u89e3\u538b\u8def\u5f84 \u6ce8\uff1a\u7528ADD\u547d\u4ee4\u6dfb\u52a0\u8fdb\u53bb\u7684.tar.gz\u6587\u4ef6\u4f1a\u81ea\u52a8\u89e3\u538b \u5b89\u88c5\u57fa\u7840\u7684\u547d\u4ee4 \u8bbe\u7f6eENV\u73af\u5883\u53d8\u91cf \u8fdb\u53bb\u7684\u65f6\u5019\u5c31\u8fdb\u5165\u5230\u73af\u5883\u53d8\u91cf \u914d\u7f6e\u5de5\u4f5c\u76ee\u5f55 \u914d\u7f6eJAVA\u73af\u5883\u53d8\u91cf \u914d\u7f6eTomcat\u73af\u5883\u53d8\u91cf \u66b4\u9732\u7aef\u53e3 FROM centos MAINTAINER lwenwu<lwenwu1999@qq.com> COPY readme.txt /usr/local/readme.txt ADD jdk-8u271-linux-x64.tar.gz /usr/local ADD apache-tomcat-9.0.39.tar.gz /usr/local RUN yum -y install vim ENV MYPATH /usr/local WORKDIR $MYPATH ENV JAVA_HOME /usr/local/jdk1.8.0_271 ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.39 ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.39 ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin EXPOSE 8080 CMD /usr/local/apache-tomcat-9.0.39/bin/startup.sh && tail -F /usr/local/apache-tomcat-9.0.39/logs/catalina.out \u6784\u5efa\u955c\u50cf docker build -t diytomcat . \u6784\u5efa\u8fc7\u7a0b [root@localhost dockerfile]# docker build -t testtomcat . Sending build context to Docker daemon 154.4MB Step 1/15 : FROM centos latest: Pulling from library/centos 3c72a8ed6814: Pull complete Digest: sha256:76d24f3ba3317fa945743bb3746fbaf3a0b752f10b10376960de01da70685fbd Status: Downloaded newer image for centos:latest ---> 0d120b6ccaa8 Step 2/15 : MAINTAINER lwenwu<lwenwu1999@qq.com> ---> Running in 47b5eb8df66b Removing intermediate container 47b5eb8df66b ---> 49bcdfea4e32 Step 3/15 : COPY readme.txt /usr/local/readme.txt ---> 2a6be7198e44 Step 4/15 : ADD jdk-8u271-linux-x64.tar.gz /usr/local ---> 88e1646ee66d Step 5/15 : ADD apache-tomcat-9.0.39.tar.gz /usr/local ---> 259ee757cb6f Step 6/15 : RUN yum -y install vim ---> Running in 2d1b5f504afa CentOS-8 - AppStream 3.3 MB/s | 5.8 MB 00:01 CentOS-8 - Base 2.5 MB/s | 2.2 MB 00:00 CentOS-8 - Extras 13 kB/s | 8.1 kB 00:00 Dependencies resolved. ================================================================================ Package Arch Version Repository Size ================================================================================ Installing: vim-enhanced x86_64 2:8.0.1763-13.el8 AppStream 1.4 M Installing dependencies: gpm-libs x86_64 1.20.7-15.el8 AppStream 39 k vim-common x86_64 2:8.0.1763-13.el8 AppStream 6.3 M vim-filesystem noarch 2:8.0.1763-13.el8 AppStream 48 k which x86_64 2.21-12.el8 BaseOS 49 k Transaction Summary ================================================================================ Install 5 Packages Total download size: 7.8 M Installed size: 31 M Downloading Packages: (1/5): gpm-libs-1.20.7-15.el8.x86_64.rpm 176 kB/s | 39 kB 00:00 (2/5): vim-filesystem-8.0.1763-13.el8.noarch.rp 697 kB/s | 48 kB 00:00 (3/5): which-2.21-12.el8.x86_64.rpm 474 kB/s | 49 kB 00:00 (4/5): vim-enhanced-8.0.1763-13.el8.x86_64.rpm 1.6 MB/s | 1.4 MB 00:00 (5/5): vim-common-8.0.1763-13.el8.x86_64.rpm 4.2 MB/s | 6.3 MB 00:01 -------------------------------------------------------------------------------- Total 2.2 MB/s | 7.8 MB 00:03 warning: /var/cache/dnf/AppStream-02e86d1c976ab532/packages/gpm-libs-1.20.7-15.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY CentOS-8 - AppStream 825 kB/s | 1.6 kB 00:00 Importing GPG key 0x8483C65D: Userid : \"CentOS (CentOS Official Signing Key) <security@centos.org>\" Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D From : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial Key imported successfully Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : which-2.21-12.el8.x86_64 1/5 Installing : vim-filesystem-2:8.0.1763-13.el8.noarch 2/5 Installing : vim-common-2:8.0.1763-13.el8.x86_64 3/5 Installing : gpm-libs-1.20.7-15.el8.x86_64 4/5 Running scriptlet: gpm-libs-1.20.7-15.el8.x86_64 4/5 Installing : vim-enhanced-2:8.0.1763-13.el8.x86_64 5/5 Running scriptlet: vim-enhanced-2:8.0.1763-13.el8.x86_64 5/5 Running scriptlet: vim-common-2:8.0.1763-13.el8.x86_64 5/5 Verifying : gpm-libs-1.20.7-15.el8.x86_64 1/5 Verifying : vim-common-2:8.0.1763-13.el8.x86_64 2/5 Verifying : vim-enhanced-2:8.0.1763-13.el8.x86_64 3/5 Verifying : vim-filesystem-2:8.0.1763-13.el8.noarch 4/5 Verifying : which-2.21-12.el8.x86_64 5/5 Installed: gpm-libs-1.20.7-15.el8.x86_64 vim-common-2:8.0.1763-13.el8.x86_64 vim-enhanced-2:8.0.1763-13.el8.x86_64 vim-filesystem-2:8.0.1763-13.el8.noarch which-2.21-12.el8.x86_64 Complete! Removing intermediate container 2d1b5f504afa ---> 104e56b60aec Step 7/15 : ENV MYPATH /usr/local ---> Running in 9582f9a31cee Removing intermediate container 9582f9a31cee ---> dd0e414f6f83 Step 8/15 : WORKDIR $MYPATH ---> Running in 5a1b9e7b62c7 Removing intermediate container 5a1b9e7b62c7 ---> 4a2e99caa954 Step 9/15 : ENV JAVA_HOME /usr/local/jdk1.8.0_271 ---> Running in 4d8ee0c67b7b Removing intermediate container 4d8ee0c67b7b ---> 8da62fbac351 Step 10/15 : ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar ---> Running in 065821bf046e Removing intermediate container 065821bf046e ---> ad73e38ee464 Step 11/15 : ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.39 ---> Running in 4792108504fd Removing intermediate container 4792108504fd ---> e5ad1371c5c4 Step 12/15 : ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.39 ---> Running in 62dbef974ce0 Removing intermediate container 62dbef974ce0 ---> a494ad3353e3 Step 13/15 : ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin ---> Running in 2cc75de94c1e Removing intermediate container 2cc75de94c1e ---> 06bec94756ec Step 14/15 : EXPOSE 8080 ---> Running in ccbe33eefb43 Removing intermediate container ccbe33eefb43 ---> 75e040b2f7c3 Step 15/15 : CMD /usr/local/apache-tomcat-9.0.39/bin/startup.sh && tail -F /usr/local/apache-tomcat-9.0.39/logs/catalina.out ---> Running in ad622bea20ad Removing intermediate container ad622bea20ad ---> 13aa57b24d7f Successfully built 13aa57b24d7f Successfully tagged testtomcat:latest \u67e5\u770b\u955c\u50cf docker images \u540e\u53f0\u8fd0\u884c\u5bb9\u5668 -d\uff1a\u540e\u53f0\u8fd0\u884c \u6302\u8f7d\u76ee\u5f55 docker run -d -p 9090:8080 --name tomcattest -v /data/tomcat/test:/usr/local/apache-tomcat-9.0.39/webapps/test -v /data/tomcat/logs:/usr/local/apache-tomcat-9.0.39/logs testtomcat \u6d4b\u8bd5\u6302\u8f7d \u5bb9\u5668\u5185\uff1a \u5bb9\u5668\u5916\uff1a \u8fdb\u5165\u5bb9\u5668 \u67e5\u770b\u8fd0\u884c\u5bb9\u5668 docker ps \u8fdb\u5165\u5bb9\u5668 docker exec -it ID /bin/bash \u8bbf\u95ee\u6d4b\u8bd5 \u5bb9\u5668\u5916\u9762\u6d4b\u8bd5 curl localhost:9090 [root@localhost data]# curl localhost:9090 <!DOCTYPE html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\" /> <title>Apache Tomcat/9.0.39</title> <link href=\"favicon.ico\" rel=\"icon\" type=\"image/x-icon\" /> <link href=\"favicon.ico\" rel=\"shortcut icon\" type=\"image/x-icon\" /> <link href=\"tomcat.css\" rel=\"stylesheet\" type=\"text/css\" /> </head> <body> <div id=\"wrapper\"> <div id=\"navigation\" class=\"curved container\"> <span id=\"nav-home\"><a href=\"https://tomcat.apache.org/\">Home</a></span> <span id=\"nav-hosts\"><a href=\"/docs/\">Documentation</a></span> <span id=\"nav-config\"><a href=\"/docs/config/\">Configuration</a></span> <span id=\"nav-examples\"><a href=\"/examples/\">Examples</a></span> <span id=\"nav-wiki\"><a href=\"https://wiki.apache.org/tomcat/FrontPage\">Wiki</a></span> <span id=\"nav-lists\"><a href=\"https://tomcat.apache.org/lists.html\">Mailing Lists</a></span> <span id=\"nav-help\"><a href=\"https://tomcat.apache.org/findhelp.html\">Find Help</a></span> <br class=\"separator\" /> </div> <div id=\"asf-box\"> <h1>Apache Tomcat/9.0.39</h1> </div> <div id=\"upper\" class=\"curved container\"> <div id=\"congrats\" class=\"curved container\"> <h2>If you're seeing this, you've successfully installed Tomcat. Congratulations!</h2> </div> <div id=\"notice\"> <img src=\"tomcat.png\" alt=\"[tomcat logo]\" /> <div id=\"tasks\"> <h3>Recommended Reading:</h3> <h4><a href=\"/docs/security-howto.html\">Security Considerations How-To</a></h4> <h4><a href=\"/docs/manager-howto.html\">Manager Application How-To</a></h4> <h4><a href=\"/docs/cluster-howto.html\">Clustering/Session Replication How-To</a></h4> </div> </div> <div id=\"actions\"> <div class=\"button\"> <a class=\"container shadow\" href=\"/manager/status\"><span>Server Status</span></a> </div> <div class=\"button\"> <a class=\"container shadow\" href=\"/manager/html\"><span>Manager App</span></a> </div> <div class=\"button\"> <a class=\"container shadow\" href=\"/host-manager/html\"><span>Host Manager</span></a> </div> </div> <br class=\"separator\" /> </div> <div id=\"middle\" class=\"curved container\"> <h3>Developer Quick Start</h3> <div class=\"col25\"> <div class=\"container\"> <p><a href=\"/docs/setup.html\">Tomcat Setup</a></p> <p><a href=\"/docs/appdev/\">First Web Application</a></p> </div> </div> <div class=\"col25\"> <div class=\"container\"> <p><a href=\"/docs/realm-howto.html\">Realms &amp; AAA</a></p> <p><a href=\"/docs/jndi-datasource-examples-howto.html\">JDBC DataSources</a></p> </div> </div> <div class=\"col25\"> <div class=\"container\"> <p><a href=\"/examples/\">Examples</a></p> </div> </div> <div class=\"col25\"> <div class=\"container\"> <p><a href=\"https://wiki.apache.org/tomcat/Specifications\">Servlet Specifications</a></p> <p><a href=\"https://wiki.apache.org/tomcat/TomcatVersions\">Tomcat Versions</a></p> </div> </div> <br class=\"separator\" /> </div> <div id=\"lower\"> <div id=\"low-manage\" class=\"\"> <div class=\"curved container\"> <h3>Managing Tomcat</h3> <p>For security, access to the <a href=\"/manager/html\">manager webapp</a> is restricted. Users are defined in:</p> <pre>$CATALINA_HOME/conf/tomcat-users.xml</pre> <p>In Tomcat 9.0 access to the manager application is split between different users. &nbsp; <a href=\"/docs/manager-howto.html\">Read more...</a></p> <br /> <h4><a href=\"/docs/RELEASE-NOTES.txt\">Release Notes</a></h4> <h4><a href=\"/docs/changelog.html\">Changelog</a></h4> <h4><a href=\"https://tomcat.apache.org/migration.html\">Migration Guide</a></h4> <h4><a href=\"https://tomcat.apache.org/security.html\">Security Notices</a></h4> </div> </div> <div id=\"low-docs\" class=\"\"> <div class=\"curved container\"> <h3>Documentation</h3> <h4><a href=\"/docs/\">Tomcat 9.0 Documentation</a></h4> <h4><a href=\"/docs/config/\">Tomcat 9.0 Configuration</a></h4> <h4><a href=\"https://wiki.apache.org/tomcat/FrontPage\">Tomcat Wiki</a></h4> <p>Find additional important configuration information in:</p> <pre>$CATALINA_HOME/RUNNING.txt</pre> <p>Developers may be interested in:</p> <ul> <li><a href=\"https://tomcat.apache.org/bugreport.html\">Tomcat 9.0 Bug Database</a></li> <li><a href=\"/docs/api/index.html\">Tomcat 9.0 JavaDocs</a></li> <li><a href=\"https://github.com/apache/tomcat/tree/master\">Tomcat 9.0 Git Repository at GitHub</a></li> </ul> </div> </div> <div id=\"low-help\" class=\"\"> <div class=\"curved container\"> <h3>Getting Help</h3> <h4><a href=\"https://tomcat.apache.org/faq/\">FAQ</a> and <a href=\"https://tomcat.apache.org/lists.html\">Mailing Lists</a></h4> <p>The following mailing lists are available:</p> <ul> <li id=\"list-announce\"><strong><a href=\"https://tomcat.apache.org/lists.html#tomcat-announce\">tomcat-announce</a><br /> Important announcements, releases, security vulnerability notifications. (Low volume).</strong> </li> <li><a href=\"https://tomcat.apache.org/lists.html#tomcat-users\">tomcat-users</a><br /> User support and discussion </li> <li><a href=\"https://tomcat.apache.org/lists.html#taglibs-user\">taglibs-user</a><br /> User support and discussion for <a href=\"https://tomcat.apache.org/taglibs/\">Apache Taglibs</a> </li> <li><a href=\"https://tomcat.apache.org/lists.html#tomcat-dev\">tomcat-dev</a><br /> Development mailing list, including commit messages </li> </ul> </div> </div> <br class=\"separator\" /> </div> <div id=\"footer\" class=\"curved container\"> <div class=\"col20\"> <div class=\"container\"> <h4>Other Downloads</h4> <ul> <li><a href=\"https://tomcat.apache.org/download-connectors.cgi\">Tomcat Connectors</a></li> <li><a href=\"https://tomcat.apache.org/download-native.cgi\">Tomcat Native</a></li> <li><a href=\"https://tomcat.apache.org/taglibs/\">Taglibs</a></li> <li><a href=\"/docs/deployer-howto.html\">Deployer</a></li> </ul> </div> </div> <div class=\"col20\"> <div class=\"container\"> <h4>Other Documentation</h4> <ul> <li><a href=\"https://tomcat.apache.org/connectors-doc/\">Tomcat Connectors</a></li> <li><a href=\"https://tomcat.apache.org/connectors-doc/\">mod_jk Documentation</a></li> <li><a href=\"https://tomcat.apache.org/native-doc/\">Tomcat Native</a></li> <li><a href=\"/docs/deployer-howto.html\">Deployer</a></li> </ul> </div> </div> <div class=\"col20\"> <div class=\"container\"> <h4>Get Involved</h4> <ul> <li><a href=\"https://tomcat.apache.org/getinvolved.html\">Overview</a></li> <li><a href=\"https://tomcat.apache.org/source.html\">Source Repositories</a></li> <li><a href=\"https://tomcat.apache.org/lists.html\">Mailing Lists</a></li> <li><a href=\"https://wiki.apache.org/tomcat/FrontPage\">Wiki</a></li> </ul> </div> </div> <div class=\"col20\"> <div class=\"container\"> <h4>Miscellaneous</h4> <ul> <li><a href=\"https://tomcat.apache.org/contact.html\">Contact</a></li> <li><a href=\"https://tomcat.apache.org/legal.html\">Legal</a></li> <li><a href=\"https://www.apache.org/foundation/sponsorship.html\">Sponsorship</a></li> <li><a href=\"https://www.apache.org/foundation/thanks.html\">Thanks</a></li> </ul> </div> </div> <div class=\"col20\"> <div class=\"container\"> <h4>Apache Software Foundation</h4> <ul> <li><a href=\"https://tomcat.apache.org/whoweare.html\">Who We Are</a></li> <li><a href=\"https://tomcat.apache.org/heritage.html\">Heritage</a></li> <li><a href=\"https://www.apache.org\">Apache Home</a></li> <li><a href=\"https://tomcat.apache.org/resources.html\">Resources</a></li> </ul> </div> </div> <br class=\"separator\" /> </div> <p class=\"copyright\">Copyright &copy;1999-2020 Apache Software Foundation. All Rights Reserved</p> </div> </body> </html> [root@localhost data]# \u7f51\u9875\u6d4b\u8bd5 http://192.168.100.100:9090 \u3010\u5751\u3011\u62a5\u9519\u65e5\u5fd7\uff1a /usr/local/apache-tomcat-9.0.39/bin/catalina.sh: line 502: /usr/local/jdk.1.8.0.27/bin/java: No such file or directory /usr/local/apache-tomcat-9.0.39/bin/catalina.sh: line 502: /usr/local/jdk.1.8.0.27/bin/java: No such file or directory \u5206\u6790\u4fee\u6539\u73af\u5883\u53d8\u91cf #ENV JAVA_HOME /usr/local/jdk1.8.0_271 java\u73af\u5883\u53d8\u91cf\u9519\u8bef\uff0c\u5bfc\u81f4\u540e\u9762\u5f15\u7528\u7684\u53d8\u91cf\u90fd\u9519\u8bef\uff0c\u6700\u7ec8\u5bfc\u81f4Tomcat\u6ca1\u6709\u542f\u52a8\u6210\u529f\u3002 html\u6d4b\u8bd5 web.xml <?xml version=\"1.0\" encoding=\"UTF-8\"?> <web-app xmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\" version=\"2.5\"> </web-app> index.jsp <%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%> <!DOCTYPE html> <html> <head> <meta charset=\"utf-8\"> <title>hello.lwenwu\uff01</title> </head> <body> Hello World!<br/> <% out.println(\"this is a test file\"); %> </body> </html> \u5931\u8d25 \u5206\u6790\uff1a \u53d1\u5e03\u955c\u50cf \u53d1\u5e03\u955c\u50cf\u5230DockerHub 1.\u5730\u5740:https://hub.docker.com/\uff0c\u6ce8\u518c\u8d26\u53f7\u3002 2.dockler login\u5e2e\u52a9\u547d\u4ee4 -u #\u7528\u6237 -p #\u5bc6\u7801 Usage: docker login [OPTIONS] [SERVER] Log in to a Docker registry. If no server is specified, the default is defined by the daemon. Options: -p, --password string Password --password-stdin Take the password from stdin -u, --username string Username 3.\u767b\u5f55\u8d26\u53f7 [root@localhost ~]# docker login -u lwenwu Password: 4.\u670d\u52a1\u5668\u767b\u9646\u540e\u63d0\u4ea4\u81ea\u5df1\u7684\u955c\u50cf\uff0cdocker push push\u65f6\u9700\u8981\u5e26\u4e0a\u4f5c\u8005\u7684\u540d\u5b57\uff0c\u955c\u50cf\u9700\u8981\u5e26\u4e0a\u7248\u672c\u53f7\uff0c\u5426\u5219\u4f1a\u62d2\u7edd\uff0c\u672c\u5730\u955c\u50cf\u7684TAG\u6807\u7b7e\u8981\u6539\u6210 \u8d26\u53f7/\u540d\u79f0:tag \u624d\u80fdpush\u6210\u529f\u3002 \u9519\u8bef\uff1a \u589e\u52a0TAG,\u7ed9\u5f53\u524d\u955c\u50cf\u589e\u52a0TAG\u6807\u7b7e\u3002 \u6ce8\uff1a\u672c\u5730\u955c\u50cf\u7684TAG\u6807\u7b7e\u8981\u6539\u6210 \u8d26\u53f7/\u540d\u79f0:tag \u624d\u80fdpush\u6210\u529f\u3002 docker tag 13aa57b24d7f lwenwu/tomcat:1.0 \u4fee\u6539\u540e\u4f1a\u591a\u51fa\u4e00\u4e2a \u518d\u6b21\u63d0\u4ea4 docker push lwenwu/tomcat:1.0 [root@localhost ~]# docker push lwenwu/tomcat:1.0 The push refers to repository [docker.io/lwenwu/tomcat] fbf49d42cce1: Pushed ab05fe66e378: Pushed 947e7a54038d: Pushed 9fb962ef813e: Pushed 291f6e44771a: Mounted from library/centos 1.0: digest: sha256:9ee0258534ff11bcfefc26fd1f2f5ca2e048f07736ecb7102e5be97c9190c673 size: 1373 \u63d0\u4ea4\u4e5f\u662f\u6309\u7167\u955c\u50cf\u7684\u5c42\u7ea7\u8fdb\u884c\u63d0\u4ea4\u7684\uff01 \u53d1\u5e03\u955c\u50cf\u5230\u963f\u91cc\u4e91 1.\u767b\u5f55\u963f\u91cc\u4e91 https://cr.console.aliyun.com/cn-hangzhou/instances/repositories 2.\u627e\u5230\u5bb9\u5668\u955c\u50cf\u670d\u52a1 3.\u521b\u5efa\u547d\u540d\u7a7a\u95f4 \u547d\u4ee4\u7a7a\u95f4\uff1a\u9879\u76ee \u4e00\u4e2a\u8d26\u53f7\u6700\u591a\u53ef\u4ee5\u521b\u5efa 3 \u4e2a\u547d\u540d\u7a7a\u95f4\u547d\u540d\u7a7a\u95f4\u3002 4.\u521b\u5efa\u955c\u50cf\u4ed3\u5e93 5.\u4ed3\u5e93\u4fe1\u606f 1. \u767b\u5f55\u963f\u91cc\u4e91Docker Registry $ sudo docker login --username=lwenwu1999 registry.cn-hangzhou.aliyuncs.com \u7528\u4e8e\u767b\u5f55\u7684\u7528\u6237\u540d\u4e3a\u963f\u91cc\u4e91\u8d26\u53f7\u5168\u540d\uff0c\u5bc6\u7801\u4e3a\u5f00\u901a\u670d\u52a1\u65f6\u8bbe\u7f6e\u7684\u5bc6\u7801\u3002 \u60a8\u53ef\u4ee5\u5728\u8bbf\u95ee\u51ed\u8bc1\u9875\u9762\u4fee\u6539\u51ed\u8bc1\u5bc6\u7801\u3002 2. \u4eceRegistry\u4e2d\u62c9\u53d6\u955c\u50cf $ sudo docker pull registry.cn-hangzhou.aliyuncs.com/lwenwu/docker:[\u955c\u50cf\u7248\u672c\u53f7] 3. \u5c06\u955c\u50cf\u63a8\u9001\u5230Registry $ sudo docker login --username=lwenwu1999 registry.cn-hangzhou.aliyuncs.com $ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/lwenwu/docker:[\u955c\u50cf\u7248\u672c\u53f7] $ sudo docker push registry.cn-hangzhou.aliyuncs.com/lwenwu/docker:[\u955c\u50cf\u7248\u672c\u53f7] \u8bf7\u6839\u636e\u5b9e\u9645\u955c\u50cf\u4fe1\u606f\u66ff\u6362\u793a\u4f8b\u4e2d\u7684[ImageId]\u548c[\u955c\u50cf\u7248\u672c\u53f7]\u53c2\u6570\u3002 4. \u9009\u62e9\u5408\u9002\u7684\u955c\u50cf\u4ed3\u5e93\u5730\u5740 \u4eceECS\u63a8\u9001\u955c\u50cf\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u955c\u50cf\u4ed3\u5e93\u5185\u7f51\u5730\u5740\u3002\u63a8\u9001\u901f\u5ea6\u5c06\u5f97\u5230\u63d0\u5347\u5e76\u4e14\u5c06\u4e0d\u4f1a\u635f\u8017\u60a8\u7684\u516c\u7f51\u6d41\u91cf\u3002 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u673a\u5668\u4f4d\u4e8eVPC\u7f51\u7edc\uff0c\u8bf7\u4f7f\u7528 registry-vpc.cn-hangzhou.aliyuncs.com \u4f5c\u4e3aRegistry\u7684\u57df\u540d\u767b\u5f55\u3002 6.\u767b\u5f55\u963f\u91cc\u4e91Docker Registry docker login --username=lwenwu1999 registry.cn-hangzhou.aliyuncs.com 7.\u5c06\u955c\u50cf\u63a8\u9001\u5230Registry \u9519\u8bef \u89e3\u51b3\uff1a \u4e25\u683c\u6309\u7167\u5b98\u65b9\u8bf4\u660e\u8fdb\u884cTAG\u6807\u7b7e\u4fee\u6539\uff0c\u7136\u540epush\u3002 docker push registry.cn-hangzhou.aliyuncs.com/lwenwu/tomcat:1.0 docker\u6d41\u7a0b\u603b\u7ed3 Docker\u7f51\u7edc \u7406\u89e3docker0 \u9996\u5148\u6e05\u7a7a\u6240\u6709\u955c\u50cf\uff0c\u4fdd\u8bc1\u5e72\u51c0\u73af\u5883\u3002 docker rmi -f $(docker images -a -q) lo: #\u672c\u673a\u56de\u73af\u5730\u5740 eth0: #\u672c\u673a\u7f51\u5361\u5730\u5740 docker0:docker0\u5730\u5740 docker\u662f\u5982\u4f55\u5904\u7406\u5bb9\u5668\u7f51\u7edc\u8bbf\u95ee\u7684\uff1f \u6d4b\u8bd5 docker run -d -P --name tomcat01 tomcat \u67e5\u770b\u5bb9\u5668\u5185\u90e8\u7684\u7f51\u7edc\u5730\u5740 docker exec -it tomcat01 ip addr [root@localhost ~]# docker exec -it tomcat01 ip addr 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever 4: eth0@if5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0 valid_lft forever preferred_lft forever [root@localhost ~]# \u53d1\u73b0\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u4f1a\u5f97\u5230\u4e00\u4e2adocker\u5206\u914d\u7684eth0@if5 \u7f51\u5361\u3002 linux\u5bbf\u4e3b\u673a\u80fd\u4e0d\u80fdping\u901a\u5bb9\u5668\u5185\u7684IP\u5730\u5740\uff1f \u6d4b\u8bd5 \u7ed3\u679c\uff1alinux\u4e3b\u673a\u53ef\u4ee5ping\u901a\u5bb9\u5668\u5185\u90e8 \u5bb9\u5668\u5185\u662f\u5426\u53ef\u4ee5ping\u901alinux\u4e3b\u673a? \u6d4b\u8bd5 \u7ed3\u679c\uff1a\u5bb9\u5668\u5185\u5426\u53ef\u4ee5ping\u901alinux\u4e3b\u673a\u3002 docker0\u76f8\u5f53\u4e8e\u5bb6\u5ead\u4e2d\u7684\u8def\u7531\u5668\uff0c\u8d1f\u8d23\u7ed9\u7f51\u6bb5\u5185\u7684\u4e3b\u673a\u5206\u914dIP\u5730\u5740\u3002 docker0\u539f\u7406 1.\u6211\u4eec\u6bcf\u542f\u52a8\u4e00\u4e2adocker\u5bb9\u5668\uff0c docker\u5c31\u4f1a\u7ed9docker\u5bb9\u5668\u5206\u914d\u4e00\u4e2aip\uff0c \u6211\u4eec\u53ea\u8981\u5b89\u88c5\u4e86docker\uff0c \u5c31\u4f1a\u6709\u4e00\u4e2a\u7f51\u5361docker 0 ,\u91c7\u7528\u6865\u63a5\u6a21\u5f0f\uff0c \u4f7f\u7528\u7684\u6280\u672f\u662fev th-pair\u6280\u672f! 2.\u542f\u52a8\u5bb9\u5668\u518d\u6b21\u6d4b\u8bd5ipaddr\uff0c\u53d1\u73b0\u591a\u4e86\u4e00\u4e2a\u7f51\u5361\u3002 \u7ed3\u8bba\uff1a\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668linux\u5bbf\u4e3b\u673a\u4f1a\u591a\u51fa1\u4e2a\u5bf9\u5e94\u7684\u7f51\u5361\u3002 3.\u5bb9\u5668\u5185\u548c\u5bb9\u5668\u5916\u7f51\u5361\u662f\u76f8\u4e92\u7ed1\u5b9a\u7684\u3002 \u5bb9\u5668\u5185\uff1a \u5bb9\u5668\u5916\uff1a 4.\u518d\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668\u8fdb\u884c\u6d4b\u8bd5\u3002 \u7ed3\u8bba\uff1a\u542f\u52a8N\u4e2a\u5bb9\u5668linux\u5bbf\u4e3b\u673a\u4f1a\u591a\u51faN\u4e2a\u5bf9\u5e94\u7684\u7f51\u5361\u3002 #\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5bb9\u5668\u5e26\u6765\u7f51\u5361\uff0c\u90fd\u662f\u76f8\u4e92\u7ed1\u5b9a\u7684\u3002 #veth-pair\u5c31\u662f\u4e00\u5bf9\u7684\u865a\u62df\u8bbe\u5907\u63a5\u53e3\uff0c \u4ed6\u4eec\u90fd\u662f\u76f8\u4e92\u7ed1\u5b9a\u51fa\u73b0\u7684\uff0c \u4e00\u6bb5\u8fde\u7740\u534f\u8bae\uff0c \u4e00\u6bb5\u5f7c\u6b64\u76f8\u8fde #\u6b63\u56e0\u4e3a\u6709\u8fd9\u4e2a\u7279\u6027\uff0c veth-pair\u5145\u5f53\u4e00\u4e2a\u6865\u6881\uff0c \u8fde\u63a5\u5404\u79cd\u865a\u62df\u7f51\u7edc\u8bbe\u5907\u7684 #OpenStak\uff0cDocker\u5bb9\u5668\u4e4b\u95f4\u7684\u8fde\u63a5\uff0covS\u7684\u8fde\u63a5\uff0c\u90fd\u662f\u4f7f\u7528veth-pair\u6280\u672f. \u5bb9\u5668\u95f4\u901a\u4fe1 \u6d4b\u8bd5\u5bb9\u5668\u4e4b\u95f4\u662f\u5426\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff1f tomcat01 tomcat02 \u6d4b\u8bd5ping \u90fd\u80fd\u4e92\u76f8ping\u901a\u3002 \u77e5\u8bc6\uff1a \u53ef\u4ee5\u4e0d\u8fdb\u5165\u5bb9\u5668\u6765ping\u3002 docker exec -it tomcat02 ping 172.17.0.2 \u7ed3\u8bba\uff1a\u5bb9\u5668\u548c\u5bb9\u5668\u95f4\u662f\u53ef\u4ee5\u4e92\u76f8ping\u901a\u7684\uff01 Docker0\u7f51\u7edc\u6a21\u578b\u56fe\uff1a \u7ed3\u8bba\uff1aDocker\u4f7f\u7528\u7684\u662fLinux\u7684\u6865\u63a5\uff0c \u5bbf\u4e3b\u673a\u4e2d\u662f\u4e00\u4e2aDokcer\u5bb9\u5668\u7684\u7f51\u6865docker0\u3002 \u865a\u62df\u7f51\u5361\uff0cDocker\u4e2d\u7684\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\u90fd\u662f\u865a\u62df\u7684\u3002\u865a\u62df\u7684\u8f6c\u53d1\u6548\u7387\u9ad8! (\u5185\u7f51\u4f20\u9012\u6587\u4ef6!) \u79fb\u9664\u5bb9\u5668\u67e5\u770b\u7f51\u5361 \u79fb\u9664\u5bb9\u5668\u540e\u7f51\u5361\u81ea\u52a8\u6d88\u5931 \u6d4b\u8bd5 \u6ce8\uff1a\u53ea\u8981\u5220\u9664\u5bb9\u5668\uff0c\u5bf9\u5e94\u7684\u7f51\u5361\u5c31\u4f1a\u5220\u9664\uff01 --link \u573a\u666f\uff1a\u5bb9\u5668IP\u53d8\u66f4\uff0c\u4e0d\u5f71\u54cd\u901a\u4fe1\uff0c\u4ee5docker\u5bb9\u5668\u540d\u79f0\u8fdb\u884cping\u901a\u4fe1\u3002 \u542f\u52a8\u5bb9\u5668tomcat01\u548ctomcat02 \u6d4b\u8bd5\uff1a\u7528\u5bb9\u5668\u540d\u79f0ping\u6d4b\u8bd5\u901a\u4fe1\u3002 docker exec -it tomcat01 ping tomcat02 \u89e3\u51b3\u5bb9\u5668\u540d\u79f0\u4e92\u901a \u5982\u4f55\u53ef\u4ee5\u89e3\u51b3\uff1f \u518d\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668tomcat03,\u589e\u52a0--link\u53c2\u6570\uff0c\u6d4b\u8bd5\u901a\u4fe1\u3002 docker run -d -P --name tomcat03 --link tomcat02 tomcat \u6d4b\u8bd5\u7528\u5bb9\u5668\u540d\u79f0ping docker exec -it tomcat03 ping tomcat02 \u53cd\u5411ping\u6d4b\u8bd5 [\u5751]\u53cd\u5411ping\u6d4b\u8bd5 docker network\u7a76\u7adf [root@localhost ~]# docker network --help Usage: docker network COMMAND Manage networks Commands: connect Connect a container to a network create Create a network disconnect Disconnect a container from a network inspect Display detailed information on one or more networks ls List networks prune Remove all unused networks rm Remove one or more networks \u67e5\u770bdocker0 bridge\u7f51\u5361\u8be6\u7ec6\u4fe1\u606f docker0\u7f51\u5361 docker network inspect 991190b12345 \u5bb9\u5668\u5206\u914d\u7684\u5730\u5740\u4fe1\u606f \u67e5\u770b\u5bb9\u5668tomcat03\u7684\u8be6\u7ec6\u4fe1\u606f docker inspect fc39850d8b31 \u62d3\u5c55\uff1a docker inspect conID|grep tomcat03 -n \u67e5\u770btomcat03\u5bb9\u5668\u7684hosts\u6587\u4ef6 docker exec -it fc39850d8b31 cat /etc/hosts \u672c\u8d28\u63a2\u7a76\uff1a--link\u5c31\u662f\u6211\u4eec\u5728hosts\u914d\u7f6e\u6587\u4ef6\u4e2d\u589e\u52a0\u4e861\u4e2atomcat02\u7684\u6620\u5c04\u3002 \u4e0d\u5efa\u8bae\u4f7f\u7528--link,\u56e0\u4e3a--link\u9700\u8981\u76f8\u4e92\u7ed1\u5b9a\u624d\u80fd\u4e92\u76f8\u901a\u4fe1\u3002 docker0\u95ee\u9898\uff1a\u4e0d\u652f\u6301\u5bb9\u5668\u540d\u4e92\u76f8\u8fde\u63a5\u8bbf\u95ee\uff01 \u5bb9\u5668\u4e92\u8054 docker0\u95ee\u9898\uff1a\u4e0d\u652f\u6301\u5bb9\u5668\u540d\u4e92\u76f8\u8fde\u63a5\u8bbf\u95ee\uff01 \u67e5\u770b\u6240\u6709\u7684docker\u7f51\u7edc docker network ls \u7f51\u7edc\u6a21\u5f0f bridge\uff1a\u6865\u63a5docker\u9ed8\u8ba4\uff0c\u81ea\u5b9a\u4e49\u7684\u7f51\u7edc\u4e5f\u4f7f\u7528bridge\u6a21\u5f0f\u3002 none\uff1a\u4e0d\u914d\u7f6e\u7f51\u7edc\u3002 host\uff1a\u548c\u5bbf\u4e3b\u673a\u5171\u4eab\u7f51\u7edc\u3002 container\uff1a\u5bb9\u5668\u5185\u7f51\u7edc\u8fde\u901a\uff01\u7528\u7684\u5c11\uff01\u5c40\u9650\u5f88\u5927\uff01 docker network\u5e2e\u52a9\u4fe1\u606f [root@localhost ~]# docker network --help Usage: docker network COMMAND Manage networks Commands: connect Connect a container to a network create Create a network disconnect Disconnect a container from a network inspect Display detailed information on one or more networks ls List networks prune Remove all unused networks rm Remove one or more networks \u6d4b\u8bd5\u81ea\u5b9a\u4e49\u7f51\u7edc \u5220\u9664\u6240\u6709\u5bb9\u5668\uff0c\u4fdd\u8bc1\u5e72\u51c0\u73af\u5883\u3002 docker rm -f $(docker ps -a -q) \u56de\u5230\u6700\u521d\u76843\u4e2a\u7f51\u5361 \u4e4b\u524d\u76f4\u63a5\u542f\u52a8\u7684\u7684\u547d\u4ee4 docker run -d -P --name tomcat01 tomcat #\u76f4\u63a5\u542f\u52a8\u7684\u5bb9\u5668\u9ed8\u8ba4\u662fdocker0\u7f51\u7edc\uff0c\u5176\u5b9e\u9ed8\u8ba4\u7701\u7565\u4e86--net bridge\u53c2\u6570 docker0\u7279\u70b9\uff0c\u9ed8\u8ba4\u57df\u540d\u4e0d\u80fd\u8bbf\u95ee\uff0c--link\u9700\u8981\u4e92\u76f8\u6253\u901a\u624d\u80fd\u76f8\u4e92\u901a\u4fe1\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002 \u81ea\u5b9a\u4e49\u7f51\u7edc \u518d\u67e5\u770bdocker network create --help\u5e2e\u52a9\u4fe1\u606f docker network create --help \u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7f51\u7edc --driver bridge #\u9ed8\u8ba4\u4e3a\u6865\u63a5\uff0c\u53ef\u4e0d\u5199 --subnet 192.168.0.0/16 #\u5b50\u7f51 --gateway 192.168.0.1 #\u8def\u7531 docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 nettest \u67e5\u770b\u521b\u5efa\u7684\u7f51\u7edc docker network ls \u67e5\u770b\u521b\u5efa\u7f51\u7edc\u7684\u8be6\u7ec6\u4fe1\u606f docker network inspect nettest \u5230\u6b64\u81ea\u5df1\u7684\u7f51\u7edc\u5c31\u521b\u5efa\u597d\u4e86\u3002 \u5bb9\u5668\u8d70\u81ea\u5b9a\u4e49\u7f51\u7edc \u6d4b\u8bd5\u542f\u52a82\u4e2a\u5bb9\u5668 docker run -d -P --name tomcat-net-01 --net nettest tomcat docker run -d -P --name tomcat-net-02 --net nettest tomcat \u518d\u6b21\u67e5\u770b\u81ea\u5b9a\u4e49\u7f51\u7edc\u7684\u8be6\u7ec6\u4fe1\u606f docker network inspect nettest \u6b64\u65f6\u81ea\u5b9a\u4e49\u7f51\u7edc\u4e0b\u9762\u5c31\u6709\u4e86\u6211\u4eec\u7684\u5bb9\u5668\u4fe1\u606f\u3002 \u6d4b\u8bd5\u57df\u540dping docker exec -it tomcat-net-01 ping 192.168.0.3 docker exec -it tomcat-net-01 ping tomcat-net-02 \u6b64\u65f6\u7528\u5bb9\u5668\u7684\u540d\u79f0\u53ef\u4ee5\u4e92\u76f8Ping\u901a\u4e86\u3002 \u81ea\u5b9a\u4e49\u7684\u7f51\u7edc\u4fee\u590d\u4e86docker0\u7684\u7f3a\u9677\u3002 \u7f51\u7edc\u95f4\u901a\u4fe1 \u7f51\u7edc\u8054\u901a\uff0c\u4f7f2\u5f20\u7f51\u4e0b\u7684\u5bb9\u5668\u4e5f\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\u3002 \u542f\u52a82\u4e2a\u5bb9\u5668\uff0c\u4e0d\u6307\u5b9a\u7f51\u7edc\u3002\u6d4b\u8bd52\u4e2a\u7f51\u7edc\u4e0b\u662f\u5426\u53ef\u4ee5\u4e92\u901a\u3002 docker run -d -P --name tomcat01 tomcat docker run -d -P --name tomcat02 tomcat #\u6d4b\u8bd5 docker exec -it tomcat01 ping tomcat-net-01 \u5982\u4f55\u6253\u901adocker0\u548c\u81ea\u5b9a\u4e49\u7684\u7f51\u7edc\uff1f \u7f51\u7edc\u4e4b\u95f4\u5982\u4f55\u4e92\u76f8\u6253\u901a\uff1f \u8fde\u63a51\u4e2a\u5bb9\u5668\u52301\u4e2a\u7f51\u7edc docker network --help \u67e5\u770b\u5e2e\u52a9\u4fe1\u606f docker network connect --help \u6d4b\u8bd5\u6253\u901a,\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f docker network connect nettest tomcat01 \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\uff0c\u8fde\u901a\u540e\u53d1\u751f\u4e86\u4ec0\u4e48\uff1f docker network inspect nettest \u8fde\u901a\u4e4b\u540e\u5c31\u5c06tomcat01\u653e\u5230\u4e86nettest\u7f51\u7edc\u4e0b\uff1f \u6d4b\u8bd5\u901a\u4fe1 \u5b98\u65b9\uff1a1\u4e2a\u5bb9\u56682\u4e2aIP \u65b9\u6cd5\uff1a\u5bb9\u5668\u548c\u7f51\u7edc\u6253\u901a\u89e3\u51b32\u5f20\u7f51\u7edc\u4e0b\u5bb9\u5668\u901a\u4fe1\u3002 \u6d4b\u8bd5tomcat02 tomcat02\u4e0e\u81ea\u5b9a\u4e49\u7f51\u7edcnettest\u6ca1\u6709\u6253\u901a\uff0c\u6240\u4ee5\u65e0\u6cd5ping\u901a\u3002 \u7ed3\u8bba\uff1a\u5047\u8bbe\u8981\u8de8\u7f51\u7edc\u901a\u4fe1\uff0c\u5c31\u9700\u8981\u4f7f\u7528docker network connect\u6253\u901a\uff01 \u90e8\u7f72Redis\u96c6\u7fa4 \u5206\u7247+\u9ad8\u53ef\u7528+\u8d1f\u8f7d\u5747\u8861 \u5176\u4e2d\u4e00\u4e2a\u6302\u4e86\uff0c\u5907\u7528\u7684\u9876\u4e0a redis\u96c6\u7fa4 \u542f\u52a86\u4e2a\u5bb9\u5668 \u521b\u5efaredis\u96c6\u7fa4\u7f51\u5361 docker network create redis --subnet 172.38.0.0/16 \u67e5\u770bredis\u7f51\u5361\u7684\u8be6\u7ec6\u4fe1\u606f docker network inspect redis \u914d\u7f6eredis\u96c6\u7fa4 \u901a\u8fc7\u811a\u672c\u521b\u5efa6\u4e2aredis\u914d\u7f6e for port in $(seq 1 6); \\ do \\ mkdir -p /data/redis/node-${port}/conf touch /data/redis/node-${port}/conf/redis.conf cat << EOF >/data/redis/node-${port}/conf/redis.conf port 6379 bind 0.0.0.0 cluster-enabled yes cluster-config-file nodes.conf cluster-node-timeout 5000 cluster-announce-ip 172.38.0.1${port} cluster-announce-port 6379 cluster-announce-bus-port 16379 appendonly yes EOF done \u67e5\u770b\u521b\u5efa\u7684\u6587\u4ef6 \u542f\u52a8\u5bb9\u5668 #\u811a\u672c docker run -p 637${port}:6379 -p 1637${port}:16379 --name redis-${port} \\ -v /data/redis/node-${port}/data:/data \\ -v /data/redis/node-${port}/conf/redis.conf:/etc/redis/redis.conf \\ -d --net redis --ip 172.38.0.1${port} redis:5.0.10-alpine3.12 redis-server /etc/redis/redis.conf; \\ #\u624b\u52a8 docker run -p 6371:6379 -p 16371:16379 --name redis-1 -v /data/redis/node-1/data:/data -v /data/redis/node-1/conf/redis.conf:/etc/redis/redis.conf -d --net redis --ip 172.38.0.11 redis:5.0.10-alpine3.12 redis-server /etc/redis/redis.conf \u67e5\u770b\u542f\u52a8\u5bb9\u5668 docker ps \u8fdb\u5165redis\u5bb9\u5668 redis\u4e2d\u6ca1\u6709bash\u547d\u4ee4\uff0credis\u8fdb\u5165\u4f7f\u7528/bin/sh docker exec -it IDNAME /bin/sh \u8fdb\u5165\u540e\u9ed8\u8ba4\u7684\u76ee\u5f55\u4e3a/data \u521b\u5efa\u96c6\u7fa4 redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1 \u96c6\u7fa4\u521b\u5efa\u5b8c\u6bd5 #\u8fc7\u7a0b >>> Performing hash slots allocation on 6 nodes... Master[0] -> Slots 0 - 5460 Master[1] -> Slots 5461 - 10922 Master[2] -> Slots 10923 - 16383 Adding replica 172.38.0.15:6379 to 172.38.0.11:6379 Adding replica 172.38.0.16:6379 to 172.38.0.12:6379 Adding replica 172.38.0.14:6379 to 172.38.0.13:6379 M: 290353fdbf5a7345e66fee97be33fa4e352eadfb 172.38.0.11:6379 slots:[0-5460] (5461 slots) master M: 2d341c0a2aac0cd99a4cec112292bc7c48e608e2 172.38.0.12:6379 slots:[5461-10922] (5462 slots) master M: 4d1882d9fa8f86d794bfad393ae982be4350338c 172.38.0.13:6379 slots:[10923-16383] (5461 slots) master S: 8319c1e759a38114d5208ab329dc241b35289d28 172.38.0.14:6379 replicates 4d1882d9fa8f86d794bfad393ae982be4350338c S: 8b81002b5dcef5041c5ca70605c8cc30a53d05e0 172.38.0.15:6379 replicates 290353fdbf5a7345e66fee97be33fa4e352eadfb S: 530887eef54e59efe34b2a98f131fdc5cc6e1937 172.38.0.16:6379 replicates 2d341c0a2aac0cd99a4cec112292bc7c48e608e2 Can I set the above configuration? (type 'yes' to accept): yes >>> Nodes configuration updated >>> Assign a different config epoch to each node >>> Sending CLUSTER MEET messages to join the cluster Waiting for the cluster to join . >>> Performing Cluster Check (using node 172.38.0.11:6379) M: 290353fdbf5a7345e66fee97be33fa4e352eadfb 172.38.0.11:6379 slots:[0-5460] (5461 slots) master 1 additional replica(s) M: 2d341c0a2aac0cd99a4cec112292bc7c48e608e2 172.38.0.12:6379 slots:[5461-10922] (5462 slots) master 1 additional replica(s) M: 4d1882d9fa8f86d794bfad393ae982be4350338c 172.38.0.13:6379 slots:[10923-16383] (5461 slots) master 1 additional replica(s) S: 8319c1e759a38114d5208ab329dc241b35289d28 172.38.0.14:6379 slots: (0 slots) slave replicates 4d1882d9fa8f86d794bfad393ae982be4350338c S: 8b81002b5dcef5041c5ca70605c8cc30a53d05e0 172.38.0.15:6379 slots: (0 slots) slave replicates 290353fdbf5a7345e66fee97be33fa4e352eadfb S: 530887eef54e59efe34b2a98f131fdc5cc6e1937 172.38.0.16:6379 slots: (0 slots) slave replicates 2d341c0a2aac0cd99a4cec112292bc7c48e608e2 [OK] All nodes agree about slots configuration. >>> Check for open slots... >>> Check slots coverage... [OK] All 16384 slots covered. \u8fde\u63a5\u96c6\u7fa4 redis-cli -c \u67e5\u770b\u96c6\u7fa4\u4fe1\u606f 6379>cluster info \u67e5\u770b\u8282\u70b9\u4fe1\u606f 127.0.0.1:6379>cluster nodes \u6ce8\uff1a3\u4e3b3\u4ece set a b \u4e3b\u8282\u70b9\u5728\u5904\u7406 \u4ece\u673a\u5e94\u8be5\u4e5f\u6709\u4e00\u4e2a\u8fd9\u6837\u7684\u503c\uff0c\u4e3b\u8282\u70b9\u6302\u4e86\uff0c\u4ece\u8282\u70b9\u5e94\u8be5\u66ff\u4ee3\u4e0a\u6765\u3002\uff08\u9ad8\u53ef\u7528\uff09 \u67e5\u770b\u8fd0\u884c\u7684\u5bb9\u5668 docker ps \u505c\u6389\u4e3b\u8282\u70b9 docker stop ID \u518d\u6b21get\u503c\uff0c\u8fde\u63a5\u8d85\u65f6 \u518d\u6b21\u8fde\u63a5\uff0cget a master\u5931\u8d25\uff0c\u4ece172.38.0.14\u4ece\u8282\u70b9\u81ea\u52a8\u5347\u4e3a\u4e3b\u8282\u70b9 Docker\u642d\u5efaredis\u96c6\u7fa4\u5b8c\u6210\uff01 \u4f7f\u7528docker\u4e4b\u540e\uff0c\u6240\u6709\u7684\u6280\u672f\u6162\u6162\u53d8\u7684\u7b80\u5355\u8d77\u6765\uff01 SpringBoot\u5fae\u670d\u52a1\u6253\u5305Docker\u955c\u50cf \u6784\u5efaspringboot\u9879\u76ee \u6253\u5305\u5e94\u7528 \u7f16\u5199dockerfile \u6784\u5efa\u955c\u50cf \u53d1\u5e03\u8fd0\u884c \u7ed3\u8bed docker\u8fdb\u9636 \u73af\u5883\u51c6\u5907 \u505c\u6b62docker systemctl stop docker \u5378\u8f7ddocker\u5f15\u64ce yum remove docker-ce docker-ce-cli containerd.io \u79fb\u9664docker\u76ee\u5f55 rm -rf /var/lib/docker/ /var/lib/docker/\u7684\u5185\u5bb9\uff0c\u5305\u62ec\u955c\u50cf\u3001\u5bb9\u5668\u3001\u5377\u548c\u7f51\u7edc\u3002Docker\u5f15\u64ce\u5305\u73b0\u5728\u79f0\u4e3aDocker -ce \u6d4b\u8bd5 [root@localhost ~]# docker ps -bash: /usr/bin/docker: No such file or directory [root@localhost ~]# \u6ce8\uff1a\u5df2\u7ecf\u6ca1\u6709\u76f8\u5173\u547d\u4ee4\u4e86 \u5378\u8f7d\u65e7\u7248\u672c yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine \u5982\u679cyum\u62a5\u544a\u6ca1\u6709\u5b89\u88c5\u8fd9\u4e9b\u5305\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002 [root@localhost ~]# yum remove docker \\ > docker-client \\ > docker-client-latest \\ > docker-common \\ > docker-latest \\ > docker-latest-logrotate \\ > docker-logrotate \\ > docker-engine Loaded plugins: fastestmirror No Match for argument: docker No Match for argument: docker-client No Match for argument: docker-client-latest No Match for argument: docker-common No Match for argument: docker-latest No Match for argument: docker-latest-logrotate No Match for argument: docker-logrotate No Match for argument: docker-engine No Packages marked for removal [root@localhost ~]# \u5b89\u88c5\u57fa\u7840\u5305 yum install -y yum-utils \u5b89\u88c5 yum-utils \u5305(\u5b83\u63d0\u4f9b yum-config-manager \u5b9e\u7528\u5de5\u5177)\u5e76\u8bbe\u7f6e\u7a33\u5b9a\u5b58\u50a8\u5e93\u3002 \u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93 \u9ed8\u8ba4\u56fd\u5916\u6e90\uff1a yum-config-manager \\ --add-repo \\ https://download.docker.com/linux/centos/docker-ce.repo \u963f\u91cc\u4e91\uff1a yum-config-manager \\ --add-repo \\ http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo \u66f4\u65b0yum\u8f6f\u4ef6\u5305\u7d22\u5f15 yum makecache fast \u5b89\u88c5 Docker\u5f15\u64ce yum install docker-ce docker-ce-cli containerd.io \u5b89\u88c5\u7279\u5b9a\u7248\u672c\u7684Docker\uff1a yum install docker-ce- docker-ce-cli- containerd.io \u542f\u52a8Docker systemctl start docker systemctl enable docker \u6d4b\u8bd5 docker version docker run hello-world docker images \u914d\u7f6e\u955c\u50cf\u52a0\u901f\u5668 sudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json <<-'EOF' { \"registry-mirrors\": [\"https://gnxq79wc.mirror.aliyuncs.com\"] } EOF sudo systemctl daemon-reload sudo systemctl restart docker Docker Compose Docker Compose\u4ecb\u7ecd https://docs.docker.com/compose/ \u5b9a\u4e49\u591a\u4e2a\u5bb9\u5668\u4e00\u952e\u542f\u52a8\u6240\u6709\u5bb9\u5668\u3002 YAML \u914d\u7f6e\u6587\u4ef6 \u547d\u4ee4\u6709\u54ea\u4e9b\uff1f \u5b98\u65b9\u4ecb\u7ecd Compose\u662f\u4e00\u4e2a\u7528\u4e8e\u5b9a\u4e49\u548c\u8fd0\u884c\u591a\u5bb9\u5668Docker\u5e94\u7528\u7a0b\u5e8f\u7684\u5de5\u5177\u3002\u4f7f\u7528Compose\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2aYAML\u6587\u4ef6\u6765\u914d\u7f6e\u5e94\u7528\u7a0b\u5e8f\u7684\u670d\u52a1\u3002\u7136\u540e\uff0c\u4f7f\u7528\u4e00\u4e2a\u547d\u4ee4\uff0c\u60a8\u53ef\u4ee5\u4ece\u60a8\u7684\u914d\u7f6e\u4e2d\u521b\u5efa\u5e76\u542f\u52a8\u6240\u6709\u7684\u670d\u52a1\u3002\u8981\u4e86\u89e3\u6709\u5173Compose\u7684\u6240\u6709\u7279\u6027\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7279\u6027\u5217\u8868\u3002 \u5728\u6240\u6709\u73af\u5883\u4e2d\u7ec4\u5408\u5de5\u4f5c:\u751f\u4ea7\u3001\u5206\u6bb5\u3001\u5f00\u53d1\u3001\u6d4b\u8bd5\uff0c\u4ee5\u53caCI\u5de5\u4f5c\u6d41\u3002\u60a8\u53ef\u4ee5\u5728\u5e38\u89c1\u7528\u4f8b\u4e2d\u4e86\u89e3\u5173\u4e8e\u6bcf\u4e2a\u7528\u4f8b\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u4f7f\u7528Compose\u57fa\u672c\u4e0a\u6709\u4e09\u4e2a\u6b65\u9aa4: 1\u3001\u7528Dockerfile\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u7684\u73af\u5883\uff0c\u8fd9\u6837\u5b83\u5c31\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u590d\u5236\u3002 2\u3001\u5728docker-compose.yml\u4e2d\u5b9a\u4e49\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u670d\u52a1\uff0c\u4ee5\u4fbf\u5b83\u4eec\u53ef\u4ee5\u5728\u9694\u79bb\u7684\u73af\u5883\u4e2d\u4e00\u8d77\u8fd0\u884c\u3002 3\u3001\u8fd0\u884cdocker-compose up\u548cCompose starts\u5e76\u8fd0\u884c\u6574\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002 \u4f5c\u7528\uff1a\u6279\u91cf\u5bb9\u5668\u7f16\u6392\u3002 \u81ea\u5df1\u7406\u89e3\uff1a Comepose\u662fDocker\u5b98\u65b9\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u9700\u8981\u5b89\u88c5\uff01 Dockerfile\u8ba9\u7a0b\u5e8f\u5728\u4efb\u4f55\u5730\u65b9\u8fd0\u884c\u3002web\u670d\u52a1\u3001redis\u3001nginx...\u591a\u4e2a\u5bb9\u5668\u3002 docker-compose.yml\u4f8b\u5b50\uff1a version: \"3.9\" services: web: build: . ports: - \"5000:5000\" volumes: - .:/code - logvolume01:/var/log links: - redis redis: image: redis volumes: logvolume01: {} docker compose up \u4e00\u6b21\u542f\u52a8\u591a\u4e2a\u670d\u52a1\u3002 Docker Compose\u6982\u5ff5 Comepose:\u91cd\u8981\u6982\u5ff5 \u670d\u52a1services\uff0c\u5e94\u7528\uff08web\u3001redis\u3001mysql\uff09 \u9879\u76eeproject,\u4e00\u7ec4\u5173\u8054\u7684\u5bb9\u5668\u3002 Compose\u5b89\u88c5 1\u3001\u4e0b\u8f7d \u5b98\u65b9\u5730\u5740\uff1a\u4e0b\u8f7d\u8f83\u6162 sudo curl -L \"https://github.com/docker/compose/releases/download/1.27.4/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose \u56fd\u5185\u955c\u50cf\u5730\u5740\uff1a curl -L https://get.daocloud.io/docker/compose/releases/download/1.27.4/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose 2\u3001\u589e\u52a0\u53ef\u6267\u884c\u6743\u9650 sudo chmod +x /usr/local/bin/docker-compose \u786e\u8ba4 [root@localhost ~]# docker-compose --version docker-compose version 1.27.4, build 40524192 [root@localhost ~]# \u5f00\u59cbcompose https://docs.docker.com/compose/gettingstarted/ \u5b98\u65b9\u8bf4\u660e \u5728\u8fd9\u4e2a\u9875\u9762\u4e0a\uff0c\u60a8\u6784\u5efa\u4e86\u4e00\u4e2a\u8fd0\u884c\u5728 Docker Compose \u4e0a\u7684\u7b80\u5355 Python web \u5e94\u7528\u7a0b\u5e8f\u3002\u8be5\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u4e86 Flask \u6846\u67b6\uff0c\u5e76\u5728 Redis \u7ef4\u62a4\u4e86\u4e00\u4e2a\u70b9\u51fb\u8ba1\u6570\u5668\u3002\u867d\u7136\u793a\u4f8b\u4f7f\u7528 Python\uff0c\u4f46\u8fd9\u91cc\u6f14\u793a\u7684\u6982\u5ff5\u5e94\u8be5\u662f\u53ef\u4ee5\u7406\u89e3\u7684\uff0c\u5373\u4f7f\u60a8\u4e0d\u719f\u6089\u5b83\u3002\u5148\u51b3\u6761\u4ef6\u786e\u4fdd\u60a8\u5df2\u7ecf\u5b89\u88c5\u4e86 Docker \u5f15\u64ce\u548c Docker Compose\u3002\u60a8\u4e0d\u9700\u8981\u5b89\u88c5 Python \u6216 Redis\uff0c\u56e0\u4e3a\u5b83\u4eec\u90fd\u662f\u7531 Docker \u6620\u50cf\u63d0\u4f9b\u7684\u3002 1\u3001\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u7684\u4f9d\u8d56\u9879\u3002\u4e3a\u9879\u76ee\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55 [root@localhost ~]# cd /data/ [root@localhost data]# mkdir composetest [root@localhost data]# cd composetest [root@localhost composetest]# 2\u3001\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aapp.py\u7684\u6587\u4ef6,\u5e76\u5c06\u4ee5\u4e0b\u5185\u5bb9\u7c98\u8d34\u5230\u6587\u4ef6\u4e2d import time import redis from flask import Flask app = Flask(__name__) cache = redis.Redis(host='redis', port=6379) def get_hit_count(): retries = 5 while True: try: return cache.incr('hits') except redis.exceptions.ConnectionError as exc: if retries == 0: raise exc retries -= 1 time.sleep(0.5) @app.route('/') def hello(): count = get_hit_count() return 'Hello World! I have been seen {} times.\\n'.format(count) \u5728\u6b64\u793a\u4f8b\u4e2d\uff0credis\u662f\u5e94\u7528\u7a0b\u5e8f\u7f51\u7edc\u4e0a\u7684redis\u5bb9\u5668\u7684\u4e3b\u673a\u540d\u3002\u6211\u4eec\u4e3aRedis\u4f7f\u7528\u9ed8\u8ba4\u7aef\u53e36379\u3002 \u6ce8\u610fget_hit_count\u51fd\u6570\u7684\u7f16\u5199\u65b9\u5f0f\u3002\u5982\u679credis\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u8fd9\u4e2a\u57fa\u672c\u7684\u91cd\u8bd5\u5faa\u73af\u5141\u8bb8\u6211\u4eec\u591a\u6b21\u5c1d\u8bd5\u8bf7\u6c42\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u4e0a\u7ebf\u65f6\uff0c\u8fd9\u5728\u542f\u52a8\u65f6\u5f88\u6709\u7528\uff0c\u4f46\u662f\u5982\u679c\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u751f\u547d\u5468\u671f\u5185\u9700\u8981\u91cd\u65b0\u542f\u52a8Redis\u670d\u52a1\uff0c\u8fd9\u4e5f\u4f7f\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u66f4\u6709\u5f39\u6027\u3002\u5728\u96c6\u7fa4\u4e2d\uff0c\u8fd9\u4e5f\u6709\u52a9\u4e8e\u5904\u7406\u8282\u70b9\u4e4b\u95f4\u7684\u77ac\u65f6\u8fde\u63a5\u4e2d\u65ad\u3002 3\u3001\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa\u53e6\u4e00\u4e2a\u540d\u4e3arequirements.txt\u7684\u6587\u4ef6\uff0c\u5e76\u5c06\u4ee5\u4e0b\u5185\u5bb9\u7c98\u8d34\u5230\u6587\u4ef6\u4e2d [root@localhost composetest]# cat requirements.txt flask redis [root@localhost composetest]# \u521b\u5efaDockerfile \u5728\u8fd9\u4e00\u6b65\u4e2d\uff0c\u60a8\u5c06\u7f16\u5199\u4e00\u4e2aDockerfile\u6765\u6784\u5efaDocker\u6620\u50cf\u3002\u56fe\u50cf\u5305\u542bPython\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u7684\u6240\u6709\u4f9d\u8d56\u9879\uff0c\u5305\u62ecPython\u672c\u8eab\u3002 \u5728\u9879\u76ee\u76ee\u5f55\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aDockerfile\u7684\u6587\u4ef6\u5e76\u7c98\u8d34\u4ee5\u4e0b\u5185\u5bb9\uff1a FROM python:3.7-alpine WORKDIR /code ENV FLASK_APP=app.py ENV FLASK_RUN_HOST=0.0.0.0 RUN apk add --no-cache gcc musl-dev linux-headers COPY requirements.txt requirements.txt RUN pip install -r requirements.txt EXPOSE 5000 COPY . . CMD [\"flask\", \"run\"] \u8fd9\u544a\u8bc9Docker\uff1a \u4ecepython3.7\u6620\u50cf\u5f00\u59cb\u6784\u5efa\u4e00\u4e2a\u6620\u50cf\u3002 \u5c06\u5de5\u4f5c\u76ee\u5f55\u8bbe\u7f6e\u4e3a/code\u3002 \u8bbe\u7f6eflask\u547d\u4ee4\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u3002 \u5b89\u88c5gcc\u548c\u5176\u4ed6\u4f9d\u8d56\u9879 \u590d\u5236\u8981\u6c42.txt\u5e76\u5b89\u88c5Python\u4f9d\u8d56\u9879\u3002 \u5411\u6620\u50cf\u6dfb\u52a0\u5143\u6570\u636e\uff0c\u4ee5\u8bf4\u660e\u5bb9\u5668\u6b63\u5728\u4fa6\u542c\u7aef\u53e35000 \u590d\u5236\u5f53\u524d\u76ee\u5f55\u3002\u5728\u5de5\u7a0b\u4e2d\u3002\u5728\u56fe\u50cf\u4e2d\u3002 \u5c06\u5bb9\u5668\u7684\u9ed8\u8ba4\u547d\u4ee4\u8bbe\u7f6e\u4e3aflask run\u3002 \u5b9a\u4e49\u670d\u52a1 1\u3001\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3adocker-compose.yml\u7684\u6587\u4ef6\uff0c\u7136\u540e\u7c98\u8d34\u4ee5\u4e0b\u5185\u5bb9\uff1a version: \"3.9\" services: web: build: . ports: - \"5000:5000\" redis: image: \"redis:alpine\" \u8be5Compose\u6587\u4ef6\u5b9a\u4e49\u4e86\u4e24\u4e2a\u670d\u52a1\uff1aWeb\u548cRedis\u3002 Web\u670d\u52a1 web\u670d\u52a1\u4f7f\u7528\u4ece\u5f53\u524d\u76ee\u5f55\u4e2d\u7684Dockerfile\u6784\u5efa\u7684\u6620\u50cf\u3002\u7136\u540e\u5b83\u5c06\u5bb9\u5668\u548c\u4e3b\u673a\u7ed1\u5b9a\u5230\u516c\u5f00\u7684\u7aef\u53e35000\u3002\u6b64\u793a\u4f8b\u670d\u52a1\u4f7f\u7528Flask web\u670d\u52a1\u5668\u7684\u9ed8\u8ba4\u7aef\u53e35000\u3002 Redis\u670d\u52a1 redis\u670d\u52a1\u4f7f\u7528\u4eceDocker Hub\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u7684\u516c\u5171redis\u6620\u50cf\u3002 \u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u76844\u4e2a\u6587\u4ef6\uff1a [root@localhost composetest]# ll total 16 -rw-r--r-- 1 root root 514 Dec 14 23:22 app.py -rw-r--r-- 1 root root 111 Dec 14 23:51 docker-compose.yml -rw-r--r-- 1 root root 252 Dec 14 23:25 Dockerfile -rw-r--r-- 1 root root 12 Dec 14 23:21 requirements.txt [root@localhost composetest]# \u6784\u5efa\u548c\u8fd0\u884c\u5e94\u7528 \u4f7f\u7528Compose\u6784\u5efa\u548c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u3002 1\u3001\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\uff0c\u901a\u8fc7\u8fd0\u884cdocker-compose up\u6765\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\u3002 docker-compose up 1.\u5e94\u7528app.py 2.Dockerfile \u5e94\u7528\u6253\u5305\u4e3a\u955c\u50cf 3.Docker-compose.yaml\u6587\u4ef6\uff08\u5b9a\u4e49\u6574\u4e2a\u670d\u52a1\u9700\u8981\u7684\u73af\u5883\u3001web\u3001redis,\u5b8c\u6574\u7684\u4e0a\u7ebf\u670d\u52a1\uff09 4.\u542f\u52a8compose\u9879\u76ee\uff08docker-compose up\uff09 \u544a\u8b66\u89e3\u51b3 \u6d41\u7a0b\uff1a \u521b\u5efa\u7f51\u7edc\u2014\u6267\u884cDocker-compose.yaml\u6587\u4ef6\u2014\u542f\u52a8\u670d\u52a1\u3002 \u4e2d\u9014\u62a5\u8b66\u63d0\u793a\u955c\u50cf\u4e0d\u5b58\u5728\uff0c\u6267\u884cdocker-compose build [root@localhost composetest]# docker-compose build redis uses an image, skipping Building web Step 1/10 : FROM python:3.7-alpine ---> 0ce5215b0b31 Step 2/10 : WORKDIR /code ---> Using cache ---> ba1f9f199b82 Step 3/10 : ENV FLASK_APP=app.py ---> Using cache ---> 2fc74b01a73d Step 4/10 : ENV FLASK_RUN_HOST=0.0.0.0 ---> Using cache ---> 32b4aa9e96e0 Step 5/10 : RUN apk add --no-cache gcc musl-dev linux-headers ---> Using cache ---> 950b055b2a97 Step 6/10 : COPY requirements.txt requirements.txt ---> Using cache ---> 7bf0bce3d7a9 Step 7/10 : RUN pip install -r requirements.txt ---> Using cache ---> e18eb5e5bafb Step 8/10 : EXPOSE 5000 ---> Using cache ---> a66622c4cc0f Step 9/10 : COPY . . ---> Using cache ---> 42114f1ec656 Step 10/10 : CMD [\"flask\", \"run\"] ---> Using cache ---> 0f443e7f92e4 Successfully built 0f443e7f92e4 Successfully tagged composetest_web:latest [root@localhost composetest]# \u518d\u6b21\u6267\u884cdocker-compose up\uff0c\u542f\u52a8\u6210\u529f [root@localhost composetest]# docker-compose up Starting composetest_redis_1 ... done Starting composetest_web_1 ... done Attaching to composetest_redis_1, composetest_web_1 redis_1 | 1:C 16 Dec 2020 04:22:40.307 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo redis_1 | 1:C 16 Dec 2020 04:22:40.307 # Redis version=6.0.9, bits=64, commit=00000000, modified=0, pid=1, just started redis_1 | 1:C 16 Dec 2020 04:22:40.307 # Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf redis_1 | 1:M 16 Dec 2020 04:22:40.307 * Running mode=standalone, port=6379. redis_1 | 1:M 16 Dec 2020 04:22:40.307 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128. redis_1 | 1:M 16 Dec 2020 04:22:40.307 # Server initialized redis_1 | 1:M 16 Dec 2020 04:22:40.307 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect. redis_1 | 1:M 16 Dec 2020 04:22:40.307 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo madvise > /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled (set to 'madvise' or 'never'). redis_1 | 1:M 16 Dec 2020 04:22:40.320 * Loading RDB produced by version 6.0.9 redis_1 | 1:M 16 Dec 2020 04:22:40.320 * RDB age 79370 seconds redis_1 | 1:M 16 Dec 2020 04:22:40.320 * RDB memory usage when created 0.77 Mb redis_1 | 1:M 16 Dec 2020 04:22:40.320 * DB loaded from disk: 0.012 seconds redis_1 | 1:M 16 Dec 2020 04:22:40.320 * Ready to accept connections web_1 | * Serving Flask app \"app.py\" web_1 | * Environment: production web_1 | WARNING: This is a development server. Do not use it in a production deployment. web_1 | Use a production WSGI server instead. web_1 | * Debug mode: off web_1 | * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit) \u8bbf\u95ee5000\u7aef\u53e3,\u8ba1\u6570\u5668\uff1a\u6bcf\u8bbf\u95ee\u4e00\u6b21\u52a0\u4e00\u3002 [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 1 times. [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 2 times. [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 3 times. [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 4 times. [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 5 times. [root@localhost ~]# \u5bf9\u5e94\u524d\u9762\u6587\u4ef6app.py\u4e2d\u7684\u5185\u5bb9 import time import redis from flask import Flask app = Flask(__name__) cache = redis.Redis(host='redis', port=6379) def get_hit_count(): retries = 5 while True: try: return cache.incr('hits') except redis.exceptions.ConnectionError as exc: if retries == 0: raise exc retries -= 1 time.sleep(0.5) @app.route('/') def hello(): count = get_hit_count() return 'Hello World! I have been seen {} times.\\n'.format(count) \u67e5\u770b\u8fd0\u884c\u7684\u5bb9\u5668,\u670d\u52a1\u542f\u52a8\u6210\u529f\u3002 [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 4fbea3b1e5c1 composetest_web \"flask run\" 23 hours ago Up About a minute 0.0.0.0:5000->5000/tcp composetest_web_1 061c25816933 redis:alpine \"docker-entrypoint.s\u2026\" 23 hours ago Up About a minute 6379/tcp composetest_redis_1 [root@localhost ~]# \u67e5\u770b\u955c\u50cf [root@localhost ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE composetest_web latest 0f443e7f92e4 47 hours ago 196MB redis alpine f731cd48185c 5 days ago 31.6MB python 3.7-alpine 0ce5215b0b31 5 days ago 41.1MB hello-world latest bf756fb1ae65 11 months ago 13.3kB [root@localhost ~]# \u4ee5\u524d\u90fd\u9700\u8981run\u4e0b\u8f7d\u955c\u50cf\uff0c\u73b0\u5728\u901a\u8fc7docker-compose.yml\u4f1a\u81ea\u52a8\u6784\u5efa\u3002 composetest_web redis python \u670d\u52a1\u89c4\u5219 composetest_web_1 composetest_redis_1 \u6587\u4ef6\u540d _ _ \u670d\u52a1\u540d _ __num\u6570\u5b57 \u751f\u4ea7\u73af\u5883\uff1a \u591a\u4e2a\u670d\u52a1\u5668\u642d\u5efa\u96c6\u7fa4\u3002 \u96c6\u7fa4\u73af\u5883\uff1a \u670d\u52a1redis\u2014\u591a\u4e2a\u526f\u672c\uff0c\u670d\u52a1\u4e0d\u53ef\u80fd\u53ea\u6709\u4e00\u4e2a\u8fd0\u884c\u5b9e\u4f8b\uff0c\u771f\u5b9e\u73af\u5883\u90fd\u662f\u5f39\u6027\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u9ad8\u53ef\u7528\u3002 \u67e5\u770b\u6240\u6709\u670d\u52a1 \u56e0\u4e3a\u4e0d\u662f\u96c6\u7fa4\uff0c\u6240\u4ee5\u8be5\u547d\u4ee4\u65e0\u6cd5\u67e5\u770b\u670d\u52a1\u3002\u9700\u8981swarm\u96c6\u7fa4\u3002 [root@localhost ~]# docker service ls Error response from daemon: This node is not a swarm manager. Use \"docker swarm init\" or \"docker swarm join\" to connect this node to swarm and try again. [root@localhost ~]# \u7f51\u7edc\u89c4\u5219 [root@localhost ~]# docker network ls NETWORK ID NAME DRIVER SCOPE bea25d6732f1 bridge bridge local d2a12aac3c49 composetest_default bridge local 0638c33a175f host host local 943386457d17 none null local [root@localhost ~]# composetest_default: \u901a\u8fc7compose\u542f\u52a8\u5c31\u4f1a\u751f\u4ea7\u4e00\u4e2a\u81ea\u5df1\u7684\u7f51\u7edc\u3002 10\u4e2a\u670d\u52a1=>\u9879\u76ee \u9879\u76ee\u4e2d\u7684\u5185\u5bb9\u90fd\u5728\u540c\u4e00\u4e2a\u7f51\u7edc\u4e0b\uff0c\u57df\u540d\u8bbf\u95ee\u3002 \u67e5\u770b\u7f51\u7edc\u4fe1\u606f [root@localhost ~]# docker network inspect composetest_default [ { \"Name\": \"composetest_default\", \"Id\": \"d2a12aac3c494f30b43bfbf1cac3668eb2fdfab004fba1de973ea053328e813b\", \"Created\": \"2020-12-14T23:58:05.062718888-05:00\", \"Scope\": \"local\", \"Driver\": \"bridge\", \"EnableIPv6\": false, \"IPAM\": { \"Driver\": \"default\", \"Options\": null, \"Config\": [ { \"Subnet\": \"172.18.0.0/16\", \"Gateway\": \"172.18.0.1\" } ] }, \"Internal\": false, \"Attachable\": true, \"Ingress\": false, \"ConfigFrom\": { \"Network\": \"\" }, \"ConfigOnly\": false, \"Containers\": { \"061c2581693361daca9dd9b1c8e613658e22233c5a327a3a8b01ceff78c276db\": { \"Name\": \"composetest_redis_1\", \"EndpointID\": \"da79080b268347d234943fa0c8e021010e32decde0a56a46a7eba4b61b2ae04c\", \"MacAddress\": \"02:42:ac:12:00:02\", \"IPv4Address\": \"172.18.0.2/16\", \"IPv6Address\": \"\" }, \"4fbea3b1e5c1f2eb880d73422f6af97121c47c13f706cef2dfc384aa8d66a26e\": { \"Name\": \"composetest_web_1\", \"EndpointID\": \"1b980f3b031dc64c76bd9b1fd7aeb9232fd1339f477813750e13866c4173c634\", \"MacAddress\": \"02:42:ac:12:00:03\", \"IPv4Address\": \"172.18.0.3/16\", \"IPv6Address\": \"\" } }, \"Options\": {}, \"Labels\": { \"com.docker.compose.network\": \"default\", \"com.docker.compose.project\": \"composetest\", \"com.docker.compose.version\": \"1.27.4\" } } ] [root@localhost ~]# \"Containers\": web\u548credis\u90fd\u5728\u540c\u4e00\u4e2a\u7f51\u7edc\u4e0b\uff0c\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u57df\u540d\u8bbf\u95ee\u3002 cache = redis.Redis(host='redis', port=6379) \u524d\u9762\u6587\u4ef6\u4e2d\u6ca1\u6709\u5199\u5b9e\u9645\u7684IP\uff0c\u800c\u662fhost='redis',\u8fd9\u6837\u505a\u7684\u597d\u5904\u5c31\u662f\u5047\u5982\u4e00\u4e2a\u670d\u52a1\u6302\u4e86\uff0c\u518d\u6b21\u62c9\u8d77\u4e00\u4e2a\u670d\u52a1\uff0c\u6b64\u65f6IP\u4f1a\u53d8\u66f4\uff0c\u800c\u91c7\u7528host\u8fd9\u79cd\u65b9\u5f0f\u670d\u52a1\u5373\u4f7f\u6302\u6389\u518d\u62c9\u8d77\u4e00\u4e2a\u540c\u6837\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u57df\u540d\u6765\u8bbf\u95ee\u3002 \u505c\u6b62\u670d\u52a1 \u5fc5\u987b\u5728\u5f53\u524d\u6587\u4ef6\u76ee\u5f55\u4e0b docker-compose down \u6216\u5728\u5982\u4e0b\u9875\u9762 \u6309Ctrl+C \u4ee5\u524d\u90fd\u662f\u5355\u4e2adocker run\u542f\u52a8\u5bb9\u5668\u3002 \u73b0\u5728\u53ef\u4ee5\u901a\u8fc7 docker-compose\u7f16\u5199yaml\u914d\u7f6e\u6587\u4ef6\u7f16\u5199\u670d\u52a1\uff0c\u518d\u901a\u8fc7docker-compose up\u4e00\u952e\u542f\u52a8\u6216\u505c\u6b62\u6240\u6709\u670d\u52a1\u3002 YAML\u7f16\u5199\u89c4\u5219 https://docs.docker.com/compose/compose-file/ \u6838\u5fc3\uff1a3\u5c42\u3002 \u5b98\u7f51\u4f8b\u5b50\uff1a https://docs.docker.com/compose/compose-file/compose-file-v3/ version: \"3.9\" services: redis: image: redis:alpine ports: - \"6379\" networks: - frontend deploy: replicas: 2 update_config: parallelism: 2 delay: 10s restart_policy: condition: on-failure db: image: postgres:9.4 volumes: - db-data:/var/lib/postgresql/data networks: - backend deploy: placement: max_replicas_per_node: 1 constraints: - \"node.role==manager\" vote: image: dockersamples/examplevotingapp_vote:before ports: - \"5000:80\" networks: - frontend depends_on: - redis deploy: replicas: 2 update_config: parallelism: 2 restart_policy: condition: on-failure result: image: dockersamples/examplevotingapp_result:before ports: - \"5001:80\" networks: - backend depends_on: - db deploy: replicas: 1 update_config: parallelism: 2 delay: 10s restart_policy: condition: on-failure worker: image: dockersamples/examplevotingapp_worker networks: - frontend - backend deploy: mode: replicated replicas: 1 labels: [APP=VOTING] restart_policy: condition: on-failure delay: 10s max_attempts: 3 window: 120s placement: constraints: - \"node.role==manager\" visualizer: image: dockersamples/visualizer:stable ports: - \"8080:8080\" stop_grace_period: 1m30s volumes: - \"/var/run/docker.sock:/var/run/docker.sock\" deploy: placement: constraints: - \"node.role==manager\" networks: frontend: backend: volumes: db-data: \u7b2c\u4e00\u5c42\uff1aversion: \"3.9\" \u7b2c\u4e8c\u5c42\uff1aservices:\u4ee5\u53ca\u670d\u52a1\u7684\u914d\u7f6e \u670d\u52a1\u914d\u7f6e\u53c2\u8003\uff1ahttps://docs.docker.com/compose/compose-file/compose-file-v3/\u53f3\u8fb9\u3002 Service configuration reference build context dockerfile args cache_from labels network shm_size target cap_add, cap_drop cgroup_parent command configs Short syntax Long syntax container_name credential_spec Example gMSA configuration depends_on deploy endpoint_mode labels mode placement max_replicas_per_node replicas resources restart_policy rollback_config update_config Not supported for docker stack deploy devices dns dns_search entrypoint env_file environment expose external_links extra_hosts healthcheck image init isolation labels links logging network_mode networks aliases ipv4_address, ipv6_address pid ports Short syntax Long syntax restart secrets Short syntax Long syntax security_opt stop_grace_period stop_signal sysctls tmpfs ulimits userns_mode volumes Short syntax Long syntax Volumes for services, swarms, and stack files domainname, hostname, ipc, mac_address, privileged, read_only, shm_size, stdin_open, tty, user, working_dir Specifying durations Specifying byte values Volume configuration reference driver driver_opts external labels name Network configuration reference driver bridge overlay host or none driver_opts attachable enable_ipv6 ipam internal labels external name \u7b2c\u4e09\u5c42\uff1a\u5176\u4ed6\u914d\u7f6e\uff08volumes\u3001networks\u3001configs\uff09 depends_on \u4f9d\u8d56\uff0c\u786e\u4fdd\u670d\u52a1\u4f9d\u8d56\u5173\u7cfb\u6b63\u786e\u3002 web\u670d\u52a1\u4e2d\u5199depends on,web\u670d\u52a1\u4f9d\u8d56redis\u548cdb,\u6240\u4ee5\u4f1a\u4f18\u5148\u542f\u52a8\u5176\u4ed62\u4e2a\u670d\u52a1\u3002 deploy \u4e2d\u6709\u4e2areplicas: 6\u662f\u526f\u672c\u7684\u610f\u601d\u3002 \u642d\u5efa\u5f00\u6e90\u535a\u5ba2 \u4f20\u7edf\uff1a\u4e0b\u8f7d\u7a0b\u5e8f\uff0c\u5b89\u88c5\u6570\u636e\u5e93\uff0c\u914d\u7f6e... compose\u7f16\u5199\u5e94\u7528\uff0c\u4e00\u952e\u542f\u52a8\uff01 \u5b98\u7f51\u4f8b\u5b50\uff1ahttps://docs.docker.com/compose/wordpress/ WordPress\u662f\u4f7f\u7528 PHP \u8bed\u8a00\u5f00\u53d1\u7684\u535a\u5ba2\u5e73\u53f0\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u652f\u6301PHP\u548cMySQL\u6570\u636e\u5e93\u7684 \u670d\u52a1\u5668 \u4e0a\u67b6\u8bbe\u5c5e\u4e8e\u81ea\u5df1\u7684\u7f51\u7ad9\u3002\u4e5f\u53ef\u4ee5\u628a WordPress\u5f53\u4f5c\u4e00\u4e2a \u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf \uff08CMS\uff09\u6765\u4f7f\u7528\u3002 1.\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u9879\u76ee\u76ee\u5f55\u3002 [root@localhost ~]# cd /data/ [root@localhost data]# mkdir wordpress [root@localhost data]# ls composetest wordpress [root@localhost data]# 2.\u5207\u6362\u5230\u9879\u76ee\u76ee\u5f55\u3002 [root@localhost data]# cd wordpress/ [root@localhost wordpress]# ls [root@localhost wordpress]# 3.\u521b\u5efa\u4e00\u4e2a docker-compose\u3002\u4e00\u4e2a yml \u6587\u4ef6\uff0c\u7528\u4e8e\u542f\u52a8\u4f60\u7684 WordPress \u535a\u5ba2\u548c\u4e00\u4e2a\u72ec\u7acb\u7684 MySQL \u5b9e\u4f8b\uff0c\u5b83\u6709\u4e00\u4e2a\u6570\u636e\u6301\u4e45\u6027\u7684\u5377\u88c5\u8f7d. \u63d0\u793a: \u60a8\u53ef\u4ee5\u4e3a\u8fd9\u4e2a\u6587\u4ef6\u4f7f\u7528.yml \u6216.yaml \u6269\u5c55\u540d\uff0c\u90fd\u53ef\u4ee5\u5de5\u4f5c\u3002 [root@localhost wordpress]# vim docker-compose.yml version: '3.3' services: db: image: mysql:5.7 volumes: - db_data:/var/lib/mysql restart: always environment: MYSQL_ROOT_PASSWORD: somewordpress MYSQL_DATABASE: wordpress MYSQL_USER: wordpress MYSQL_PASSWORD: wordpress wordpress: depends_on: - db image: wordpress:latest ports: - \"8000:80\" restart: always environment: WORDPRESS_DB_HOST: db:3306 WORDPRESS_DB_USER: wordpress WORDPRESS_DB_PASSWORD: wordpress WORDPRESS_DB_NAME: wordpress volumes: db_data: {} \u5907\u6ce8\uff1a depends_on\uff1a\u4f9d\u8d56\u4e8e\u4e0a\u4e00\u4e2a environment:\u73af\u5883\u914d\u7f6e \u542f\u52a8\u4e00\u4e2awordpress\u4f9d\u8d56\u4e8emysql\u3002 4.\u4ece\u9879\u76ee\u76ee\u5f55\u8fd0\u884c docker-compose up -d docker-compose up -d:\u540e\u53f0\u542f\u52a8 \u542f\u52a8\u8fc7\u7a0b\uff1a [root@localhost wordpress]# docker-compose up -d Creating network \"wordpress_default\" with the default driver Creating volume \"wordpress_db_data\" with default driver Pulling db (mysql:5.7)... 5.7: Pulling from library/mysql 6ec7b7d162b2: Pull complete fedd960d3481: Pull complete 7ab947313861: Pull complete 64f92f19e638: Pull complete 3e80b17bff96: Pull complete 014e976799f9: Pull complete 59ae84fee1b3: Pull complete 7d1da2a18e2e: Pull complete 301a28b700b9: Pull complete 529dc8dbeaf3: Pull complete bc9d021dc13f: Pull complete Digest: sha256:c3a567d3e3ad8b05dfce401ed08f0f6bf3f3b64cc17694979d5f2e5d78e10173 Status: Downloaded newer image for mysql:5.7 Pulling wordpress (wordpress:latest)... latest: Pulling from library/wordpress 6ec7b7d162b2: Already exists db606474d60c: Pull complete afb30f0cd8e0: Pull complete 3bb2e8051594: Pull complete 4c761b44e2cc: Pull complete c2199db96575: Pull complete 1b9a9381eea8: Pull complete 50450ffc67ee: Pull complete 4d1e5a768e83: Pull complete 5e8be0d1df16: Pull complete 7a6395859d40: Pull complete 7306499d3dce: Pull complete fa6f0ba15ac6: Pull complete 308a9ead128f: Pull complete 2db781a8732e: Pull complete 63d3161e9e46: Pull complete a08dd591ed8a: Pull complete 931a26282f2a: Pull complete f5c6b405e809: Pull complete caf2bb847f73: Pull complete Digest: sha256:dadd8e9c2ef6dc2fe146cbc5f2edc0ed8ae1026ae252b52f25791be4d7d16600 Status: Downloaded newer image for wordpress:latest Creating wordpress_db_1 ... done Creating wordpress_wordpress_1 ... done [root@localhost wordpress]# docker-compose up -d wordpress_db_1 is up-to-date wordpress_wordpress_1 is up-to-date [root@localhost wordpress]# docker-compose up wordpress_db_1 is up-to-date wordpress_wordpress_1 is up-to-date Attaching to wordpress_db_1, wordpress_wordpress_1 db_1 | 2021-01-06 09:19:34+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.32-1debian10 started. db_1 | 2021-01-06 09:19:34+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql' db_1 | 2021-01-06 09:19:34+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.32-1debian10 started. db_1 | 2021-01-06 09:19:34+00:00 [Note] [Entrypoint]: Initializing database files db_1 | 2021-01-06T09:19:35.000436Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). db_1 | 2021-01-06T09:19:35.482173Z 0 [Warning] InnoDB: New log files created, LSN=45790 db_1 | 2021-01-06T09:19:35.597659Z 0 [Warning] InnoDB: Creating foreign key constraint system tables. db_1 | 2021-01-06T09:19:35.678204Z 0 [Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: 4b32e97d-5000-11eb-8c6b-0242ac130002. db_1 | 2021-01-06T09:19:35.682249Z 0 [Warning] Gtid table is not ready to be used. Table 'mysql.gtid_executed' cannot be opened. db_1 | 2021-01-06T09:19:36.436871Z 0 [Warning] CA certificate ca.pem is self signed. db_1 | 2021-01-06T09:19:36.664740Z 1 [Warning] root@localhost is created with an empty password ! Please consider switching off the --initialize-insecure option. db_1 | 2021-01-06 09:19:38+00:00 [Note] [Entrypoint]: Database files initialized db_1 | 2021-01-06 09:19:38+00:00 [Note] [Entrypoint]: Starting temporary server db_1 | 2021-01-06 09:19:38+00:00 [Note] [Entrypoint]: Waiting for server startup db_1 | 2021-01-06T09:19:39.125099Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). db_1 | 2021-01-06T09:19:39.133047Z 0 [Note] mysqld (mysqld 5.7.32) starting as process 77 ... db_1 | 2021-01-06T09:19:39.176985Z 0 [Note] InnoDB: PUNCH HOLE support available db_1 | 2021-01-06T09:19:39.177009Z 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins db_1 | 2021-01-06T09:19:39.177012Z 0 [Note] InnoDB: Uses event mutexes db_1 | 2021-01-06T09:19:39.177014Z 0 [Note] InnoDB: GCC builtin __atomic_thread_fence() is used for memory barrier db_1 | 2021-01-06T09:19:39.177016Z 0 [Note] InnoDB: Compressed tables use zlib 1.2.11 db_1 | 2021-01-06T09:19:39.177019Z 0 [Note] InnoDB: Using Linux native AIO db_1 | 2021-01-06T09:19:39.177210Z 0 [Note] InnoDB: Number of pools: 1 db_1 | 2021-01-06T09:19:39.177390Z 0 [Note] InnoDB: Using CPU crc32 instructions db_1 | 2021-01-06T09:19:39.181520Z 0 [Note] InnoDB: Initializing buffer pool, total size = 128M, instances = 1, chunk size = 128M db_1 | 2021-01-06T09:19:39.194255Z 0 [Note] InnoDB: Completed initialization of buffer pool db_1 | 2021-01-06T09:19:39.202793Z 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority(). db_1 | 2021-01-06T09:19:39.222672Z 0 [Note] InnoDB: Highest supported file format is Barracuda. db_1 | 2021-01-06T09:19:39.260853Z 0 [Note] InnoDB: Creating shared tablespace for temporary tables db_1 | 2021-01-06T09:19:39.260954Z 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ... db_1 | 2021-01-06T09:19:39.312019Z 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB. db_1 | 2021-01-06T09:19:39.321067Z 0 [Note] InnoDB: 96 redo rollback segment(s) found. 96 redo rollback segment(s) are active. db_1 | 2021-01-06T09:19:39.321123Z 0 [Note] InnoDB: 32 non-redo rollback segment(s) are active. db_1 | 2021-01-06T09:19:39.325037Z 0 [Note] InnoDB: Waiting for purge to start db_1 | 2021-01-06T09:19:39.376297Z 0 [Note] InnoDB: 5.7.32 started; log sequence number 2746702 db_1 | 2021-01-06T09:19:39.378041Z 0 [Note] Plugin 'FEDERATED' is disabled. db_1 | 2021-01-06T09:19:39.387166Z 0 [Note] InnoDB: Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool db_1 | 2021-01-06T09:19:39.417925Z 0 [Note] InnoDB: Buffer pool(s) load completed at 210106 9:19:39 db_1 | 2021-01-06T09:19:39.426605Z 0 [Note] Found ca.pem, server-cert.pem and server-key.pem in data directory. Trying to enable SSL support using them. db_1 | 2021-01-06T09:19:39.426627Z 0 [Note] Skipping generation of SSL certificates as certificate files are present in data directory. db_1 | 2021-01-06T09:19:39.427642Z 0 [Warning] CA certificate ca.pem is self signed. db_1 | 2021-01-06T09:19:39.427726Z 0 [Note] Skipping generation of RSA key pair as key files are present in data directory. db_1 | 2021-01-06T09:19:39.431945Z 0 [Warning] Insecure configuration for --pid-file: Location '/var/run/mysqld' in the path is accessible to all OS users. Consider choosing a different directory. db_1 | 2021-01-06T09:19:39.443443Z 0 [Note] Event Scheduler: Loaded 0 events db_1 | 2021-01-06T09:19:39.443720Z 0 [Note] mysqld: ready for connections. db_1 | Version: '5.7.32' socket: '/var/run/mysqld/mysqld.sock' port: 0 MySQL Community Server (GPL) db_1 | 2021-01-06 09:19:39+00:00 [Note] [Entrypoint]: Temporary server started. db_1 | Warning: Unable to load '/usr/share/zoneinfo/iso3166.tab' as time zone. Skipping it. db_1 | Warning: Unable to load '/usr/share/zoneinfo/leap-seconds.list' as time zone. Skipping it. db_1 | Warning: Unable to load '/usr/share/zoneinfo/zone.tab' as time zone. Skipping it. db_1 | Warning: Unable to load '/usr/share/zoneinfo/zone1970.tab' as time zone. Skipping it. db_1 | 2021-01-06 09:19:41+00:00 [Note] [Entrypoint]: Creating database wordpress db_1 | 2021-01-06 09:19:41+00:00 [Note] [Entrypoint]: Creating user wordpress db_1 | 2021-01-06 09:19:41+00:00 [Note] [Entrypoint]: Giving user wordpress access to schema wordpress db_1 | db_1 | 2021-01-06 09:19:41+00:00 [Note] [Entrypoint]: Stopping temporary server db_1 | 2021-01-06T09:19:41.455747Z 0 [Note] Giving 0 client threads a chance to die gracefully db_1 | 2021-01-06T09:19:41.455763Z 0 [Note] Shutting down slave threads db_1 | 2021-01-06T09:19:41.455769Z 0 [Note] Forcefully disconnecting 0 remaining clients db_1 | 2021-01-06T09:19:41.455773Z 0 [Note] Event Scheduler: Purging the queue. 0 events db_1 | 2021-01-06T09:19:41.455919Z 0 [Note] Binlog end db_1 | 2021-01-06T09:19:41.456361Z 0 [Note] Shutting down plugin 'ngram' db_1 | 2021-01-06T09:19:41.456368Z 0 [Note] Shutting down plugin 'partition' db_1 | 2021-01-06T09:19:41.456370Z 0 [Note] Shutting down plugin 'BLACKHOLE' db_1 | 2021-01-06T09:19:41.456372Z 0 [Note] Shutting down plugin 'ARCHIVE' db_1 | 2021-01-06T09:19:41.456374Z 0 [Note] Shutting down plugin 'PERFORMANCE_SCHEMA' db_1 | 2021-01-06T09:19:41.456391Z 0 [Note] Shutting down plugin 'MRG_MYISAM' db_1 | 2021-01-06T09:19:41.456395Z 0 [Note] Shutting down plugin 'MyISAM' db_1 | 2021-01-06T09:19:41.456400Z 0 [Note] Shutting down plugin 'INNODB_SYS_VIRTUAL' db_1 | 2021-01-06T09:19:41.456402Z 0 [Note] Shutting down plugin 'INNODB_SYS_DATAFILES' db_1 | 2021-01-06T09:19:41.456404Z 0 [Note] Shutting down plugin 'INNODB_SYS_TABLESPACES' db_1 | 2021-01-06T09:19:41.456405Z 0 [Note] Shutting down plugin 'INNODB_SYS_FOREIGN_COLS' db_1 | 2021-01-06T09:19:41.456407Z 0 [Note] Shutting down plugin 'INNODB_SYS_FOREIGN' db_1 | 2021-01-06T09:19:41.456408Z 0 [Note] Shutting down plugin 'INNODB_SYS_FIELDS' db_1 | 2021-01-06T09:19:41.456410Z 0 [Note] Shutting down plugin 'INNODB_SYS_COLUMNS' db_1 | 2021-01-06T09:19:41.456411Z 0 [Note] Shutting down plugin 'INNODB_SYS_INDEXES' db_1 | 2021-01-06T09:19:41.456413Z 0 [Note] Shutting down plugin 'INNODB_SYS_TABLESTATS' db_1 | 2021-01-06T09:19:41.456414Z 0 [Note] Shutting down plugin 'INNODB_SYS_TABLES' db_1 | 2021-01-06T09:19:41.456416Z 0 [Note] Shutting down plugin 'INNODB_FT_INDEX_TABLE' db_1 | 2021-01-06T09:19:41.456417Z 0 [Note] Shutting down plugin 'INNODB_FT_INDEX_CACHE' db_1 | 2021-01-06T09:19:41.456419Z 0 [Note] Shutting down plugin 'INNODB_FT_CONFIG' db_1 | 2021-01-06T09:19:41.456420Z 0 [Note] Shutting down plugin 'INNODB_FT_BEING_DELETED' db_1 | 2021-01-06T09:19:41.456421Z 0 [Note] Shutting down plugin 'INNODB_FT_DELETED' db_1 | 2021-01-06T09:19:41.456423Z 0 [Note] Shutting down plugin 'INNODB_FT_DEFAULT_STOPWORD' db_1 | 2021-01-06T09:19:41.456424Z 0 [Note] Shutting down plugin 'INNODB_METRICS' db_1 | 2021-01-06T09:19:41.456425Z 0 [Note] Shutting down plugin 'INNODB_TEMP_TABLE_INFO' db_1 | 2021-01-06T09:19:41.456427Z 0 [Note] Shutting down plugin 'INNODB_BUFFER_POOL_STATS' db_1 | 2021-01-06T09:19:41.456429Z 0 [Note] Shutting down plugin 'INNODB_BUFFER_PAGE_LRU' db_1 | 2021-01-06T09:19:41.456430Z 0 [Note] Shutting down plugin 'INNODB_BUFFER_PAGE' db_1 | 2021-01-06T09:19:41.456431Z 0 [Note] Shutting down plugin 'INNODB_CMP_PER_INDEX_RESET' db_1 | 2021-01-06T09:19:41.456433Z 0 [Note] Shutting down plugin 'INNODB_CMP_PER_INDEX' db_1 | 2021-01-06T09:19:41.456434Z 0 [Note] Shutting down plugin 'INNODB_CMPMEM_RESET' db_1 | 2021-01-06T09:19:41.456435Z 0 [Note] Shutting down plugin 'INNODB_CMPMEM' db_1 | 2021-01-06T09:19:41.456437Z 0 [Note] Shutting down plugin 'INNODB_CMP_RESET' db_1 | 2021-01-06T09:19:41.456438Z 0 [Note] Shutting down plugin 'INNODB_CMP' db_1 | 2021-01-06T09:19:41.456439Z 0 [Note] Shutting down plugin 'INNODB_LOCK_WAITS' db_1 | 2021-01-06T09:19:41.456441Z 0 [Note] Shutting down plugin 'INNODB_LOCKS' db_1 | 2021-01-06T09:19:41.456442Z 0 [Note] Shutting down plugin 'INNODB_TRX' db_1 | 2021-01-06T09:19:41.456444Z 0 [Note] Shutting down plugin 'InnoDB' db_1 | 2021-01-06T09:19:41.456478Z 0 [Note] InnoDB: FTS optimize thread exiting. db_1 | 2021-01-06T09:19:41.456713Z 0 [Note] InnoDB: Starting shutdown... db_1 | 2021-01-06T09:19:41.558263Z 0 [Note] InnoDB: Dumping buffer pool(s) to /var/lib/mysql/ib_buffer_pool db_1 | 2021-01-06T09:19:41.560067Z 0 [Note] InnoDB: Buffer pool(s) dump completed at 210106 9:19:41 db_1 | 2021-01-06T09:19:43.273861Z 0 [Note] InnoDB: Shutdown completed; log sequence number 12617575 db_1 | 2021-01-06T09:19:43.275009Z 0 [Note] InnoDB: Removed temporary tablespace data file: \"ibtmp1\" db_1 | 2021-01-06T09:19:43.275028Z 0 [Note] Shutting down plugin 'MEMORY' db_1 | 2021-01-06T09:19:43.275037Z 0 [Note] Shutting down plugin 'CSV' db_1 | 2021-01-06T09:19:43.275041Z 0 [Note] Shutting down plugin 'sha256_password' db_1 | 2021-01-06T09:19:43.275043Z 0 [Note] Shutting down plugin 'mysql_native_password' db_1 | 2021-01-06T09:19:43.275124Z 0 [Note] Shutting down plugin 'binlog' db_1 | 2021-01-06T09:19:43.275626Z 0 [Note] mysqld: Shutdown complete db_1 | db_1 | 2021-01-06 09:19:43+00:00 [Note] [Entrypoint]: Temporary server stopped db_1 | db_1 | 2021-01-06 09:19:43+00:00 [Note] [Entrypoint]: MySQL init process done. Ready for start up. db_1 | db_1 | 2021-01-06T09:19:43.638878Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). db_1 | 2021-01-06T09:19:43.640547Z 0 [Note] mysqld (mysqld 5.7.32) starting as process 1 ... db_1 | 2021-01-06T09:19:43.644140Z 0 [Note] InnoDB: PUNCH HOLE support available db_1 | 2021-01-06T09:19:43.644167Z 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins db_1 | 2021-01-06T09:19:43.644171Z 0 [Note] InnoDB: Uses event mutexes db_1 | 2021-01-06T09:19:43.644237Z 0 [Note] InnoDB: GCC builtin __atomic_thread_fence() is used for memory barrier db_1 | 2021-01-06T09:19:43.644241Z 0 [Note] InnoDB: Compressed tables use zlib 1.2.11 db_1 | 2021-01-06T09:19:43.644246Z 0 [Note] InnoDB: Using Linux native AIO db_1 | 2021-01-06T09:19:43.644413Z 0 [Note] InnoDB: Number of pools: 1 db_1 | 2021-01-06T09:19:43.644521Z 0 [Note] InnoDB: Using CPU crc32 instructions db_1 | 2021-01-06T09:19:43.645817Z 0 [Note] InnoDB: Initializing buffer pool, total size = 128M, instances = 1, chunk size = 128M db_1 | 2021-01-06T09:19:43.652932Z 0 [Note] InnoDB: Completed initialization of buffer pool db_1 | 2021-01-06T09:19:43.654891Z 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority(). db_1 | 2021-01-06T09:19:43.666791Z 0 [Note] InnoDB: Highest supported file format is Barracuda. db_1 | 2021-01-06T09:19:43.680623Z 0 [Note] InnoDB: Creating shared tablespace for temporary tables db_1 | 2021-01-06T09:19:43.680704Z 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ... db_1 | 2021-01-06T09:19:43.698427Z 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB. db_1 | 2021-01-06T09:19:43.698911Z 0 [Note] InnoDB: 96 redo rollback segment(s) found. 96 redo rollback segment(s) are active. db_1 | 2021-01-06T09:19:43.698918Z 0 [Note] InnoDB: 32 non-redo rollback segment(s) are active. db_1 | 2021-01-06T09:19:43.699150Z 0 [Note] InnoDB: Waiting for purge to start db_1 | 2021-01-06T09:19:43.750903Z 0 [Note] InnoDB: 5.7.32 started; log sequence number 12617575 db_1 | 2021-01-06T09:19:43.752692Z 0 [Note] Plugin 'FEDERATED' is disabled. db_1 | 2021-01-06T09:19:43.763484Z 0 [Note] InnoDB: Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool db_1 | 2021-01-06T09:19:43.777047Z 0 [Note] InnoDB: Buffer pool(s) load completed at 210106 9:19:43 db_1 | 2021-01-06T09:19:43.778348Z 0 [Note] Found ca.pem, server-cert.pem and server-key.pem in data directory. Trying to enable SSL support using them. db_1 | 2021-01-06T09:19:43.778372Z 0 [Note] Skipping generation of SSL certificates as certificate files are present in data directory. db_1 | 2021-01-06T09:19:43.779331Z 0 [Warning] CA certificate ca.pem is self signed. db_1 | 2021-01-06T09:19:43.779426Z 0 [Note] Skipping generation of RSA key pair as key files are present in data directory. db_1 | 2021-01-06T09:19:43.781025Z 0 [Note] Server hostname (bind-address): '*'; port: 3306 db_1 | 2021-01-06T09:19:43.781193Z 0 [Note] IPv6 is available. db_1 | 2021-01-06T09:19:43.781211Z 0 [Note] - '::' resolves to '::'; db_1 | 2021-01-06T09:19:43.781254Z 0 [Note] Server socket created on IP: '::'. db_1 | 2021-01-06T09:19:43.783683Z 0 [Warning] Insecure configuration for --pid-file: Location '/var/run/mysqld' in the path is accessible to all OS users. Consider choosing a different directory. db_1 | 2021-01-06T09:19:43.792136Z 0 [Note] Event Scheduler: Loaded 0 events db_1 | 2021-01-06T09:19:43.792261Z 0 [Note] mysqld: ready for connections. db_1 | Version: '5.7.32' socket: '/var/run/mysqld/mysqld.sock' port: 3306 MySQL Community Server (GPL) wordpress_1 | WordPress not found in /var/www/html - copying now... wordpress_1 | Complete! WordPress has been successfully copied to /var/www/html wordpress_1 | [06-Jan-2021 09:19:37 UTC] PHP Warning: mysqli::__construct(): (HY000/2002): Connection refused in Standard input code on line 22 wordpress_1 | wordpress_1 | MySQL Connection Error: (2002) Connection refused wordpress_1 | wordpress_1 | MySQL Connection Error: (2002) Connection refused wordpress_1 | wordpress_1 | MySQL Connection Error: (2002) Connection refused wordpress_1 | AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.19.0.3. Set the 'ServerName' directive globally to suppress this message wordpress_1 | AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.19.0.3. Set the 'ServerName' directive globally to suppress this message wordpress_1 | [Wed Jan 06 09:19:46.171484 2021] [mpm_prefork:notice] [pid 1] AH00163: Apache/2.4.38 (Debian) PHP/7.4.13 configured -- resuming normal operations wordpress_1 | [Wed Jan 06 09:19:46.171532 2021] [core:notice] [pid 1] AH00094: Command line: 'apache2 -D FOREGROUND' Docker-compose up\uff1a \u8fd9\u5c06\u4ee5\u5206\u79bb\u6a21\u5f0f\u8fd0\u884c Docker-compose up\uff0c\u83b7\u53d6\u6240\u9700\u7684 Docker \u6620\u50cf\uff0c\u5e76\u542f\u52a8 wordpress \u548c\u6570\u636e\u5e93\u5bb9\u5668\u3002 docker-compose up -d:\u540e\u53f0\u542f\u52a8 docker-compose up --build:\u91cd\u65b0\u6784\u5efa 5.\u6d4b\u8bd5\u8bbf\u95ee http://IP:8000/ \u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528 Docker MACHINE\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c\u547d\u4ee4 Docker-MACHINE ip MACHINE _ vm \u6765\u83b7\u53d6\u673a\u5668\u5730\u5740\uff0c\u7136\u540e\u5728 web \u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 http://machine_vm_ip:8000\u3002 dockerfile:\u6784\u5efa\u955c\u50cf\u3002 docker-compose.yaml:\u5b9a\u4e49\u591a\u4e2a\u5bb9\u5668\u4e00\u952e\u542f\u52a8\u6240\u6709\u5bb9\u5668\u3002\u5b9a\u4e49\u591a\u4e2a\u5bb9\u5668\u4e00\u952e\u542f\u52a8\u6240\u6709\u5bb9\u5668\u3002 Docker Swarm \u73af\u5883\u642d\u5efa \u51c6\u59074\u53f0\u865a\u62df\u673a\uff0c\u914d\u7f6e\u597d\u7f51\u7edc\uff0c\u53ef\u4ee5\u8bbf\u95ee\u5916\u7f51\u3002 4\u53f0\u670d\u52a1\u5668\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5b89\u88c5Docker\u3002 1.\u5b89\u88c5gcc\u76f8\u5173\u73af\u5883 yum -y install gcc yum -y install gcc-c++ 2.\u5378\u8f7d\u65e7\u7248\u672c yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine 3.\u5b89\u88c5\u57fa\u7840\u5305 yum install -y yum-utils 4.\u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93 \u9ed8\u8ba4\u56fd\u5916\u6e90\uff1a yum-config-manager \\ --add-repo \\ https://download.docker.com/linux/centos/docker-ce.repo \u963f\u91cc\u4e91\uff1a yum-config-manager \\ --add-repo \\ http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo 5.\u66f4\u65b0yum\u8f6f\u4ef6\u5305\u7d22\u5f15 yum makecache fast 6.\u5b89\u88c5 Docker\u5f15\u64ce yum install -y docker-ce docker-ce-cli containerd.io 7.\u542f\u52a8\u5e76\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8 systemctl start docker systemctl enable docker \u5224\u65ad\u662f\u5426\u5b89\u88c5\u6210\u529f\uff1a [root@localhost ~]# docker version Client: Docker Engine - Community Version: **19.03.13** API version: 1.40 Go version: **go1.13.15** Git commit: 4484c46d9d Built: Wed Sep 16 17:03:45 2020 OS/Arch: linux/amd64 Experimental: false **Server: Docker Engine - Community** Engine: Version: 19.03.13 API version: 1.40 (minimum version 1.12) Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:02:21 2020 OS/Arch: **linux/amd64** Experimental: false containerd: Version: 1.3.7 GitCommit: 8fba4e9a7d01810a393d5d25a3621dc101981175 runc: Version: 1.0.0-rc10 GitCommit: dc9208a3303feef5b3839f4323d9beb36df0a9dd docker-init: Version: 0.18.0 GitCommit: fec3683 [root@localhost ~]# 8.\u914d\u7f6e\u955c\u50cf\u52a0\u901f\u5668 \u9488\u5bf9Docker\u5ba2\u6237\u7aef\u7248\u672c\u5927\u4e8e 1.10.0 \u7684\u7528\u6237 \u60a8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539daemon\u914d\u7f6e\u6587\u4ef6/etc/docker/daemon.json\u6765\u4f7f\u7528\u52a0\u901f\u5668 sudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json <<-'EOF' { \"registry-mirrors\": [\"https://gnxq79wc.mirror.aliyuncs.com\"] } EOF sudo systemctl daemon-reload sudo systemctl restart docker Swarm\u96c6\u7fa4\u642d\u5efa \u6587\u6863\uff1ahttps://docs.docker.com/get-started/swarm-deploy/ Swarm\u6982\u8ff0\uff1a \u8981\u5728\u7fa4\u6a21\u5f0f\u4e0b\u4f7f\u7528 Docker\uff0c\u8bf7\u5b89\u88c5 Docker\u3002 \u5f53\u524d\u7248\u672c\u7684 Docker \u5305\u62ecSwarm\u6a21\u578b\uff0c\u7528\u4e8e\u7ba1\u7406\u4e00\u7ec4\u79f0\u4e3aSwarm\u6a21\u578b\u7684 Docker \u5f15\u64ce\u3002\u4f7f\u7528 dockercli \u521b\u5efa\u4e00\u4e2a\u7fa4\u4f53\uff0c\u5c06\u5e94\u7528\u670d\u52a1\u90e8\u7f72\u5230\u4e00\u4e2a\u7fa4\u4f53\uff0c\u5e76\u7ba1\u7406\u7fa4\u4f53\u884c\u4e3a\u3002 \u7279\u70b9\uff1a 1.\u96c6\u7fa4\u7ba1\u7406\u4e0e Docker \u5f15\u64ce\u96c6\u6210\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684\u7f16\u6392\u8f6f\u4ef6\u6765\u521b\u5efa\u6216\u7ba1\u7406\u7fa4\u3002 2.\u5206\u6563\u5f0f\u8bbe\u8ba1master\u4e0eworker 3.\u58f0\u660e\u6027\u670d\u52a1\u6a21\u578b: Docker Engine \u4f7f\u7528\u58f0\u660e\u6027\u65b9\u6cd5\u6765\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u5806\u6808\u4e2d\u5404\u79cd\u670d\u52a1\u7684\u671f\u671b\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u63cf\u8ff0\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u7531\u5177\u6709\u6d88\u606f\u6392\u961f\u670d\u52a1\u548c\u6570\u636e\u5e93\u540e\u7aef\u7684 web \u524d\u7aef\u670d\u52a1\u7ec4\u6210\u3002 4.\u4f38\u7f29\u6027: \u5bf9\u4e8e\u6bcf\u4e2a\u670d\u52a1\uff0c\u60a8\u53ef\u4ee5\u58f0\u660e\u60f3\u8981\u6267\u884c\u7684\u4efb\u52a1\u7684\u6570\u91cf\u3002\u5f53\u4f60\u5411\u4e0a\u6216\u5411\u4e0b\u6269\u5c55\u65f6\uff0c\u7fa4\u7ba1\u7406\u5668\u4f1a\u901a\u8fc7\u6dfb\u52a0\u6216\u5220\u9664\u4efb\u52a1\u6765\u81ea\u52a8\u8c03\u6574\u4ee5\u4fdd\u6301\u6240\u9700\u7684\u72b6\u6001\u3002 5.\u72b6\u6001\u534f\u8c03: \u7fa4\u7ba1\u7406\u5668\u8282\u70b9\u4e0d\u65ad\u76d1\u89c6\u96c6\u7fa4\u72b6\u6001\uff0c\u5e76\u534f\u8c03\u5b9e\u9645\u72b6\u6001\u548c\u60a8\u6240\u9700\u7684\u72b6\u6001\u4e4b\u95f4\u7684\u4efb\u4f55\u5dee\u5f02\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u670d\u52a1\u6765\u8fd0\u884c\u4e00\u4e2a\u5bb9\u5668\u768410\u4e2a\u526f\u672c\uff0c\u5e76\u4e14\u4e00\u4e2a\u5de5\u4f5c\u673a\u5668\u627f\u8f7d\u4e86\u5176\u4e2d\u7684\u4e24\u4e2a\u526f\u672c\u5d29\u6e83\uff0c\u90a3\u4e48\u7ba1\u7406\u5668\u5c06\u521b\u5efa\u4e24\u4e2a\u65b0\u7684\u526f\u672c\u6765\u66ff\u6362\u5d29\u6e83\u7684\u526f\u672c\u3002\u7ba1\u7406\u5668\u5c06\u65b0\u7684\u526f\u672c\u5206\u914d\u7ed9\u6240\u6709\u80fd\u591f\u6267\u884c\u4efb\u52a1\u7684\u5de5\u4f5c\u8005\u3002 6.\u591a\u4e3b\u673a\u7f51\u7edc: \u53ef\u4ee5\u4e3a\u60a8\u7684\u670d\u52a1\u6307\u5b9aoverlay\u7f51\u7edc\u3002\u5f53\u521d\u59cb\u5316\u6216\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0cSwarm manager\u4f1a\u81ea\u52a8\u4e3aoverlay\u7f51\u7edc\u4e0a\u7684\u5bb9\u5668\u5206\u914d\u5730\u5740\u3002 7.\u670d\u52a1\u53d1\u73b0: Swarm manager \u8282\u70b9\u4e3a\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u5206\u914d\u552f\u4e00\u7684 DNS \u540d\u79f0\u548c\u8fd0\u884c\u5bb9\u5668\u7684\u8d1f\u8f7d\u5e73\u8861\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u5d4c\u5165\u5728\u7fa4\u4f53\u4e2d\u7684 DNS \u670d\u52a1\u5668\u67e5\u8be2\u7fa4\u4f53\u4e2d\u8fd0\u884c\u7684\u6bcf\u4e2a\u5bb9\u5668\u3002 8.\u8d1f\u8f7d\u5747\u8861: \u5b9e\u73b0\u670d\u52a1\u526f\u672c\u8d1f\u8f7d\u5747\u8861\uff0c\u63d0\u4f9b\u5165\u53e3\u8bbf\u95ee\u3002\u4e5f\u53ef\u4ee5\u5c06\u670d\u52a1\u5165\u53e3\u66b4\u9732\u7ed9\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u518d\u6b21\u8d1f\u8f7d\u5747\u8861\u3002 9.\u5b89\u5168\u4f20\u8f93: \u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u5f3a\u5236\u4f7f\u7528TLS \u76f8\u4e92\u8ba4\u8bc1\u548c\u52a0\u5bc6\uff0c\u4ee5\u786e\u4fdd\u81ea\u8eab\u548c\u5176\u4ed6\u8282\u70b9\u4e4b\u95f4\u7684\u901a\u4fe1\u5b89\u5168\u3002\u60a8\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u6765\u81ea\u81ea\u5b9a\u4e49\u6839 CA \u7684\u81ea\u7b7e\u540d\u6839\u8bc1\u4e66\u6216\u8bc1\u4e66\u3002 10.\u6eda\u52a8\u66f4\u65b0: \u5728\u5347\u7ea7\u65f6\uff0c\u9010\u6b65\u5c06\u5e94\u7528\u66f4\u65b0\u5230\u65b0\u7684\u8282\u70b9\u3002Swarm\u5141\u8bb8\u60a8\u63a7\u5236\u4e0d\u540c\u8282\u70b9\u96c6\u7684\u670d\u52a1\u90e8\u7f72\u4e4b\u95f4\u7684\u5ef6\u8fdf\u3002\u5982\u679c\u51fa\u73b0\u4efb\u4f55\u95ee\u9898\uff0c\u60a8\u53ef\u4ee5\u56de\u6eda\u5230\u8be5\u670d\u52a1\u7684\u4ee5\u524d\u7248\u672c\u3002 \u5de5\u4f5c\u6a21\u5f0f \u8282\u70b9\u662f\u5982\u4f55\u5de5\u4f5c\u7684? Docker Engine 1.12\u5f15\u5165\u4e86\u96c6\u7fa4\u6a21\u5f0f\uff0c\u4f7f\u60a8\u80fd\u591f\u521b\u5efa\u4e00\u4e2a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a Docker Engine \u7ec4\u6210\u7684\u96c6\u7fa4\uff0c\u79f0\u4e3aSwarm\u3002\u4e00\u4e2a\u96c6\u7fa4\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u8282\u70b9\u7ec4\u6210: \u5728\u96c6\u7fa4\u6a21\u5f0f\u4e0b\u8fd0\u884c Docker Engine 1.12\u6216\u66f4\u9ad8\u7248\u672c\u7684\u7269\u7406\u6216\u865a\u62df\u673a\u5668\u3002 \u8282\u70b9\u6709\u4e24\u79cd\u7c7b\u578b: managers and workers . Manager nodes\uff08\u7ba1\u7406\u5668\u8282\u70b9\uff09 \u7ba1\u7406\u5668\u8282\u70b9\u5904\u7406\u96c6\u7fa4\u7ba1\u7406\u4efb\u52a1: maintaining cluster state \u4fdd\u6301\u96c6\u7fa4\u72b6\u6001 scheduling services \u8c03\u5ea6\u670d\u52a1 serving swarm mode \u670d\u52a1\u7fa4\u6a21\u5f0f Raft\u4e00\u81f4\u6027\u7b97\u6cd5\uff08\u4fdd\u8bc1\u53ef\u7528\u6027\uff09 \u7ba1\u7406\u8005\u96c6\u7fa4\u6700\u591a\u53ea\u80fd\u5fcd\u53d7\u635f\u5931 (N-1)/2 managers. \u5efa\u8bae\u4e00\u4e2a\u96c6\u7fa4\u6700\u5c11\u67093\u53f0\u4e3b\u673a\u3002 \u5efa\u8bae\u4e00\u4e2a\u96c6\u7fa4\u6700\u591a\u6709\u4e03\u4e2a\u7ba1\u7406\u5668\u8282\u70b9\u3002 \u91cd\u8981\u63d0\u793a: \u6dfb\u52a0\u66f4\u591a\u7684\u7ba1\u7406\u5668\u5e76\u4e0d\u610f\u5473\u7740\u589e\u52a0\u53ef\u4f38\u7f29\u6027\u6216\u66f4\u9ad8\u7684\u6027\u80fd\u3002 Worker nodes \uff08\u5de5\u4f5c\u8282\u70b9\uff09 \u5de5\u4f5c\u8282\u70b9\u4e5f\u662f Docker Engine \u7684\u5b9e\u4f8b\uff0c\u5b83\u7684\u552f\u4e00\u76ee\u7684\u662f\u6267\u884c\u5bb9\u5668\u3002\u5de5\u4f5c\u8282\u70b9\u4e0d\u53c2\u4e0e Raft \u5206\u5e03\u5f0f\u72b6\u6001\uff0c\u4e0d\u505a\u8c03\u5ea6\u51b3\u7b56\uff0c\u4e5f\u4e0d\u670d\u52a1\u4e8e\u96c6\u7fa4\u6a21\u5f0f\u7684 HTTP API\u3002 \u60a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7531\u4e00\u4e2a\u7ba1\u7406\u5668\u8282\u70b9\u7ec4\u6210\u7684\u7fa4\uff0c\u4f46\u662f\u5982\u679c\u6ca1\u6709\u81f3\u5c11\u4e00\u4e2a\u7ba1\u7406\u5668\u8282\u70b9\uff0c\u5c31\u4e0d\u80fd\u6709\u4e00\u4e2aworker\u8282\u70b9\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684\u7ba1\u7406\u8005\u90fd\u662fworker\u3002\u5728\u5355\u4e2a\u7ba1\u7406\u5668\u8282\u70b9\u96c6\u7fa4\u4e2d\uff0c\u60a8\u53ef\u4ee5\u8fd0\u884c\u8bf8\u5982 docker \u670d\u52a1 create \u4e4b\u7c7b\u7684\u547d\u4ee4\uff0c\u8c03\u5ea6\u7a0b\u5e8f\u5c06\u6240\u6709\u4efb\u52a1\u653e\u5728\u672c\u5730\u5f15\u64ce\u4e0a\u3002 \u82e5\u8981\u9632\u6b62\u8c03\u5ea6\u7a0b\u5e8f\u5c06\u4efb\u52a1\u653e\u5728\u591a\u8282\u70b9\u7fa4\u4e2d\u7684\u7ba1\u7406\u5668\u8282\u70b9\u4e0a\uff0c\u8bf7\u5c06\u7ba1\u7406\u5668\u8282\u70b9\u7684\u53ef\u7528\u6027\u8bbe\u7f6e\u4e3a Drain\u3002\u8c03\u5ea6\u7a0b\u5e8f\u5728 Drain \u6a21\u5f0f\u4e0b\u6b63\u5e38\u505c\u6b62\u8282\u70b9\u4e0a\u7684\u4efb\u52a1\uff0c\u5e76\u5728\u6d3b\u52a8\u8282\u70b9\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u8c03\u5ea6\u7a0b\u5e8f\u4e0d\u4f1a\u5c06\u65b0\u4efb\u52a1\u5206\u914d\u7ed9\u5177\u6709 Drain \u53ef\u7528\u6027\u7684\u8282\u70b9 \u670d\u52a1\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\uff1f \u8981\u5728 Docker Engine \u5904\u4e8e\u7fa4\u6a21\u5f0f\u65f6\u90e8\u7f72\u5e94\u7528\u7a0b\u5e8f\u6620\u50cf\uff0c\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u3002\u670d\u52a1\u901a\u5e38\u662f\u67d0\u4e2a\u8f83\u5927\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u4e2d\u5fae\u670d\u52a1\u7684\u6620\u50cf\u3002\u670d\u52a1\u7684\u793a\u4f8b\u53ef\u80fd\u5305\u62ec HTTP \u670d\u52a1\u5668\u3001\u6570\u636e\u5e93\u6216\u5e0c\u671b\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u8fd0\u884c\u7684\u4efb\u4f55\u5176\u4ed6\u7c7b\u578b\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u3002 Services\uff1a \u5f53\u60a8\u5c06\u670d\u52a1\u90e8\u7f72\u5230Swarm\u65f6\uff0cSwarm manager\u63a5\u53d7\u60a8\u7684\u670d\u52a1\u5b9a\u4e49\u4f5c\u4e3a\u670d\u52a1\u7684\u671f\u671b\u72b6\u6001\u3002\u7136\u540e\u5c06Swarm\u4e2d\u8282\u70b9\u4e0a\u7684\u670d\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a\u526f\u672c\u4efb\u52a1\u8fdb\u884c\u8c03\u5ea6\u3002\u8fd9\u4e9b\u4efb\u52a1\u5728\u7fa4\u4e2d\u7684\u8282\u70b9\u4e0a\u72ec\u7acb\u8fd0\u884c\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u60a8\u5e0c\u671b\u5728\u4e00\u4e2a HTTP \u4fa6\u542c\u5668\u7684\u4e09\u4e2a\u5b9e\u4f8b\u4e4b\u95f4\u8fdb\u884c\u8d1f\u8f7d\u5e73\u8861\u3002\u4e0b\u56fe\u663e\u793a\u4e86\u4e00\u4e2a\u5177\u6709\u4e09\u4e2a\u526f\u672c\u7684 HTTP \u4fa6\u542c\u5668\u670d\u52a1\u3002\u76d1\u542c\u5668\u7684\u4e09\u4e2a\u5b9e\u4f8b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u662f\u7fa4\u4e2d\u7684\u4e00\u4e2a\u4efb\u52a1\u3002 TASK\u548cScheduler: \u5bb9\u5668\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u8fc7\u7a0b\u3002\u5728\u7fa4\u6a21\u5f0f\u6a21\u578b\u4e2d\uff0c\u6bcf\u4e2a\u4efb\u52a1\u53ea\u8c03\u7528\u4e00\u4e2a\u5bb9\u5668\u3002\u4efb\u52a1\u7c7b\u4f3c\u4e8e\u8c03\u5ea6\u7a0b\u5e8f\u653e\u7f6e\u5bb9\u5668\u7684\u201c\u69fd\u201d\u3002\u4e00\u65e6\u5bb9\u5668\u5904\u4e8e\u6fc0\u6d3b\u72b6\u6001\uff0c\u8c03\u5ea6\u7a0b\u5e8f\u5c31\u4f1a\u8bc6\u522b\u51fa\u4efb\u52a1\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3002\u5982\u679c\u5bb9\u5668\u672a\u80fd\u901a\u8fc7\u5065\u5eb7\u68c0\u67e5\u6216\u7ec8\u6b62\uff0c\u5219\u4efb\u52a1\u7ec8\u6b62\u3002 \u4efb\u52a1\u662f\u96c6\u7fa4\u4e2d\u8c03\u5ea6\u7684\u539f\u5b50\u5355\u4f4d\u3002\u5f53\u60a8\u901a\u8fc7\u521b\u5efa\u6216\u66f4\u65b0\u670d\u52a1\u6765\u58f0\u660e\u6240\u9700\u7684\u670d\u52a1\u72b6\u6001\u65f6\uff0c\u534f\u8c03\u5668\u901a\u8fc7\u8c03\u5ea6\u4efb\u52a1\u6765\u5b9e\u73b0\u6240\u9700\u7684\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u60a8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u5b83\u6307\u793a\u534f\u8c03\u5668\u59cb\u7ec8\u8fd0\u884c HTTP \u4fa6\u542c\u5668\u7684\u4e09\u4e2a\u5b9e\u4f8b\u3002\u534f\u8c03\u8005\u901a\u8fc7\u521b\u5efa\u4e09\u4e2a\u4efb\u52a1\u6765\u8fdb\u884c\u54cd\u5e94\u3002\u6bcf\u4e2a\u4efb\u52a1\u90fd\u662f\u8c03\u5ea6\u7a0b\u5e8f\u901a\u8fc7\u751f\u6210\u5bb9\u5668\u586b\u5145\u7684\u69fd\u3002\u5bb9\u5668\u662f\u4efb\u52a1\u7684\u5b9e\u4f8b\u5316\u3002\u5982\u679c HTTP \u4fa6\u542c\u5668\u4efb\u52a1\u968f\u540e\u5931\u8d25\u6216\u5d29\u6e83\uff0c\u534f\u8c03\u5668\u5c06\u521b\u5efa\u4e00\u4e2a\u4ea7\u751f\u65b0\u5bb9\u5668\u7684\u65b0\u526f\u672c\u4efb\u52a1\u3002 \u4efb\u52a1\u662f\u4e00\u79cd\u5355\u5411\u673a\u5236\u3002\u5b83\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u72b6\u6001\u5355\u8c03\u5730\u8fdb\u884c: \u5206\u914d\u3001\u51c6\u5907\u3001\u8fd0\u884c\u7b49\u7b49\u3002\u5982\u679c\u4efb\u52a1\u5931\u8d25\uff0c\u534f\u8c03\u5668\u5c06\u5220\u9664\u4efb\u52a1\u53ca\u5176\u5bb9\u5668\uff0c\u7136\u540e\u6839\u636e\u670d\u52a1\u6307\u5b9a\u7684\u6240\u9700\u72b6\u6001\u521b\u5efa\u4e00\u4e2a\u65b0\u4efb\u52a1\u6765\u66ff\u6362\u5b83\u3002 Docker \u7fa4\u6a21\u5f0f\u7684\u57fa\u672c\u903b\u8f91\u662f\u4e00\u4e2a\u901a\u7528\u7684\u8c03\u5ea6\u5668\u548c\u534f\u8c03\u5668\u3002\u670d\u52a1\u548c\u4efb\u52a1\u62bd\u8c61\u672c\u8eab\u5e76\u4e0d\u77e5\u9053\u5b83\u4eec\u5b9e\u73b0\u7684\u5bb9\u5668\u3002\u5047\u8bbe\uff0c\u60a8\u53ef\u4ee5\u5b9e\u73b0\u5176\u4ed6\u7c7b\u578b\u7684\u4efb\u52a1\uff0c\u4f8b\u5982\u865a\u62df\u673a\u4efb\u52a1\u6216\u975e\u5bb9\u5668\u5316\u7684\u6d41\u7a0b\u4efb\u52a1\u3002\u8c03\u5ea6\u7a0b\u5e8f\u548c\u534f\u8c03\u5668\u5bf9\u4efb\u52a1\u7684\u7c7b\u578b\u4e0d\u77e5\u9053\u3002\u4f46\u662f\uff0c\u5f53\u524d\u7248\u672c\u7684 Docker \u53ea\u652f\u6301\u5bb9\u5668\u4efb\u52a1\u3002 \u4e0b\u56fe\u663e\u793a\u4e86\u7fa4\u6a21\u5f0f\u5982\u4f55\u63a5\u53d7\u670d\u52a1\u521b\u5efa\u8bf7\u6c42\u5e76\u5c06\u4efb\u52a1\u8c03\u5ea6\u5230\u5de5\u4f5c\u8282\u70b9\u3002 \u547d\u4ee4\u2014\u7ba1\u7406\u2014API\u2014\u8c03\u5ea6\u2014\u5de5\u4f5c\u8282\u70b9\uff08\u521b\u5efaTASK,\u5bb9\u5668\u90e8\u7f72\uff0c\u7ef4\u62a4\uff09 eplicated and global services: \u6709\u4e24\u79cd\u7c7b\u578b\u7684\u670d\u52a1\u90e8\u7f72\uff0c\u590d\u5236\u7684\u548c\u5168\u5c40\u7684\u3002 \u5bf9\u4e8e\u590d\u5236\u670d\u52a1\uff0c\u6307\u5b9a\u8981\u8fd0\u884c\u7684\u76f8\u540c\u4efb\u52a1\u7684\u6570\u91cf\u3002\u4f8b\u5982\uff0c\u60a8\u51b3\u5b9a\u4f7f\u7528\u4e09\u4e2a\u526f\u672c\u90e8\u7f72\u4e00\u4e2a HTTP \u670d\u52a1\uff0c\u6bcf\u4e2a\u526f\u672c\u63d0\u4f9b\u76f8\u540c\u7684\u5185\u5bb9\u3002 \u5168\u5c40\u670d\u52a1\u662f\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u4e00\u4e2a\u4efb\u52a1\u7684\u670d\u52a1\u3002\u6ca1\u6709\u9884\u5148\u6307\u5b9a\u7684\u4efb\u52a1\u6570\u91cf\u3002\u6bcf\u6b21\u5411\u7fa4\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u8282\u70b9\u65f6\uff0c\u534f\u8c03\u5668\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\uff0c\u8c03\u5ea6\u5668\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u65b0\u8282\u70b9\u3002\u5168\u7403\u670d\u52a1\u7684\u4f18\u79c0\u5019\u9009\u8005\u662f\u76d1\u63a7\u4ee3\u7406\u7a0b\u5e8f\u3001\u53cd\u75c5\u6bd2\u626b\u63cf\u7a0b\u5e8f\u6216\u5176\u4ed6\u7c7b\u578b\u7684\u5bb9\u5668\uff0c\u60a8\u5e0c\u671b\u5728\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u8fd9\u4e9b\u5bb9\u5668\u3002 \u4e0b\u56fe\u663e\u793a\u4e86\u4e00\u4e2a\u9ec4\u8272\u7684\u4e09\u670d\u52a1\u526f\u672c\u548c\u4e00\u4e2a\u7070\u8272\u7684\u5168\u5c40\u670d\u52a1\u3002 \u89e3\u91caReplicated and global \uff1a Replicated \u590d\u5236\uff1a\u6307\u5b9a\u8981\u8fd0\u884c\u7684\u8282\u70b9\u548c\u6570\u91cf\uff0c\u9ed8\u8ba4\u3002 global \u5168\u5c40\uff1a\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u4e00\u4e2a\u4efb\u52a1\u7684\u670d\u52a1\u3002\u6bcf\u589e\u52a0\u4e00\u4e2a\u65b0\u8282\u70b9\uff0c\u534f\u8c03\u5668\u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4efb\u52a1\uff0c\u8c03\u5ea6\u5668\u518d\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u65b0\u8282\u70b9\u3002 \u5177\u4f53\u65b9\u6cd5\uff1a --mode string Service mode (replicated or global)(default \"replicated\") docker service create --mode replicated --name mytom tomcat:7 \u9ed8\u8ba4 docker service create --mode global --name mytest alpine ping baidu.com \u573a\u666f\uff1f \u65e5\u5fd7\u6536\u96c6 \u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u6709\u81ea\u5df1\u7684\u65e5\u5fd7\u6536\u96c6\u5668\uff0c\u8fc7\u6ee4\uff0c\u628a\u6240\u6709\u65e5\u5fd7\u6700\u7ec8\u518d\u4f20\u7ed9\u65e5\u5fd7\u4e2d\u5fc3\u670d\u52a1\u76d1\u63a7\u72b6\u6001\u6027\u80fd\u3002 \u4f7f\u7528Swarm 1.docker swarm --help [root@localhost ~]# docker swarm --help Usage: docker swarm COMMAND Manage Swarm Commands: ca Display and rotate the root CA init Initialize a swarm \u521d\u59cb\u5316\u4e00\u4e2a\u96c6\u7fa4 join Join a swarm as a node and/or manager \u52a0\u5165\u4e00\u4e2a\u96c6\u7fa4 join-token Manage join tokens \u521b\u5efa\u4e00\u4e2atoken leave Leave the swarm \u79bb\u5f00\u4e00\u4e2a\u96c6\u7fa4 unlock Unlock swarm unlock-key Manage the unlock key update Update the swarm \u66f4\u65b0\u4e00\u4e2a\u96c6\u7fa4 Run 'docker swarm COMMAND --help' for more information on a command. [root@localhost ~]# 2.docker swarm init --help [root@localhost ~]# docker swarm init --help Usage: docker swarm init [OPTIONS] Initialize a swarm Options: --advertise-addr string \u589e\u52a0\u5e7f\u64ad\u5730\u5740 Advertised address (format: <ip|interface>[:port]) --autolock Enable manager autolocking (requiring an unlock key to start a stopped manager) --availability string Availability of the node (\"active\"|\"pause\"|\"drain\") (default \"active\") --cert-expiry duration Validity period for node certificates (ns|us|ms|s|m|h) (default 2160h0m0s) --data-path-addr string Address or interface to use for data path traffic (format: <ip|interface>) --data-path-port uint32 Port number to use for data path traffic (1024 - 49151). If no value is set or is set to 0, the default port (4789) is used. --default-addr-pool ipNetSlice default address pool in CIDR format (default []) --default-addr-pool-mask-length uint32 default address pool subnet mask length (default 24) --dispatcher-heartbeat duration Dispatcher heartbeat period (ns|us|ms|s|m|h) (default 5s) --external-ca external-ca Specifications of one or more certificate signing endpoints --force-new-cluster Force create a new cluster from current state --listen-addr node-addr Listen address (format: <ip|interface>[:port]) (default 0.0.0.0:2377) --max-snapshots uint Number of additional Raft snapshots to retain --snapshot-interval uint Number of log entries between Raft snapshots (default 10000) --task-history-limit int Task history retention limit (default 5) [root@localhost ~]# --advertise-addr string\u5e7f\u64ad\u5730\u5740 \u521d\u59cb\u5316 1.\u67e5\u770b\u4e3b\u673aIP\u4fe1\u606f [root@localhost ~]# ip a 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000 link/ether 00:0c:29:4c:20:77 brd ff:ff:ff:ff:ff:ff inet 192.168.100.103/24 brd 192.168.100.255 scope global noprefixroute eth0 valid_lft forever preferred_lft forever inet6 fe80::5ff3:633c:1e91:e523/64 scope link tentative noprefixroute dadfailed valid_lft forever preferred_lft forever inet6 fe80::4cb8:b4bd:811f:6064/64 scope link tentative noprefixroute dadfailed valid_lft forever preferred_lft forever inet6 fe80::da97:34b6:c534:91b8/64 scope link tentative noprefixroute dadfailed valid_lft forever preferred_lft forever 3: docker0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN group default link/ether 02:42:e7:a7:1e:81 brd ff:ff:ff:ff:ff:ff inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0 valid_lft forever preferred_lft forever [root@localhost ~]# 2.\u8ba9\u8be5\u4e3b\u673a\u6210\u4e3a\u4e3b\u8282\u70b9 docker swarm init --advertise-addr 192.168.100.100 [root@localhost ~]# docker swarm init --advertise-addr 192.168.100.100 Swarm initialized: current node (28fgw2e0nmc14greycbow7v9s) is now a manager. To add a worker to this swarm, run the following command: docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-303dpxlqb9vehlo7sox0wv56a 192.168.100.100:2377 To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions. [root@localhost ~]# 3.\u5f97\u5230\u4fe1\u606f \u5f53\u524d\u8282\u70b9\uff0828fgw2e0nmc14greycbow7v9s\uff09\u5df2\u52a0\u5165\u5230Swarm\u4e2d\uff0c\u73b0\u5728\u662f\u4e00\u4e2a\u7ba1\u7406\u5458\u3002 Swarm initialized: current node (28fgw2e0nmc14greycbow7v9s) is now a manager. \u8981\u5c06worker\u5de5\u4f5c\u8282\u70b9\u6dfb\u52a0\u5230\u8be5\u7fa4\u96c6\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4 docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-303dpxlqb9vehlo7sox0wv56a 192.168.100.100:2377 \u8981\u5c06\u7ba1\u7406\u5668\u6dfb\u52a0\u5230\u8be5\u96c6\u7fa4\uff0c\u8bf7\u8fd0\u884c\u201c docker swarm join-token manager\u201d\u5e76\u6309\u7167\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002 To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions. docker swarm init \u521d\u59cb\u5316\u8282\u70b9 docker swarm join \u52a0\u5165\u4e00\u4e2a\u8282\u70b9 \u83b7\u53d6\u4ee4\u724c\uff1a docker swarm join-token manager \u751f\u6210\u4e3b\u8282\u70b9\u4ee4\u724c docker swarm join-token worker \u751f\u6210\u52a0\u5165\u8282\u70b9\u4ee4\u724c \u5728\u4e3b\u8282\u70b9\u6267\u884c\u547d\u4ee4\u540e\u4f1a\u751f\u6210\u52a0\u5165\u547d\u4ee4\u3002 \u52a0\u5165\u96c6\u7fa4 \u5728\u5de5\u4f5c\u8282\u70b9\u6267\u884c\u52a0\u5165\u96c6\u7fa4\u547d\u4ee4\uff1a docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-303dpxlqb9vehlo7sox0wv56a 192.168.100.100:2377 \u7ed3\u679c\uff1a\u6b64\u8282\u70b9\u4f5c\u4e3a\u5de5\u4f5c\u8282\u70b9\u5df2\u52a0\u5165\u96c6\u7fa4\u3002 [root@localhost ~]# docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-303dpxlqb9vehlo7sox0wv56a 192.168.100.100:2377 This node joined a swarm as a worker. [root@localhost ~]# \u67e5\u770b\u52a0\u5165\u7684\u8282\u70b9\u4fe1\u606f \u5728\u4e3b\u8282\u70b9\u6267\u884c\u5982\u4e0b\u547d\u4ee4: [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 28fgw2e0nmc14greycbow7v9s * localhost.localdomain Ready Active Leader 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u72b6\u6001\uff1aReady Active \u4e3b\u8282\u70b9\u9ed8\u8ba4\u6709Leader\u6807\u7b7e\u3002\u5de5\u4f5c\u8282\u70b9\u65e0\u3002 \u5c06\u6240\u6709\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\u540e\u518d\u67e5\u770b\u8282\u70b9\u4fe1\u606f [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 28fgw2e0nmc14greycbow7v9s * localhost.localdomain Ready Active Leader 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Ready Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Ready Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u5220\u9664\u8282\u70b9 Error response from daemon: This node is already part of a swarm. Use \"docker swarm leave\" to leave this swarm and join another one. [root@localhost ~]# docker swarm leave Node left the swarm. [root@localhost ~]# \u5c06\u7b2c\u56db\u53f0\u4e3b\u673a\u6539\u4e3a\u4e3b\u8282\u70b9 \u4ece\u96c6\u7fa4\u4e2d\u79fb\u9664\u540e\uff0c\u5728\u4e3b\u8282\u70b9\u4e0a\u6267\u884cdocker swarm join-token manager\u5c06\u8be5\u7ba1\u7406\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\u3002 [root@localhost ~]# docker swarm join-token manager To add a manager to this swarm, run the following command: docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-bdcobfl71betmca8g1aci3hks 192.168.100.100:2377 [root@localhost ~]# \u751f\u6210\u52a0\u5165\u4ee4\u724c\u540e\u5728\u7b2c4\u53f0\u4e3b\u673a\u6267\u884c\u8be5\u547d\u4ee4\u3002 [root@localhost ~]# docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-bdcobfl71betmca8g1aci3hks 192.168.100.100:2377 This node joined a swarm as a manager. [root@localhost ~]# \u518d\u6b21\u5230\u4e3b\u8282\u70b9\u67e5\u770b\u96c6\u7fa4\u7684\u8282\u70b9\u4fe1\u606f [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s * localhost.localdomain Ready Active Leader 20.10.2 653jropyn5jpg6f1ytwye2xrr localhost.localdomain Ready Active Reachable 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Ready Active 20.10.2 \u52a0\u5165\u7684\u7ba1\u7406\u8282\u70b9\u5e26\u6709Reachable\u6807\u7b7e\u3002 \u53cc\u4e3b\u53cc\u4ece\u96c6\u7fa4\u642d\u5efa\u5b8c\u6bd5\u3002 Raft\u4e00\u81f4\u6027\u534f\u8bae \u5b9e\u9a8c \u53cc\u4e3b\u53cc\u4ece\uff1a\u5047\u8bbe\u4e00\u4e2a\u8282\u70b9\u6302\u6389\uff0c\u5176\u4ed6\u8282\u70b9\u662f\u5426\u53ef\u7528\uff1f \u505c\u6389docker-1,\u5728docker-4\u4e0a\u6267\u884c\u547d\u4ee4\u6d4b\u8bd5 docker-1 systemctl stop docker docker-4 docker node ls \u62a5\u9519\u4fe1\u606f\uff08\u6765\u81ea\u5b88\u62a4\u7a0b\u5e8f\u7684\u9519\u8bef\u54cd\u5e94\uff1arpc\u9519\u8bef\uff1a\uff09\uff1a [root@localhost ~]# docker node ls Error response from daemon: rpc error: code = DeadlineExceeded desc = context deadline exceeded [root@localhost ~]# \u518d\u6b21\u542f\u52a8docker-1\u4e3b\u8282\u70b9\uff0c\u67e5\u770b\u8282\u70b9\u4fe1\u606f\uff0c\u53ef\u4ee5\u7ee7\u7eed\u5de5\u4f5c \u53d1\u73b0\uff1a \u4e00\u4e2a\u4e3b\u8282\u70b9\u6302\u6389\uff0c\u518d\u6b21\u542f\u52a8\u540e\u8be5\u4e3b\u8282\u70b9\u53d8\u4e3a\u5de5\u4f5c\u8282\u70b9 [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s * localhost.localdomain Ready Active Reachable 20.10.2 653jropyn5jpg6f1ytwye2xrr localhost.localdomain Unknown Active Leader 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Unknown Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u5230docker-4\u8282\u70b9\u67e5\u770b\u4fe1\u606f\uff0c\u6b64\u65f6docker-4\u7ba1\u7406\u8282\u70b9\u53d8\u4e3aLeader\u7ba1\u7406\u8282\u70b9\u3002 [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s localhost.localdomain Ready Active Reachable 20.10.2 653jropyn5jpg6f1ytwye2xrr * localhost.localdomain Ready Active Leader 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Ready Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u4e09\u4e3b\u8282\u70b9 \u5b9e\u9a8c \u5c06docker-3\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\uff0c\u7531worker\u8282\u70b9\u4fee\u6539\u4e3amanager\u8282\u70b9\u3002 [root@localhost ~]# docker swarm leave Node left the swarm. [root@localhost ~]# docker swarm leave Error response from daemon: This node is not part of a swarm [root@localhost ~]# manager\u8282\u70b9\u67e5\u770b\u8282\u70b9\u4fe1\u606f \u79fb\u9664\u8282\u70b9\u540e\u518d\u67e5\u770b\u8282\u70b9\u4f1a\u53d8\u6210Dowm\u72b6\u6001\u3002 [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s localhost.localdomain Ready Active Reachable 20.10.2 653jropyn5jpg6f1ytwye2xrr * localhost.localdomain Ready Active Leader 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Down Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u7ba1\u7406\u8282\u70b9\u751f\u6210\u4ee4\u724c [root@localhost ~]# docker swarm join-token manager To add a manager to this swarm, run the following command: docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-bdcobfl71betmca8g1aci3hks 192.168.100.103:2377 [root@localhost ~]# \u5c06docker-3\u4ee5\u7ba1\u7406\u8282\u70b9\u52a0\u5165Swarm\u96c6\u7fa4 [root@localhost ~]# docker swarm leave Error response from daemon: This node is not part of a swarm [root@localhost ~]# docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-bdcobfl71betmca8g1aci3hks 192.168.100.103:2377 This node joined a swarm as a manager. [root@localhost ~]# docker-3\u52a0\u5165\u7ba1\u7406\u8282\u70b9\u540e\u5728docker-3\u4e0b\u6267\u884cdocker node ls,\u8be5\u8282\u70b9\u4e5f\u88ab\u6253\u4e0aReachable\u6807\u7b7e\u3002 [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s localhost.localdomain Ready Active Reachable 20.10.2 653jropyn5jpg6f1ytwye2xrr localhost.localdomain Ready Active Leader 20.10.2 j8xhfzomjxqqq9m97n3rf0xk8 * localhost.localdomain Ready Active Reachable 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Down Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# worker\u8282\u70b9\u53ea\u7528\u6765\u5de5\u4f5c\uff0c\u65e0\u6cd5\u64cd\u4f5c\u96c6\u7fa4\u3002 manager\u7ba1\u7406\u8282\u70b9\u7528\u6765\u64cd\u4f5cSwarm\u96c6\u7fa4\u3002 \u6d4b\u8bd5\u5173\u95eddocker-1\u8282\u70b9 [root@localhost ~]# systemctl stop docker Warning: Stopping docker.service, but it can still be activated by: docker.socket [root@localhost ~]# docker-1\u8282\u70b9\u4f1a\u6253\u4e0aUnreachable\uff08\u65e0\u6cd5\u5230\u8fbe\uff09\u6807\u7b7e [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s localhost.localdomain Ready Active Unreachable 20.10.2 653jropyn5jpg6f1ytwye2xrr * localhost.localdomain Ready Active Leader 20.10.2 j8xhfzomjxqqq9m97n3rf0xk8 localhost.localdomain Ready Active Reachable 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Down Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u4e09\u4e3b\u4e00\u4ece\uff0c\u6302\u63891\u53f0\u7ba1\u7406\u8282\u70b9\uff0c\u5176\u4ed62\u53f0\u7ba1\u7406\u8282\u70b9docker-3 docker-4\u7ba1\u7406\u8282\u70b9\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u3002 \u6d4b\u8bd5\u6302\u63892\u53f0\u7ba1\u7406\u8282\u70b9 \u518d\u505c\u63891\u53f0\u7ba1\u7406\u8282\u70b9docker-3,\u6d4b\u8bd5\u53ea\u5269docker-4\u7ba1\u7406\u8282\u70b9\u662f\u5426\u53ef\u7528\u3002 docker-3 [root@localhost ~]# systemctl stop docker Warning: Stopping docker.service, but it can still be activated by: docker.socket [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES [root@localhost ~]# docker-4\u7ba1\u7406\u8282\u70b9:\u65e0\u6cd5\u4f7f\u7528 [root@localhost ~]# docker node ls Error response from daemon: rpc error: code = Unknown desc = The swarm does not have a leader. It's possible that too few managers are online. Make sure more than half of the managers are online. [root@localhost ~]# \u96c6\u7fa4\u53ef\u7528\uff1a\u81f3\u5c11\u4fdd\u8bc1>3\u8282\u70b9\uff0c>1\u53f0\u7ba1\u7406\u8282\u70b9\u5b58\u6d3b\u3002 Raft\u534f\u8bae:\u4fdd\u8bc1\u5927\u591a\u6570\u8282\u70b9\u5b58\u6d3b\u624d\u53ef\u4ee5\u7528\uff0c\u9ad8\u53ef\u7528\u3002 \u5f39\u6027\u6269\u7f29\u5bb9 docker run \u5bb9\u5668\u542f\u52a8\uff0c\u4e0d\u5177\u5907\u6269\u7f29\u5bb9\u5668\uff01 docker service \u5177\u6709\u6269\u7f29\u5bb9\uff0c\u6eda\u52a8\u66f4\u65b0\uff01 [root@docker1 ~]# docker service --help Usage: docker service COMMAND Manage services Commands: create Create a new service inspect Display detailed information on one or more services logs Fetch the logs of a service or task ls List services ps List the tasks of one or more services rm Remove one or more services rollback Revert changes to a service's configuration scale Scale one or multiple replicated services update Update a service Run 'docker service COMMAND --help' for more information on a command. [root@docker1 ~]# rollback Revert changes to a service's configuration\uff08\u5c06\u66f4\u6539\u8fd8\u539f\u5230\u670d\u52a1\u7684\u914d\u7f6e\uff09\u2014\u56de\u6eda scale Scale one or multiple replicated services\uff08\u6269\u5c55\u4e00\u4e2a\u6216\u591a\u4e2a\u670d\u52a1\uff09\u2014\u52a8\u6001\u6269\u7f29\u5bb9 update Update a service\uff08\u66f4\u65b0\u670d\u52a1\uff09\u2014\u66f4\u65b0 \u521b\u5efa\u670d\u52a1\u2014\u52a8\u6001\u6269\u5c55\u670d\u52a1\u2014\u52a8\u6001\u66f4\u65b0\u670d\u52a1 create\u5e2e\u52a9\u547d\u4ee4 [root@docker1 ~]# docker service create --help Usage: docker service create [OPTIONS] IMAGE [COMMAND] [ARG...] Create a new service Options: --cap-add list Add Linux capabilities --cap-drop list Drop Linux capabilities --config config Specify configurations to expose to the service --constraint list Placement constraints --container-label list Container labels --credential-spec credential-spec Credential spec for managed service account (Windows only) -d, --detach Exit immediately instead of waiting for the service to converge --dns list Set custom DNS servers --dns-option list Set DNS options --dns-search list Set custom DNS search domains --endpoint-mode string Endpoint mode (vip or dnsrr) (default \"vip\") --entrypoint command Overwrite the default ENTRYPOINT of the image -e, --env list Set environment variables --env-file list Read in a file of environment variables --generic-resource list User defined resources --group list Set one or more supplementary user groups for the container --health-cmd string Command to run to check health --health-interval duration Time between running the check (ms|s|m|h) --health-retries int Consecutive failures needed to report unhealthy --health-start-period duration Start period for the container to initialize before counting retries towards unstable (ms|s|m|h) --health-timeout duration Maximum time to allow one check to run (ms|s|m|h) --host list Set one or more custom host-to-IP mappings (host:ip) --hostname string Container hostname --init Use an init inside each service container to forward signals and reap processes --isolation string Service container isolation mode -l, --label list Service labels --limit-cpu decimal Limit CPUs --limit-memory bytes Limit Memory --limit-pids int Limit maximum number of processes (default 0 = unlimited) --log-driver string Logging driver for service --log-opt list Logging driver options --max-concurrent uint Number of job tasks to run concurrently (default equal to --replicas) --mode string Service mode (replicated, global, replicated-job, or global-job) (default \"replicated\") --mount mount Attach a filesystem mount to the service --name string Service name --network network Network attachments --no-healthcheck Disable any container-specified HEALTHCHECK --no-resolve-image Do not query the registry to resolve image digest and supported platforms --placement-pref pref Add a placement preference -p, --publish port Publish a port as a node port -q, --quiet Suppress progress output --read-only Mount the container's root filesystem as read only --replicas uint Number of tasks --replicas-max-per-node uint Maximum number of tasks per node (default 0 = unlimited) --reserve-cpu decimal Reserve CPUs --reserve-memory bytes Reserve Memory --restart-condition string Restart when condition is met (\"none\"|\"on-failure\"|\"any\") (default \"any\") --restart-delay duration Delay between restart attempts (ns|us|ms|s|m|h) (default 5s) --restart-max-attempts uint Maximum number of restarts before giving up --restart-window duration Window used to evaluate the restart policy (ns|us|ms|s|m|h) --rollback-delay duration Delay between task rollbacks (ns|us|ms|s|m|h) (default 0s) --rollback-failure-action string Action on rollback failure (\"pause\"|\"continue\") (default \"pause\") --rollback-max-failure-ratio float Failure rate to tolerate during a rollback (default 0) --rollback-monitor duration Duration after each task rollback to monitor for failure (ns|us|ms|s|m|h) (default 5s) --rollback-order string Rollback order (\"start-first\"|\"stop-first\") (default \"stop-first\") --rollback-parallelism uint Maximum number of tasks rolled back simultaneously (0 to roll back all at once) (default 1) --secret secret Specify secrets to expose to the service --stop-grace-period duration Time to wait before force killing a container (ns|us|ms|s|m|h) (default 10s) --stop-signal string Signal to stop the container --sysctl list Sysctl options -t, --tty Allocate a pseudo-TTY --ulimit ulimit Ulimit options (default []) --update-delay duration Delay between updates (ns|us|ms|s|m|h) (default 0s) --update-failure-action string Action on update failure (\"pause\"|\"continue\"|\"rollback\") (default \"pause\") --update-max-failure-ratio float Failure rate to tolerate during an update (default 0) --update-monitor duration Duration after each task update to monitor for failure (ns|us|ms|s|m|h) (default 5s) --update-order string Update order (\"start-first\"|\"stop-first\") (default \"stop-first\") --update-parallelism uint Maximum number of tasks updated simultaneously (0 to update all at once) (default 1) -u, --user string Username or UID (format: <name|uid>[:<group|gid>]) --with-registry-auth Send registry authentication details to swarm agents -w, --workdir string Working directory inside the container [root@docker1 ~]# 1.\u521b\u5efa\u670d\u52a1 [root@docker1 ~]# docker service create -p 8888:80 --name my-nginx nginx t99km76mvfkrfx274gdopaux5 overall progress: 1 out of 1 tasks 1/1: running verify: Service converged [root@docker1 ~]# 2.\u67e5\u770b\u521b\u5efa\u7684\u670d\u52a1 REPLICAS:\u526f\u672c\u4e3a1 [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS t99km76mvfkr my-nginx replicated 1/1 nginx:latest *:8888->80/tcp [root@docker1 ~]# 3.\u67e5\u770b\u8fd0\u884c\u7684\u670d\u52a1 [root@docker1 ~]# docker service ps my-nginx ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS af2fbra1lyjx my-nginx.1 nginx:latest docker4 Running Running 4 minutes ago [root@docker1 ~]# \u5728docker1\u521b\u5efa\u7684\u670d\u52a1\u8dd1\u5728docker4\u4e0a NODE\uff1adocker4 [root@docker4 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 4b56584f6710 nginx:latest \"/docker-entrypoint.\u2026\" 10 minutes ago Up 10 minutes 80/tcp my-nginx.1.af2fbra1lyjxxmjor5821c4av [root@docker4 ~]# 4.\u67e5\u770b\u670d\u52a1\u8be6\u7ec6\u4fe1\u606f [root@docker1 ~]# docker service inspect my-nginx [ { \"ID\": \"t99km76mvfkrfx274gdopaux5\", \"Version\": { \"Index\": 78 }, \"CreatedAt\": \"2021-01-11T02:35:51.137685495Z\", \"UpdatedAt\": \"2021-01-11T02:35:51.287333784Z\", \"Spec\": { \"Name\": \"my-nginx\", \"Labels\": {}, \"TaskTemplate\": { \"ContainerSpec\": { \"Image\": \"nginx:latest@sha256:4cf620a5c81390ee209398ecc18e5fb9dd0f5155cd82adcbae532fec94006fb9\", \"Init\": false, \"StopGracePeriod\": 10000000000, \"DNSConfig\": {}, \"Isolation\": \"default\" }, \"Resources\": { \"Limits\": {}, \"Reservations\": {} }, \"RestartPolicy\": { \"Condition\": \"any\", \"Delay\": 5000000000, \"MaxAttempts\": 0 }, \"Placement\": { \"Platforms\": [ { \"Architecture\": \"amd64\", \"OS\": \"linux\" }, { \"OS\": \"linux\" }, { \"OS\": \"linux\" }, { \"Architecture\": \"arm64\", \"OS\": \"linux\" }, { \"Architecture\": \"386\", \"OS\": \"linux\" }, { \"Architecture\": \"mips64le\", \"OS\": \"linux\" }, { \"Architecture\": \"ppc64le\", \"OS\": \"linux\" }, { \"Architecture\": \"s390x\", \"OS\": \"linux\" } ] }, \"ForceUpdate\": 0, \"Runtime\": \"container\" }, \"Mode\": { \"Replicated\": { \"Replicas\": 1 } }, \"UpdateConfig\": { \"Parallelism\": 1, \"FailureAction\": \"pause\", \"Monitor\": 5000000000, \"MaxFailureRatio\": 0, \"Order\": \"stop-first\" }, \"RollbackConfig\": { \"Parallelism\": 1, \"FailureAction\": \"pause\", \"Monitor\": 5000000000, \"MaxFailureRatio\": 0, \"Order\": \"stop-first\" }, \"EndpointSpec\": { \"Mode\": \"vip\", \"Ports\": [ { \"Protocol\": \"tcp\", \"TargetPort\": 80, \"PublishedPort\": 8888, \"PublishMode\": \"ingress\" } ] } }, \"Endpoint\": { \"Spec\": { \"Mode\": \"vip\", \"Ports\": [ { \"Protocol\": \"tcp\", \"TargetPort\": 80, \"PublishedPort\": 8888, \"PublishMode\": \"ingress\" } ] }, \"Ports\": [ { \"Protocol\": \"tcp\", \"TargetPort\": 80, \"PublishedPort\": 8888, \"PublishMode\": \"ingress\" } ], \"VirtualIPs\": [ { \"NetworkID\": \"y06qj1nd1ebb7k2hfvdvkbepy\", \"Addr\": \"10.0.0.9/24\" } ] } } ] [root@docker1 ~]# \u7f51\u7edc\u6a21\u5f0f \"PublishMode\": ingress:\u9ed8\u8ba4\uff08\u7279\u6b8a\u7684Overlay\u7f51\u7edc\uff0c\u5177\u5907\u8d1f\u8f7d\u5747\u8861\u7684\u529f\u80fd\uff1aIPVS/VIP\uff09 Overlay:\u8de8\u670d\u52a1\u5668\u7f51\u7edc Swarm\u91c7\u7528Overlay\u6a21\u5f0f [root@docker1 ~]# docker network ls NETWORK ID NAME DRIVER SCOPE c155108e2db2 bridge bridge local 72827bba54c0 docker_gwbridge bridge local b4006bd11662 host host local y06qj1nd1ebb ingress overlay swarm 44f671135a58 none null local [root@docker1 ~]# \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f [root@docker1 ~]# docker network inspect ingress [ { \"Name\": \"ingress\", \"Id\": \"y06qj1nd1ebb7k2hfvdvkbepy\", \"Created\": \"2021-01-08T03:47:18.963091326-05:00\", \"Scope\": \"swarm\", \"Driver\": \"overlay\", \"EnableIPv6\": false, \"IPAM\": { \"Driver\": \"default\", \"Options\": null, \"Config\": [ { \"Subnet\": \"10.0.0.0/24\", \"Gateway\": \"10.0.0.1\" } ] }, \"Internal\": false, \"Attachable\": false, \"Ingress\": true, \"ConfigFrom\": { \"Network\": \"\" }, \"ConfigOnly\": false, \"Containers\": { \"ingress-sbox\": { \"Name\": \"ingress-endpoint\", \"EndpointID\": \"0d906a438633c47c060ff4c83c057f45d56e47887679d6777c0342cee98a4201\", \"MacAddress\": \"02:42:0a:00:00:02\", \"IPv4Address\": \"10.0.0.2/24\", \"IPv6Address\": \"\" } }, \"Options\": { \"com.docker.network.driver.overlay.vxlanid_list\": \"4096\" }, \"Labels\": {}, \"Peers\": [ { \"Name\": \"30f2fbbc3dfd\", \"IP\": \"192.168.100.100\" }, { \"Name\": \"a77efb0227b7\", \"IP\": \"192.168.100.101\" }, { \"Name\": \"30078eb13cab\", \"IP\": \"192.168.100.103\" }, { \"Name\": \"79e62e9699f5\", \"IP\": \"192.168.100.102\" } ] } ] [root@docker1 ~]# \"Peers\": [ { \"Name\": \"30f2fbbc3dfd\", \"IP\": \"192.168.100.100\" }, { \"Name\": \"a77efb0227b7\", \"IP\": \"192.168.100.101\" }, { \"Name\": \"30078eb13cab\", \"IP\": \"192.168.100.103\" }, { \"Name\": \"79e62e9699f5\", \"IP\": \"192.168.100.102\" } ingress\uff1a\u5176\u5b9e\u662f\u7ed1\u5b9a\u4e864\u53f0\u4e3b\u673a\u7684\u7f51\u7edc\u4fe1\u606f\u3002 \u867d\u7136docker\u57284\u53f0\u4e3b\u673a\u4e0a\uff0c\u5b9e\u9645\u7f51\u7edc\u662f\u540c\u4e00\u4e2a\uff01ingress\u662f\u4e00\u4e2a\u7279\u6b8a\u7684Overlay\u7f51\u7edc\u3002 \u4e0d\u540c\u8282\u70b9\u7684IP\u662f\u4e0d\u540c\u7684\uff0c\u8282\u70b9\u4e4b\u95f4\u7684\u7f51\u7edc\u662f\u65e0\u6cd5\u901a\u4fe1\u7684\uff0c\u901a\u8fc7Overlay\u7f51\u7edc\u53ef\u4ee5\u6253\u901a\u8282\u70b9\u95f4\u7684\u8bbf\u95ee\u3002 \u8bbf\u95ee\u589e\u5927\uff0c\u589e\u52a0\u526f\u672c\u7f13\u89e3\u670d\u52a1\u5668\u538b\u529b\u3002 update\u5e2e\u52a9\u547d\u4ee4 --replicas uint Number of tasks\u521b\u5efa\u4efb\u52a1\u6570\uff08\u526f\u672c\uff09 [root@docker1 ~]# docker service update --help Usage: docker service update [OPTIONS] SERVICE Update a service Options: --args command Service command args --cap-add list Add Linux capabilities --cap-drop list Drop Linux capabilities --config-add config Add or update a config file on a service --config-rm list Remove a configuration file --constraint-add list Add or update a placement constraint --constraint-rm list Remove a constraint --container-label-add list Add or update a container label --container-label-rm list Remove a container label by its key --credential-spec credential-spec Credential spec for managed service account (Windows only) -d, --detach Exit immediately instead of waiting for the service to converge --dns-add list Add or update a custom DNS server --dns-option-add list Add or update a DNS option --dns-option-rm list Remove a DNS option --dns-rm list Remove a custom DNS server --dns-search-add list Add or update a custom DNS search domain --dns-search-rm list Remove a DNS search domain --endpoint-mode string Endpoint mode (vip or dnsrr) --entrypoint command Overwrite the default ENTRYPOINT of the image --env-add list Add or update an environment variable --env-rm list Remove an environment variable --force Force update even if no changes require it --generic-resource-add list Add a Generic resource --generic-resource-rm list Remove a Generic resource --group-add list Add an additional supplementary user group to the container --group-rm list Remove a previously added supplementary user group from the container --health-cmd string Command to run to check health --health-interval duration Time between running the check (ms|s|m|h) --health-retries int Consecutive failures needed to report unhealthy --health-start-period duration Start period for the container to initialize before counting retries towards unstable (ms|s|m|h) --health-timeout duration Maximum time to allow one check to run (ms|s|m|h) --host-add list Add a custom host-to-IP mapping (host:ip) --host-rm list Remove a custom host-to-IP mapping (host:ip) --hostname string Container hostname --image string Service image tag --init Use an init inside each service container to forward signals and reap processes --isolation string Service container isolation mode --label-add list Add or update a service label --label-rm list Remove a label by its key --limit-cpu decimal Limit CPUs --limit-memory bytes Limit Memory --limit-pids int Limit maximum number of processes (default 0 = unlimited) --log-driver string Logging driver for service --log-opt list Logging driver options --max-concurrent uint Number of job tasks to run concurrently (default equal to --replicas) --mount-add mount Add or update a mount on a service --mount-rm list Remove a mount by its target path --network-add network Add a network --network-rm list Remove a network --no-healthcheck Disable any container-specified HEALTHCHECK --no-resolve-image Do not query the registry to resolve image digest and supported platforms --placement-pref-add pref Add a placement preference --placement-pref-rm pref Remove a placement preference --publish-add port Add or update a published port --publish-rm port Remove a published port by its target port -q, --quiet Suppress progress output --read-only Mount the container's root filesystem as read only --replicas uint Number of tasks --replicas-max-per-node uint Maximum number of tasks per node (default 0 = unlimited) --reserve-cpu decimal Reserve CPUs --reserve-memory bytes Reserve Memory --restart-condition string Restart when condition is met (\"none\"|\"on-failure\"|\"any\") --restart-delay duration Delay between restart attempts (ns|us|ms|s|m|h) --restart-max-attempts uint Maximum number of restarts before giving up --restart-window duration Window used to evaluate the restart policy (ns|us|ms|s|m|h) --rollback Rollback to previous specification --rollback-delay duration Delay between task rollbacks (ns|us|ms|s|m|h) --rollback-failure-action string Action on rollback failure (\"pause\"|\"continue\") --rollback-max-failure-ratio float Failure rate to tolerate during a rollback --rollback-monitor duration Duration after each task rollback to monitor for failure (ns|us|ms|s|m|h) --rollback-order string Rollback order (\"start-first\"|\"stop-first\") --rollback-parallelism uint Maximum number of tasks rolled back simultaneously (0 to roll back all at once) --secret-add secret Add or update a secret on a service --secret-rm list Remove a secret --stop-grace-period duration Time to wait before force killing a container (ns|us|ms|s|m|h) --stop-signal string Signal to stop the container --sysctl-add list Add or update a Sysctl option --sysctl-rm list Remove a Sysctl option -t, --tty Allocate a pseudo-TTY --ulimit-add ulimit Add or update a ulimit option (default []) --ulimit-rm list Remove a ulimit option --update-delay duration Delay between updates (ns|us|ms|s|m|h) --update-failure-action string Action on update failure (\"pause\"|\"continue\"|\"rollback\") --update-max-failure-ratio float Failure rate to tolerate during an update --update-monitor duration Duration after each task update to monitor for failure (ns|us|ms|s|m|h) --update-order string Update order (\"start-first\"|\"stop-first\") --update-parallelism uint Maximum number of tasks updated simultaneously (0 to update all at once) -u, --user string Username or UID (format: <name|uid>[:<group|gid>]) --with-registry-auth Send registry authentication details to swarm agents -w, --workdir string Working directory inside the container [root@docker1 ~]# 5.\u521b\u5efa3\u4e2a\u526f\u672c [root@docker1 ~]# docker service update --replicas 3 my-nginx my-nginx overall progress: 3 out of 3 tasks 1/3: running 2/3: running 3/3: running verify: Service converged [root@docker1 ~]# 6.\u67e5\u770b\u521b\u5efa\u7684\u526f\u672c \u521b\u5efa\u7684\u526f\u672c\u8dd1\u5728docker1\u3001docker2\u3001docker4\u4e0a\u3002 [root@docker1 ~]# docker service ps my-nginx ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS af2fbra1lyjx my-nginx.1 nginx:latest docker4 Running Running 27 minutes ago aldb5980l82x my-nginx.2 nginx:latest docker2 Running Running 3 minutes ago lx0ylq7q7l5u my-nginx.3 nginx:latest docker1 Running Running 3 minutes ago [root@docker1 ~]# docker1 [root@docker1 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 12ea2cc33770 nginx:latest \"/docker-entrypoint.\u2026\" 5 minutes ago Up 5 minutes 80/tcp my-nginx.3.lx0ylq7q7l5ugxj79xqh9seku [root@docker1 ~]# docker2 [root@docker2 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 843c3d3519a4 nginx:latest \"/docker-entrypoint.\u2026\" 6 minutes ago Up 6 minutes 80/tcp my-nginx.2.aldb5980l82xeh13ik8yax3dq [root@docker2 ~]# docker4 [root@docker4 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 4b56584f6710 nginx:latest \"/docker-entrypoint.\u2026\" 30 minutes ago Up 30 minutes 80/tcp my-nginx.1.af2fbra1lyjxxmjor5821c4av [root@docker4 ~]# docker3\u4e0a\u6ca1\u6709 [root@docker3 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES [root@docker3 ~]# 7.\u8bbf\u95ee\u6d4b\u8bd5 docker3\u6ca1\u6709\u8fd0\u884c\u5bb9\u5668\uff0c\u4f46\u5728\u96c6\u7fa4\u91cc\u9762\uff0c\u5b83\u7684IP\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95eenginx\u9879\u76ee! \u96c6\u7fa4\u4e2d\u4efb\u610f\u8282\u70b9\u90fd\u53ef\u4ee5\u8bbf\u95ee\uff0c\u670d\u52a1\u53ef\u4ee5\u6709\u591a\u4e2a\u526f\u672c\u52a8\u6001\u6269\u7f29\u5bb9\u5b9e\u73b0\u9ad8\u53ef\u7528\uff01 8.\u4e00\u6b21\u542f\u52a810\u4e2a\u526f\u672c [root@docker1 ~]# docker service update --replicas 10 my-nginx my-nginx overall progress: 10 out of 10 tasks 1/10: running 2/10: running 3/10: running 4/10: running 5/10: running 6/10: running 7/10: running 8/10: running 9/10: running 10/10: running verify: Service converged 9.\u67e5\u770b\u542f\u52a8\u7684\u526f\u672c [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS t99km76mvfkr my-nginx replicated 10/10 nginx:latest *:8888->80/tcp [root@docker1 ~]# 10.\u7f29\u5bb9\uff0c\u66f4\u65b0\u52301\u4e2a\u526f\u672c [root@docker1 ~]# docker service update --replicas 1 my-nginx my-nginx overall progress: 1 out of 1 tasks 1/1: verify: Service converged [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS t99km76mvfkr my-nginx replicated 1/1 nginx:latest *:8888->80/tcp [root@docker1 ~]# [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS t99km76mvfkr my-nginx replicated 1/1 nginx:latest *:8888->80/tcp [root@docker1 ~]# docker service ps my-nginx ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS af2fbra1lyjx my-nginx.1 nginx:latest docker4 Running Running 4 hours ago aldb5980l82x my-nginx.2 nginx:latest docker2 Shutdown Shutdown 4 hours ago lx0ylq7q7l5u my-nginx.3 nginx:latest docker1 Shutdown Shutdown 4 hours ago laaa1qqfcwzg my-nginx.4 nginx:latest docker2 Shutdown Shutdown 4 hours ago 88eb61egsn6q my-nginx.7 nginx:latest docker2 Shutdown Shutdown 4 hours ago kxli7w26dft9 my-nginx.8 nginx:latest docker1 Shutdown Shutdown 4 hours ago [root@docker1 ~]# \u5f39\u6027\u6269\u7f29\u5bb9\u3002 11.\u6269\u7f29\u5bb9\u547d\u4ee4 [root@docker1 ~]# docker service scale --help Usage: docker service scale SERVICE=REPLICAS [SERVICE=REPLICAS...] Scale one or multiple replicated services Options: -d, --detach Exit immediately instead of waiting for the service to converge [root@docker1 ~]# \u4f7f\u7528\u65b9\u6cd5\uff1a \u4e0e\u66f4\u65b0\u539f\u7406\u4e00\u81f4 [root@docker1 ~]# docker service scale my-nginx=5 my-nginx scaled to 5 overall progress: 5 out of 5 tasks 1/5: running 2/5: running 3/5: running 4/5: running 5/5: running verify: Service converged [root@docker1 ~]# \u79fb\u9664\u670d\u52a1 [root@docker1 ~]# docker service --help Usage: docker service COMMAND Manage services Commands: create Create a new service inspect Display detailed information on one or more services logs Fetch the logs of a service or task ls List services ps List the tasks of one or more services rm Remove one or more services rollback Revert changes to a service's configuration scale Scale one or multiple replicated services update Update a service Run 'docker service COMMAND --help' for more information on a command. [root@docker1 ~]# \u79fb\u9664my-nginx\u670d\u52a1 [root@docker1 ~]# docker service rm my-nginx my-nginx [root@docker1 ~]# docker service ps \"docker service ps\" requires at least 1 argument. See 'docker service ps --help'. Usage: docker service ps [OPTIONS] SERVICE [SERVICE...] List the tasks of one or more services [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS [root@docker1 ~]# Swarm\u6982\u5ff5\u5b66\u4e60 Swarm \u96c6\u7fa4\u7684\u7ba1\u7406\u548c\u7f16\u6392\u3002docker\u53ef\u4ee5\u521d\u59cb\u5316\u4e00\u4e2a\u96c6\u7fa4\uff0c\u5176\u4ed6\u8282\u70b9\u53ef\u4ee5\u4ee5\u7ba1\u7406\u8005\u6216\u5de5\u4f5c\u8005\u52a0\u5165\u96c6\u7fa4\u3002 Node \u5c31\u662f\u4e00\u4e2adocker\u8282\u70b9\u3002\u591a\u4e2a\u8282\u70b9\u5c31\u7ec4\u6210\u4e86\u4e00\u4e2a\u7f51\u7edc\u96c6\u7fa4\u3002 Service \u670d\u52a1\uff0c\u53ef\u4ee5\u5728\u7ba1\u7406\u8282\u70b9\u6216\u8005\u5de5\u4f5c\u8282\u70b9\u6765\u8fd0\u884c\uff0c\u6838\u5fc3\uff01 Task \u4efb\u52a1\uff0c\u4efb\u52a1\u662f\u96c6\u7fa4\u4e2d\u8c03\u5ea6\u7684\u539f\u5b50\u5355\u4f4d\u3002\u5f53\u60a8\u901a\u8fc7\u521b\u5efa\u6216\u66f4\u65b0\u670d\u52a1\u6765\u58f0\u660e\u6240\u9700\u7684\u670d\u52a1\u72b6\u6001\u65f6\uff0c\u534f\u8c03\u5668\u901a\u8fc7\u8c03\u5ea6\u4efb\u52a1\u6765\u5b9e\u73b0\u6240\u9700\u7684\u72b6\u6001\u3002 Docker Stack Docker-compose:\u5355\u673a\u90e8\u7f72\u9879\u76ee Docker Stack\uff1a\u96c6\u7fa4\u90e8\u7f72\u9879\u76ee #\u5355\u673a docker-compose up -d wordpress.yaml #\u96c6\u7fa4 docker stack deploy wordpres.yaml \u4f8b\uff1a version: '3' services: web: image: wordpress ports: - 8080:80 environment: WORDPRESS_DB_HOST: mysql WORDPRESS_DB_PASSWORD: root networks: - my-network depends_on: - mysql deploy: mode: replicated replicas: 3 restart_policy: condition: on-failure delay: 5s max_attempts: 3 update_config: parallelism: 1 delay: 10s mysql: image: mysql environment: MYSQL_ROOT_PASSWORD: root MYSQL_DATABASE: wordpress volumes: - mysql-data:/var/lib/mysql networks: - my-network deploy: mode: global placement: constraints: - node.role == manager volumes: mysql-data: networks: my-network: driver: overlay \u4e0d\u540c\u70b9: Docker stack\u4f1a\u5ffd\u7565\u4e86\u201c\u6784\u5efa\u201d\u6307\u4ee4\u3002 \u60a8\u65e0\u6cd5\u4f7f\u7528stack\u547d\u4ee4\u6784\u5efa\u65b0\u955c\u50cf\u3002 \u5b83\u662f\u9700\u8981\u955c\u50cf\u662f\u9884\u5148\u5df2\u7ecf\u6784\u5efa\u597d\u7684\u3002 \u6240\u4ee5docker-compose\u66f4\u9002\u5408\u4e8e\u5f00\u53d1\u573a\u666f\u3002 Docker Stack \u90e8\u7f72\u547d\u4ee4\uff1a docker stack deploy\uff1a \u7528\u4e8e\u6839\u636estack\u6587\u4ef6\u90e8\u7f72\u548c\u66f4\u65b0stack\u670d\u52a1 docker stack ls \uff1a\u5217\u51faswarm\u96c6\u7fa4\u4e2d\u6240\u6709\u7684stack docker stack ps: \u5217\u51fa\u67d0\u4e2a\u5df2\u7ecf\u90e8\u7f72\u7684stack\u7684\u76f8\u5173\u4fe1\u606f\u3002 docker stack rm\uff1a\u4eceswarm\u96c6\u7fa4\u4e2d\u79fb\u9664stack Docker Secret \u5b89\u5168\uff0c\u914d\u7f6e\u5bc6\u7801\uff0c\u8bc1\u4e66\u3002 [root@docker1 ~]# docker secret --help Usage: docker secret COMMAND Manage Docker secrets Commands: create Create a secret from a file or STDIN as content inspect Display detailed information on one or more secrets ls List secrets rm Remove one or more secrets Run 'docker secret COMMAND --help' for more information on a command. [root@docker1 ~]# Docker Config Usage: docker config COMMAND Manage Docker configs Commands: create Create a config from a file or STDIN inspect Display detailed information on one or more configs ls List configs rm Remove one or more configs Run 'docker config COMMAND --help' for more information on a command. [root@docker1 ~]# \u65b9\u6cd5\uff1a\u627e\u5168\u5957\u8bfe\u7a0b\u5b66\u4e60\u6848\u4f8b\u8fb9\u5b66\u8fb9\u7ec3\u5148\u8dd1\u8d77\u6765\u2014\u2014\u67e5\u770b\u547d\u4ee4\u5e2e\u52a9\u6587\u6863--help\u638c\u63e1\u7528\u6cd5\u2014\u2014\u5b98\u65b9\u67e5\u770b\u6587\u6863\uff0c\u5bf9\u5177\u4f53\u7684\u539f\u7406\u548c\u5de5\u4f5c\u65b9\u5f0f\u8fdb\u884c\u5b66\u4e60\u3002 \u76ee\u6807\uff1a\u4e91\u539f\u751fK8s\u3002 \u5b66\u4e60\u5185\u5bb9\uff1a GO\u8bed\u8a00 Docker\u3001K8s\u3001Etcd\u3001\u8c37\u6b4cV8\u5f15\u64ce\u90fd\u662fGO\u8bed\u8a00\u5f00\u53d1\u3002 \u6280\u672f\u5f00\u59cb\u8f6c\u5411GO\u65b9\u5411\u3002 \u5929\u751f\u7684\u5e76\u53d1\u8bed\u8a00\uff0c\u6548\u7387\u9ad8\u3002 Go \uff08\u53c8\u79f0 Golang \uff09\u662f Google \u7684 Robert Griesemer\uff0cRob Pike \u53ca Ken Thompson \u5f00\u53d1\u7684\u4e00\u79cd \u9759\u6001 \u5f3a\u7c7b\u578b \u3001 \u7f16\u8bd1\u578b\u8bed\u8a00 \u3002Go \u8bed\u8a00\u8bed\u6cd5\u4e0e C \u76f8\u8fd1\uff0c\u4f46\u529f\u80fd\u4e0a\u6709\uff1a\u5185\u5b58\u5b89\u5168\uff0c GC \uff08\u5783\u573e\u56de\u6536\uff09\uff0c \u7ed3\u6784\u5f62\u6001 \u53ca CSP-style \u5e76\u53d1\u8ba1\u7b97 \u3002 Kubernetes \u4e91\u539f\u751f\u3002","title":"Docker\u6982\u8ff0"},{"location":"Docker/#docker","text":"Docker\u662f\u4e00\u4e2a\u7528\u4e8e\u5f00\u53d1\uff0c\u53d1\u5e03\u548c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u653e\u5e73\u53f0\u3002Docker\u4f7f\u60a8\u80fd\u591f\u5c06\u5e94\u7528\u7a0b\u5e8f\u4e0e\u57fa\u7840\u67b6\u6784\u5206\u5f00\uff0c\u4ece\u800c\u53ef\u4ee5\u5feb\u901f\u4ea4\u4ed8\u8f6f\u4ef6\u3002\u501f\u52a9Docker\uff0c\u60a8\u53ef\u4ee5\u4ee5\u4e0e\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\u76f8\u540c\u7684\u65b9\u5f0f\u6765\u7ba1\u7406\u57fa\u7840\u67b6\u6784\u3002\u901a\u8fc7\u5229\u7528Docker\u7684\u65b9\u6cd5\u6765\u5feb\u901f\u4ea4\u4ed8\uff0c\u6d4b\u8bd5\u548c\u90e8\u7f72\u4ee3\u7801\uff0c\u60a8\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u7f16\u5199\u4ee3\u7801\u548c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u8fd0\u884c\u4ee3\u7801\u4e4b\u95f4\u7684\u5ef6\u8fdf\u3002","title":"Docker\u6982\u8ff0"},{"location":"Docker/#docker_1","text":"Docker\u63d0\u4f9b\u4e86\u5728\u677e\u6563\u9694\u79bb\u7684\u73af\u5883\uff08\u79f0\u4e3a\u5bb9\u5668\uff09\u4e2d\u6253\u5305\u548c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u7684\u529f\u80fd\u3002\u9694\u79bb\u548c\u5b89\u5168\u6027\u4f7f\u60a8\u53ef\u4ee5\u5728\u7ed9\u5b9a\u4e3b\u673a\u4e0a\u540c\u65f6\u8fd0\u884c\u591a\u4e2a\u5bb9\u5668\u3002\u5bb9\u5668\u662f\u8f7b\u91cf\u7ea7\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u9700\u8981\u7ba1\u7406\u7a0b\u5e8f\u7684\u989d\u5916\u8d1f\u8f7d\uff0c\u800c\u662f\u76f4\u63a5\u5728\u4e3b\u673a\u7684\u5185\u6838\u4e2d\u8fd0\u884c\u3002\u8fd9\u610f\u5473\u7740\u4e0e\u4f7f\u7528\u865a\u62df\u673a\u76f8\u6bd4\uff0c\u5728\u7ed9\u5b9a\u7684\u786c\u4ef6\u7ec4\u5408\u4e0a\u53ef\u4ee5\u8fd0\u884c\u66f4\u591a\u7684\u5bb9\u5668\u3002\u60a8\u751a\u81f3\u53ef\u4ee5\u5728\u5b9e\u9645\u4e0a\u662f\u865a\u62df\u673a\u7684\u4e3b\u673a\u4e2d\u8fd0\u884cDocker\u5bb9\u5668\uff01 Docker\u63d0\u4f9b\u4e86\u5de5\u5177\u548c\u5e73\u53f0\u6765\u7ba1\u7406\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\uff1a \u4f7f\u7528\u5bb9\u5668\u5f00\u53d1\u5e94\u7528\u7a0b\u5e8f\u53ca\u5176\u652f\u6301\u7ec4\u4ef6\u3002 \u5bb9\u5668\u6210\u4e3a\u5206\u53d1\u548c\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f\u7684\u5355\u5143\u3002 \u51c6\u5907\u5c31\u7eea\u540e\uff0c\u53ef\u4ee5\u5c06\u5e94\u7528\u7a0b\u5e8f\u4f5c\u4e3a\u5bb9\u5668\u6216\u534f\u8c03\u670d\u52a1\u90e8\u7f72\u5230\u751f\u4ea7\u73af\u5883\u4e2d\u3002\u65e0\u8bba\u60a8\u7684\u751f\u4ea7\u73af\u5883\u662f\u672c\u5730\u6570\u636e\u4e2d\u5fc3\uff0c\u4e91\u63d0\u4f9b\u5546\u8fd8\u662f\u4e24\u8005\u7684\u6df7\u5408\uff0c\u5176\u5de5\u4f5c\u539f\u7406\u90fd\u76f8\u540c\u3002","title":"Docker\u5e73\u53f0"},{"location":"Docker/#docker_2","text":"Docker Engine \u662f\u5177\u6709\u4ee5\u4e0b\u4e3b\u8981\u7ec4\u4ef6\u7684\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u5e94\u7528\u7a0b\u5e8f\uff1a \u670d\u52a1\u5668\u662f\u4e00\u79cd\u957f\u671f\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u79f0\u4e3a\u5b88\u62a4\u7a0b\u5e8f\u8fdb\u7a0b\uff08 dockerd \u547d\u4ee4\uff09\u3002 REST API\uff0c\u5b83\u6307\u5b9a\u7a0b\u5e8f\u53ef\u4ee5\u7528\u6765\u4e0e\u5b88\u62a4\u7a0b\u5e8f\u8fdb\u884c\u901a\u4fe1\u5e76\u6307\u793a\u5176\u64cd\u4f5c\u7684\u63a5\u53e3\u3002 \u547d\u4ee4\u884c\u754c\u9762\uff08CLI\uff09\u5ba2\u6237\u7aef\uff08 docker \u547d\u4ee4\uff09\u3002 CLI\u4f7f\u7528Docker REST API\u901a\u8fc7\u811a\u672c\u6216\u76f4\u63a5CLI\u547d\u4ee4\u63a7\u5236\u6216\u4e0eDocker\u5b88\u62a4\u7a0b\u5e8f\u4ea4\u4e92\u3002\u8bb8\u591a\u5176\u4ed6Docker\u5e94\u7528\u7a0b\u5e8f\u90fd\u4f7f\u7528\u57fa\u7840API\u548cCLI\u3002 \u5b88\u62a4\u7a0b\u5e8f\u521b\u5efa\u548c\u7ba1\u7406Docker \u5bf9\u8c61 \uff0c\u4f8b\u5982\u56fe\u50cf\uff0c\u5bb9\u5668\uff0c\u7f51\u7edc\u548c\u5377\u3002 \u6ce8\u610f \uff1aDocker\u5df2\u83b7\u5f97\u5f00\u6e90Apache 2.0\u8bb8\u53ef\u8bc1\u7684\u8bb8\u53ef\u3002 \u6211\u53ef\u4ee5\u5c06Docker\u7528\u4e8e\u4ec0\u4e48\uff1f \u5feb\u901f\uff0c\u4e00\u81f4\u5730\u4ea4\u4ed8\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f Docker\u901a\u8fc7\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u63d0\u4f9b\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u7684\u672c\u5730\u5bb9\u5668\u5728\u6807\u51c6\u5316\u73af\u5883\u4e2d\u5de5\u4f5c\uff0c\u4ece\u800c\u7b80\u5316\u4e86\u5f00\u53d1\u751f\u547d\u5468\u671f\u3002\u5bb9\u5668\u975e\u5e38\u9002\u5408\u6301\u7eed\u96c6\u6210\u548c\u6301\u7eed\u4ea4\u4ed8\uff08CI / CD\uff09\u5de5\u4f5c\u6d41\u7a0b\u3002 \u8bf7\u8003\u8651\u4ee5\u4e0b\u793a\u4f8b\u65b9\u6848\uff1a \u60a8\u7684\u5f00\u53d1\u4eba\u5458\u5728\u672c\u5730\u7f16\u5199\u4ee3\u7801\uff0c\u5e76\u4f7f\u7528Docker\u5bb9\u5668\u4e0e\u540c\u4e8b\u5171\u4eab\u4ed6\u4eec\u7684\u5de5\u4f5c\u3002 \u4ed6\u4eec\u4f7f\u7528Docker\u5c06\u5176\u5e94\u7528\u7a0b\u5e8f\u63a8\u9001\u5230\u6d4b\u8bd5\u73af\u5883\u4e2d\uff0c\u5e76\u6267\u884c\u81ea\u52a8\u548c\u624b\u52a8\u6d4b\u8bd5\u3002 \u5f53\u5f00\u53d1\u4eba\u5458\u53d1\u73b0\u9519\u8bef\u65f6\uff0c\u4ed6\u4eec\u53ef\u4ee5\u5728\u5f00\u53d1\u73af\u5883\u4e2d\u5bf9\u5176\u8fdb\u884c\u4fee\u590d\uff0c\u7136\u540e\u5c06\u5176\u91cd\u65b0\u90e8\u7f72\u5230\u6d4b\u8bd5\u73af\u5883\u4e2d\u4ee5\u8fdb\u884c\u6d4b\u8bd5\u548c\u9a8c\u8bc1\u3002 \u6d4b\u8bd5\u5b8c\u6210\u540e\uff0c\u5c06\u4fee\u8865\u7a0b\u5e8f\u63a8\u9001\u7ed9\u751f\u4ea7\u73af\u5883\u5c31\u50cf\u5c06\u66f4\u65b0\u7684\u6620\u50cf\u63a8\u9001\u5230\u751f\u4ea7\u73af\u5883\u4e00\u6837\u7b80\u5355\u3002 \u54cd\u5e94\u5f0f\u90e8\u7f72\u548c\u6269\u5c55 Docker\u57fa\u4e8e\u5bb9\u5668\u7684\u5e73\u53f0\u5141\u8bb8\u9ad8\u5ea6\u53ef\u79fb\u690d\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002Docker\u5bb9\u5668\u53ef\u4ee5\u5728\u5f00\u53d1\u4eba\u5458\u7684\u672c\u5730\u7b14\u8bb0\u672c\u7535\u8111\u4e0a\uff0c\u6570\u636e\u4e2d\u5fc3\u4e2d\u7684\u7269\u7406\u6216\u865a\u62df\u673a\uff0c\u4e91\u63d0\u4f9b\u5546\u6216\u6df7\u5408\u73af\u5883\u4e2d\u8fd0\u884c\u3002 Docker\u7684\u53ef\u79fb\u690d\u6027\u548c\u8f7b\u91cf\u7ea7\u7684\u7279\u6027\u8fd8\u4f7f\u60a8\u53ef\u4ee5\u8f7b\u677e\u5730\u52a8\u6001\u7ba1\u7406\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5e76\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u6307\u793a\u5b9e\u65f6\u6269\u5c55\u6216\u62c6\u9664\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u3002 \u5728\u540c\u4e00\u786c\u4ef6\u4e0a\u8fd0\u884c\u66f4\u591a\u5de5\u4f5c\u8d1f\u8f7d Docker\u8f7b\u5de7\u5feb\u901f\u3002\u5b83\u4e3a\u57fa\u4e8e\u865a\u62df\u673a\u7ba1\u7406\u7a0b\u5e8f\u7684\u865a\u62df\u673a\u63d0\u4f9b\u4e86\u53ef\u884c\u4e14\u7ecf\u6d4e\u9ad8\u6548\u7684\u66ff\u4ee3\u65b9\u6848\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u5229\u7528\u66f4\u591a\u7684\u8ba1\u7b97\u80fd\u529b\u6765\u5b9e\u73b0\u4e1a\u52a1\u76ee\u6807\u3002Docker\u975e\u5e38\u9002\u5408\u9ad8\u5bc6\u5ea6\u73af\u5883\u4ee5\u53ca\u4e2d\u5c0f\u578b\u90e8\u7f72\uff0c\u800c\u60a8\u9700\u8981\u7528\u66f4\u5c11\u7684\u8d44\u6e90\u505a\u66f4\u591a\u7684\u4e8b\u60c5\u3002","title":"Docker\u5f15\u64ce"},{"location":"Docker/#docker_3","text":"Docker\u4f7f\u7528\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u67b6\u6784\uff08C/S\uff09\u3002Docker \u5ba2\u6237\u7aef \u4e0eDocker \u5b88\u62a4\u8fdb\u7a0b \u8fdb\u884c\u5bf9\u8bdd\uff0c\u8be5 \u5b88\u62a4\u8fdb\u7a0b \u5b8c\u6210\u4e86\u6784\u5efa\uff0c\u8fd0\u884c\u548c\u5206\u53d1Docker\u5bb9\u5668\u7684\u7e41\u91cd\u5de5\u4f5c\u3002Docker\u5ba2\u6237\u7aef\u548c\u5b88\u62a4\u7a0b\u5e8f \u53ef\u4ee5 \u5728\u540c\u4e00\u7cfb\u7edf\u4e0a\u8fd0\u884c\uff0c\u6216\u8005\u60a8\u53ef\u4ee5\u5c06Docker\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u8fdc\u7a0bDocker\u5b88\u62a4\u7a0b\u5e8f\u3002Docker\u5ba2\u6237\u7aef\u548c\u5b88\u62a4\u7a0b\u5e8f\u5728UNIX\u5957\u63a5\u5b57\u6216\u7f51\u7edc\u63a5\u53e3\u4e0a\u4f7f\u7528REST API\u8fdb\u884c\u901a\u4fe1\u3002","title":"Docker\u67b6\u6784"},{"location":"Docker/#docker_4","text":"Docker\u5b88\u62a4\u7a0b\u5e8f\uff08 dockerd \uff09\u4fa6\u542cDocker API\u8bf7\u6c42\u5e76\u7ba1\u7406Docker\u5bf9\u8c61\uff0c\u4f8b\u5982\u56fe\u50cf\uff0c\u5bb9\u5668\uff0c\u7f51\u7edc\u548c\u5377\u3002\u5b88\u62a4\u7a0b\u5e8f\u8fd8\u53ef\u4ee5\u4e0e\u5176\u4ed6\u5b88\u62a4\u7a0b\u5e8f\u901a\u4fe1\u4ee5\u7ba1\u7406Docker\u670d\u52a1\u3002","title":"Docker\u5b88\u62a4\u7a0b\u5e8f"},{"location":"Docker/#docker_5","text":"Docker\u5ba2\u6237\u7aef\uff08 docker \uff09\u662f\u8bb8\u591aDocker\u7528\u6237\u4e0eDocker\u4ea4\u4e92\u7684\u4e3b\u8981\u65b9\u5f0f\u3002\u5f53\u60a8\u4f7f\u7528\u8bf8\u5982\u4e4b\u7c7b\u7684\u547d\u4ee4\u65f6 docker run \uff0c\u5ba2\u6237\u7aef\u4f1a\u5c06\u8fd9\u4e9b\u547d\u4ee4\u53d1\u9001\u5230 dockerd \uff0c\u4ee5\u6267\u884c\u8fd9\u4e9b\u547d\u4ee4\u3002\u8be5 docker \u547d\u4ee4\u4f7f\u7528Docker API\u3002Docker\u5ba2\u6237\u7aef\u53ef\u4ee5\u4e0e\u591a\u4e2a\u5b88\u62a4\u7a0b\u5e8f\u901a\u4fe1\u3002","title":"Docker\u5ba2\u6237\u7aef"},{"location":"Docker/#docker_6","text":"Docker \u6ce8\u518c\u8868 \u5b58\u50a8Docker\u6620\u50cf\u3002Docker Hub\u662f\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u4f7f\u7528\u7684\u516c\u5171\u6ce8\u518c\u8868\uff0c\u5e76\u4e14\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDocker\u5df2\u914d\u7f6e\u4e3a\u5728Docker Hub\u4e0a\u67e5\u627e\u6620\u50cf\u3002\u60a8\u751a\u81f3\u53ef\u4ee5\u8fd0\u884c\u81ea\u5df1\u7684\u79c1\u4eba\u6ce8\u518c\u8868\u3002 \u4f7f\u7528 docker pull \u6216 docker run \u547d\u4ee4\u65f6\uff0c\u6240\u9700\u7684\u56fe\u50cf\u5c06\u4ece\u914d\u7f6e\u7684\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u3002\u4f7f\u7528\u8be5 docker push \u547d\u4ee4\u65f6\uff0c\u4f1a\u5c06\u6620\u50cf\u63a8\u9001\u5230\u914d\u7f6e\u7684\u6ce8\u518c\u8868\u3002 \u5bb9\u5668\u662f\u56fe\u50cf\u7684\u53ef\u8fd0\u884c\u5b9e\u4f8b\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528Docker API\u6216CLI\u521b\u5efa\uff0c\u542f\u52a8\uff0c\u505c\u6b62\uff0c\u79fb\u52a8\u6216\u5220\u9664\u5bb9\u5668\u3002\u60a8\u53ef\u4ee5\u5c06\u5bb9\u5668\u8fde\u63a5\u5230\u4e00\u4e2a\u6216\u591a\u4e2a\u7f51\u7edc\uff0c\u5c06\u5b58\u50a8\u8fde\u63a5\u5230\u5b83\uff0c\u751a\u81f3\u6839\u636e\u5176\u5f53\u524d\u72b6\u6001\u521b\u5efa\u4e00\u4e2a\u65b0\u6620\u50cf\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bb9\u5668\u4e0e\u5176\u4ed6\u5bb9\u5668\u53ca\u5176\u4e3b\u673a\u4e4b\u95f4\u7684\u9694\u79bb\u5ea6\u76f8\u5bf9\u8f83\u9ad8\u3002\u60a8\u53ef\u4ee5\u63a7\u5236\u5bb9\u5668\u7684\u7f51\u7edc\uff0c\u5b58\u50a8\u6216\u5176\u4ed6\u57fa\u7840\u5b50\u7cfb\u7edf\u4e0e\u5176\u4ed6\u5bb9\u5668\u6216\u4e0e\u4e3b\u673a\u7684\u9694\u79bb\u7a0b\u5ea6\u3002 \u5bb9\u5668\u7531\u5176\u6620\u50cf\u4ee5\u53ca\u5728\u521b\u5efa\u6216\u542f\u52a8\u65f6\u4e3a\u5176\u63d0\u4f9b\u7684\u4efb\u4f55\u914d\u7f6e\u9009\u9879\u5b9a\u4e49\u3002\u5220\u9664\u5bb9\u5668\u540e\uff0c\u672a\u5b58\u50a8\u5728\u6c38\u4e45\u6027\u5b58\u50a8\u4e2d\u7684\u72b6\u6001\u66f4\u6539\u5c06\u6d88\u5931\u3002","title":"Docker\u6ce8\u518c\u8868"},{"location":"Docker/#_1","text":"\u5bb9\u5668\u548c\u865a\u62df\u673a\u5177\u6709\u76f8\u4f3c\u7684\u8d44\u6e90\u9694\u79bb\u548c\u5206\u914d\u4f18\u52bf\uff0c\u4f46\u529f\u80fd\u4e0d\u540c\uff0c\u56e0\u4e3a\u5bb9\u5668\u865a\u62df\u5316\u64cd\u4f5c\u7cfb\u7edf\u800c\u4e0d\u662f\u786c\u4ef6\u3002\u66f4\u65b9\u4fbf\u643a\u5e26\uff0c\u6548\u7387\u66f4\u9ad8\u3002","title":"\u6bd4\u8f83\u5bb9\u5668\u548c\u865a\u62df\u673a"},{"location":"Docker/#_2","text":"\u5bb9\u5668\u662f\u5e94\u7528\u5c42\u7684\u62bd\u8c61\uff0c\u5b83\u5c06\u4ee3\u7801\u548c\u4f9d\u8d56\u9879\u6253\u5305\u5728\u4e00\u8d77\u3002\u591a\u4e2a\u5bb9\u5668\u53ef\u4ee5\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u8fd0\u884c\uff0c\u5e76\u4e0e\u5176\u4ed6\u5bb9\u5668\u5171\u4eab\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff0c\u6bcf\u4e2a\u5bb9\u5668\u90fd\u4f5c\u4e3a\u7528\u6237\u7a7a\u95f4\u4e2d\u7684\u72ec\u7acb\u8fdb\u7a0b\u8fd0\u884c\u3002\u5bb9\u5668\u6bd4\u865a\u62df\u673a\u5360\u7528\u66f4\u5c11\u7684\u7a7a\u95f4\uff08\u5bb9\u5668\u6620\u50cf\u7684\u5927\u5c0f\u901a\u5e38\u662f\u51e0\u5341MB\uff09\uff0c\u53ef\u4ee5\u5904\u7406\u66f4\u591a\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u9700\u8981\u66f4\u5c11\u7684\u865a\u62df\u673a\u548c\u64cd\u4f5c\u7cfb\u7edf\u3002","title":"\u5bb9\u5668"},{"location":"Docker/#_3","text":"\u865a\u62df\u673a\uff08vm\uff09\u662f\u7269\u7406\u786c\u4ef6\u7684\u62bd\u8c61\uff0c\u5c06\u4e00\u53f0\u670d\u52a1\u5668\u8f6c\u6362\u6210\u591a\u53f0\u670d\u52a1\u5668\u3002hypervisor\u5141\u8bb8\u591a\u4e2avm\u5728\u4e00\u53f0\u673a\u5668\u4e0a\u8fd0\u884c\u3002\u6bcf\u4e2a\u865a\u62df\u673a\u90fd\u5305\u542b\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b8c\u6574\u526f\u672c\u3001\u5e94\u7528\u7a0b\u5e8f\u3001\u5fc5\u8981\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u5e93\u2014\u5360\u7528\u4e86\u6570\u5341GB\u7684\u7a7a\u95f4\u3002vm\u7684\u542f\u52a8\u901f\u5ea6\u4e5f\u5f88\u6162\u3002 Docker\u4e3a\u4ec0\u4e48\u6bd4VM\u5feb\uff1f 1.Docker\u6709\u7740\u6bd4\u865a\u62df\u673a\u66f4\u5c11\u7684\u62bd\u8c61\u5c42\u3002 2.Docker\u5229\u7528\u7684\u662f\u5bbf\u4e3b\u673a\u7684\u5185\u6838\uff0cVM\u9700\u8981\u5b8c\u6574Guest OS\u3002 \u65b0\u5efa\u4e00\u4e2a\u5bb9\u5668\u65f6\uff0cDocker\u4e0d\u9700\u8981\u50cf\u865a\u62df\u673a\u4e00\u6837\u91cd\u65b0\u52a0\u8f7d\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff0c\u907f\u514d\u5f15\u5bfc\u3002 \u865a\u62df\u673a\u52a0\u8f7dGuest OS\u662f\u5206\u949f\u7ea7\u522b\uff0cDocker\u5229\u7528\u5bbf\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\uff0c\u79d2\u7ea7\u3002","title":"\u865a\u62df\u673a"},{"location":"Docker/#_4","text":"Docker\u7528 Go\u7f16\u7a0b\u8bed\u8a00 \u7f16\u5199\uff0c\u5e76\u5229\u7528Linux\u5185\u6838\u7684\u591a\u4e2a\u529f\u80fd\u6765\u4ea4\u4ed8\u5176\u529f\u80fd\u3002","title":"\u5e95\u5c42\u6280\u672f"},{"location":"Docker/#_5","text":"Docker\u4f7f\u7528\u4e00\u79cd\u79f0\u4e3a namespaces \u63d0\u4f9b \u5bb9\u5668 \u7684\u9694\u79bb\u5de5\u4f5c\u533a\u7684\u6280\u672f\u3002\u8fd0\u884c\u5bb9\u5668\u65f6\uff0cDocker\u4f1a\u4e3a\u8be5\u5bb9\u5668\u521b\u5efa\u4e00\u7ec4 \u540d\u79f0\u7a7a\u95f4 \u3002 \u8fd9\u4e9b\u540d\u79f0\u7a7a\u95f4\u63d0\u4f9b\u4e86\u4e00\u5c42\u9694\u79bb\u3002\u5bb9\u5668\u7684\u6bcf\u4e2a\u65b9\u9762\u90fd\u5728\u5355\u72ec\u7684\u540d\u79f0\u7a7a\u95f4\u4e2d\u8fd0\u884c\uff0c\u5e76\u4e14\u5176\u8bbf\u95ee\u4ec5\u9650\u4e8e\u8be5\u540d\u79f0\u7a7a\u95f4\u3002 Docker Engine\u5728Linux\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u540d\u79f0\u7a7a\u95f4\uff1a \u7684 pid \u547d\u540d\u7a7a\u95f4\uff1a \u8fdb\u7a0b\u9694\u79bb\uff08PID\uff1a\u8fdb\u7a0bID\uff09\u3002 \u8be5 net \u547d\u540d\u7a7a\u95f4\uff1a \u7ba1\u7406\u7f51\u7edc\u63a5\u53e3\uff08NET\uff1a\u7f51\u7edc\uff09\u3002 \u8be5 ipc \u547d\u540d\u7a7a\u95f4\uff1a \u7ba1\u7406\u8bbf\u95eeIPC\u8d44\u6e90\uff08IPC\uff1a\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff09\u3002 \u8be5 mnt \u547d\u540d\u7a7a\u95f4\uff1a \u7ba1\u7406\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u70b9\uff08MNT\uff1a\u6469\uff09\u3002 \u8be5 uts \u547d\u540d\u7a7a\u95f4\uff1a \u9694\u79bb\u5185\u6838\u548c\u7248\u672c\u6807\u8bc6\u7b26\u3002\uff08UTS\uff1aUnix\u65f6\u95f4\u5171\u4eab\u7cfb\u7edf\uff09\u3002","title":"\u547d\u540d\u7a7a\u95f4"},{"location":"Docker/#_6","text":"Linux\u4e0a\u7684Docker\u5f15\u64ce\u8fd8\u4f9d\u8d56\u4e8e\u53e6\u4e00\u79cd\u79f0\u4e3a \u63a7\u5236\u7ec4 \uff08 cgroups \uff09\u7684\u6280\u672f\u3002cgroup\u5c06\u5e94\u7528\u7a0b\u5e8f\u9650\u5236\u4e3a\u4e00\u7ec4\u7279\u5b9a\u7684\u8d44\u6e90\u3002\u63a7\u5236\u7ec4\u5141\u8bb8Docker Engine\u5c06\u53ef\u7528\u7684\u786c\u4ef6\u8d44\u6e90\u5171\u4eab\u7ed9\u5bb9\u5668\uff0c\u5e76\u6709\u9009\u62e9\u5730\u5b9e\u65bd\u9650\u5236\u548c\u7ea6\u675f\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u9650\u5236\u7279\u5b9a\u5bb9\u5668\u53ef\u7528\u7684\u5185\u5b58\u3002","title":"\u5bf9\u7167\u7ec4"},{"location":"Docker/#_7","text":"\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u6216UnionFS\u662f\u901a\u8fc7\u521b\u5efa\u56fe\u5c42\u8fdb\u884c\u64cd\u4f5c\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f7f\u5176\u975e\u5e38\u8f7b\u4fbf\u4e14\u5feb\u901f\u3002Docker Engine\u4f7f\u7528UnionFS\u4e3a\u5bb9\u5668\u63d0\u4f9b\u6784\u5efa\u6a21\u5757\u3002Docker Engine\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2aUnionFS\u53d8\u4f53\uff0c\u5305\u62ecAUFS\uff0cbtrfs\uff0cvfs\u548cDeviceMapper\u3002","title":"\u8054\u5408\u6587\u4ef6\u7cfb\u7edf"},{"location":"Docker/#_8","text":"Docker Engine\u5c06\u540d\u79f0\u7a7a\u95f4\uff0c\u63a7\u5236\u7ec4\u548cUnionFS\u7ec4\u5408\u5230\u4e00\u4e2a\u79f0\u4e3a\u5bb9\u5668\u683c\u5f0f\u7684\u5305\u88c5\u5668\u4e2d\u3002\u9ed8\u8ba4\u5bb9\u5668\u683c\u5f0f\u4e3a libcontainer \u3002\u5c06\u6765\uff0cDocker\u53ef\u4ee5\u901a\u8fc7\u4e0eBSD Jails\u6216Solaris Zones\u7b49\u6280\u672f\u96c6\u6210\u6765\u652f\u6301\u5176\u4ed6\u5bb9\u5668\u683c\u5f0f\u3002","title":"\u5bb9\u5668\u683c\u5f0f"},{"location":"Docker/#docker_7","text":"Docker\u6587\u6863\uff1a https://docs.docker.com/get-docker/","title":"\u5b89\u88c5Docker"},{"location":"Docker/#docker_8","text":"\u5148\u51b3\u6761\u4ef6\uff1a \u64cd\u4f5c\u7cfb\u7edf\u8981\u6c42\uff1a\u8981\u5b89\u88c5Docker\u5f15\u64ce\uff0c\u9700\u8981CentOS 7\u7684\u7ef4\u62a4\u7248\u672c\u3002\u4e0d\u652f\u6301\u6216\u6d4b\u8bd5\u5b58\u6863\u7248\u672c\u3002 \u5fc5\u987b\u542f\u7528centos-extras\u5b58\u50a8\u5e93\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8be5\u5b58\u50a8\u5e93\u662f\u542f\u7528\u7684\uff0c\u4f46\u662f\u5982\u679c\u60a8\u5df2\u7ecf\u7981\u7528\u4e86\u5b83\uff0c\u5219\u9700\u8981\u91cd\u65b0\u542f\u7528\u5b83\u3002 \u5b89\u88c5gcc\u76f8\u5173\u73af\u5883 yum -y install gcc yum -y install gcc-c++","title":"\u5b89\u88c5Docker\u5f15\u64ce"},{"location":"Docker/#1","text":"yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine \u5982\u679cyum\u62a5\u544a\u6ca1\u6709\u5b89\u88c5\u8fd9\u4e9b\u5305\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002 /var/lib/docker/\u7684\u5185\u5bb9\uff0c\u5305\u62ec\u955c\u50cf\u3001\u5bb9\u5668\u3001\u5377\u548c\u7f51\u7edc\u3002Docker\u5f15\u64ce\u5305\u73b0\u5728\u79f0\u4e3aDocker -ce","title":"1.\u5378\u8f7d\u65e7\u7248\u672c"},{"location":"Docker/#2","text":"yum install -y yum-utils \u5b89\u88c5 yum-utils \u5305(\u5b83\u63d0\u4f9b yum-config-manager \u5b9e\u7528\u5de5\u5177)\u5e76\u8bbe\u7f6e\u7a33\u5b9a\u5b58\u50a8\u5e93\u3002","title":"2.\u5b89\u88c5\u57fa\u7840\u5305"},{"location":"Docker/#3","text":"\u9ed8\u8ba4\u56fd\u5916\u6e90\uff1a yum-config-manager \\ --add-repo \\ https://download.docker.com/linux/centos/docker-ce.repo \u963f\u91cc\u4e91\uff1a yum-config-manager \\ --add-repo \\ http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo","title":"3.\u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93"},{"location":"Docker/#4yum","text":"yum makecache fast","title":"4.\u66f4\u65b0yum\u8f6f\u4ef6\u5305\u7d22\u5f15"},{"location":"Docker/#5-docker","text":"yum install docker-ce docker-ce-cli containerd.io \u5b89\u88c5\u7279\u5b9a\u7248\u672c\u7684Docker\uff1a yum install docker-ce-<VERSION_STRING> docker-ce-cli-<VERSION_STRING> containerd.io","title":"5.\u5b89\u88c5 Docker\u5f15\u64ce"},{"location":"Docker/#6","text":"systemctl start docker systemctl enable docker \u5224\u65ad\u662f\u5426\u5b89\u88c5\u6210\u529f\uff1a [root@localhost ~]# docker version Client: Docker Engine - Community Version: **19.03.13** API version: 1.40 Go version: **go1.13.15** Git commit: 4484c46d9d Built: Wed Sep 16 17:03:45 2020 OS/Arch: linux/amd64 Experimental: false **Server: Docker Engine - Community** Engine: Version: 19.03.13 API version: 1.40 (minimum version 1.12) Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:02:21 2020 OS/Arch: **linux/amd64** Experimental: false containerd: Version: 1.3.7 GitCommit: 8fba4e9a7d01810a393d5d25a3621dc101981175 runc: Version: 1.0.0-rc10 GitCommit: dc9208a3303feef5b3839f4323d9beb36df0a9dd docker-init: Version: 0.18.0 GitCommit: fec3683 [root@localhost ~]#","title":"6.\u542f\u52a8\u5e76\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8"},{"location":"Docker/#7hello-world","text":"\u901a\u8fc7\u8fd0\u884c hello-world \u955c\u50cf\u6765\u9a8c\u8bc1 Docker Engine \u5b89\u88c5\u662f\u5426\u6b63\u786e\u3002 docker run hello-world [root@localhost ~]# docker run hello-world Unable to find image 'hello-world:latest' locally #\u5bfb\u627e\u955c\u50cf latest: Pulling from library/hello-world #\u4ecelibrary\u8fdc\u7a0b\u62c9\u53d6hello-world\u955c\u50cf 0e03bdcc26d7: Pull complete Digest: sha256:8c5aeeb6a5f3ba4883347d3747a7249f491766ca1caa47e5da5dfcf6b9b717c0 Status: Downloaded newer image for hello-world:latest Hello from Docker! #Docker\u5b89\u88c5\u6210\u529f This message shows that your installation appears to be working correctly. To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub. (amd64) 3. The Docker daemon created a new container from that image which runs the executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it to your terminal. To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bash Share images, automate workflows, and more with a free Docker ID: https://hub.docker.com/ For more examples and ideas, visit: https://docs.docker.com/get-started/","title":"7.\u6d4b\u8bd5hello-world"},{"location":"Docker/#8hello-world","text":"[root@localhost ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE hello-world latest bf756fb1ae65 9 months ago 13.3kB [root@localhost ~]#","title":"8.\u67e5\u770bhello-world\u955c\u50cf"},{"location":"Docker/#9-docker","text":"\u5378\u8f7d Docker Engine\u3001 CLI \u548c Containerd \u8f6f\u4ef6\u5305: yum remove docker-ce docker-ce-cli containerd.io \u4e0d\u4f1a\u81ea\u52a8\u5220\u9664\u4e3b\u673a\u4e0a\u7684\u6620\u50cf\u3001\u5bb9\u5668\u3001\u5377\u6216\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u3002\u60a8\u5fc5\u987b\u624b\u52a8\u5220\u9664\u4efb\u4f55\u5df2\u7f16\u8f91\u7684\u914d\u7f6e\u6587\u4ef6\u3002\u5220\u9664\u6240\u6709\u955c\u50cf\uff0c\u5bb9\u5668\u548c\u5377: rm -rf /var/lib/docker","title":"9.\u5378\u8f7d Docker \u5f15\u64ce"},{"location":"Docker/#_9","text":"","title":"\u914d\u7f6e\u963f\u91cc\u4e91\u955c\u50cf\u52a0\u901f"},{"location":"Docker/#1_1","text":"","title":"1.\u627e\u5230\u955c\u50cf\u52a0\u901f\u5668"},{"location":"Docker/#2_1","text":"\u9488\u5bf9Docker\u5ba2\u6237\u7aef\u7248\u672c\u5927\u4e8e 1.10.0 \u7684\u7528\u6237 \u60a8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539daemon\u914d\u7f6e\u6587\u4ef6/etc/docker/daemon.json\u6765\u4f7f\u7528\u52a0\u901f\u5668 sudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json <<-'EOF' { \"registry-mirrors\": [\"https://gnxq79wc.mirror.aliyuncs.com\"] } EOF sudo systemctl daemon-reload sudo systemctl restart docker","title":"2.\u914d\u7f6e\u955c\u50cf\u52a0\u901f\u5668"},{"location":"Docker/#hello-worlddocker","text":"","title":"\u56de\u987ehello-world\u4e86\u89e3Docker\u8fd0\u884c\u539f\u7406"},{"location":"Docker/#_10","text":"","title":"\u5e95\u5c42\u539f\u7406"},{"location":"Docker/#1docker","text":"Docker\u662f\u4e00\u4e2aClient-Server\u7ed3\u6784\u7684\u7cfb\u7edf\uff0cDocker\u7684\u5b88\u62a4\u8fdb\u7a0b\u8fd0\u884c\u5728\u670d\u52a1\u5668\u4e0a\u3002\u901a\u8fc7Socket\u5ba2\u6237\u7aef\u8bbf\u95ee\uff01","title":"1.Docker\u662f\u600e\u4e48\u5de5\u4f5c\u7684\uff1f"},{"location":"Docker/#docker_9","text":"","title":"Docker\u547d\u4ee4"},{"location":"Docker/#_11","text":"","title":"\u5e2e\u52a9\u547d\u4ee4"},{"location":"Docker/#docker-version","text":"","title":"docker version"},{"location":"Docker/#docker_10","text":"[root@localhost ~]# docker version Client: Docker Engine - Community Version: 19.03.13 API version: 1.40 Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:03:45 2020 OS/Arch: linux/amd64 Experimental: false Server: Docker Engine - Community Engine: Version: 19.03.13 API version: 1.40 (minimum version 1.12) Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:02:21 2020 OS/Arch: linux/amd64 Experimental: false containerd: Version: 1.3.7 GitCommit: 8fba4e9a7d01810a393d5d25a3621dc101981175 runc: Version: 1.0.0-rc10 GitCommit: dc9208a3303feef5b3839f4323d9beb36df0a9dd docker-init: Version: 0.18.0 GitCommit: fec3683 [root@localhost ~]#","title":"\u663e\u793aDocker\u7248\u672c\u4fe1\u606f"},{"location":"Docker/#docker-info","text":"","title":"docker info"},{"location":"Docker/#docker_11","text":"[root@localhost ~]# docker info Client: Debug Mode: false Server: Containers: 1 Running: 0 Paused: 0 Stopped: 1 Images: 1 Server Version: 19.03.13 Storage Driver: overlay2 Backing Filesystem: xfs Supports d_type: true Native Overlay Diff: true Logging Driver: json-file Cgroup Driver: cgroupfs Plugins: Volume: local Network: bridge host ipvlan macvlan null overlay Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog Swarm: inactive Runtimes: runc Default Runtime: runc Init Binary: docker-init containerd version: 8fba4e9a7d01810a393d5d25a3621dc101981175 runc version: dc9208a3303feef5b3839f4323d9beb36df0a9dd init version: fec3683 Security Options: seccomp Profile: default Kernel Version: 3.10.0-1127.19.1.el7.x86_64 Operating System: CentOS Linux 7 (Core) OSType: linux Architecture: x86_64 CPUs: 1 Total Memory: 1.777GiB Name: localhost.localdomain ID: 4ARA:NX4Y:7DM7:IGVR:XQNU:PNSQ:SDFN:44U2:VINY:2OMR:VDKO:2SKU Docker Root Dir: /var/lib/docker Debug Mode: false Registry: https://index.docker.io/v1/ Labels: Experimental: false Insecure Registries: 127.0.0.0/8 Registry Mirrors: https://gnxq79wc.mirror.aliyuncs.com/ Live Restore Enabled: false [root@localhost ~]#","title":"\u663e\u793adocker\u7684\u7cfb\u7edf\u4fe1\u606f\uff0c\u5305\u62ec\u955c\u50cf\u548c\u5bb9\u5668\u7684\u6570\u91cf\u3002"},{"location":"Docker/#docker-help","text":"","title":"docker \u547d\u4ee4 --help"},{"location":"Docker/#_12","text":"https://docs.docker.com/ \u547d\u4ee4\uff1ahttps://docs.docker.com/engine/reference/commandline/","title":"\u5e2e\u52a9\u547d\u4ee4"},{"location":"Docker/#_13","text":"","title":"\u955c\u50cf\u547d\u4ee4"},{"location":"Docker/#docker-images","text":"\u67e5\u770b\u6240\u6709\u672c\u5730\u4e3b\u673a\u4e0a\u7684\u955c\u50cf [root@localhost ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE hello-world latest bf756fb1ae65 10 months ago 13.3kB #\u89e3\u91ca REPOSITORY \u955c\u50cf\u4ed3\u5e93\u6e90 TAG \u955c\u50cf\u7684\u6807\u7b7e IMAGE ID \u955c\u50cf\u7684ID CREATED \u955c\u50cf\u7684\u521b\u5efa\u65f6\u95f4 SIZE \u955c\u50cf\u7684\u5927\u5c0f","title":"docker images"},{"location":"Docker/#options","text":"[root@localhost ~]# docker images --help Usage: docker images [OPTIONS] [REPOSITORY[:TAG]] List images Options: -a, --all Show all images (default hides intermediate images) --digests Show digests #\u683c\u5f0f\u5316 -f, --filter filter Filter output based on conditions provided #\u8fc7\u6ee4 --format string Pretty-print images using a Go template --no-trunc Don't truncate output -q, --quiet Only show numeric IDs","title":"Options\u9009\u9879"},{"location":"Docker/#_14","text":"-a \u5217\u51fa\u6240\u6709\u955c\u50cf -q \u53ea\u663e\u793a\u955c\u50cf\u7684ID [root@localhost ~]# docker images -a REPOSITORY TAG IMAGE ID CREATED SIZE hello-world latest bf756fb1ae65 10 months ago 13.3kB [root@localhost ~]# docker images -aq bf756fb1ae65 [root@localhost ~]#","title":"\u89e3\u91ca"},{"location":"Docker/#_15","text":"","title":"\u641c\u7d22\u547d\u4ee4"},{"location":"Docker/#_16","text":"https://hub.docker.com/","title":"\u7f51\u9875\u641c\u7d22"},{"location":"Docker/#docker-search","text":"docker search --help [root@localhost ~]# docker search --help Usage: docker search [OPTIONS] TERM Search the Docker Hub for images Options: -f, --filter filter Filter output based on conditions provided --format string Pretty-print search using a Go template --limit int Max number of search results (default 25) --no-trunc Don't truncate output [root@localhost ~]# \u4f8b\u5982\uff1a --filter=STARS=3000 #\u8fc7\u6ee4\u51fa\u955c\u50cf\u6536\u85cf\u5927\u4e8e3000\u7684 [root@localhost ~]# docker search mysql --filter=STARS=3000 NAME DESCRIPTION STARS OFFICIAL AUTOMATED mysql MySQL is a widely used, open-source relation\u2026 10115 [OK] mariadb MariaDB is a community-developed fork of MyS\u2026 3715 [OK] [root@localhost ~]#","title":"docker search"},{"location":"Docker/#_17","text":"","title":"\u4e0b\u8f7d\u547d\u4ee4"},{"location":"Docker/#docker-pull","text":"[root@localhost ~]# docker pull --help Usage: docker pull [OPTIONS] NAME[:TAG|@DIGEST] Pull an image or a repository from a registry Options: -a, --all-tags Download all tagged images in the repository --disable-content-trust Skip image verification (default true) --platform string Set platform if server is multi-platform capable -q, --quiet Suppress verbose output [root@localhost ~]# [root@localhost ~]# docker pull mysql Using default tag: latest #\u5982\u679c\u4e0d\u5199tag:\uff0c\u9ed8\u8ba4\u4e0b\u8f7d\u6700\u65b0\u7684\u7248\u672c latest: Pulling from library/mysql bb79b6b2107f: Pull complete #\u5206\u5c42\u4e0b\u8f7d\uff0cdocker image\u7684\u6838\u5fc3\uff1a\u8054\u5408\u6587\u4ef6\u7cfb\u7edf 49e22f6fb9f7: Pull complete 842b1255668c: Pull complete 9f48d1f43000: Pull complete c693f0615bce: Pull complete 8a621b9dbed2: Pull complete 0807d32aef13: Pull complete a56aca0feb17: Pull complete de9d45fd0f07: Pull complete 1d68a49161cc: Pull complete d16d318b774e: Pull complete 49e112c55976: Pull complete Digest: sha256:8c17271df53ee3b843d6e16d46cff13f22c9c04d6982eb15a9a47bd5c9ac7e2d #\u7b7e\u540d Status: Downloaded newer image for mysql:latest docker.io/library/mysql:latest #\u771f\u5b9e\u5730\u5740 [root@localhost ~] docker pull mysql=docker pull docker.io/library/mysql:latest #\u7b49\u4ef7","title":"docker pull"},{"location":"Docker/#_18","text":"docker pull \u955c\u50cf\u540d:tag \u6ce8\uff1a\u6307\u5b9a\u4e0b\u8f7d\u7684\u7248\u672c\u5fc5\u987b\u662f\u5b58\u5728\u7684\u3002 \u8054\u5408\u6587\u4ef6\u7cfb\u7edf\uff0c\u516c\u7528\u6587\u4ef6\u4e0d\u5728\u4e0b\u8f7d\u6781\u5927\u51cf\u5c11\u5360\u7528\u5b58\u50a8 \u6bd4\u8f83\uff1a [root@localhost ~]# docker pull mysql Using default tag: latest latest: Pulling from library/mysql bb79b6b2107f: Pull complete 49e22f6fb9f7: Pull complete 842b1255668c: Pull complete 9f48d1f43000: Pull complete c693f0615bce: Pull complete 8a621b9dbed2: Pull complete 0807d32aef13: Pull complete a56aca0feb17: Pull complete de9d45fd0f07: Pull complete 1d68a49161cc: Pull complete d16d318b774e: Pull complete 49e112c55976: Pull complete Digest: sha256:8c17271df53ee3b843d6e16d46cff13f22c9c04d6982eb15a9a47bd5c9ac7e2d Status: Downloaded newer image for mysql:latest docker.io/library/mysql:latest [root@localhost ~]# docker pull mysql:5.7 5.7: Pulling from library/mysql bb79b6b2107f: Already exists 49e22f6fb9f7: Already exists 842b1255668c: Already exists 9f48d1f43000: Already exists c693f0615bce: Already exists 8a621b9dbed2: Already exists 0807d32aef13: Already exists f15d42f48bd9: Pull complete 098ceecc0c8d: Pull complete b6fead9737bc: Pull complete 351d223d3d76: Pull complete Digest: sha256:4d2b34e99c14edb99cdd95ddad4d9aa7ea3f2c4405ff0c3509a29dc40bcb10ef Status: Downloaded newer image for mysql:5.7 docker.io/library/mysql:5.7 [root@localhost ~]# \u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf","title":"\u6307\u5b9a\u4e0b\u8f7d\u7248\u672c"},{"location":"Docker/#_19","text":"","title":"\u5220\u9664\u955c\u50cf\u547d\u4ee4"},{"location":"Docker/#docker-rmi-f-id","text":"docker rmi -f id1 id2 id3 #\u5220\u9664\u591a\u4e2a\u6307\u5b9a\u7684\u5bb9\u5668\u955c\u50cf \u901a\u8fc7ID\u5220\u9664\u955c\u50cf/\u901a\u8fc7TAG\u5220\u9664\u955c\u50cf \u518d\u6b21\u67e5\u770b\uff0cmysql 5.7\u5df2\u88ab\u5220\u9664\uff0c\u53ea\u5220\u9664\u4e86\u90e8\u5206\u5c42\u3002","title":"docker rmi -f id"},{"location":"Docker/#_20","text":"docker rmi -f $(docker images -aq)","title":"\u5220\u9664\u5168\u90e8\u5bb9\u5668\u955c\u50cf"},{"location":"Docker/#_21","text":"\u6709\u4e86\u955c\u50cf\u624d\u53ef\u4ee5\u521b\u5efa\u5bb9\u5668\uff0c\u4e0b\u8f7d\u4e00\u4e2acentos\u955c\u50cf\u6765\u6d4b\u8bd5\u5b66\u4e60","title":"\u5bb9\u5668\u547d\u4ee4"},{"location":"Docker/#_22","text":"docker pull centos","title":"\u4e0b\u8f7d\u955c\u50cf"},{"location":"Docker/#_23","text":"docker run [\u53ef\u9009\u53c2\u6570] image","title":"\u65b0\u5efa\u5bb9\u5668\u5e76\u542f\u52a8"},{"location":"Docker/#_24","text":"--name='Name' \u5bb9\u5668\u540d\u5b57\uff0c\u7528\u6765\u533a\u5206\u5bb9\u5668 -d \u540e\u53f0\u65b9\u5f0f\u8fd0\u884c -it \u4f7f\u7528\u4ea4\u4e92\u65b9\u5f0f\u8fd0\u884c\uff0c\u8fdb\u5165\u5bb9\u5668\u67e5\u770b\u5185\u5bb9 -p \u6307\u5b9a\u5bb9\u5668\u7684\u7aef\u53e3 -p 8080:8080 \u200b -p \u4e3b\u673a\u7aef\u53e3\u6620\u5c04\uff1a\u5bb9\u5668\u7aef\u53e3\uff08\u5e38\u7528\uff09 \u200b -p \u76f4\u63a5\u5bb9\u5668\u7aef\u53e3 -P \u968f\u673a\u6307\u5b9a\u7aef\u53e3\uff08\u5927\u5199\uff09 \u67e5\u770bdocker run\u5e2e\u52a9\u547d\u4ee4 docker run --help \u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf docker images \u6d4b\u8bd5\u542f\u52a8\u5e76\u8fdb\u5165\u5bb9\u5668 docker run -it centos /bin/bash #\u4e3b\u673a\u540d\u79f0\u53d8\u66f4 cd / ls \u67e5\u770b\u5bb9\u5668\u5185\u7684centos \u4ece\u5bb9\u5668\u4e2d\u9000\u56de\u4e3b\u673a exit #\u76f4\u63a5\u505c\u6b62\u5e76\u9000\u51fa","title":"\u53c2\u6570\u8bf4\u660e"},{"location":"Docker/#_25","text":"docker ps \u5217\u51fa\u6240\u6709\u8fd0\u884c\u8fc7\u7684\u5bb9\u5668 docker ps -a \u663e\u793a\u6700\u8fd1\u521b\u5efa\u7684\u5bb9\u5668 docker ps -a -n=1 \u663e\u793a\u6240\u6709\u8fd0\u884c\u5bb9\u5668\u7684\u7f16\u53f7 docker ps -aq","title":"\u5217\u51fa\u8fd0\u884c\u6b63\u5728\u7684\u5bb9\u5668"},{"location":"Docker/#_26","text":"exit \u76f4\u63a5\u505c\u6b62\u5e76\u9000\u51fa Ctrl+P+Q \u5bb9\u5668\u4e0d\u505c\u6b62\u9000\u51fa","title":"\u9000\u51fa\u5bb9\u5668"},{"location":"Docker/#_27","text":"docker rm ID #\u5220\u9664\u6307\u5b9a\u7684\u5bb9\u5668\u955c\u50cf\uff0c\u4e0d\u80fd\u5220\u9664\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u955c\u50cf docker rm -f $(docker ps -aq) #\u5220\u9664\u6240\u6709\u7684\u5bb9\u5668\u955c\u50cf docker ps -a -q|xargs docker rm -f #\u5220\u9664\u6240\u6709\u7684\u5bb9\u5668\u955c\u50cf centos8\u62a5\u9519","title":"\u5220\u9664\u5bb9\u5668\u955c\u50cf"},{"location":"Docker/#_28","text":"\u542f\u52a8 docker start ID \u91cd\u542f docker restart ID \u505c\u6b62\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u5bb9\u5668 docker stop ID \u5f3a\u5236\u505c\u6b62\u5f53\u524d\u8fd0\u884c\u5bb9\u5668 docker kill ID","title":"\u542f\u52a8\u505c\u6b62\u5bb9\u5668"},{"location":"Docker/#_29","text":"docker run -d \u955c\u50cf\u540d \u95ee\u9898\uff1a 1.Docker\u5bb9\u5668\u4f7f\u7528\u540e\u53f0\u8fd0\u884c\uff0c\u5c31\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u524d\u53f0\u8fdb\u7a0b\uff0cDocker\u53d1\u73b0\u6ca1\u6709\u524d\u53f0\u5e94\u7528\uff0c\u5c31\u4f1a\u81ea\u52a8\u505c\u6b62 2.\u4f8b\uff1anginx,\u5bb9\u5668\u542f\u52a8\u540e\uff0c\u53d1\u73b0\u81ea\u5df1\u6ca1\u6709\u63d0\u4f9b\u670d\u52a1\uff0c\u5c31\u4f1a\u7acb\u523b\u505c\u6b62\uff0c\u5c31\u662f\u6ca1\u6709\u7a0b\u5e8f\u4e86","title":"\u540e\u53f0\u542f\u52a8"},{"location":"Docker/#_30","text":"docker logs \u67e5\u770b\u5e2e\u52a9\u547d\u4ee4 docker logs --help \u9996\u5148\u542f\u52a8\u5bb9\u5668\u955c\u50cf docker run -it centos /bin/bash \u5199\u4e00\u70b9\u811a\u672c docker run -d centos /bin/sh -c \"while true;do echo test;sleep 1;done\" \u67e5\u770b\u65e5\u5fd7 docker logs -tf ID \u67e5\u770b\u5177\u4f53\u884c\u7684\u65e5\u5fd7 docker logs -tf --tail N ID","title":"\u67e5\u770b\u65e5\u5fd7"},{"location":"Docker/#_31","text":"","title":"\u8fdb\u7a0b\u4fe1\u606f"},{"location":"Docker/#docker-top-id","text":"docker top ID","title":"docker top ID"},{"location":"Docker/#_32","text":"docker inspect ID \u5e2e\u52a9\u547d\u4ee4 Args:\u4f20\u9012\u7684\u53c2\u6570 pid:\u8fdb\u7a0b Mounts:\u6302\u8f7d\u4fe1\u606f Env:\u73af\u5883\u53d8\u91cf [root@localhost ~]# docker inspect 072d6fb47015 [ { \"Id\": \"072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056\", \"Created\": \"2020-11-02T04:44:44.123849543Z\", \"Path\": \"/bin/bash\", \"Args\": [], \"State\": { \"Status\": \"running\", \"Running\": true, \"Paused\": false, \"Restarting\": false, \"OOMKilled\": false, \"Dead\": false, \"Pid\": 2448, \"ExitCode\": 0, \"Error\": \"\", \"StartedAt\": \"2020-11-02T04:44:44.305600406Z\", \"FinishedAt\": \"0001-01-01T00:00:00Z\" }, \"Image\": \"sha256:0d120b6ccaa8c5e149176798b3501d4dd1885f961922497cd0abef155c869566\", \"ResolvConfPath\": \"/var/lib/docker/containers/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056/resolv.conf\", \"HostnamePath\": \"/var/lib/docker/containers/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056/hostname\", \"HostsPath\": \"/var/lib/docker/containers/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056/hosts\", \"LogPath\": \"/var/lib/docker/containers/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056/072d6fb47015c713a12a27f9dd9b52d140260fadc320c50415656f1547d3b056-json.log\", \"Name\": \"/wonderful_carson\", \"RestartCount\": 0, \"Driver\": \"overlay2\", \"Platform\": \"linux\", \"MountLabel\": \"\", \"ProcessLabel\": \"\", \"AppArmorProfile\": \"\", \"ExecIDs\": null, \"HostConfig\": { \"Binds\": null, \"ContainerIDFile\": \"\", \"LogConfig\": { \"Type\": \"json-file\", \"Config\": {} }, \"NetworkMode\": \"default\", \"PortBindings\": {}, \"RestartPolicy\": { \"Name\": \"no\", \"MaximumRetryCount\": 0 }, \"AutoRemove\": false, \"VolumeDriver\": \"\", \"VolumesFrom\": null, \"CapAdd\": null, \"CapDrop\": null, \"Capabilities\": null, \"Dns\": [], \"DnsOptions\": [], \"DnsSearch\": [], \"ExtraHosts\": null, \"GroupAdd\": null, \"IpcMode\": \"private\", \"Cgroup\": \"\", \"Links\": null, \"OomScoreAdj\": 0, \"PidMode\": \"\", \"Privileged\": false, \"PublishAllPorts\": false, \"ReadonlyRootfs\": false, \"SecurityOpt\": null, \"UTSMode\": \"\", \"UsernsMode\": \"\", \"ShmSize\": 67108864, \"Runtime\": \"runc\", \"ConsoleSize\": [ 0, 0 ], \"Isolation\": \"\", \"CpuShares\": 0, \"Memory\": 0, \"NanoCpus\": 0, \"CgroupParent\": \"\", \"BlkioWeight\": 0, \"BlkioWeightDevice\": [], \"BlkioDeviceReadBps\": null, \"BlkioDeviceWriteBps\": null, \"BlkioDeviceReadIOps\": null, \"BlkioDeviceWriteIOps\": null, \"CpuPeriod\": 0, \"CpuQuota\": 0, \"CpuRealtimePeriod\": 0, \"CpuRealtimeRuntime\": 0, \"CpusetCpus\": \"\", \"CpusetMems\": \"\", \"Devices\": [], \"DeviceCgroupRules\": null, \"DeviceRequests\": null, \"KernelMemory\": 0, \"KernelMemoryTCP\": 0, \"MemoryReservation\": 0, \"MemorySwap\": 0, \"MemorySwappiness\": null, \"OomKillDisable\": false, \"PidsLimit\": null, \"Ulimits\": null, \"CpuCount\": 0, \"CpuPercent\": 0, \"IOMaximumIOps\": 0, \"IOMaximumBandwidth\": 0, \"MaskedPaths\": [ \"/proc/asound\", \"/proc/acpi\", \"/proc/kcore\", \"/proc/keys\", \"/proc/latency_stats\", \"/proc/timer_list\", \"/proc/timer_stats\", \"/proc/sched_debug\", \"/proc/scsi\", \"/sys/firmware\" ], \"ReadonlyPaths\": [ \"/proc/bus\", \"/proc/fs\", \"/proc/irq\", \"/proc/sys\", \"/proc/sysrq-trigger\" ] }, \"GraphDriver\": { \"Data\": { \"LowerDir\": \"/var/lib/docker/overlay2/31c0a7dadc6ab0aac8610ef1cbc6453a7deb07b7e4041eb13d0fde9ffcc1fca2-init/diff:/var/lib/docker/overlay2/a3eea815ce2e49aeb13672555a2278994bc4d4510b0e7d8418f5966573d90b7b/diff\", \"MergedDir\": \"/var/lib/docker/overlay2/31c0a7dadc6ab0aac8610ef1cbc6453a7deb07b7e4041eb13d0fde9ffcc1fca2/merged\", \"UpperDir\": \"/var/lib/docker/overlay2/31c0a7dadc6ab0aac8610ef1cbc6453a7deb07b7e4041eb13d0fde9ffcc1fca2/diff\", \"WorkDir\": \"/var/lib/docker/overlay2/31c0a7dadc6ab0aac8610ef1cbc6453a7deb07b7e4041eb13d0fde9ffcc1fca2/work\" }, \"Name\": \"overlay2\" }, \"Mounts\": [], \"Config\": { \"Hostname\": \"072d6fb47015\", \"Domainname\": \"\", \"User\": \"\", \"AttachStdin\": true, \"AttachStdout\": true, \"AttachStderr\": true, \"Tty\": true, \"OpenStdin\": true, \"StdinOnce\": true, \"Env\": [ \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" ], \"Cmd\": [ \"/bin/bash\" ], \"Image\": \"centos\", \"Volumes\": null, \"WorkingDir\": \"\", \"Entrypoint\": null, \"OnBuild\": null, \"Labels\": { \"org.label-schema.build-date\": \"20200809\", \"org.label-schema.license\": \"GPLv2\", \"org.label-schema.name\": \"CentOS Base Image\", \"org.label-schema.schema-version\": \"1.0\", \"org.label-schema.vendor\": \"CentOS\" } }, \"NetworkSettings\": { \"Bridge\": \"\", \"SandboxID\": \"8b6a572d50123d07c047632ddc336df8a9f717e485a09e5b469d572a435514ce\", \"HairpinMode\": false, \"LinkLocalIPv6Address\": \"\", \"LinkLocalIPv6PrefixLen\": 0, \"Ports\": {}, \"SandboxKey\": \"/var/run/docker/netns/8b6a572d5012\", \"SecondaryIPAddresses\": null, \"SecondaryIPv6Addresses\": null, \"EndpointID\": \"c75a2ed0b7f7a7de7315f9c0ce8d1a77324949ae192f5ca4d8a0040ec1581738\", \"Gateway\": \"172.17.0.1\", \"GlobalIPv6Address\": \"\", \"GlobalIPv6PrefixLen\": 0, \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"\", \"MacAddress\": \"02:42:ac:11:00:02\", \"Networks\": { \"bridge\": { \"IPAMConfig\": null, \"Links\": null, \"Aliases\": null, \"NetworkID\": \"697346d198aa6d39088da36bf3aa32eee7ef70ae170fa52118cb7ed8cc8993f6\", \"EndpointID\": \"c75a2ed0b7f7a7de7315f9c0ce8d1a77324949ae192f5ca4d8a0040ec1581738\", \"Gateway\": \"172.17.0.1\", \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"\", \"GlobalIPv6Address\": \"\", \"GlobalIPv6PrefixLen\": 0, \"MacAddress\": \"02:42:ac:11:00:02\", \"DriverOpts\": null } } } } ] [root@localhost ~]#","title":"\u5bb9\u5668\u4fe1\u606f"},{"location":"Docker/#_33","text":"\u901a\u5e38\u5bb9\u5668\u90fd\u662f\u4f7f\u7528\u540e\u53f0\u65b9\u5f0f\u8fd0\u884c\uff0c\u9700\u8981\u8fdb\u5165\u5bb9\u5668\uff0c\u4fee\u6539\u4e00\u4e9b\u914d\u7f6e","title":"\u8fdb\u5165\u8fd0\u884c\u5bb9\u5668"},{"location":"Docker/#docker-exec","text":"docker exec -it \u5bb9\u5668ID bashshell \u6d4b\u8bd5 [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 072d6fb47015 centos \"/bin/bash\" 6 hours ago Up 6 hours wonderful_carson [root@localhost ~]# docker exec -it 072d6fb47015 /bin/bash [root@072d6fb47015 /]# ls bin etc lib lost+found mnt proc run srv tmp var dev home lib64 media opt root sbin sys usr [root@072d6fb47015 /]# ps -ef UID PID PPID C STIME TTY TIME CMD root 1 0 0 05:52 pts/0 00:00:00 /bin/bash root 16 0 0 10:25 pts/1 00:00:00 /bin/bash root 30 16 0 10:26 pts/1 00:00:00 ps -ef [root@072d6fb47015 /]#","title":"docker exec"},{"location":"Docker/#docker-attach","text":"docker attach \u5bb9\u5668ID \u6bd4\u8f83: docker exec \u8fdb\u5165\u5bb9\u5668\u540e\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff0c\u53ef\u4ee5\u5728\u91cc\u9762\u64cd\u4f5c\uff08\u5e38\u7528\uff09 docker attach \u8fdb\u5165\u5bb9\u5668\u6b63\u5728\u6267\u884c\u7684\u7ec8\u7aef\uff0c\u4e0d\u4f1a\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b\uff01","title":"docker attach"},{"location":"Docker/#_34","text":"","title":"\u4ece\u5bb9\u5668\u5185\u62f7\u8d1d\u6587\u4ef6\u5230\u4e3b\u673a"},{"location":"Docker/#docker-cp","text":"docker cp \u5bb9\u5668ID:\u5bb9\u5668\u5185\u8def\u5f84 \u4e3b\u673a\u8def\u5f84 [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 072d6fb47015 centos \"/bin/bash\" 6 hours ago Up 6 hours wonderful_carson #\u8fdb\u5165docker\u5bb9\u5668\u5185\u90e8 [root@localhost ~]# docker attach 072d6fb47015 [root@072d6fb47015 /]# cd /home/ [root@072d6fb47015 home]# ls #\u5728\u5bb9\u5668\u5185\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6 [root@072d6fb47015 home]# touch test.txt [root@072d6fb47015 home]# ls test.txt #\u9000\u51fa\u5bb9\u5668\u8fdb\u884c\u62f7\u8d1d\u6d4b\u8bd5\uff0c\u9000\u51fa\u4e0d\u5f71\u54cd\u6587\u4ef6\u7684\u62f7\u8d1d [root@072d6fb47015 home]# exit exit #\u5c06\u6587\u4ef6\u62f7\u8d1d\u5230\u4e3b\u673a\u4e0a [root@localhost ~]# docker cp 072d6fb47015:/home/test.txt /home/ [root@localhost ~]# cd /home/ [root@localhost home]# ls test.txt [root@localhost home]# \u5c0f\u7ed3 attach Attach to a running container #\u5f53\u524dshe 11 \u4e0battach\u8fde\u63a5\u6307\u5b9a\u8fd0\u884c\u955c\u50cf build Bui1dan image from a Docker file #\u901a\u8fc7Docker file\u5b9a\u5236\u955c\u50cf commit Create a new image from a container changes #\u63d0\u4ea4\u5f53\u524d\u5bb9\u5668\u4e3a\u65b0\u7684\u955c\u50cf cp Copyfiles/fo1ders from the containers filesystem to the host path #\u4ece\u5bb9\u5668\u4e2d\u62f7\u8d1d\u6307\u5b9a\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u5230\u5bbf\u4e3b\u673a\u4e2d create Create a new container #\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5bb9\u5668\uff0c \u540crun\uff0c \u4f46\u4e0d\u542f\u52a8\u5bb9\u5668 diff Inspect changes on a container's filesystem #\u67e5\u770bdocker\u5bb9\u5668\u53d8\u5316 events Get real time events from the server #\u4ecedocker\u670d\u52a1\u83b7\u53d6\u5bb9\u5668\u5b9e\u65f6\u4e8b\u4ef6 exec Run a command in an existing container #\u5728\u5df2\u5b58\u5728\u7684\u5bb9\u5668\u4e0a\u8fd0\u884c\u547d\u4ee4 export Stream the contents of a container as at ar archive #\u5bfc\u51fa\u5bb9\u5668\u7684\u5185\u5bb9\u6d41\u4f5c\u4e3a\u4e00\u4e2atar\u5f52\u6863\u6587\u4ef6[\u5bf9\u5e94 import] history show the history of an image #\u5c55\u793a\u4e00\u4e2a\u955c\u50cf\u5f62\u6210\u5386\u53f2 images List images #\u5217\u51fa\u7cfb\u7edf\u5f53\u524d\u955c\u50cf import create a new filesystem image from the contents of at arba 11 #\u4ecetar\u5305\u4e2d\u7684\u5185\u5bb9\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u7cfb \u7edf\u6620\u50cf[\u5bf9\u5e94export] info Display system-wide information #\u663e\u793a\u7cfb\u7edf\u76f8\u5173\u4fe1\u606f inspect Return 1ow-1eve 1 information on a container #\u67e5\u770b\u5bb9\u5668\u8be6\u7ec6\u4fe1\u606f kill kill a running container #ki ll\u6307\u5b9adocker\u5bb9\u5668 load Load an image from at ar archive #\u4ece\u4e00\u4e2atar\u5305\u4e2d\u52a0\u8f7d\u4e00\u4e2a\u955c\u50cf[\u5bf9\u5e94save] login Register or Login to the docker registry server #\u6ce8\u518c\u6216\u8005\u767b\u9646\u4e00\u4e2adocker\u6e90\u670d\u52a1\u5668 logout Logout from a Docker registry server #\u4ece\u5f53\u524dDocker registry\u9000\u51fa logs Fetch the 1ogsofa container #\u8f93\u51fa\u5f53\u524d\u5bb9\u5668\u65e5\u5fd7\u4fe1\u606f port Lookup the pub1ic-facing port which is NAT-ed to PRIVATE_PORT #\u67e5\u770b\u6620\u5c04\u7aef\u53e3\u5bf9\u5e94\u7684\u5bb9\u5668\u5185\u90e8\u6e90\u7aef \u53e3 pause Pause a 11 processes within a container #\u6682\u505c\u5bb9\u5668 ps List containers #\u5217\u51fa\u5bb9\u5668\u5217\u8868 pull Pullanimageora repository from the docker registry server #\u4ecedocker\u955c\u50cf\u6e90\u670d\u52a1\u5668\u62c9\u53d6\u6307\u5b9a\u955c\u50cf\u6216\u8005\u5e93\u955c\u50cf push Push an image or a repository to the docker registry server #\u63a8\u9001\u6307\u5b9a\u955c\u50cf\u6216\u8005\u5e93\u955c\u50cf\u81f3docker\u6e90\u670d\u52a1\u5668 restart Restart a running container #\u91cd\u542f\u8fd0\u884c\u7684\u5bb9\u5668 rm Remove one or more containers #\u79fb\u9664\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5bb9\u5668 rmi Remove one or more images #\u79fb\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u955c\u50cf[\u65e0\u5bb9\u5668\u4f7f\u7528\u8be5\u955c\u50cf\u624d\u53ef\u5220\u9664\uff0c\u5426\u5219\u9700\u5220\u9664\u76f8\u5173\u5bb9 \u5668\u624d\u53ef\u7ee7\u7eed\u6216-f\u5f3a\u5236\u5220\u9664] run Run a command in a new container #\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5bb9\u5668\u5e76\u8fd0\u884c\u4e00\u4e2a\u547d\u4ee4 save Save an image to at ar archive #\u4fdd\u5b58\u4e00\u4e2a\u955c\u50cf\u4e3a\u4e00\u4e2atar\u5305[\u5bf9\u5e941oad] search Search for an image on the Docker Hub #\u5728docker hub\u4e2d\u641c\u7d22\u955c\u50cf start Start a stopped containers #\u542f\u52a8\u5bb9\u5668 stop Stop a running containers #\u505c\u6b62\u5bb9\u5668 tag Tagan image into a repository #\u7ed9\u6e90\u4e2d\u955c\u50cf\u6253\u6807\u7b7e top Lookup the running processes of a container #\u67e5\u770b\u5bb9\u5668\u4e2d\u8fd0\u884c\u7684\u8fdb\u7a0b\u4fe1\u606f un pause Un pause a paused container #\u53d6\u6d88\u6682\u505c\u5bb9\u5668 version Show the docker version information #\u67e5\u770bdocker\u7248\u672c\u53f7 wait Block until a container stops\uff0c then print its exitcode #\u622a\u53d6\u5bb9\u5668\u505c\u6b62\u65f6\u7684\u9000\u51fa\u72b6\u6001\u503c","title":"docker cp"},{"location":"Docker/#nginx","text":"","title":"\u90e8\u7f72Nginx"},{"location":"Docker/#_35","text":"\u7f51\u9875\u641c\u7d22\u955c\u50cf \u5efa\u8bae\u5728docker hub\u8fdb\u884c\u641c\u7d22\uff0c\u53ef\u4ee5\u770b\u5230\u5e2e\u52a9\u6587\u6863\u3002 \u6253\u5f00\u67e5\u770b\u955c\u50cf\u8be6\u7ec6\u4fe1\u606f \u547d\u4ee4\u641c\u7d22\u955c\u50cf docker search nginx","title":"\u641c\u7d22\u955c\u50cf"},{"location":"Docker/#_36","text":"docker pull nginx","title":"\u4e0b\u8f7d\u955c\u50cf"},{"location":"Docker/#_37","text":"docker images","title":"\u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf"},{"location":"Docker/#_38","text":"docker run -d --name=nginx01 -p 3344:80 nginx -d #\u540e\u53f0\u8fd0\u884c --name #\u7ed9\u5bb9\u5668\u8d77\u540d -p #\u66b4\u9732\u7aef\u53e3\uff08\u5bbf\u4e3b\u673a\u7aef\u53e3\uff1a\u5bb9\u5668\u5185\u90e8\u7aef\u53e3\uff09","title":"\u542f\u52a8\u955c\u50cf"},{"location":"Docker/#_39","text":"docker ps","title":"\u67e5\u770b\u8fd0\u884c\u5bb9\u5668"},{"location":"Docker/#_40","text":"curl localhost:3344","title":"\u8bf7\u6c42\u6d4b\u8bd5"},{"location":"Docker/#_41","text":"docker exec -it nginx01 /bin/bash \u8fdb\u5165\u5bb9\u5668\uff0c\u641c\u7d22nginx,\u67e5\u770bnginx\u914d\u7f6e\u6587\u4ef6\uff0c\u9000\u51fa\u5bb9\u5668\uff0c\u505c\u6b62\u5bb9\u5668\uff0c\u518d\u6b21\u8bbf\u95ee\u6d4b\u8bd5 [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STAT 370ce844910c nginx \"/docker-entrypoint.\u2026\" 17 minutes ago Up 1 [root@localhost ~]# docker exec -it nginx01 /bin/bash root@370ce844910c:/# whereis nginx nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx root@370ce844910c:/# cd /etc/nginx/ root@370ce844910c:/etc/nginx# ls conf.d koi-utf mime.types nginx.conf uwsgi_params fastcgi_params koi-win modules scgi_params win-utf root@370ce844910c:/etc/nginx# exit exit [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 370ce844910c nginx \"/docker-entrypoint.\u2026\" 19 minutes ago Up 19 minutes 0.0.0.0:3344->80/tcp nginx01 [root@localhost ~]# docker stop 370ce844910c 370ce844910c [root@localhost ~]# \u505c\u6b62\u5bb9\u5668\u540e\u4fbf\u65e0\u6cd5\u8bbf\u95eenginx","title":"\u8fdb\u5165\u5bb9\u5668"},{"location":"Docker/#tomcat","text":"","title":"\u90e8\u7f72tomcat"},{"location":"Docker/#_42","text":"\u5b98\u65b9\u4f7f\u7528\uff1a \u6d4b\u8bd5\u4f7f\u7528\uff1a\u7528\u5b8c\u5373\u5220\u9664\u5bb9\u5668 docker run -it --rm toncat:9.0 \u5bb9\u5668\u5220\u9664\uff0c\u955c\u50cf\u8fd8\u5728","title":"\u641c\u7d22\u955c\u50cf"},{"location":"Docker/#_43","text":"docker pull tomcat","title":"\u4e0b\u8f7d\u955c\u50cf"},{"location":"Docker/#_44","text":"docker images","title":"\u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf"},{"location":"Docker/#_45","text":"\u4ee5\u540e\u53f0\u7684\u65b9\u5f0f\u542f\u52a8 docker run -d -p 3355:8080 --name=tomcat01 tomcat","title":"\u542f\u52a8\u955c\u50cf"},{"location":"Docker/#_46","text":"\u6d4b\u8bd5\u8bbf\u95ee\u6ca1\u6709\u95ee\u9898\uff0c\u5c11\u4e1c\u897f","title":"\u8bbf\u95ee\u6d4b\u8bd5"},{"location":"Docker/#_47","text":"docker exec -it tomcat01 /bin/bash \u95ee\u9898\uff1a \u547d\u4ee4\u7f3a\u5c11 webapps\u76ee\u5f55\u6ca1\u6709\u6587\u4ef6 \u539f\u56e0\uff1a \u963f\u91cc\u4e91\u955c\u50cf\u539f\u56e0\uff0c\u9ed8\u8ba4\u6700\u5c0f\u7684\u955c\u50cf\uff0c \u6240\u6709\u4e0d\u5fc5\u8981\u7684\u90fd\u5220\u9664\u6389\uff0c\u4fdd\u8bc1\u6700\u5c0f\u53ef\u8fd0\u884c\u7684\u73af\u5883\u3002","title":"\u8fdb\u5165\u5bb9\u5668"},{"location":"Docker/#_48","text":"webapps\u6587\u4ef6\u88ab\u653e\u5728\u4e86webapps.dist\u76ee\u5f55\u4e2d\uff0c\u62f7\u8d1dwebapps.dist\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u5230webapps\u4e2d\uff0c\u518d\u6b21\u5237\u65b0\u6d4b\u8bd5\u8bbf\u95ee\u3002 \u518d\u6b21\u6d4b\u8bd5","title":"\u89e3\u51b3\u8bbf\u95ee"},{"location":"Docker/#eskibana","text":"\u5168\u6587\u641c\u7d22\u5f15\u64ceelasticsearch","title":"\u90e8\u7f72es+kibana"},{"location":"Docker/#_49","text":"es: \u66b4\u9732\u7684\u7aef\u53e3\u5f88\u591a \u5341\u5206\u7684\u8017\u5185\u5b58 --net somenetwork \u7f51\u7edc","title":"\u641c\u7d22\u955c\u50cf"},{"location":"Docker/#_50","text":"docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" elasticsearch:7.6.2","title":"\u4e0b\u8f7d\u542f\u52a8\u955c\u50cf"},{"location":"Docker/#_51","text":"docker ps","title":"\u67e5\u770b\u8fd0\u884c\u5bb9\u5668"},{"location":"Docker/#cpu","text":"\u5185\u5b58\u5360\u7528\u8f83\u9ad8 docker stats","title":"\u67e5\u770bCPU\u5185\u5b58\u72b6\u6001"},{"location":"Docker/#_52","text":"curl localhost:9200","title":"\u8bf7\u6c42\u6d4b\u8bd5"},{"location":"Docker/#_53","text":"\u5173\u95ed\u5bb9\u5668\uff0c\u589e\u52a0\u5185\u5b58\u9650\u5236\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 -e:\u73af\u5883\u914d\u7f6e\u4fee\u6539 docker ps docker stop ID \u4fee\u6539\u914d\u7f6e\u518d\u6b21\u542f\u52a8 docker run -d --name elasticsearch02 -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" -e ES_JAVA_OPTS=\"-Xms64m -Xmx512m\" elasticsearch:7.6.2","title":"\u589e\u52a0\u5185\u5b58\u9650\u5236"},{"location":"Docker/#_54","text":"","title":"\u518d\u6b21\u67e5\u770b\u72b6\u6001"},{"location":"Docker/#_55","text":"curl localhost:9200","title":"\u8bf7\u6c42\u6d4b\u8bd5"},{"location":"Docker/#kibanaelasticsearch","text":"","title":"\u4f7f\u7528kibana\u8fde\u63a5elasticsearch"},{"location":"Docker/#portainer","text":"Docker\u56fe\u5f62\u5316\u754c\u9762\u7ba1\u7406\u5de5\u5177\uff01\u63d0\u4f9b\u4e00\u4e2a\u540e\u53f0\u9762\u677f\u4f9b\u6211\u4eec\u64cd\u4f5c\uff01","title":"portainer\u53ef\u89c6\u5316"},{"location":"Docker/#_56","text":"docker run -d -p 8088:9000 \\ --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer","title":"\u4e0b\u8f7d\u8fd0\u884c\u955c\u50cf"},{"location":"Docker/#_57","text":"curl localhost:8088","title":"\u8bbf\u95ee\u6d4b\u8bd5"},{"location":"Docker/#_58","text":"http://IP:8088 \u8bbe\u7f6e\u5bc6\u7801\uff0c\u521b\u5efa\u7528\u6237\u3002\u9009\u62e9LOCAL\u6570\u636e\u3002","title":"\u7f51\u9875\u8bbf\u95ee"},{"location":"Docker/#_59","text":"","title":"\u8fdb\u5165\u9762\u677f"},{"location":"Docker/#docker_12","text":"","title":"Docker\u955c\u50cf\u8bb2\u89e3"},{"location":"Docker/#_60","text":"\u955c\u50cf\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u3001\u53ef\u6267\u884c\u7684\u72ec\u7acb\u8f6f\u4ef6\u5305\uff0c\u7528\u6765\u6253\u5305\u8f6f\u4ef6\u8fd0\u884c\u73af\u5883\u548c\u57fa\u4e8e\u8fd0\u884c\u73af\u5883\u5f00\u53d1\u7684\u8f6f\u4ef6\uff0c\u5b83\u5305\u542b\u8fd0\u884c\u67d0\u4e2a\u8f6f\u4ef6\u6240\u9700\u7684\u6240\u6709\u5185\u5bb9\uff0c\u5305\u62ec\u4ee3\u7801\u3001\u8fd0\u884c\u65f6\u3001\u5e93\u3001\u73af\u5883\u53d8\u91cf\u548c\u914d\u7f6e\u6587\u4ef6\u3002 \u6240\u6709\u7684\u5e94\u7528\uff0c \u76f4\u63a5\u6253\u5305\u6210docker\u955c\u50cf\uff0c \u5c31\u53ef\u4ee5\u76f4\u63a5\u8dd1\u8d77\u6765!","title":"\u955c\u50cf\u662f\u4ec0\u4e48\uff1f"},{"location":"Docker/#_61","text":"\u4ece\u8fdc\u7a0b\u4ed3\u5e93\u4e0b\u8f7d \u670b\u53cb\u62f7\u8d1d\u7ed9\u4f60 \u81ea\u5df1\u5236\u4f5c\u4e00\u4e2a\u955c\u50cfDocker File","title":"\u5982\u4f55\u5f97\u5230\u955c\u50cf\uff1f"},{"location":"Docker/#unionfs","text":"\u6211\u4eec\u4e0b\u8f7d\u7684\u65f6\u5019\u770b\u5230\u7684\u4e00\u5c42\u4e00\u5c42\u5c31\u662f\u5206\u5c42\u4e0b\u8f7d\uff01 UnionFS(\u8054\u5408\u6587\u4ef6\u7cfb\u7edf) \uff1aUnion\u6587\u4ef6\u7cfb\u7edf(UnionFS) \u662f\u4e00\u79cd\u5206\u5c42\u3001\u8f7b\u91cf\u7ea7\u5e76\u4e14\u9ad8\u6027\u80fd\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c \u5b83\u652f\u6301\u5bf9\u6587\u4ef6\u7cfb\u7edf\u7684\u4fee\u6539\u4f5c\u4e3a\u4e00\u6b21\u63d0\u4ea4\u6765\u4e00\u5c42\u5c42\u7684\u53e0\u52a0\uff0c\u540c\u65f6\u53ef\u4ee5\u5c06\u4e0d\u540c\u76ee\u5f55\u6302\u8f7d\u5230\u540c\u4e00\u4e2a\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u4e0b(unite several directories into a single virtual filesystem) \u3002Union\u6587\u4ef6\u7cfb\u7edf\u662fDocker\u955c\u50cf\u7684\u57fa\u7840\u3002\u955c\u50cf\u53ef\u4ee5\u901a\u8fc7\u5206\u5c42\u6765\u8fdb\u884c\u7ee7\u627f\uff0c \u57fa\u4e8e\u57fa\u7840\u955c\u50cf(\u6ca1\u6709\u7236\u955c\u50cf) \uff0c \u53ef\u4ee5\u5236\u4f5c\u5404\u79cd\u5177\u4f53\u7684\u5e94\u7528\u955c\u50cf\u3002 \u7279\u6027\uff1a\u4e00\u6b21\u540c\u65f6\u52a0\u8f7d\u591a\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f46\u4ece\u5916\u9762\u770b\u8d77\u6765\uff0c\u53ea\u80fd\u770b\u5230\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff0c\u8054\u5408\u52a0\u8f7d\u4f1a\u628a\u5404\u5c42\u6587\u4ef6\u7cfb\u7edf\u53e0\u52a0\u8d77\u6765\uff0c\u8fd9\u6837\u6700\u7ec8\u7684 \u6587\u4ef6\u7cfb\u7edf\u4f1a\u5305\u542b\u6240\u6709\u5e95\u5c42\u7684\u6587\u4ef6\u548c\u76ee\u5f55 \u3002","title":"UnionFS\u8054\u5408\u6587\u4ef6\u7cfb\u7edf"},{"location":"Docker/#docker_13","text":"docker\u7684\u955c\u50cf\u5b9e\u9645\u4e0a\u7531\u4e00\u5c42\u4e00\u5c42\u7684\u6587\u4ef6\u7cfb\u7edf\u7ec4\u6210\uff0c \u8fd9\u79cd\u5c42\u7ea7\u7684\u6587\u4ef6\u7cfb\u7edfUnionFS\u3002 bootfs(boot file system) \u4e3b\u8981\u5305\u542bbootloader\u548ckernel\uff0cbootloader\u4e3b\u8981\u662f\u5f15\u5bfc\u52a0\u8f7dkernel\uff0c Linux\u521a\u542f\u52a8\u65f6\u4f1a\u52a0\u8f7dbootfs\u6587\u4ef6\u7cfb\u7edf\uff0c\u5728Docker\u955c\u50cf\u7684\u6700\u5e95\u5c42\u662fbootfs\u3002\u8fd9\u4e00\u5c42\u4e0e\u6211\u4eec\u5178\u578b\u7684Linux/Unix\u7cfb\u7edf\u662f\u4e00\u6837\u7684\uff0c \u5305\u542bboot\u52a0\u8f7d\u5668\u548c\u5185\u6838\u3002\u5f53boot\u52a0\u8f7d\u5b8c\u6210\u4e4b\u540e\u6574\u4e2a\u5185\u6838\u5c31\u90fd\u5728\u5185\u5b58\u4e2d\u4e86\uff0c \u6b64\u65f6\u5185\u5b58\u7684\u4f7f\u7528\u6743\u5df2\u7531bootfs\u8f6c\u4ea4\u7ed9\u5185\u6838\uff0c \u6b64\u65f6\u7cfb\u7edf\u4e5f\u4f1a\u5378\u8f7dbootfs\u3002 rootfs(root file system) \uff0c\u5728bootfs\u4e4b\u4e0a\u3002\u5305\u542b\u7684\u5c31\u662f\u5178\u578bLinux\u7cfb\u7edf\u4e2d\u7684/dev\uff0c/proc\uff0c/bin\uff0c/etc\u7b49\u6807\u51c6\u76ee\u5f55\u548c\u6587\u4ef6\u3002rootfs\u5c31\u662f\u5404\u79cd\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\uff0c \u6bd4\u5982Ubuntu\uff0c Centos\u7b49\u7b49\u3002 \u5e73\u65f6\u6211\u4eec\u5b89\u88c5\u8fdb\u865a\u62df\u673a\u7684CentOS\u90fd\u662f\u597d\u51e0\u4e2aG\uff0c \u4e3a\u4ec0\u4e48Docker\u8fd9\u91cc\u624d200M? \u5bf9\u4e8e\u4e00\u4e2a\u7cbe\u7b80\u7684OS,rootfs\u53ef\u4ee5\u5f88\u5c0f\uff0c\u53ea\u9700\u8981\u5305\u542b\u6700\u57fa\u672c\u7684\u547d\u4ee4,\u5de5\u5177\u548c\u7a0b\u5e8f\u5e93\u5c31\u53ef\u4ee5\u4e86\uff0c \u56e0\u4e3a\u5e95\u5c42\u76f4\u63a5\u7528Host\u7684kernel\uff0c \u81ea\u5df1\u53ea\u9700\u8981\u63d0\u4f9brootfs\u5c31\u53ef\u4ee5\u4e86\u3002\u7531\u6b64\u53ef\u89c1\u5bf9\u4e8e\u4e0d\u540c\u7684linux\u53d1\u884c\u7248\uff0c bootfs\u57fa\u672c\u662f\u4e00\u81f4\u7684,rootfs\u4f1a\u6709\u5dee\u522b,\u56e0\u6b64\u4e0d\u540c\u7684\u53d1\u884c\u7248\u53ef\u4ee5\u516c\u7528 bootfs\u3002 \u5e95\u5c42\u5f15\u5bfc\u4e0d\u53d8 \u865a\u62df\u673a\u5206\u949f\u7ea7\u522b\uff0c\u5bb9\u5668\u79d2\u7ea7\u3002","title":"Docker\u955c\u50cf\u52a0\u8f7d\u539f\u7406"},{"location":"Docker/#_62","text":"\u6211\u4eec\u53ef\u4ee5\u53bb\u4e0b\u8f7d\u4e00\u4e2a\u955c\u50cf\uff0c\u6ce8\u610f\u89c2\u5bdf\u4e0b\u8f7d\u7684\u65e5\u5fd7\u8f93\u51fa\uff0c\u53ef\u4ee5\u770b\u5230\u662f\u4e00\u5c42\u4e00\u5c42\u7684\u5728\u4e0b\u8f7d! \u601d\u8003\uff1a\u4e3a\u4ec0\u4e48Docker\u955c\u50cf\u8981\u91c7\u7528\u8fd9\u79cd\u5206\u5c42\u7684\u7ed3\u6784\u5462? \u6700\u5927\u7684\u597d\u5904\uff0c\u83ab\u8fc7\u4e8e\u662f\u8d44\u6e90\u5171\u4eab!\u6bd4\u5982\u6709\u591a\u4e2a\u955c\u50cf\u90fd\u4ece\u76f8\u540c\u7684Base\u955c\u50cf\u6784\u5efa\u800c\u6765,\u90a3\u4e48\u5bbf\u4e3b\u673a\u53ea\u9700\u5728\u78c1\u76d8\u4e0a\u4fdd\u7559\u4e00\u4efdbase\u955c\u50cf,\u540c\u65f6\u5185\u5b58\u4e2d\u4e5f\u53ea\u9700\u8981\u52a0\u8f7d\u4e00\u4efdbase\u955c\u50cf,\u8fd9\u6837\u5c31\u53ef\u4ee5\u4e3a\u6240\u6709\u7684\u5bb9\u5668\u670d\u52a1\u4e86, \u800c\u4e14\u955c\u50cf\u7684\u6bcf\u4e00\u5c42\u90fd\u53ef\u4ee5\u88ab\u5171\u4eab\u3002 \u67e5\u770b\u955c\u50cf\u5206\u5c42\u7684\u65b9\u5f0f\u53ef\u4ee5\u901a\u8fc7docker image inspect\u547d\u4ee4! [root@localhost ~]# docker image inspect redis:latest [ //...... \"RootFS\": { \"Type\": \"layers\", \"Layers\": [ \"sha256:d0fe97fa8b8cefdffcef1d62b65aba51a6c87b6679628a2b50fc6a7a579f764c\", \"sha256:832f21763c8e6b070314e619ebb9ba62f815580da6d0eaec8a1b080bd01575f7\", \"sha256:223b15010c47044b6bab9611c7a322e8da7660a8268949e18edde9c6e3ea3700\", \"sha256:6a9976a8f40851f45dc8c68a04b130e90522f46bb7e8403c6e7eb4331674f213\", \"sha256:c875a9fc3ec72b140e325e1a1b3b57d299b91811e8288a07c6b788b0d7cba185\", \"sha256:d9364cb75b1a364fbcb97b2f51332fc012ae0321e18c3fd3811f5e5a9f8a2d0e\" ] }, \"Metadata\": { \"LastTagTime\": \"0001-01-01T00:00:00Z\" } } ] \u7406\u89e3\uff1a \u6240\u6709\u7684Docker\u955c\u50cf\u90fd\u8d77\u59cb\u4e8e\u4e00\u4e2a\u57fa\u7840\u955c\u50cf\u5c42\uff0c\u5f53\u8fdb\u884c\u4fee\u6539\u6216\u589e\u52a0\u65b0\u7684\u5185\u5bb9\u65f6\uff0c\u5c31\u4f1a\u5728\u5f53\u524d\u955c\u50cf\u5c42\u4e4b\u4e0a\u521b\u5efa\u65b0\u7684\u955c\u50cf\u5c42\u3002\u4e3e\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5047\u5982\u57fa\u4e8eUbuntu Linux 16.04\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\uff0c\u8fd9\u5c31\u662f\u65b0\u955c\u50cf\u7684\u7b2c\u4e00\u5c42\uff1b\u5982\u679c\u5728\u8be5\u955c\u50cf\u4e2d\u6dfb\u52a0Python\u5305\u5c31\u4f1a\u5728\u57fa\u7840\u955c\u50cf\u5c42\u4e4b\u4e0a\u521b\u5efa\u7b2c\u4e8c\u4e2a\u955c\u50cf\u5c42\uff1b\u5982\u679c\u7ee7\u7eed\u6dfb\u52a0\u4e00\u4e2a\u5b89\u5168\u8865\u4e01\uff0c\u5c31\u4f1a\u521b\u5efa\u7b2c\u4e09\u4e2a\u955c\u50cf\u5c42\u3002\u8be5\u955c\u50cf\u5f53\u524d\u5df2\u7ecf\u5305\u542b3\u4e2a\u955c\u50cf\u5c42\uff0c\u5982\u4e0b\u56fe\u6240\u793a(\u8fd9\u53ea\u662f\u4e00\u4e2a\u7528\u4e8e\u6f14\u793a\u7684\u5f88\u7b80\u5355\u7684\u4f8b\u5b50)\u3002 \u5728\u6dfb\u52a0\u989d\u5916\u7684\u955c\u50cf\u5c42\u7684\u540c\u65f6\uff0c\u955c\u50cf\u59cb\u7ec8\u4fdd\u6301\u662f\u5f53\u524d\u6240\u6709\u955c\u50cf\u7684\u7ec4\u5408\uff0c\u7406\u89e3\u8fd9\u4e00\u70b9\u975e\u5e38\u91cd\u8981\u3002\u4e0b\u56fe\u4e2d\u4e3e\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u6bcf\u4e2a\u955c\u50cf\u5c42\u5305\u542b3\u4e2a\u6587\u4ef6\uff0c\u800c\u955c\u50cf\u5305\u542b\u4e86\u6765\u81ea\u4e24\u4e2a\u955c\u50cf\u5c42\u76846\u4e2a\u6587\u4ef6\u3002 \u4e0a\u56fe\u4e2d\u7684\u955c\u50cf\u5c42\u8ddf\u4e4b\u524d\u56fe\u4e2d\u7684\u7565\u6709\u533a\u522b\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u4fbf\u4e8e\u5c55\u793a\u6587\u4ef6\u3002 \u4e0b\u56fe\u4e2d\u5c55\u793a\u4e86\u4e00\u4e2a\u7a0d\u5fae\u590d\u6742\u7684\u4e09\u5c42\u955c\u50cf\uff0c\u5728\u5916\u90e8\u770b\u6765\u6574\u4e2a\u955c\u50cf\u53ea\u67096\u4e2a\u6587\u4ef6\uff0c\u8fd9\u662f\u56e0\u4e3a\u6700\u4e0a\u5c42\u4e2d\u7684\u6587\u4ef67\u662f\u6587\u4ef65\u7684\u4e00\u4e2a\u66f4\u65b0\u7248\u672c\u3002 \u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0a\u5c42\u955c\u50cf\u5c42\u4e2d\u7684\u6587\u4ef6\u8986\u76d6\u4e86\u5e95\u5c42\u955c\u50cf\u5c42\u4e2d\u7684\u6587\u4ef6\u3002\u8fd9\u6837\u5c31\u4f7f\u5f97\u6587\u4ef6\u7684\u66f4\u65b0\u7248\u672c\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u955c\u50cf\u5c42\u6dfb\u52a0\u5230\u955c\u50cf\u5f53\u4e2d\u3002 Docker\u901a\u8fc7\u5b58\u50a8\u5f15\u64ce(\u65b0\u7248\u672c\u91c7\u7528\u5feb\u7167\u673a\u5236) \u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u955c\u50cf\u5c42\u5806\u6808\uff0c \u5e76\u4fdd\u8bc1\u591a\u955c\u50cf\u5c42\u5bf9\u5916\u5c55\u793a\u4e3a\u7edf\u4e00\u7684\u6587\u4ef6\u7cfb\u7edf\u3002 Linux\u4e0a\u53ef\u7528\u7684\u5b58\u50a8\u5f15\u64ce\u6709AUFS\u3001 Overlay2\u3001Device Mapper\u3001Btrfs\u4ee5\u53caZFS\u3002\u987e\u540d\u601d\u4e49\uff0c \u6bcf\u79cd\u5b58\u50a8\u5f15\u64ce\u90fd\u57fa\u4e8eLinux\u4e2d\u5bf9\u5e94\u7684\u6587\u4ef6\u7cfb\u7edf\u6216\u8005\u5757\u8bbe\u5907\u6280\u672f\uff0c\u5e76\u4e14\u6bcf\u79cd\u5b58\u50a8\u5f15\u64ce\u90fd\u6709\u5176\u72ec\u6709\u7684\u6027\u80fd\u7279\u70b9\u3002 Docker\u5728Windows\u4e0a\u4ec5\u652f\u6301windows filter\u4e00\u79cd\u5b58\u50a8\u5f15\u64ce\uff0c \u8be5\u5f15\u64ce\u57fa\u4e8eNTFS\u6587\u4ef6\u7cfb\u7edf\u4e4b\u4e0a\u5b9e\u73b0\u4e86\u5206\u5c42\u548cCoW[1] \u3002 \u4e0b\u56fe\u5c55\u793a\u4e86\u4e0e\u7cfb\u7edf\u663e\u793a\u76f8\u540c\u7684\u4e09\u5c42\u955c\u50cf\u3002\u6240\u6709\u955c\u50cf\u5c42\u5806\u53e0\u5e76\u5408\u5e76\uff0c\u5bf9\u5916\u63d0\u4f9b\u7edf\u4e00\u7684\u89c6\u56fe\u3002","title":"\u5206\u5c42\u7684\u955c\u50cf"},{"location":"Docker/#_63","text":"Docker\u955c\u50cf\u90fd\u662f\u53ea\u8bfb\u7684\uff0c \u5f53\u5bb9\u5668\u542f\u52a8\u65f6\uff0c \u4e00\u4e2a\u65b0\u7684\u53ef\u5199\u5c42\u88ab\u52a0\u8f7d\u5230\u955c\u50cf\u7684\u9876\u90e8 \u8fd9\u4e00\u5c42\u5c31\u662f\u6211\u4eec\u901a\u5e38\u8bf4\u7684\u5bb9\u5668\u5c42\uff0c\u5bb9\u5668\u4e4b\u4e0b\u7684\u90fd\u53eb\u955c\u50cf\u5c42! \u6ce8\uff1a\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u57fa\u4e8e\u5bb9\u5668\u5c42\u3002 \u5982\u4f55\u63d0\u4ea4\u4e00\u4e2a\u81ea\u5df1\u7684\u955c\u50cf\uff1f","title":"\u7279\u70b9"},{"location":"Docker/#commit","text":"\u63d0\u4ea4\u4fee\u6539\u7684\u5bb9\u5668\u6210\u4e3a\u4e00\u4e2a\u65b0\u7684\u526f\u672c docker commit docker commit -m=\"\u63d0\u4ea4\u7684\u63cf\u8ff0\u4fe1\u606f\" -a=\"\u4f5c\u8005\" ID\u76ee\u6807\u955c\u50cf\u540d:[TAG]","title":"commit\u63d0\u4ea4\u955c\u50cf"},{"location":"Docker/#_64","text":"docker images","title":"\u67e5\u770b\u955c\u50cf"},{"location":"Docker/#_65","text":"docker run -it -p 8080:8080 tomcat \u65b0\u5f00\u7a97\u53e3","title":"\u4ea4\u4e92\u6a21\u5f0f\u542f\u52a8"},{"location":"Docker/#_66","text":"docker ps","title":"\u67e5\u770b\u8fd0\u884c\u5bb9\u5668"},{"location":"Docker/#_67","text":"docker exec -it ID /bin/bash","title":"\u8fdb\u5165\u8fd0\u884c\u7684\u5bb9\u5668"},{"location":"Docker/#_68","text":"\u542f\u52a8\u9ed8\u8ba4\u7684tamcat \u53d1\u73b0\u8fd9\u4e2a\u9ed8\u8ba4\u7684tamcat\u662f\u6ca1\u6709webapps\u5e94\u7528\uff0c\u955c\u50cf\u7684\u539f\u56e0\uff0c\u5b98\u65b9\u955c\u50cf\u9ed8\u8ba4webapps\u4e0b\u9762\u662f\u6ca1\u6709\u6587\u4ef6\u7684\u3002 \u81ea\u5df1\u62f7\u8d1d\u8fdb\u53bb\u57fa\u672c\u6587\u4ef6","title":"\u4fee\u6539\u5bb9\u5668\u5185\u5bb9"},{"location":"Docker/#_69","text":"docker commit -m=\"\u63d0\u4ea4\u7684\u63cf\u8ff0\u4fe1\u606f\" -a=\"\u4f5c\u8005\" ID \u76ee\u6807\u955c\u50cf\u540d:[TAG\u7248\u672c] -a=\"\u4f5c\u8005\" -m=\"\u63cf\u8ff0\" docker commit -a=\"lwenwu\" -m=\"add webapps app\" 444facacd961 tomcat02:1.0","title":"\u5c06\u4fee\u6539\u7684\u5bb9\u5668\u6253\u5305"},{"location":"Docker/#_70","text":"docker images \u6bd4\u539f\u6765\u7684\u955c\u50cf\u5927\u4e86\u4e00\u4e9b\uff0c\u53ef\u4ee5\u76f4\u63a5\u542f\u52a8\u8fd0\u884c\u3002","title":"\u67e5\u770b\u6253\u5305\u597d\u7684\u955c\u50cf"},{"location":"Docker/#_71","text":"\u4ec0\u4e48\u662f\u5bb9\u5668\u6570\u636e\u5377\uff1f docker\u7684\u7406\u5ff5\u56de\u987e \u5c06\u5e94\u7528\u548c\u73af\u5883\u6253\u5305\u6210\u4e00\u4e2a\u955c\u50cf! \u6570\u636e?\u5982\u679c\u6570\u636e\u90fd\u5728\u5bb9\u5668\u4e2d\uff0c\u90a3\u4e48\u6211\u4eec\u5bb9\u5668\u5220\u9664\uff0c\u6570\u636e\u5c31\u4f1a\u4e22\u5931!\u9700\u6c42\uff1a\u6570\u636e\u53ef\u4ee5\u6301\u4e45\u5316 MySQL\uff0c\u5bb9\u5668\u5220\u4e86\uff0c\u5220\u5e93\u8dd1\u8def!\u9700\u6c42\uff1aMySQL\u6570\u636e\u53ef\u4ee5\u5b58\u50a8\u5728\u672c\u5730! \u5bb9\u5668\u4e4b\u95f4\u53ef\u4ee5\u6709\u4e00\u4e2a\u6570\u636e\u5171\u4eab\u7684\u6280\u672f!Docker\u5bb9\u5668\u4e2d\u4ea7\u751f\u7684\u6570\u636e\uff0c\u540c\u6b65\u5230\u672c\u5730!\u8fd9\u5c31\u662f\u5377\u6280\u672f!\u76ee\u5f55\u7684\u6302\u8f7d\uff0c\u5c06\u6211\u4eec\u5bb9\u5668\u5185\u7684\u76ee\u5f55\uff0c\u6302\u8f7d\u5230Linux\u4e0a\u9762! \u603b\u7ed3\u4e00\u53e5\u8bdd\uff1a\u5bb9\u5668\u7684\u6301\u4e45\u5316\u548c\u540c\u6b65\u64cd\u4f5c\uff01\u5bb9\u5668\u95f4\u4e5f\u662f\u53ef\u4ee5\u6570\u636e\u5377\u5171\u4eab\u7684\uff01","title":"\u5bb9\u5668\u6570\u636e\u5377"},{"location":"Docker/#_72","text":"","title":"\u4f7f\u7528\u6570\u636e\u5377"},{"location":"Docker/#_73","text":"-v docker run -it -v \u4e3b\u673a\u76ee\u5f55\uff1a\u5bb9\u5668\u76ee\u5f55 docker run -it -v /home/test:/home centos /bin/bash","title":"\u4f7f\u7528\u547d\u4ee4\u6302\u8f7d"},{"location":"Docker/#_74","text":"\u65b0\u5f00\u7a97\u53e3\uff0c\u5728\u4e3b\u673a\u76ee\u5f55\u4e0b\u67e5\u770b docker inspect ID","title":"\u67e5\u770b\u5bb9\u5668\u6302\u8f7d\u4fe1\u606f"},{"location":"Docker/#_75","text":"\u53cc\u5411\u7ed1\u5b9a\uff0c\u81ea\u52a8\u540c\u6b65\u3002 \u5bb9\u5668\u5220\u9664\uff0c\u6570\u636e\u4e0d\u4f1a\u4e22\u5931\u3002","title":"\u6d4b\u8bd5\u6587\u4ef6\u540c\u6b65"},{"location":"Docker/#_76","text":"\u5bb9\u5668\u9000\u51fa\uff0c\u5bbf\u4e3b\u673a\u4e0a\u4fee\u6539\u6587\u4ef6\u6d4b\u8bd5\u540c\u6b65 exit \u5bbf\u4e3b\u673a\u4e0a\u4fee\u6539\u5b8c\u6587\u4ef6\u540e\uff0c\u5f00\u542f\u5bb9\u5668\uff0c\u8fdb\u5165\u5bb9\u5668 docker start ID docker attach ID \u8fdb\u5165\u76ee\u5f55\uff0c\u67e5\u770b\u6570\u636e\u3002","title":"\u53cc\u5411\u6d4b\u8bd5"},{"location":"Docker/#mysql","text":"","title":"\u5b9e\u6218MySQL"},{"location":"Docker/#_77","text":"docker search mysql","title":"\u641c\u7d22\u955c\u50cf"},{"location":"Docker/#_78","text":"docker pull mysql:5.7","title":"\u4e0b\u8f7d\u955c\u50cf"},{"location":"Docker/#_79","text":"","title":"\u67e5\u770b\u4e0b\u8f7d\u7684\u955c\u50cf"},{"location":"Docker/#_80","text":"\u5b89\u88c5\u542f\u52a8mysql,\u9700\u8981\u8bbe\u7f6e\u5bc6\u7801\u3002 \u5b98\u65b9\u8bf4\u660e\uff1a \u540e\u53f0\u8fd0\u884c docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 -d:\u540e\u53f0\u8fd0\u884c -p:\u7aef\u53e3\u6620\u5c04 -v:\u6570\u636e\u5377\u6302\u8f7d -e:\u73af\u5883\u914d\u7f6e --name:\u5bb9\u5668\u540d\u79f0","title":"\u542f\u52a8\u5bb9\u5668"},{"location":"Docker/#_81","text":"\u542f\u52a8\u6210\u529f\uff0c\u6211\u4eec\u5728\u672c\u5730\u4f7f\u7528sqlyog\u8fdb\u884c\u6d4b\u8bd5,\u65b0\u5efa\u8fde\u63a5\u3002 sqlyog-\u8fde\u63a5\u5230\u670d\u52a1\u5668\u76843310----3310\u548c\u5bb9\u5668\u5185\u76843306\u6620\u5c04\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u8fde\u63a5\u4e0a\u4e86!","title":"\u8fde\u63a5\u6d4b\u8bd5"},{"location":"Docker/#_82","text":"","title":"\u5bbf\u4e3b\u673a\u786e\u8ba4\u76ee\u5f55"},{"location":"Docker/#sqlyog","text":"","title":"sqlyog\u4e0a\u521b\u5efa\u6570\u636e\u5e93\u6d4b\u8bd5"},{"location":"Docker/#test","text":"","title":"\u521b\u5efatest\u6570\u636e\u5e93"},{"location":"Docker/#_83","text":"\u67e5\u770b\u6620\u5c04\u7684\u6570\u636e\u662f\u5426OK!","title":"\u4e3b\u673a\u6d4b\u8bd5\u4f20\u8f93"},{"location":"Docker/#_84","text":"\u5bb9\u5668\u4e2dMySQL\u914d\u7f6e\u76f4\u63a5\u5728\u672c\u5730/home/conf\u4e0b\u8fdb\u884c\u914d\u7f6e\uff0c\u914d\u7f6e\u524d\u5e94\u5148\u5c06\u5bb9\u5668\u4e2d\u7684\u914d\u7f6e\u62f7\u8d1d\u5230\u4e3b\u673a\u914d\u7f6e\u76ee\u5f55\u3002","title":"\u914d\u7f6e\u672c\u5730\u4fee\u6539"},{"location":"Docker/#_85","text":"\u5220\u9664\u5bb9\u5668\uff0c\u5bb9\u5668\u6570\u636e\u4e22\u5931\uff0c\u67e5\u770b\u672c\u5730\u6570\u636e\u3002 docker rm -f mysql01 \u67e5\u770b\u8fd0\u884c\u7684\u5bb9\u5668 docker ps \u5df2\u7ecf\u6ca1\u6709mysql01\u5bb9\u5668 \u53d1\u73b0\uff0c\u6211\u4eec\u6302\u8f7d\u5230\u672c\u5730\u7684\u6570\u636e\u5377\u4f9d\u65e7\u6ca1\u6709\u4e22\u5931\uff0c\u8fd9\u5c31\u5b9e\u73b0\u4e86\u5bb9\u5668\u6570\u636e\u6301\u4e45\u5316\u529f\u80fd!","title":"\u5220\u9664\u6d4b\u8bd5"},{"location":"Docker/#_86","text":"","title":"\u5177\u540d\u3001\u533f\u540d\u3001\u6307\u5b9a\u8def\u5f84\u6302\u8f7d"},{"location":"Docker/#_87","text":"-v \u76f4\u63a5\u6307\u5b9a\u5bb9\u5668\u5185\u8def\u5f84 docker run -d -P --name nginx01 -v /etc/nginx nginx","title":"\u533f\u540d\u6302\u8f7d"},{"location":"Docker/#_88","text":"docker volume --help","title":"\u67e5\u770b\u5377\u5e2e\u52a9\u4fe1\u606f"},{"location":"Docker/#_89","text":"volume name\u4e3a\u968f\u673a\u6570\u5b57 ac173af98840fdb2c146eada65ebb0de10c9b402b4701e76a7f52fd83bf1556b e831e07007d636fef22472ca81d64eccbdc5e1dab6d550e15d39b84a2e30988f","title":"\u67e5\u770b\u6240\u6709\u5377"},{"location":"Docker/#_90","text":"","title":"\u5177\u540d\u6302\u8f7d"},{"location":"Docker/#_91","text":"\u901a\u8fc7 -v \u5377\u540d\uff1a\u5bb9\u5668\u5185\u8def\u5f84 docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx","title":"\u547d\u4ee4\u5377"},{"location":"Docker/#_92","text":"docker volume ls","title":"\u67e5\u770b\u6240\u6709\u5377"},{"location":"Docker/#_93","text":"docker volume inspect juming-nginx","title":"\u67e5\u770b\u5377\u4f4d\u7f6e"},{"location":"Docker/#_94","text":"\u6240\u6709\u7684docker\u5bb9\u5668\u5185\u7684\u5377\uff0c\u6ca1\u6709\u6307\u5b9a\u76ee\u5f55\u7684\u60c5\u51b5\u4e0b\u90fd\u662f\u5728 /var/lib/docker/volumes/xxxx/_data \u6211\u4eec\u901a\u8fc7\u5177\u540d\u6302\u8f7d\u53ef\u4ee5\u65b9\u4fbf\u7684\u627e\u5230\u6211\u4eec\u7684\u4e00\u4e2a\u5377\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4f7f\u7528\u5177\u540d\u6302\u8f7d\u3002 \u5982\u4f55\u786e\u5b9a\u662f\u5177\u540d\u6302\u8f7d\u8fd8\u662f\u533f\u540d\u6302\u8f7d\uff0c\u8fd8\u662f\u6307\u5b9a\u8def\u5f84\u6302\u8f7d\uff1f -v \u5bb9\u5668\u5185\u8def\u5f84 #\u533f\u540d\u6302\u8f7d -v \u5377\u540d\uff1a\u5bb9\u5668\u5185\u8def\u5f84 #\u5177\u540d\u6302\u8f7d -v \u4e3b\u673a\u8def\u5f84:\u5bb9\u5668\u5185\u8def\u5f84 #\u6307\u5b9a\u8def\u5f84\u6302\u8f7d \u62d3\u5c55\uff1a #\u901a\u8fc7-v\u5bb9\u5668\u5185\u8def\u5f84\uff1aro/rw \u53ef\u6539\u53d8\u8bfb\u5199\u6743\u9650 ro readonly #\u53ea\u8bfb rw readwrite #\u53ef\u8bfb\u53ef\u5199 #\u4e00\u65e6\u8fd9\u4e2a\u8bbe\u7f6e\u4e86\u5bb9\u5668\u6743\u9650\uff0c\u5bb9\u5668\u5bf9\u6211\u4eec\u6302\u8f7d\u51fa\u6765\u7684\u5185\u5bb9\u5c31\u6709\u9650\u5b9a\u4e86! docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx #ro \u53ea\u8981\u770b\u5230ro\u5c31\u8bf4\u660e\u8fd9\u4e2a\u8def\u5f84\u53ea\u80fd\u901a\u8fc7\u5bbf\u4e3b\u673a\u6765\u64cd\u4f5c\uff0c\u5bb9\u5668\u5185\u90e8\u662f\u65e0\u6cd5\u64cd\u4f5c\u7684!","title":"\u8fdb\u5165\u5377"},{"location":"Docker/#_95","text":"-v \u4e3b\u673a\u8def\u5f84:\u5bb9\u5668\u5185\u8def\u5f84 #\u6307\u5b9a\u8def\u5f84\u6302\u8f7d","title":"\u6307\u5b9a\u8def\u5f84\u6302\u8f7d"},{"location":"Docker/#dockerfile","text":"","title":"DockerFile"},{"location":"Docker/#dockerfile_1","text":"\u8fdb\u5165/home \u521b\u5efadocker-test-volume\u76ee\u5f55 \u8fdb\u5165docker-test-volume\u76ee\u5f55\uff0c\u521b\u5efadockerfile\u6587\u4ef6\uff08\u540d\u5b57\u53ef\u968f\u610f\uff0c\u5efa\u8bae\u7528dockerfile\uff09 \u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff1a \u6307\u4ee4\u90fd\u5927\u5199\uff0c\u53c2\u6570\u5c0f\u5199 FROM centos VOLUME [\"volume01\",\"volume02\"] CMD echo \"-----------end------------\" CMD /bin/bash \u6bcf\u4e2a\u547d\u4ee4\uff0c\u5c31\u76f8\u5f53\u4e8e\u955c\u50cf\u7684\u4e00\u5c42\u3002","title":"DockerFile\u5236\u4f5c\u955c\u50cf"},{"location":"Docker/#_96","text":"build \u6784\u5efa -f \u811a\u672c\u6587\u4ef6\u5730\u5740 -t \u751f\u4ea7 \u6587\u4ef6\u540d \u6700\u540e\u9700\u8981.\u70b9 docker build -f /home/docker-test-volume/dockerfile1 -t lwemwu/centos . \u5206\u5c42\u6784\u5efa","title":"\u6784\u5efa\u955c\u50cf"},{"location":"Docker/#_97","text":"docker images","title":"\u67e5\u770b\u955c\u50cf"},{"location":"Docker/#_98","text":"docker run -it ID /bin/bash \u8fd9\u4e2a\u76ee\u5f55\u5c31\u662f\u6211\u4eec\u751f\u6210\u955c\u50cf\u7684\u65f6\u5019\u81ea\u52a8\u6302\u8f7d\u7684\u6570\u636e\u5377\u76ee\u5f55\u3002 \u8fd9\u4e2a\u5377\u548c\u5916\u90e8\u4e00\u5b9a\u6709\u4e00\u4e2a\u540c\u6b65\u7684\u76ee\u5f55\u3002","title":"\u542f\u52a8\u955c\u50cf"},{"location":"Docker/#_99","text":"\u5916\u90e8\u4e00\u5b9a\u6709\u4e00\u4e2a\u540c\u6b65\u7684\u76ee\u5f55\u3002 \u9000\u51fa\u5bb9\u5668","title":"\u5bb9\u5668\u5185\u90e8\u521b\u5efa\u6587\u4ef6"},{"location":"Docker/#_100","text":"\u67e5\u770b\u8fd0\u884c\u5bb9\u5668 docker ps -a \u67e5\u770b\u5bb9\u5668\u8be6\u7ec6\u4fe1\u606f docker inspect id \u8fdb\u5165\u6302\u8f7d\u8def\u5f84\uff0c\u67e5\u770b\u672c\u5730\u6570\u636e\u662f\u5426\u88ab\u540c\u6b65\u8fc7\u6765\u3002 \u6d4b\u8bd5\u4e00\u4e0b\u521a\u624d\u7684\u6587\u4ef6\u662f\u5426\u540c\u6b65\u51fa\u53bb\u4e86! \u8fd9\u79cd\u65b9\u5f0f\u6211\u4eec\u672a\u6765\u4f7f\u7528\u7684\u5341\u5206\u591a\uff0c\u56e0\u4e3a\u6211\u4eec\u901a\u5e38\u4f1a\u6784\u5efa\u81ea\u5df1\u7684\u955c\u50cf! \u5047\u8bbe\u6784\u5efa\u955c\u50cf\u65f6\u5019\u6ca1\u6709\u6302\u8f7d\u5377\uff0c\u8981\u624b\u52a8\u955c\u50cf\u6302\u8f7d-v\u5377\u540d\uff1a\u5bb9\u5668\u5185\u8def\u5f84!|","title":"\u5bbf\u4e3b\u673a\u67e5\u770b"},{"location":"Docker/#_101","text":"\u5bb9\u5668\u95f4\u6570\u636e\u540c\u6b65 \u542f\u52a83\u4e2a\u5bb9\u5668\uff0c\u901a\u8fc7\u6211\u4eec\u521a\u624d\u81ea\u5df1\u6784\u5efa\u7684\u955c\u50cf\u542f\u52a8\u3002","title":"\u6570\u636e\u5377\u5bb9\u5668"},{"location":"Docker/#_102","text":"docker images","title":"\u67e5\u770b\u5bb9\u5668"},{"location":"Docker/#docker01","text":"docker run -it --name docker01 lwemwu/centos Ctrl+P+Q\u9000\u51fa\u5bb9\u5668 \u7ee7\u7eed\u8fd0\u884c","title":"\u542f\u52a8Docker01"},{"location":"Docker/#docker02","text":"docker run -it --name docker02 --volumes-from docker01 lwemwu/centos","title":"\u542f\u52a8Docker02"},{"location":"Docker/#_103","text":"\u5728Docker01\u4e2d\u589e\u52a0\u6587\u4ef6docker01,\u5230Docker02\u67e5\u770b\u6570\u636e\u540c\u6b65\u3002 docker attach docker01(ID) \u8fdb\u5165docker02\u67e5\u770b\u3002 docker01\u521b\u5efa\u7684\u6587\u4ef6\u5728docker02\u4e0a\u540c\u6b65\u4e86\u8fc7\u6765\u3002","title":"\u6d4b\u8bd5\u540c\u6b65"},{"location":"Docker/#docker03","text":"docker run -it --name docker03 --volumes-from docker01 lwemwu/centos \u5230docker02\u67e5\u770bvolume01\u6570\u636e\u3002 \u603b\u7ed3\uff1a\u901a\u8fc7--volumes-from\u53ef\u4ee5\u5b9e\u73b0\u5bb9\u5668\u95f4\u7684\u6570\u636e\u5171\u4eab\u3002","title":"\u542f\u52a8Docker03"},{"location":"Docker/#_104","text":"docker ps -a \u5220\u9664\u5bb9\u5668 docker rm -f ID docker01\u5df2\u88ab\u5220\u9664 \u8fdb\u5165docker02\u3001docker01\u67e5\u770b\u6570\u636e\u662f\u5426\u8fd8\u5728\uff1f \u6570\u636e\u672a\u4e22\u5931\uff0c\u53ef\u4ee5\u8bbf\u95ee\u3002","title":"\u5220\u9664\u5bb9\u5668\u6d4b\u8bd5\u6570\u636e"},{"location":"Docker/#mysql_1","text":"docker run -d -p 3310:3306 -v /etc/mysql/conf.d -v var/lib/mysql --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7 docker run -d -p 3310:3306 -e MYSQL_ROOT_PASSWORD=123456 --name mysql02 --volumes-from mysql01 mysql:5.7 \u5b9e\u73b0\u5bb9\u5668\u6570\u636e\u540c\u6b65 \u7ed3\u8bba\uff1a \u5bb9\u5668\u4e4b\u95f4\u914d\u7f6e\u4fe1\u606f\u7684\u4f20\u9012\uff0c\u6570\u636e\u5377\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u4e00\u76f4\u6301\u7eed\u5230\u6ca1\u6709\u5bb9\u5668\u4f7f\u7528\u4e3a\u6b62\u3002 \u4f46\u662f\u4e00\u65e6\u4f60\u6301\u4e45\u5316\u5230\u4e86\u672c\u5730\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u672c\u5730\u7684\u6570\u636e\u662f\u4e0d\u4f1a\u5220\u9664\u7684!","title":"\u591a\u4e2amysql\u6570\u636e\u540c\u6b65"},{"location":"Docker/#docker-file","text":"docker file\u662f\u7528\u6765\u6784\u5efadok cer\u955c\u50cf\u7684\u6587\u4ef6!\u547d\u4ee4\u53c2\u6570\u811a\u672c! \u6784\u5efa\u6b65\u9aa4\uff1a 1\u3001\u7f16\u5199\u4e00\u4e2adocker file\u6587\u4ef6 2\u3001docker build\u6784\u5efa\u6210\u4e3a\u4e00\u4e2a\u955c\u50cf 3\u3001docker run\u8fd0\u884c\u955c\u50cf 4\u3001docker push\u53d1\u5e03\u955c\u50cf(Docker Hub\u3001\u963f\u91cc\u4e91\u955c\u50cf\u4ed3\u5e93!) Docker Hub\u641c\u7d22\u955c\u50cfcentos \u9009\u62e91\u4e2a\u7248\u672c\u70b9\u51fb\u540e\u8fdb\u5165Github \u8df3\u8f6c\u540e\u7684\u8def\u5f84\u5c31\u662fDockerfile FROM scratch ADD centos-7-x86_64-docker.tar.xz / LABEL \\ org.label-schema.schema-version=\"1.0\" \\ org.label-schema.name=\"CentOS Base Image\" \\ org.label-schema.vendor=\"CentOS\" \\ org.label-schema.license=\"GPLv2\" \\ org.label-schema.build-date=\"20200809\" \\ org.opencontainers.image.title=\"CentOS Base Image\" \\ org.opencontainers.image.vendor=\"CentOS\" \\ org.opencontainers.image.licenses=\"GPL-2.0-only\" \\ org.opencontainers.image.created=\"2020-08-09 00:00:00+01:00\" CMD [\"/bin/bash\"] \u5f88\u591a\u5b98\u65b9\u955c\u50cf\u90fd\u662f\u57fa\u7840\u5305\uff0c\u5f88\u591a\u529f\u80fd\u6ca1\u6709\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u81ea\u5df1\u642d\u5efa\u81ea\u5df1\u7684\u955c\u50cf! \u5b98\u65b9\u65e2\u7136\u53ef\u4ee5\u5236\u4f5c\u955c\u50cf\uff0c\u90a3\u6211\u4eec\u4e5f\u53ef\u4ee5!","title":"Docker File\u4ecb\u7ecd"},{"location":"Docker/#docker-file_1","text":"\u57fa\u7840\u77e5\u8bc6\uff1a 1\u3001\u6bcf\u4e2a\u4fdd\u7559\u5173\u952e\u5b57(\u6307\u4ee4)\u90fd\u662f\u5fc5\u987b\u662f\u5927\u5199\u5b57\u6bcd 2\u3001\u6267\u884c\u4ece\u4e0a\u5230\u4e0b\u987a\u5e8f\u6267\u884c 3\u3001#\u8868\u793a\u6ce8\u91ca 4\u3001\u6bcf\u4e00\u4e2a\u6307\u4ee4\u90fd\u4f1a\u521b\u5efa\u63d0\u4ea4\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42\uff0c\u5e76\u63d0\u4ea4! dockerfile\u662f\u9762\u5411\u5f00\u53d1\u7684\uff0c\u6211\u4eec\u4ee5\u540e\u8981\u53d1\u5e03\u9879\u76ee\uff0c\u505a\u955c\u50cf\uff0c\u5c31\u9700\u8981\u7f16\u5199dockerfile\u6587\u4ef6\uff0c \u8fd9\u4e2a\u6587\u4ef6\u5341\u5206\u7b80\u5355! Docker\u955c\u50cf\u9010\u6e10\u6210\u4e3a\u4f01\u4e1a\u4ea4\u4ed8\u7684\u6807\u51c6\uff0c\u5fc5\u987b\u8981\u638c\u63e1! \u6b65\u9aa4\uff1a DockerFile\uff1a\u6784\u5efa\u6587\u4ef6\uff0c \u5b9a\u4e49\u4e86\u4e00\u5207\u7684\u6b65\u9aa4\uff0c \u6e90\u4ee3\u7801 Dockerlmages\uff1a\u901a\u8fc7Docker File\u6784\u5efa\u751f\u6210\u7684\u955c\u50cf\uff0c \u6700\u7ec8\u53d1\u5e03\u548c\u8fd0\u884c\u7684\u4ea7\u54c1! Docker\u5bb9\u5668\uff1a\u5bb9\u5668\u5c31\u662f\u955c\u50cf\u8fd0\u884c\u8d77\u6765\u63d0\u4f9b\u670d\u52a1\u7684 \u5f00\u53d1\uff0c\u90e8\u7f72\uff0c\u8fd0\u7ef4\u3002\u3002\u3002\u7f3a\u4e00\u4e0d\u53ef!","title":"Docker File\u6784\u5efa\u8fc7\u7a0b"},{"location":"Docker/#docker-file_2","text":"FROM #\u57fa\u7840\u955c\u955c\u50cf\uff0c\u4e00\u5207\u4ece\u8fd9\u91cc\u5f00\u59cb\u6784\u5efa MAINTAINER #\u955c\u50cf\u662f\u8c01\u5199\u7684\uff0c\u59d3\u540d+\u90ae\u7bb1 RUN #\u955c\u50cf\u6784\u5efa\u7684\u65f6\u5019\u9700\u8981\u8fd0\u884c\u7684\u547d\u4ee4 ADD #\u6b65\u9aa4\uff1atomcat\u955c\u50cf\uff0c \u8fd9\u4e2atomcat\u538b\u7f29\u5305!\u6dfb\u52a0\u5185\u5bb9 WORKDIR #\u955c\u50cf\u7684\u5de5\u4f5c\u76ee\u5f55 VOLUME #\u6302\u8f7d\u7684\u76ee\u5f55 EXPOSE #\u66b4\u9732\u7aef\u53e3\u914d\u7f6e CMD #\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u751f\u6548\uff0c\u53ef\u88ab\u66ff\u4ee3 ENTRYPOINT #\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4 ON BUILD #\u5f53\u6784\u5efa\u4e00\u4e2a\u88ab\u7ee7\u627fDocker File\u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u8fd0\u884cON BUILD \u7684\u6307\u4ee4\u3002\u89e6\u53d1\u6307\u4ee4\u3002 COPY #\u7c7b\u4f3cADD\uff0c \u5c06\u6211\u4eec\u6587\u4ef6\u62f7\u8d1d\u5230\u955c\u50cf\u4e2d ENV #\u6784\u5efa\u7684\u65f6\u5019\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf!","title":"Docker File\u6307\u4ee4"},{"location":"Docker/#_105","text":"Docker Hub\u4e2d99%\u955c\u50cf\u90fd\u662f\u4ece\u8fd9\u4e2a\u57fa\u7840\u955c\u50cf\u8fc7\u6765\u7684FROM scratch\uff0c \u7136\u540e\u914d\u7f6e\u9700\u8981\u7684\u8f6f\u4ef6\u548c\u914d\u7f6e\u6765\u8fdb\u884c\u7684\u6784\u5efa\u3002","title":"\u5b9e\u6218\u6d4b\u8bd5"},{"location":"Docker/#_106","text":"\u9ed8\u8ba4\u7684centos\u955c\u50cf\u53ea\u5305\u542b\u4e86\u6700\u57fa\u7840\u7684\u4e1c\u897f","title":"\u6784\u5efa\u81ea\u5df1\u7684\u955c\u50cf"},{"location":"Docker/#dockerfile_2","text":"\u521b\u5efa/data\u76ee\u5f55\uff0c\u518d\u521b\u5efadockerfile\u76ee\u5f55\uff0c\u7528\u6765\u4e13\u95e8\u5b58\u653edockerfile\u6587\u4ef6\u3002 \u7f16\u5199\u4e00\u4e2adockerfile\u6587\u4ef6\uff0c\u547d\u540d\u4e3adockerfile-centos FROM centos MAINTAINER lwenwu<lwenwu1999@qq.com> ENV MYPATH /usr/local WORKDIR $MYPATH RUN yum -y install vim RUN yum -y install net-tools EXPOSE 80 CMD echo $MYPATH CMD echo \"-------end--------\" CMD /bin/bash","title":"\u7f16\u5199dockerfile\u914d\u7f6e\u6587\u4ef6"},{"location":"Docker/#dockerfile_3","text":"docker build -f /data/dockerfile/dockerfile-centos -t mycentos:0.1 . [root@localhost dockerfile]# docker build -f /data/dockerfile/dockerfile-centos -t mycentos:0.1 . Sending build context to Docker daemon 2.048kB #\u53d1\u9001build\u4fe1\u606f Step 1/10 : FROM centos ---> 0d120b6ccaa8 #\u62ff\u5230\u57fa\u7840\u955c\u50cf\uff0c\u8ddfdocker images\u4e0b\u7684ID\u76f8\u540c\uff0c\u590d\u7528\u57fa\u7840\u955c\u50cf Step 2/10 : MAINTAINER lwenwu<lwenwu1999@qq.com> #\u7ef4\u62a4\u8005\u4fe1\u606f ---> Running in 26a8e7585dcd Removing intermediate container 26a8e7585dcd ---> df741b928f75 Step 3/10 : ENV MYPATH /usr/local ---> Running in 7b723400348d Removing intermediate container 7b723400348d ---> fc0f488845c1 Step 4/10 : WORKDIR $MYPATH ---> Running in 94198e6a23cb Removing intermediate container 94198e6a23cb ---> df3275a301cf Step 5/10 : RUN yum -y install vim #\u4e0b\u8f7dvim ---> Running in 48e8afc0df08 CentOS-8 - AppStream 605 kB/s | 5.8 MB 00:09 CentOS-8 - Base 2.2 MB/s | 2.2 MB 00:00 CentOS-8 - Extras 10 kB/s | 8.1 kB 00:00 Dependencies resolved. ================================================================================ Package Arch Version Repository Size ================================================================================ Installing: vim-enhanced x86_64 2:8.0.1763-13.el8 AppStream 1.4 M Installing dependencies: gpm-libs x86_64 1.20.7-15.el8 AppStream 39 k vim-common x86_64 2:8.0.1763-13.el8 AppStream 6.3 M vim-filesystem noarch 2:8.0.1763-13.el8 AppStream 48 k which x86_64 2.21-12.el8 BaseOS 49 k Transaction Summary ================================================================================ Install 5 Packages Total download size: 7.8 M Installed size: 31 M Downloading Packages: (1/5): gpm-libs-1.20.7-15.el8.x86_64.rpm 51 kB/s | 39 kB 00:00 (2/5): vim-filesystem-8.0.1763-13.el8.noarch.rp 314 kB/s | 48 kB 00:00 (3/5): vim-enhanced-8.0.1763-13.el8.x86_64.rpm 1.3 MB/s | 1.4 MB 00:01 (4/5): which-2.21-12.el8.x86_64.rpm 314 kB/s | 49 kB 00:00 (5/5): vim-common-8.0.1763-13.el8.x86_64.rpm 1.8 MB/s | 6.3 MB 00:03 -------------------------------------------------------------------------------- Total 1.7 MB/s | 7.8 MB 00:04 #\u4e0b\u8f7d\u8b66\u544a\uff0c\u6ca1\u4ec0\u4e48\u95ee\u9898 warning: /var/cache/dnf/AppStream-02e86d1c976ab532/packages/gpm-libs-1.20.7-15.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY CentOS-8 - AppStream 158 kB/s | 1.6 kB 00:00 Importing GPG key 0x8483C65D: Userid : \"CentOS (CentOS Official Signing Key) <security@centos.org>\" Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D From : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial Key imported successfully Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : which-2.21-12.el8.x86_64 1/5 Installing : vim-filesystem-2:8.0.1763-13.el8.noarch 2/5 Installing : vim-common-2:8.0.1763-13.el8.x86_64 3/5 Installing : gpm-libs-1.20.7-15.el8.x86_64 4/5 Running scriptlet: gpm-libs-1.20.7-15.el8.x86_64 4/5 Installing : vim-enhanced-2:8.0.1763-13.el8.x86_64 5/5 Running scriptlet: vim-enhanced-2:8.0.1763-13.el8.x86_64 5/5 Running scriptlet: vim-common-2:8.0.1763-13.el8.x86_64 5/5 Verifying : gpm-libs-1.20.7-15.el8.x86_64 1/5 Verifying : vim-common-2:8.0.1763-13.el8.x86_64 2/5 Verifying : vim-enhanced-2:8.0.1763-13.el8.x86_64 3/5 Verifying : vim-filesystem-2:8.0.1763-13.el8.noarch 4/5 Verifying : which-2.21-12.el8.x86_64 5/5 Installed: gpm-libs-1.20.7-15.el8.x86_64 vim-common-2:8.0.1763-13.el8.x86_64 vim-enhanced-2:8.0.1763-13.el8.x86_64 vim-filesystem-2:8.0.1763-13.el8.noarch which-2.21-12.el8.x86_64 Complete! #\u7f16\u8bd1\u6210\u529f Removing intermediate container 48e8afc0df08 ---> 3e3387c3a894 Step 6/10 : RUN yum -y install net-tools #\u4e0b\u8f7dnet-tools ---> Running in 90f391b8fe89 Last metadata expiration check: 0:00:12 ago on Thu Nov 5 13:18:48 2020. Dependencies resolved. ================================================================================ Package Architecture Version Repository Size ================================================================================ Installing: net-tools x86_64 2.0-0.51.20160912git.el8 BaseOS 323 k Transaction Summary ================================================================================ Install 1 Package Total download size: 323 k Installed size: 1.0 M Downloading Packages: net-tools-2.0-0.51.20160912git.el8.x86_64.rpm 1.4 MB/s | 323 kB 00:00 -------------------------------------------------------------------------------- Total 184 kB/s | 323 kB 00:01 Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : net-tools-2.0-0.51.20160912git.el8.x86_64 1/1 Running scriptlet: net-tools-2.0-0.51.20160912git.el8.x86_64 1/1 Verifying : net-tools-2.0-0.51.20160912git.el8.x86_64 1/1 Installed: net-tools-2.0-0.51.20160912git.el8.x86_64 Complete! #\u53c8\u7f16\u8bd1\u6210\u529f Removing intermediate container 90f391b8fe89 ---> da4ad4cd2938 Step 7/10 : EXPOSE 80 ---> Running in 96f829f08850 Removing intermediate container 96f829f08850 ---> 3d2d0365e5c7 Step 8/10 : CMD echo $MYPATH ---> Running in 00344184eafe Removing intermediate container 00344184eafe ---> 005ee0708a17 Step 9/10 : CMD echo \"-------end--------\" ---> Running in c7019a9bcfd9 Removing intermediate container c7019a9bcfd9 ---> c964b172bf9e Step 10/10 : CMD /bin/bash ---> Running in 9900c5470588 Removing intermediate container 9900c5470588 ---> f804e311e9aa Successfully built f804e311e9aa Successfully tagged mycentos:0.1 #\u6784\u5efa\u5b8c\u6210 [root@localhost dockerfile]#","title":"\u901a\u8fc7dockerfile\u6587\u4ef6\u6784\u5efa\u955c\u50cf"},{"location":"Docker/#_107","text":"\u67e5\u770b\u6784\u5efa\u7684\u955c\u50cf \u8fd0\u884c\u6784\u5efa\u7684\u5bb9\u5668 docker run -it mycentos:0.1 #\u4f7f\u7528\u955c\u50cf\u540d\u79f0\u8981\u52a0\u7248\u672c\u53f7,\u5426\u5219\u4f1a\u4e0b\u8f7d\u6700\u65b0\u7684\u955c\u50cf \u6784\u5efa\u7684\u955c\u50cfvim ifconfig\u547d\u4ee4\u53ef\u4ee5\u4f7f\u7528\uff0c\u5de5\u4f5c\u76ee\u5f55\u4e3a\u914d\u7f6e\u7684/usr/local","title":"\u6d4b\u8bd5\u8fd0\u884c"},{"location":"Docker/#_108","text":"docker history ID","title":"\u67e5\u770b\u955c\u50cf\u6784\u5efa\u5386\u53f2"},{"location":"Docker/#_109","text":"\u901a\u8fc7\u67e5\u770b\u5b98\u65b9\u955c\u50cf\u7684\u6784\u5efa\u5386\u53f2\u53ef\u4ee5\u5b66\u4e60\u955c\u50cf\u662f\u5982\u4f55\u6784\u5efa\u7684\u3002","title":"\u67e5\u770b\u5b98\u65b9\u955c\u50cf\u662f\u5982\u4f55\u6784\u5efa\u7684"},{"location":"Docker/#cmdentrypoint","text":"CMD #\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u751f\u6548\uff0c\u53ef\u88ab\u66ff\u4ee3 ENTRYPOINT #\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4","title":"CMD\u548cENTRYPOINT\u533a\u522b"},{"location":"Docker/#cmd","text":"\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u6267\u884c \u8fdb\u5165dockerfile\u76ee\u5f55\uff0c\u7f16\u5199dockerfile-cmd-test\u6587\u4ef6 \u6784\u5efa\u955c\u50cf docker build -f dockerfile-cmd-test -t cmdtest . \u6267\u884c\u955c\u50cf\uff0cls -a\u547d\u4ee4\u751f\u6548 docker run ID \u8ffd\u52a0-l\u547d\u4ee4\u53c2\u6570\u6d4b\u8bd5, docker: Error response from daemon: OCI runtime create failed: container_linux.go:349: starting container process caused \"exec: \\\"-l\\\": executable file not found in $PATH\": unknown. \u8ffd\u52a0\u7684-l\u547d\u4ee4\u66ff\u6362\u4e86CMD[\"ls\"\"-a\"]\u547d\u4ee4\uff0c-l\u4e0d\u662f\u547d\u4ee4\uff0c\u6240\u4ee5\u62a5\u9519\u3002 \u547d\u4ee4\u88ab\u66ff\u6362","title":"\u6d4b\u8bd5CMD"},{"location":"Docker/#entrypoint","text":"\u8fdb\u5165dockerfile\u76ee\u5f55\uff0c\u7f16\u5199dockerfile-entrypoint-test\u6587\u4ef6 \u6784\u5efa\u955c\u50cf docker build -f dockerfile-entrypoint-test -t entrytest . \u6267\u884c\u955c\u50cf\uff0cls -a\u547d\u4ee4\u751f\u6548 docker run ID \u8ffd\u52a0-l\u547d\u4ee4\u53c2\u6570\u6d4b\u8bd5 docker run 4c60442a1328 -l \u8ffd\u52a0-l\u751f\u6548 \u4e0d\u4f1a\u66ff\u6362\u6389dockerfile\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u3002","title":"\u6d4b\u8bd5ENTRYPOINT"},{"location":"Docker/#tomcat_1","text":"","title":"\u5b9e\u6218Tomcat\u955c\u50cf"},{"location":"Docker/#tomcat_2","text":"#TomCat\u76ee\u5f55\u7ed3\u6784\u8bf4\u660e\uff1a bin\uff1a\u8be5\u76ee\u5f55\u5b58\u653eTomCat\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e38\u7528\u7684\u6709startup.bat\u548cshutdown.bat\u6587\u4ef6\uff0cstartup.bat\u7528\u6765\u542f\u52a8Tomcat\uff0cshutdown.bat\u7528\u6765\u505c\u6b62Tomcat\uff1b conf\uff1aTomCat\u670d\u52a1\u5668\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u8981\u6709server.xml\uff08\u914d\u7f6e\u670d\u52a1\u5668\u4fe1\u606f\uff0c\u5982\u4fee\u6539\u7aef\u53e3\u53f7\uff0c\u6dfb\u52a0\u865a\u62df\u4e3b\u673a\u7b49\uff09\u3001tomcat-users.xml\uff08TomCat\u7528\u6237\u4e0e\u89d2\u8272\u4fe1\u606f\uff0c\u5bf9TomCat\u540e\u53f0\u7ba1\u7406\uff09\u548cweb.xml\uff08Web\u9879\u76ee\u90e8\u7f72\u63cf\u8ff0\u7b26\u6587\u4ef6\uff09\uff1b lib\uff1aTomcat\u6240\u9700\u7684jar\u5305\uff1b logs\uff1a\u5b58\u653eTomCat\u7684\u65e5\u5fd7\u6587\u4ef6\uff1b temp\uff1a\u5b58\u653eTomcat\u7684\u4e34\u65f6\u6587\u4ef6\uff1b webapps\uff1a\u5b58\u653e\u6240\u90e8\u7f72\u7684Web\u9879\u76ee\uff1b work\uff1a\u5b58\u653eWeb\u9879\u76ee\u90e8\u7f72\u8fd0\u884c\u65f6\u751f\u6210\u7684\u6587\u4ef6\uff0c\u5982java\u548cclass\u6587\u4ef6\uff1b RUNNING.txt\uff1a\u53ef\u67e5\u770b\u5982\u4f55\u914d\u7f6eTomCat\u73af\u5883\u53d8\u91cf\u3002 #TomCat\u914d\u7f6e\u73af\u5883\u53d8\u91cf Tomcat\u662fJava\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e0d\u76f4\u63a5\u4f7f\u7528\u73af\u5883\u53d8\u91cf\u3002 \u73af\u5883\u53d8\u91cf\u7531Tomcat\u542f\u52a8\u811a\u672c\u4f7f\u7528\u3002\u811a\u672c\u4f7f\u7528 \u73af\u5883\u53d8\u91cf\u6765\u51c6\u5907\u542f\u52a8Tomcat\u7684\u547d\u4ee4\u3002 \uff083.1\uff09\u8bbe\u7f6eCATALINA_HOME\uff08\u5fc5\u586b\uff09\u548cCATALINA_BASE\uff08\u53ef\u9009\uff09 CATALINA_HOME\u73af\u5883\u53d8\u91cf\u5e94\u8bbe\u7f6e\u4e3a Tomcat\u201c\u4e8c\u8fdb\u5236\u201d\u5206\u53d1\u7684\u6839\u76ee\u5f55\u3002 Tomcat\u542f\u52a8\u811a\u672c\u5177\u6709\u4e00\u4e9b\u903b\u8f91\u6765\u8bbe\u7f6e\u6b64\u53d8\u91cf \u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u6839\u636e\u542f\u52a8\u811a\u672c\u7684\u4f4d\u7f6e\u81ea\u52a8\u8fdb\u884c \u5728* nix\u4e2d\u548cWindows\u7684\u5f53\u524d\u76ee\u5f55\u4e2d\u3002\u8be5\u903b\u8f91\u53ef\u80fd\u4e0d\u8d77\u4f5c\u7528\u5728\u6240\u6709\u60c5\u51b5\u4e0b\uff0c\u5efa\u8bae\u663e\u5f0f\u8bbe\u7f6e\u53d8\u91cf\u3002 CATALINA_BASE\u73af\u5883\u53d8\u91cf\u6307\u5b9a\u6839\u7684\u4f4d\u7f6e Tomcat\u201c\u6d3b\u52a8\u914d\u7f6e\u201d\u7684\u76ee\u5f55\u3002\u5b83\u662f\u53ef\u9009\u7684\u3002\u5b83\u9ed8\u8ba4\u7b49\u4e8eCATALINA_HOME\u3002 #jdk\u76ee\u5f55\u7ed3\u6784\u8bf4\u660e bin\u76ee\u5f55\uff1aJava\u5de5\u5177\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5305\u62ec: java\u3001Java\u7f16\u8bd1\u5668javac\u3001\u53cd\u7f16\u8bd1.class\u6587\u4ef6javap\u3001\u5bc6\u94a5\u7ba1\u7406\u5de5\u5177keytool\u3001Java\u6587\u6863\u5de5\u5177javadoc\u7b49\u3002 COPYRIGHT\u6587\u4ef6\uff1a\u7248\u6743\u4fe1\u606f\u3002 db\u76ee\u5f55\uff1aJava\u5b9e\u73b0\u7684\u6570\u636e\u5e93\u3002 include\u76ee\u5f55\uff1a.h\u5934\u6587\u4ef6\uff0cC\u8bed\u8a00\u5f00\u53d1\u65f6\u7528\u5230\u7684\u5934\u6587\u4ef6\u3002\u6bd4\u5982jni.h\u662f\u5f00\u53d1jni\u7a0b\u5e8f\u65f6\u5fc5\u987b\u5f15\u7528\u7684\u5934\u6587\u4ef6\u3002 lib\u76ee\u5f55\uff1a Java\u7c7b\u5e93\uff0c\u6211\u4eec\u7ecf\u5e38\u770b\u5230\u7684dt.jar\u548ctools.jar\u5c31\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u3002 src.zip\u6587\u4ef6\uff1aJava\u7c7b\u5e93\u6e90\u7801\uff0c\u5305\u62ec\u4e86rt.jar\u5e93\u4e2d\u7684\u5173\u952e\u90e8\u5206\uff1b\u9664\u4e86Java\u7c7b\u5e93\uff0c\u8fd8\u5305\u542b\u4e86\u542f\u52a8\u5668\uff08launcher\uff09\u7684\u6e90\u7801\uff08C\u8bed\u8a00\u5b9e\u73b0\uff09\u3002 jre\u76ee\u5f55\uff1aJava\u8fd0\u884c\u73af\u5883\u3002 #jdk\u914d\u7f6e\u73af\u5883\u53d8\u91cf JDK\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u9996\u5148\u8981\u914d\u7f6eJAVA_HOME\u53d8\u91cf\uff0cJAVA_HOME\u53d8\u91cf\u6307\u5411JDK\u7684\u5b89\u88c5\u76ee\u5f55\uff0c\u914d\u7f6eJAVA_HOME\u4e3b\u8981\u76ee\u7684\u662f\uff1a \uff081\uff09\u914d\u7f6e\u5176\u5b83JDK\u73af\u5883\u53d8\u91cf\u65f6\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u5f15\u7528JDK\u7684\u5b89\u88c5\u76ee\u5f55\u3002 \uff082\uff09JDK\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u9700\u8981\u914d\u7f6ePath\u73af\u5883\u53d8\u91cf\uff0c\u4ee5\u65b9\u4fbf\u5f00\u53d1\u8005\u8fd0\u884cJava\u7f16\u8bd1\u5668\u7b49\u7a0b\u5e8f\u3002\u5f00\u53d1\u8005\u4e0d\u7ba1\u662f\u7528\u96c6\u6210\u5f00\u53d1\u5de5\u5177\u8fd8\u662f\u6587\u672c\u7f16\u8f91\u5de5\u5177\u7f16\u5199Java\u7a0b\u5e8f\u65f6\uff0c\u5f53\u96c6\u6210\u5f00\u53d1\u5de5\u5177\u8c03\u7528Java\u7f16\u8bd1\u5668\u6216\u7528\u6237\u5728Windows \u547d\u4ee4\u884c\u7a97\u53e3\u8f93\u5165\u547d\u4ee4\u8fd0\u884cJava\u7f16\u8bd1\u5668\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981\u4ecePath\u73af\u5883\u53d8\u91cf\u83b7\u53d6Java\u7f16\u8bd1\u5668\u7b49\u7a0b\u5e8f\u6240\u5728\u76ee\u5f55\u5e76\u542f\u52a8\u8fd0\u884c\u3002\u4f8b\u5982\uff1a\u5047\u8bbeJava\u96c6\u6210\u5f00\u53d1\u5de5\u5177\u6216Windows \u547d\u4ee4\u884c\u7a97\u53e3\u7684\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u548cJava\u7f16\u8bd1\u5668\u6240\u5728\u76ee\u5f55\u4e0d\u540c\uff0c\u5f00\u53d1\u8005\u53c8\u6ca1\u6709\u5728path\u73af\u5883\u53d8\u91cf\u4e2d\u914d\u7f6eJava\u7f16\u8bd1\u5668\u6240\u5728\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u627e\u4e0d\u5230Java\u7f16\u8bd1\u5668\u7a0b\u5e8f\uff0c\u4e5f\u5c31\u65e0\u6cd5\u542f\u52a8Java\u7f16\u8bd1\u5668\u7a0b\u5e8f\u8fdb\u884c\u7f16\u8bd1\u5de5\u4f5c\u3002 \uff083\uff09Java\u6e90\u4ee3\u7801\u88ab\u88ab\u7f16\u8bd1\u540e\u5f62\u6210\u6269\u5c55\u540d\u4e3a\u201c.class\u201d\u7684\u6587\u4ef6\uff0cJVM\uff08Java\u865a\u62df\u673a\uff09\u8fd0\u884cJava \u7a0b\u5e8f\u65f6\uff0c\u9700\u8981\u52a0\u8f7d\u5df2\u88ab\u7f16\u8bd1\u7684\u201c.class\u201d\u7684\u6587\u4ef6\u4ee5\u53ca\u8be5\u201c.class\u201d\u6587\u4ef6\u5bfc\u5165\u7684\u5176\u5b83\u7c7b\uff08\u5982Java\u7684System\u7c7b\uff09\u3002\u8bbe\u7f6eCLASSPATH\u7684\u76ee\u7684\u5c31\u662f\u8ba9JVM\u80fd\u591f\u901a\u8fc7CLASSPATH\u8bbe\u7f6e\u7684\u8def\u5f84\u627e\u5230\u8fd9\u4e9b\u7c7b\u6587\u4ef6 ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar \u544a\u8bc9jvm\u8981\u4f7f\u7528\u6216\u6267\u884c\u7684class\u653e\u5728\u4ec0\u4e48\u8def\u5f84\u4e0a\uff0c\u4fbf\u4e8eJVM\u52a0\u8f7dclass\u6587\u4ef6\uff0c.;\u8868\u793a\u5f53\u524d\u8def\u5f84\uff0ctools.jar\u548cdt.jar\u4e3a\u7c7b\u5e93\u8def\u5f84\u3002 CLASSPATH\u8be6\u89e3\uff1a tools.jar \u5de5\u5177\u7c7b\u5e93(\u7f16\u8bd1\u548c\u8fd0\u884c\u7b49)\uff0c\u5b83\u8ddf\u6211\u4eec\u7a0b\u5e8f\u4e2d\u7528\u5230\u7684\u57fa\u7840\u7c7b\u5e93\u6ca1\u6709\u5173\u7cfb\u3002\u6211\u4eec\u6ce8\u610f\u5230\u5728Path\u4e2d\u53d8\u91cf\u503cbin\u76ee\u5f55\u4e0b\u7684\u5404\u4e2aexe\u5de5\u5177\u7684\u5927\u5c0f\u90fd\u5f88\u5c0f\uff0c\u4e00\u822c\u90fd\u572827KB\u5de6\u53f3\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u5b9e\u9645\u4e0a\u4ec5\u4ec5\u76f8\u5f53\u4e8e\u662f\u4e00\u5c42\u4ee3\u7801\u7684\u5305\u88c5\uff0c\u8fd9\u4e9b\u5de5\u5177\u7684\u5b9e\u73b0\u6240\u8981\u7528\u5230\u7684\u7c7b\u5e93\u90fd\u5728tools.jar\u4e2d\uff0c\u7528\u538b\u7f29\u8f6f\u4ef6\u6253\u5f00tools.jar,\u4f60\u4f1a\u53d1\u73b0\u6709\u5f88\u591a\u6587\u4ef6\u662f\u548cbin\u76ee\u5f55\u4e0b\u7684exe\u5de5\u5177\u76f8\u5bf9\u6027\u7684\uff0c\u67e5\u770b\u56fe\u4e00\u3002\u5f53\u7136\uff0c\u5982\u679ctools.jar\u7684\u529f\u80fd\u53ea\u6709\u8fd9\u4e9b\u7684\u8bdd\uff0c\u90a3\u4e48\u6211\u4eec\u6839\u672c\u4e0d\u7528\u628a\u5b83\u52a0\u5165\u5230CLASSPATH\u53d8\u91cf\u4e2d\uff0c\u56e0\u4e3abin\u76ee\u5f55\u4e0b\u7684\u5de5\u5177\u81ea\u5df1\u53ef\u4ee5\u5b8c\u6210\u5bf9\u8fd9\u4e9b\u7c7b\u5e93\u7684\u8c03\u7528\uff0c\u56e0\u6b64tools.jar\u5e94\u8be5\u8fd8\u6709\u5176\u4ed6\u7684\u529f\u80fd\u3002\u5728\u91cc\u9762\u8fd8\u53ef\u4ee5\u770b\u5230\u6709Applet\u548cRMI\u7b49\u76f8\u5173\u7684\u6587\u4ef6\uff0c\u56e0\u6b64tools.jar\u5e94\u8be5\u8fd8\u662f\u8fdc\u7a0b\u8c03\u7528\u7b49\u5fc5\u987b\u7684jar\u5305\u3002tools.jar\u7684\u5176\u4ed6\u4f5c\u7528\u53ef\u4ee5\u67e5\u770b\u5176\u4ed6\u8d44\u6599\u3002 dt.jar \u8fd0\u884c\u73af\u5883\u7c7b\u5e93\uff0c\u4e3b\u8981\u662fSwing\u5305\uff0c\u8fd9\u4e00\u70b9\u901a\u8fc7\u7528\u538b\u7f29\u8f6f\u4ef6\u6253\u5f00dt.jar\u4e5f\u53ef\u4ee5\u770b\u5230\u3002\u5982\u679c\u5728\u5f00\u53d1\u65f6\u5019\u6ca1\u6709\u7528\u5230Swing\u5305\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e0d\u7528\u5c06dt.jar\u6dfb\u52a0\u5230CLASSPATH\u53d8\u91cf\u4e2d\u3002 CLASSPATH\u4e2d\u7684\u7c7b\u5e93\u662f\u7531Application ClassLoader\u6216\u8005\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u7c7b\u52a0\u8f7d\u5668\u6765\u52a0\u8f7d\u7684\uff0c\u8fd9\u91cc\u5f53\u7136\u4e0d\u80fd\u5305\u62ec\u57fa\u7840\u7c7b\u5e93\uff0c\u5982\u679c\u5305\u62ec\u57fa\u7840\u7c7b\u5e93\u7684\u8bdd\uff0c\u5e76\u7528\u4e24\u4e2a\u4e0d\u540c\u7684\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\u53bb\u52a0\u8f7d\u8be5\u57fa\u7840\u7c7b\uff0c\u90a3\u5b83\u5f97\u5230\u7684\u8be5\u57fa\u7840\u7c7b\u5c31\u4e0d\u662f\u552f\u4e00\u7684\u4e86\uff0c\u8fd9\u6837\u4fbf\u4e0d\u80fd\u4fdd\u8bc1Java\u7c7b\u7684\u5b89\u5168\u6027\u3002 \u57fa\u672c\u7c7b\u5e93\u548c\u6269\u5c55\u7c7b\u5e93rt.jar \u57fa\u672c\u7c7b\u5e93\u662f\u6240\u6709\u7684 import java.* \u5f00\u5934\u7684\u7c7b\uff0c\u5728 %JAVA_HOME%\\jre\\lib \u76ee\u5f55\u4e0b\uff08\u5982\u5176\u4e2d\u7684 rt.jar\u3001resource.jar \uff09\uff0c\u7c7b\u52a0\u8f7d\u673a\u5236\u63d0\u5230\uff0c\u8be5\u76ee\u5f55\u4e0b\u7684\u7c7b\u4f1a\u7531 Bootstrap ClassLoader \u81ea\u52a8\u52a0\u8f7d\uff0c\u5e76\u901a\u8fc7\u4eb2\u59d4\u6d3e\u6a21\u578b\u4fdd\u8bc1\u4e86\u57fa\u7840\u7c7b\u5e93\u53ea\u4f1a\u88abBootstrap ClassLoader\u52a0\u8f7d\uff0c\u8fd9\u4e5f\u5c31\u4fdd\u8bc1\u4e86\u57fa\u7840\u7c7b\u7684\u552f\u4e00\u6027\u3002 \u6269\u5c55\u7c7b\u5e93\u662f\u6240\u6709\u7684 import javax.* \u5f00\u5934\u7684\u7c7b\uff0c\u5728 %JAVA_HOME%\\jre\\lib\\ext \u76ee\u5f55\u4e0b\uff0c\u8be5\u76ee\u5f55\u4e0b\u7684\u7c7b\u662f\u7531Extension ClassLoader \u81ea\u52a8\u52a0\u8f7d\uff0c\u4e0d\u9700\u8981\u6211\u4eec\u6307\u5b9a\u3002","title":"TomCat\u76ee\u5f55\u7ed3\u6784\u8bf4\u660e"},{"location":"Docker/#_110","text":"\u51c6\u5907\u955c\u50cf\u6587\u4ef6\u3001tomcat\u538b\u7f29\u5305\u3001jdk\u538b\u7f29\u5305\u3002 apache-tomcat-9.0.39.tar jdk-8u271-linux-x64.tar","title":"\u51c6\u5907\u955c\u50cf\u6587\u4ef6"},{"location":"Docker/#dockerfile_4","text":"\u5b98\u65b9\u547d\u540d\uff1aDockerfile\uff0cbuild\u4f1a\u81ea\u52a8\u5bfb\u627e\u8fd9\u4e2a\u6587\u4ef6\uff0c\u5c31\u4e0d\u9700\u8981-f\u6307\u5b9a\u4e86\uff01 \u5bb9\u5668\u5185\u90e8/usr/local\u76ee\u5f55\u4e0b\u5c31\u4f1a\u770b\u5230readme.txt\u8fd9\u4e2a\u6587\u4ef6 \u5c06\u538b\u7f29\u5305\u6dfb\u52a0\u8fdb\u53bb \u8ddf\u89e3\u538b\u8def\u5f84 \u6ce8\uff1a\u7528ADD\u547d\u4ee4\u6dfb\u52a0\u8fdb\u53bb\u7684.tar.gz\u6587\u4ef6\u4f1a\u81ea\u52a8\u89e3\u538b \u5b89\u88c5\u57fa\u7840\u7684\u547d\u4ee4 \u8bbe\u7f6eENV\u73af\u5883\u53d8\u91cf \u8fdb\u53bb\u7684\u65f6\u5019\u5c31\u8fdb\u5165\u5230\u73af\u5883\u53d8\u91cf \u914d\u7f6e\u5de5\u4f5c\u76ee\u5f55 \u914d\u7f6eJAVA\u73af\u5883\u53d8\u91cf \u914d\u7f6eTomcat\u73af\u5883\u53d8\u91cf \u66b4\u9732\u7aef\u53e3 FROM centos MAINTAINER lwenwu<lwenwu1999@qq.com> COPY readme.txt /usr/local/readme.txt ADD jdk-8u271-linux-x64.tar.gz /usr/local ADD apache-tomcat-9.0.39.tar.gz /usr/local RUN yum -y install vim ENV MYPATH /usr/local WORKDIR $MYPATH ENV JAVA_HOME /usr/local/jdk1.8.0_271 ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.39 ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.39 ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin EXPOSE 8080 CMD /usr/local/apache-tomcat-9.0.39/bin/startup.sh && tail -F /usr/local/apache-tomcat-9.0.39/logs/catalina.out","title":"\u7f16\u5199Dockerfile\u6587\u4ef6"},{"location":"Docker/#_111","text":"docker build -t diytomcat .","title":"\u6784\u5efa\u955c\u50cf"},{"location":"Docker/#_112","text":"[root@localhost dockerfile]# docker build -t testtomcat . Sending build context to Docker daemon 154.4MB Step 1/15 : FROM centos latest: Pulling from library/centos 3c72a8ed6814: Pull complete Digest: sha256:76d24f3ba3317fa945743bb3746fbaf3a0b752f10b10376960de01da70685fbd Status: Downloaded newer image for centos:latest ---> 0d120b6ccaa8 Step 2/15 : MAINTAINER lwenwu<lwenwu1999@qq.com> ---> Running in 47b5eb8df66b Removing intermediate container 47b5eb8df66b ---> 49bcdfea4e32 Step 3/15 : COPY readme.txt /usr/local/readme.txt ---> 2a6be7198e44 Step 4/15 : ADD jdk-8u271-linux-x64.tar.gz /usr/local ---> 88e1646ee66d Step 5/15 : ADD apache-tomcat-9.0.39.tar.gz /usr/local ---> 259ee757cb6f Step 6/15 : RUN yum -y install vim ---> Running in 2d1b5f504afa CentOS-8 - AppStream 3.3 MB/s | 5.8 MB 00:01 CentOS-8 - Base 2.5 MB/s | 2.2 MB 00:00 CentOS-8 - Extras 13 kB/s | 8.1 kB 00:00 Dependencies resolved. ================================================================================ Package Arch Version Repository Size ================================================================================ Installing: vim-enhanced x86_64 2:8.0.1763-13.el8 AppStream 1.4 M Installing dependencies: gpm-libs x86_64 1.20.7-15.el8 AppStream 39 k vim-common x86_64 2:8.0.1763-13.el8 AppStream 6.3 M vim-filesystem noarch 2:8.0.1763-13.el8 AppStream 48 k which x86_64 2.21-12.el8 BaseOS 49 k Transaction Summary ================================================================================ Install 5 Packages Total download size: 7.8 M Installed size: 31 M Downloading Packages: (1/5): gpm-libs-1.20.7-15.el8.x86_64.rpm 176 kB/s | 39 kB 00:00 (2/5): vim-filesystem-8.0.1763-13.el8.noarch.rp 697 kB/s | 48 kB 00:00 (3/5): which-2.21-12.el8.x86_64.rpm 474 kB/s | 49 kB 00:00 (4/5): vim-enhanced-8.0.1763-13.el8.x86_64.rpm 1.6 MB/s | 1.4 MB 00:00 (5/5): vim-common-8.0.1763-13.el8.x86_64.rpm 4.2 MB/s | 6.3 MB 00:01 -------------------------------------------------------------------------------- Total 2.2 MB/s | 7.8 MB 00:03 warning: /var/cache/dnf/AppStream-02e86d1c976ab532/packages/gpm-libs-1.20.7-15.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY CentOS-8 - AppStream 825 kB/s | 1.6 kB 00:00 Importing GPG key 0x8483C65D: Userid : \"CentOS (CentOS Official Signing Key) <security@centos.org>\" Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D From : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial Key imported successfully Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : which-2.21-12.el8.x86_64 1/5 Installing : vim-filesystem-2:8.0.1763-13.el8.noarch 2/5 Installing : vim-common-2:8.0.1763-13.el8.x86_64 3/5 Installing : gpm-libs-1.20.7-15.el8.x86_64 4/5 Running scriptlet: gpm-libs-1.20.7-15.el8.x86_64 4/5 Installing : vim-enhanced-2:8.0.1763-13.el8.x86_64 5/5 Running scriptlet: vim-enhanced-2:8.0.1763-13.el8.x86_64 5/5 Running scriptlet: vim-common-2:8.0.1763-13.el8.x86_64 5/5 Verifying : gpm-libs-1.20.7-15.el8.x86_64 1/5 Verifying : vim-common-2:8.0.1763-13.el8.x86_64 2/5 Verifying : vim-enhanced-2:8.0.1763-13.el8.x86_64 3/5 Verifying : vim-filesystem-2:8.0.1763-13.el8.noarch 4/5 Verifying : which-2.21-12.el8.x86_64 5/5 Installed: gpm-libs-1.20.7-15.el8.x86_64 vim-common-2:8.0.1763-13.el8.x86_64 vim-enhanced-2:8.0.1763-13.el8.x86_64 vim-filesystem-2:8.0.1763-13.el8.noarch which-2.21-12.el8.x86_64 Complete! Removing intermediate container 2d1b5f504afa ---> 104e56b60aec Step 7/15 : ENV MYPATH /usr/local ---> Running in 9582f9a31cee Removing intermediate container 9582f9a31cee ---> dd0e414f6f83 Step 8/15 : WORKDIR $MYPATH ---> Running in 5a1b9e7b62c7 Removing intermediate container 5a1b9e7b62c7 ---> 4a2e99caa954 Step 9/15 : ENV JAVA_HOME /usr/local/jdk1.8.0_271 ---> Running in 4d8ee0c67b7b Removing intermediate container 4d8ee0c67b7b ---> 8da62fbac351 Step 10/15 : ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar ---> Running in 065821bf046e Removing intermediate container 065821bf046e ---> ad73e38ee464 Step 11/15 : ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.39 ---> Running in 4792108504fd Removing intermediate container 4792108504fd ---> e5ad1371c5c4 Step 12/15 : ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.39 ---> Running in 62dbef974ce0 Removing intermediate container 62dbef974ce0 ---> a494ad3353e3 Step 13/15 : ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin ---> Running in 2cc75de94c1e Removing intermediate container 2cc75de94c1e ---> 06bec94756ec Step 14/15 : EXPOSE 8080 ---> Running in ccbe33eefb43 Removing intermediate container ccbe33eefb43 ---> 75e040b2f7c3 Step 15/15 : CMD /usr/local/apache-tomcat-9.0.39/bin/startup.sh && tail -F /usr/local/apache-tomcat-9.0.39/logs/catalina.out ---> Running in ad622bea20ad Removing intermediate container ad622bea20ad ---> 13aa57b24d7f Successfully built 13aa57b24d7f Successfully tagged testtomcat:latest","title":"\u6784\u5efa\u8fc7\u7a0b"},{"location":"Docker/#_113","text":"docker images","title":"\u67e5\u770b\u955c\u50cf"},{"location":"Docker/#_114","text":"-d\uff1a\u540e\u53f0\u8fd0\u884c \u6302\u8f7d\u76ee\u5f55 docker run -d -p 9090:8080 --name tomcattest -v /data/tomcat/test:/usr/local/apache-tomcat-9.0.39/webapps/test -v /data/tomcat/logs:/usr/local/apache-tomcat-9.0.39/logs testtomcat","title":"\u540e\u53f0\u8fd0\u884c\u5bb9\u5668"},{"location":"Docker/#_115","text":"\u5bb9\u5668\u5185\uff1a \u5bb9\u5668\u5916\uff1a","title":"\u6d4b\u8bd5\u6302\u8f7d"},{"location":"Docker/#_116","text":"\u67e5\u770b\u8fd0\u884c\u5bb9\u5668 docker ps \u8fdb\u5165\u5bb9\u5668 docker exec -it ID /bin/bash","title":"\u8fdb\u5165\u5bb9\u5668"},{"location":"Docker/#_117","text":"\u5bb9\u5668\u5916\u9762\u6d4b\u8bd5 curl localhost:9090 [root@localhost data]# curl localhost:9090 <!DOCTYPE html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\" /> <title>Apache Tomcat/9.0.39</title> <link href=\"favicon.ico\" rel=\"icon\" type=\"image/x-icon\" /> <link href=\"favicon.ico\" rel=\"shortcut icon\" type=\"image/x-icon\" /> <link href=\"tomcat.css\" rel=\"stylesheet\" type=\"text/css\" /> </head> <body> <div id=\"wrapper\"> <div id=\"navigation\" class=\"curved container\"> <span id=\"nav-home\"><a href=\"https://tomcat.apache.org/\">Home</a></span> <span id=\"nav-hosts\"><a href=\"/docs/\">Documentation</a></span> <span id=\"nav-config\"><a href=\"/docs/config/\">Configuration</a></span> <span id=\"nav-examples\"><a href=\"/examples/\">Examples</a></span> <span id=\"nav-wiki\"><a href=\"https://wiki.apache.org/tomcat/FrontPage\">Wiki</a></span> <span id=\"nav-lists\"><a href=\"https://tomcat.apache.org/lists.html\">Mailing Lists</a></span> <span id=\"nav-help\"><a href=\"https://tomcat.apache.org/findhelp.html\">Find Help</a></span> <br class=\"separator\" /> </div> <div id=\"asf-box\"> <h1>Apache Tomcat/9.0.39</h1> </div> <div id=\"upper\" class=\"curved container\"> <div id=\"congrats\" class=\"curved container\"> <h2>If you're seeing this, you've successfully installed Tomcat. Congratulations!</h2> </div> <div id=\"notice\"> <img src=\"tomcat.png\" alt=\"[tomcat logo]\" /> <div id=\"tasks\"> <h3>Recommended Reading:</h3> <h4><a href=\"/docs/security-howto.html\">Security Considerations How-To</a></h4> <h4><a href=\"/docs/manager-howto.html\">Manager Application How-To</a></h4> <h4><a href=\"/docs/cluster-howto.html\">Clustering/Session Replication How-To</a></h4> </div> </div> <div id=\"actions\"> <div class=\"button\"> <a class=\"container shadow\" href=\"/manager/status\"><span>Server Status</span></a> </div> <div class=\"button\"> <a class=\"container shadow\" href=\"/manager/html\"><span>Manager App</span></a> </div> <div class=\"button\"> <a class=\"container shadow\" href=\"/host-manager/html\"><span>Host Manager</span></a> </div> </div> <br class=\"separator\" /> </div> <div id=\"middle\" class=\"curved container\"> <h3>Developer Quick Start</h3> <div class=\"col25\"> <div class=\"container\"> <p><a href=\"/docs/setup.html\">Tomcat Setup</a></p> <p><a href=\"/docs/appdev/\">First Web Application</a></p> </div> </div> <div class=\"col25\"> <div class=\"container\"> <p><a href=\"/docs/realm-howto.html\">Realms &amp; AAA</a></p> <p><a href=\"/docs/jndi-datasource-examples-howto.html\">JDBC DataSources</a></p> </div> </div> <div class=\"col25\"> <div class=\"container\"> <p><a href=\"/examples/\">Examples</a></p> </div> </div> <div class=\"col25\"> <div class=\"container\"> <p><a href=\"https://wiki.apache.org/tomcat/Specifications\">Servlet Specifications</a></p> <p><a href=\"https://wiki.apache.org/tomcat/TomcatVersions\">Tomcat Versions</a></p> </div> </div> <br class=\"separator\" /> </div> <div id=\"lower\"> <div id=\"low-manage\" class=\"\"> <div class=\"curved container\"> <h3>Managing Tomcat</h3> <p>For security, access to the <a href=\"/manager/html\">manager webapp</a> is restricted. Users are defined in:</p> <pre>$CATALINA_HOME/conf/tomcat-users.xml</pre> <p>In Tomcat 9.0 access to the manager application is split between different users. &nbsp; <a href=\"/docs/manager-howto.html\">Read more...</a></p> <br /> <h4><a href=\"/docs/RELEASE-NOTES.txt\">Release Notes</a></h4> <h4><a href=\"/docs/changelog.html\">Changelog</a></h4> <h4><a href=\"https://tomcat.apache.org/migration.html\">Migration Guide</a></h4> <h4><a href=\"https://tomcat.apache.org/security.html\">Security Notices</a></h4> </div> </div> <div id=\"low-docs\" class=\"\"> <div class=\"curved container\"> <h3>Documentation</h3> <h4><a href=\"/docs/\">Tomcat 9.0 Documentation</a></h4> <h4><a href=\"/docs/config/\">Tomcat 9.0 Configuration</a></h4> <h4><a href=\"https://wiki.apache.org/tomcat/FrontPage\">Tomcat Wiki</a></h4> <p>Find additional important configuration information in:</p> <pre>$CATALINA_HOME/RUNNING.txt</pre> <p>Developers may be interested in:</p> <ul> <li><a href=\"https://tomcat.apache.org/bugreport.html\">Tomcat 9.0 Bug Database</a></li> <li><a href=\"/docs/api/index.html\">Tomcat 9.0 JavaDocs</a></li> <li><a href=\"https://github.com/apache/tomcat/tree/master\">Tomcat 9.0 Git Repository at GitHub</a></li> </ul> </div> </div> <div id=\"low-help\" class=\"\"> <div class=\"curved container\"> <h3>Getting Help</h3> <h4><a href=\"https://tomcat.apache.org/faq/\">FAQ</a> and <a href=\"https://tomcat.apache.org/lists.html\">Mailing Lists</a></h4> <p>The following mailing lists are available:</p> <ul> <li id=\"list-announce\"><strong><a href=\"https://tomcat.apache.org/lists.html#tomcat-announce\">tomcat-announce</a><br /> Important announcements, releases, security vulnerability notifications. (Low volume).</strong> </li> <li><a href=\"https://tomcat.apache.org/lists.html#tomcat-users\">tomcat-users</a><br /> User support and discussion </li> <li><a href=\"https://tomcat.apache.org/lists.html#taglibs-user\">taglibs-user</a><br /> User support and discussion for <a href=\"https://tomcat.apache.org/taglibs/\">Apache Taglibs</a> </li> <li><a href=\"https://tomcat.apache.org/lists.html#tomcat-dev\">tomcat-dev</a><br /> Development mailing list, including commit messages </li> </ul> </div> </div> <br class=\"separator\" /> </div> <div id=\"footer\" class=\"curved container\"> <div class=\"col20\"> <div class=\"container\"> <h4>Other Downloads</h4> <ul> <li><a href=\"https://tomcat.apache.org/download-connectors.cgi\">Tomcat Connectors</a></li> <li><a href=\"https://tomcat.apache.org/download-native.cgi\">Tomcat Native</a></li> <li><a href=\"https://tomcat.apache.org/taglibs/\">Taglibs</a></li> <li><a href=\"/docs/deployer-howto.html\">Deployer</a></li> </ul> </div> </div> <div class=\"col20\"> <div class=\"container\"> <h4>Other Documentation</h4> <ul> <li><a href=\"https://tomcat.apache.org/connectors-doc/\">Tomcat Connectors</a></li> <li><a href=\"https://tomcat.apache.org/connectors-doc/\">mod_jk Documentation</a></li> <li><a href=\"https://tomcat.apache.org/native-doc/\">Tomcat Native</a></li> <li><a href=\"/docs/deployer-howto.html\">Deployer</a></li> </ul> </div> </div> <div class=\"col20\"> <div class=\"container\"> <h4>Get Involved</h4> <ul> <li><a href=\"https://tomcat.apache.org/getinvolved.html\">Overview</a></li> <li><a href=\"https://tomcat.apache.org/source.html\">Source Repositories</a></li> <li><a href=\"https://tomcat.apache.org/lists.html\">Mailing Lists</a></li> <li><a href=\"https://wiki.apache.org/tomcat/FrontPage\">Wiki</a></li> </ul> </div> </div> <div class=\"col20\"> <div class=\"container\"> <h4>Miscellaneous</h4> <ul> <li><a href=\"https://tomcat.apache.org/contact.html\">Contact</a></li> <li><a href=\"https://tomcat.apache.org/legal.html\">Legal</a></li> <li><a href=\"https://www.apache.org/foundation/sponsorship.html\">Sponsorship</a></li> <li><a href=\"https://www.apache.org/foundation/thanks.html\">Thanks</a></li> </ul> </div> </div> <div class=\"col20\"> <div class=\"container\"> <h4>Apache Software Foundation</h4> <ul> <li><a href=\"https://tomcat.apache.org/whoweare.html\">Who We Are</a></li> <li><a href=\"https://tomcat.apache.org/heritage.html\">Heritage</a></li> <li><a href=\"https://www.apache.org\">Apache Home</a></li> <li><a href=\"https://tomcat.apache.org/resources.html\">Resources</a></li> </ul> </div> </div> <br class=\"separator\" /> </div> <p class=\"copyright\">Copyright &copy;1999-2020 Apache Software Foundation. All Rights Reserved</p> </div> </body> </html> [root@localhost data]# \u7f51\u9875\u6d4b\u8bd5 http://192.168.100.100:9090 \u3010\u5751\u3011\u62a5\u9519\u65e5\u5fd7\uff1a /usr/local/apache-tomcat-9.0.39/bin/catalina.sh: line 502: /usr/local/jdk.1.8.0.27/bin/java: No such file or directory /usr/local/apache-tomcat-9.0.39/bin/catalina.sh: line 502: /usr/local/jdk.1.8.0.27/bin/java: No such file or directory \u5206\u6790\u4fee\u6539\u73af\u5883\u53d8\u91cf #ENV JAVA_HOME /usr/local/jdk1.8.0_271 java\u73af\u5883\u53d8\u91cf\u9519\u8bef\uff0c\u5bfc\u81f4\u540e\u9762\u5f15\u7528\u7684\u53d8\u91cf\u90fd\u9519\u8bef\uff0c\u6700\u7ec8\u5bfc\u81f4Tomcat\u6ca1\u6709\u542f\u52a8\u6210\u529f\u3002","title":"\u8bbf\u95ee\u6d4b\u8bd5"},{"location":"Docker/#html","text":"web.xml <?xml version=\"1.0\" encoding=\"UTF-8\"?> <web-app xmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\" version=\"2.5\"> </web-app> index.jsp <%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%> <!DOCTYPE html> <html> <head> <meta charset=\"utf-8\"> <title>hello.lwenwu\uff01</title> </head> <body> Hello World!<br/> <% out.println(\"this is a test file\"); %> </body> </html> \u5931\u8d25 \u5206\u6790\uff1a","title":"html\u6d4b\u8bd5"},{"location":"Docker/#_118","text":"","title":"\u53d1\u5e03\u955c\u50cf"},{"location":"Docker/#dockerhub","text":"1.\u5730\u5740:https://hub.docker.com/\uff0c\u6ce8\u518c\u8d26\u53f7\u3002 2.dockler login\u5e2e\u52a9\u547d\u4ee4 -u #\u7528\u6237 -p #\u5bc6\u7801 Usage: docker login [OPTIONS] [SERVER] Log in to a Docker registry. If no server is specified, the default is defined by the daemon. Options: -p, --password string Password --password-stdin Take the password from stdin -u, --username string Username 3.\u767b\u5f55\u8d26\u53f7 [root@localhost ~]# docker login -u lwenwu Password: 4.\u670d\u52a1\u5668\u767b\u9646\u540e\u63d0\u4ea4\u81ea\u5df1\u7684\u955c\u50cf\uff0cdocker push push\u65f6\u9700\u8981\u5e26\u4e0a\u4f5c\u8005\u7684\u540d\u5b57\uff0c\u955c\u50cf\u9700\u8981\u5e26\u4e0a\u7248\u672c\u53f7\uff0c\u5426\u5219\u4f1a\u62d2\u7edd\uff0c\u672c\u5730\u955c\u50cf\u7684TAG\u6807\u7b7e\u8981\u6539\u6210 \u8d26\u53f7/\u540d\u79f0:tag \u624d\u80fdpush\u6210\u529f\u3002 \u9519\u8bef\uff1a \u589e\u52a0TAG,\u7ed9\u5f53\u524d\u955c\u50cf\u589e\u52a0TAG\u6807\u7b7e\u3002 \u6ce8\uff1a\u672c\u5730\u955c\u50cf\u7684TAG\u6807\u7b7e\u8981\u6539\u6210 \u8d26\u53f7/\u540d\u79f0:tag \u624d\u80fdpush\u6210\u529f\u3002 docker tag 13aa57b24d7f lwenwu/tomcat:1.0 \u4fee\u6539\u540e\u4f1a\u591a\u51fa\u4e00\u4e2a \u518d\u6b21\u63d0\u4ea4 docker push lwenwu/tomcat:1.0 [root@localhost ~]# docker push lwenwu/tomcat:1.0 The push refers to repository [docker.io/lwenwu/tomcat] fbf49d42cce1: Pushed ab05fe66e378: Pushed 947e7a54038d: Pushed 9fb962ef813e: Pushed 291f6e44771a: Mounted from library/centos 1.0: digest: sha256:9ee0258534ff11bcfefc26fd1f2f5ca2e048f07736ecb7102e5be97c9190c673 size: 1373 \u63d0\u4ea4\u4e5f\u662f\u6309\u7167\u955c\u50cf\u7684\u5c42\u7ea7\u8fdb\u884c\u63d0\u4ea4\u7684\uff01","title":"\u53d1\u5e03\u955c\u50cf\u5230DockerHub"},{"location":"Docker/#_119","text":"1.\u767b\u5f55\u963f\u91cc\u4e91 https://cr.console.aliyun.com/cn-hangzhou/instances/repositories 2.\u627e\u5230\u5bb9\u5668\u955c\u50cf\u670d\u52a1 3.\u521b\u5efa\u547d\u540d\u7a7a\u95f4 \u547d\u4ee4\u7a7a\u95f4\uff1a\u9879\u76ee \u4e00\u4e2a\u8d26\u53f7\u6700\u591a\u53ef\u4ee5\u521b\u5efa 3 \u4e2a\u547d\u540d\u7a7a\u95f4\u547d\u540d\u7a7a\u95f4\u3002 4.\u521b\u5efa\u955c\u50cf\u4ed3\u5e93 5.\u4ed3\u5e93\u4fe1\u606f 1. \u767b\u5f55\u963f\u91cc\u4e91Docker Registry $ sudo docker login --username=lwenwu1999 registry.cn-hangzhou.aliyuncs.com \u7528\u4e8e\u767b\u5f55\u7684\u7528\u6237\u540d\u4e3a\u963f\u91cc\u4e91\u8d26\u53f7\u5168\u540d\uff0c\u5bc6\u7801\u4e3a\u5f00\u901a\u670d\u52a1\u65f6\u8bbe\u7f6e\u7684\u5bc6\u7801\u3002 \u60a8\u53ef\u4ee5\u5728\u8bbf\u95ee\u51ed\u8bc1\u9875\u9762\u4fee\u6539\u51ed\u8bc1\u5bc6\u7801\u3002 2. \u4eceRegistry\u4e2d\u62c9\u53d6\u955c\u50cf $ sudo docker pull registry.cn-hangzhou.aliyuncs.com/lwenwu/docker:[\u955c\u50cf\u7248\u672c\u53f7] 3. \u5c06\u955c\u50cf\u63a8\u9001\u5230Registry $ sudo docker login --username=lwenwu1999 registry.cn-hangzhou.aliyuncs.com $ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/lwenwu/docker:[\u955c\u50cf\u7248\u672c\u53f7] $ sudo docker push registry.cn-hangzhou.aliyuncs.com/lwenwu/docker:[\u955c\u50cf\u7248\u672c\u53f7] \u8bf7\u6839\u636e\u5b9e\u9645\u955c\u50cf\u4fe1\u606f\u66ff\u6362\u793a\u4f8b\u4e2d\u7684[ImageId]\u548c[\u955c\u50cf\u7248\u672c\u53f7]\u53c2\u6570\u3002 4. \u9009\u62e9\u5408\u9002\u7684\u955c\u50cf\u4ed3\u5e93\u5730\u5740 \u4eceECS\u63a8\u9001\u955c\u50cf\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u955c\u50cf\u4ed3\u5e93\u5185\u7f51\u5730\u5740\u3002\u63a8\u9001\u901f\u5ea6\u5c06\u5f97\u5230\u63d0\u5347\u5e76\u4e14\u5c06\u4e0d\u4f1a\u635f\u8017\u60a8\u7684\u516c\u7f51\u6d41\u91cf\u3002 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u673a\u5668\u4f4d\u4e8eVPC\u7f51\u7edc\uff0c\u8bf7\u4f7f\u7528 registry-vpc.cn-hangzhou.aliyuncs.com \u4f5c\u4e3aRegistry\u7684\u57df\u540d\u767b\u5f55\u3002 6.\u767b\u5f55\u963f\u91cc\u4e91Docker Registry docker login --username=lwenwu1999 registry.cn-hangzhou.aliyuncs.com 7.\u5c06\u955c\u50cf\u63a8\u9001\u5230Registry \u9519\u8bef \u89e3\u51b3\uff1a \u4e25\u683c\u6309\u7167\u5b98\u65b9\u8bf4\u660e\u8fdb\u884cTAG\u6807\u7b7e\u4fee\u6539\uff0c\u7136\u540epush\u3002 docker push registry.cn-hangzhou.aliyuncs.com/lwenwu/tomcat:1.0","title":"\u53d1\u5e03\u955c\u50cf\u5230\u963f\u91cc\u4e91"},{"location":"Docker/#docker_14","text":"","title":"docker\u6d41\u7a0b\u603b\u7ed3"},{"location":"Docker/#docker_15","text":"","title":"Docker\u7f51\u7edc"},{"location":"Docker/#docker0","text":"\u9996\u5148\u6e05\u7a7a\u6240\u6709\u955c\u50cf\uff0c\u4fdd\u8bc1\u5e72\u51c0\u73af\u5883\u3002 docker rmi -f $(docker images -a -q) lo: #\u672c\u673a\u56de\u73af\u5730\u5740 eth0: #\u672c\u673a\u7f51\u5361\u5730\u5740 docker0:docker0\u5730\u5740 docker\u662f\u5982\u4f55\u5904\u7406\u5bb9\u5668\u7f51\u7edc\u8bbf\u95ee\u7684\uff1f \u6d4b\u8bd5 docker run -d -P --name tomcat01 tomcat \u67e5\u770b\u5bb9\u5668\u5185\u90e8\u7684\u7f51\u7edc\u5730\u5740 docker exec -it tomcat01 ip addr [root@localhost ~]# docker exec -it tomcat01 ip addr 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever 4: eth0@if5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0 valid_lft forever preferred_lft forever [root@localhost ~]# \u53d1\u73b0\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\u4f1a\u5f97\u5230\u4e00\u4e2adocker\u5206\u914d\u7684eth0@if5 \u7f51\u5361\u3002 linux\u5bbf\u4e3b\u673a\u80fd\u4e0d\u80fdping\u901a\u5bb9\u5668\u5185\u7684IP\u5730\u5740\uff1f \u6d4b\u8bd5 \u7ed3\u679c\uff1alinux\u4e3b\u673a\u53ef\u4ee5ping\u901a\u5bb9\u5668\u5185\u90e8 \u5bb9\u5668\u5185\u662f\u5426\u53ef\u4ee5ping\u901alinux\u4e3b\u673a? \u6d4b\u8bd5 \u7ed3\u679c\uff1a\u5bb9\u5668\u5185\u5426\u53ef\u4ee5ping\u901alinux\u4e3b\u673a\u3002 docker0\u76f8\u5f53\u4e8e\u5bb6\u5ead\u4e2d\u7684\u8def\u7531\u5668\uff0c\u8d1f\u8d23\u7ed9\u7f51\u6bb5\u5185\u7684\u4e3b\u673a\u5206\u914dIP\u5730\u5740\u3002","title":"\u7406\u89e3docker0"},{"location":"Docker/#docker0_1","text":"1.\u6211\u4eec\u6bcf\u542f\u52a8\u4e00\u4e2adocker\u5bb9\u5668\uff0c docker\u5c31\u4f1a\u7ed9docker\u5bb9\u5668\u5206\u914d\u4e00\u4e2aip\uff0c \u6211\u4eec\u53ea\u8981\u5b89\u88c5\u4e86docker\uff0c \u5c31\u4f1a\u6709\u4e00\u4e2a\u7f51\u5361docker 0 ,\u91c7\u7528\u6865\u63a5\u6a21\u5f0f\uff0c \u4f7f\u7528\u7684\u6280\u672f\u662fev th-pair\u6280\u672f! 2.\u542f\u52a8\u5bb9\u5668\u518d\u6b21\u6d4b\u8bd5ipaddr\uff0c\u53d1\u73b0\u591a\u4e86\u4e00\u4e2a\u7f51\u5361\u3002 \u7ed3\u8bba\uff1a\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668linux\u5bbf\u4e3b\u673a\u4f1a\u591a\u51fa1\u4e2a\u5bf9\u5e94\u7684\u7f51\u5361\u3002 3.\u5bb9\u5668\u5185\u548c\u5bb9\u5668\u5916\u7f51\u5361\u662f\u76f8\u4e92\u7ed1\u5b9a\u7684\u3002 \u5bb9\u5668\u5185\uff1a \u5bb9\u5668\u5916\uff1a 4.\u518d\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668\u8fdb\u884c\u6d4b\u8bd5\u3002 \u7ed3\u8bba\uff1a\u542f\u52a8N\u4e2a\u5bb9\u5668linux\u5bbf\u4e3b\u673a\u4f1a\u591a\u51faN\u4e2a\u5bf9\u5e94\u7684\u7f51\u5361\u3002 #\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5bb9\u5668\u5e26\u6765\u7f51\u5361\uff0c\u90fd\u662f\u76f8\u4e92\u7ed1\u5b9a\u7684\u3002 #veth-pair\u5c31\u662f\u4e00\u5bf9\u7684\u865a\u62df\u8bbe\u5907\u63a5\u53e3\uff0c \u4ed6\u4eec\u90fd\u662f\u76f8\u4e92\u7ed1\u5b9a\u51fa\u73b0\u7684\uff0c \u4e00\u6bb5\u8fde\u7740\u534f\u8bae\uff0c \u4e00\u6bb5\u5f7c\u6b64\u76f8\u8fde #\u6b63\u56e0\u4e3a\u6709\u8fd9\u4e2a\u7279\u6027\uff0c veth-pair\u5145\u5f53\u4e00\u4e2a\u6865\u6881\uff0c \u8fde\u63a5\u5404\u79cd\u865a\u62df\u7f51\u7edc\u8bbe\u5907\u7684 #OpenStak\uff0cDocker\u5bb9\u5668\u4e4b\u95f4\u7684\u8fde\u63a5\uff0covS\u7684\u8fde\u63a5\uff0c\u90fd\u662f\u4f7f\u7528veth-pair\u6280\u672f.","title":"docker0\u539f\u7406"},{"location":"Docker/#_120","text":"\u6d4b\u8bd5\u5bb9\u5668\u4e4b\u95f4\u662f\u5426\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff1f tomcat01 tomcat02 \u6d4b\u8bd5ping \u90fd\u80fd\u4e92\u76f8ping\u901a\u3002 \u77e5\u8bc6\uff1a \u53ef\u4ee5\u4e0d\u8fdb\u5165\u5bb9\u5668\u6765ping\u3002 docker exec -it tomcat02 ping 172.17.0.2 \u7ed3\u8bba\uff1a\u5bb9\u5668\u548c\u5bb9\u5668\u95f4\u662f\u53ef\u4ee5\u4e92\u76f8ping\u901a\u7684\uff01 Docker0\u7f51\u7edc\u6a21\u578b\u56fe\uff1a \u7ed3\u8bba\uff1aDocker\u4f7f\u7528\u7684\u662fLinux\u7684\u6865\u63a5\uff0c \u5bbf\u4e3b\u673a\u4e2d\u662f\u4e00\u4e2aDokcer\u5bb9\u5668\u7684\u7f51\u6865docker0\u3002 \u865a\u62df\u7f51\u5361\uff0cDocker\u4e2d\u7684\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\u90fd\u662f\u865a\u62df\u7684\u3002\u865a\u62df\u7684\u8f6c\u53d1\u6548\u7387\u9ad8! (\u5185\u7f51\u4f20\u9012\u6587\u4ef6!)","title":"\u5bb9\u5668\u95f4\u901a\u4fe1"},{"location":"Docker/#_121","text":"\u79fb\u9664\u5bb9\u5668\u540e\u7f51\u5361\u81ea\u52a8\u6d88\u5931 \u6d4b\u8bd5 \u6ce8\uff1a\u53ea\u8981\u5220\u9664\u5bb9\u5668\uff0c\u5bf9\u5e94\u7684\u7f51\u5361\u5c31\u4f1a\u5220\u9664\uff01","title":"\u79fb\u9664\u5bb9\u5668\u67e5\u770b\u7f51\u5361"},{"location":"Docker/#-link","text":"\u573a\u666f\uff1a\u5bb9\u5668IP\u53d8\u66f4\uff0c\u4e0d\u5f71\u54cd\u901a\u4fe1\uff0c\u4ee5docker\u5bb9\u5668\u540d\u79f0\u8fdb\u884cping\u901a\u4fe1\u3002 \u542f\u52a8\u5bb9\u5668tomcat01\u548ctomcat02 \u6d4b\u8bd5\uff1a\u7528\u5bb9\u5668\u540d\u79f0ping\u6d4b\u8bd5\u901a\u4fe1\u3002 docker exec -it tomcat01 ping tomcat02","title":"--link"},{"location":"Docker/#_122","text":"\u5982\u4f55\u53ef\u4ee5\u89e3\u51b3\uff1f \u518d\u542f\u52a8\u4e00\u4e2a\u5bb9\u5668tomcat03,\u589e\u52a0--link\u53c2\u6570\uff0c\u6d4b\u8bd5\u901a\u4fe1\u3002 docker run -d -P --name tomcat03 --link tomcat02 tomcat \u6d4b\u8bd5\u7528\u5bb9\u5668\u540d\u79f0ping docker exec -it tomcat03 ping tomcat02","title":"\u89e3\u51b3\u5bb9\u5668\u540d\u79f0\u4e92\u901a"},{"location":"Docker/#ping","text":"[\u5751]\u53cd\u5411ping\u6d4b\u8bd5","title":"\u53cd\u5411ping\u6d4b\u8bd5"},{"location":"Docker/#docker-network","text":"[root@localhost ~]# docker network --help Usage: docker network COMMAND Manage networks Commands: connect Connect a container to a network create Create a network disconnect Disconnect a container from a network inspect Display detailed information on one or more networks ls List networks prune Remove all unused networks rm Remove one or more networks \u67e5\u770bdocker0 bridge\u7f51\u5361\u8be6\u7ec6\u4fe1\u606f docker0\u7f51\u5361 docker network inspect 991190b12345 \u5bb9\u5668\u5206\u914d\u7684\u5730\u5740\u4fe1\u606f \u67e5\u770b\u5bb9\u5668tomcat03\u7684\u8be6\u7ec6\u4fe1\u606f docker inspect fc39850d8b31 \u62d3\u5c55\uff1a docker inspect conID|grep tomcat03 -n \u67e5\u770btomcat03\u5bb9\u5668\u7684hosts\u6587\u4ef6 docker exec -it fc39850d8b31 cat /etc/hosts \u672c\u8d28\u63a2\u7a76\uff1a--link\u5c31\u662f\u6211\u4eec\u5728hosts\u914d\u7f6e\u6587\u4ef6\u4e2d\u589e\u52a0\u4e861\u4e2atomcat02\u7684\u6620\u5c04\u3002 \u4e0d\u5efa\u8bae\u4f7f\u7528--link,\u56e0\u4e3a--link\u9700\u8981\u76f8\u4e92\u7ed1\u5b9a\u624d\u80fd\u4e92\u76f8\u901a\u4fe1\u3002 docker0\u95ee\u9898\uff1a\u4e0d\u652f\u6301\u5bb9\u5668\u540d\u4e92\u76f8\u8fde\u63a5\u8bbf\u95ee\uff01","title":"docker network\u7a76\u7adf"},{"location":"Docker/#_123","text":"docker0\u95ee\u9898\uff1a\u4e0d\u652f\u6301\u5bb9\u5668\u540d\u4e92\u76f8\u8fde\u63a5\u8bbf\u95ee\uff01 \u67e5\u770b\u6240\u6709\u7684docker\u7f51\u7edc docker network ls","title":"\u5bb9\u5668\u4e92\u8054"},{"location":"Docker/#_124","text":"bridge\uff1a\u6865\u63a5docker\u9ed8\u8ba4\uff0c\u81ea\u5b9a\u4e49\u7684\u7f51\u7edc\u4e5f\u4f7f\u7528bridge\u6a21\u5f0f\u3002 none\uff1a\u4e0d\u914d\u7f6e\u7f51\u7edc\u3002 host\uff1a\u548c\u5bbf\u4e3b\u673a\u5171\u4eab\u7f51\u7edc\u3002 container\uff1a\u5bb9\u5668\u5185\u7f51\u7edc\u8fde\u901a\uff01\u7528\u7684\u5c11\uff01\u5c40\u9650\u5f88\u5927\uff01","title":"\u7f51\u7edc\u6a21\u5f0f"},{"location":"Docker/#docker-network_1","text":"[root@localhost ~]# docker network --help Usage: docker network COMMAND Manage networks Commands: connect Connect a container to a network create Create a network disconnect Disconnect a container from a network inspect Display detailed information on one or more networks ls List networks prune Remove all unused networks rm Remove one or more networks","title":"docker network\u5e2e\u52a9\u4fe1\u606f"},{"location":"Docker/#_125","text":"\u5220\u9664\u6240\u6709\u5bb9\u5668\uff0c\u4fdd\u8bc1\u5e72\u51c0\u73af\u5883\u3002 docker rm -f $(docker ps -a -q) \u56de\u5230\u6700\u521d\u76843\u4e2a\u7f51\u5361 \u4e4b\u524d\u76f4\u63a5\u542f\u52a8\u7684\u7684\u547d\u4ee4 docker run -d -P --name tomcat01 tomcat #\u76f4\u63a5\u542f\u52a8\u7684\u5bb9\u5668\u9ed8\u8ba4\u662fdocker0\u7f51\u7edc\uff0c\u5176\u5b9e\u9ed8\u8ba4\u7701\u7565\u4e86--net bridge\u53c2\u6570 docker0\u7279\u70b9\uff0c\u9ed8\u8ba4\u57df\u540d\u4e0d\u80fd\u8bbf\u95ee\uff0c--link\u9700\u8981\u4e92\u76f8\u6253\u901a\u624d\u80fd\u76f8\u4e92\u901a\u4fe1\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002","title":"\u6d4b\u8bd5\u81ea\u5b9a\u4e49\u7f51\u7edc"},{"location":"Docker/#_126","text":"\u518d\u67e5\u770bdocker network create --help\u5e2e\u52a9\u4fe1\u606f docker network create --help \u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7f51\u7edc --driver bridge #\u9ed8\u8ba4\u4e3a\u6865\u63a5\uff0c\u53ef\u4e0d\u5199 --subnet 192.168.0.0/16 #\u5b50\u7f51 --gateway 192.168.0.1 #\u8def\u7531 docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 nettest \u67e5\u770b\u521b\u5efa\u7684\u7f51\u7edc docker network ls \u67e5\u770b\u521b\u5efa\u7f51\u7edc\u7684\u8be6\u7ec6\u4fe1\u606f docker network inspect nettest \u5230\u6b64\u81ea\u5df1\u7684\u7f51\u7edc\u5c31\u521b\u5efa\u597d\u4e86\u3002","title":"\u81ea\u5b9a\u4e49\u7f51\u7edc"},{"location":"Docker/#_127","text":"\u6d4b\u8bd5\u542f\u52a82\u4e2a\u5bb9\u5668 docker run -d -P --name tomcat-net-01 --net nettest tomcat docker run -d -P --name tomcat-net-02 --net nettest tomcat \u518d\u6b21\u67e5\u770b\u81ea\u5b9a\u4e49\u7f51\u7edc\u7684\u8be6\u7ec6\u4fe1\u606f docker network inspect nettest \u6b64\u65f6\u81ea\u5b9a\u4e49\u7f51\u7edc\u4e0b\u9762\u5c31\u6709\u4e86\u6211\u4eec\u7684\u5bb9\u5668\u4fe1\u606f\u3002","title":"\u5bb9\u5668\u8d70\u81ea\u5b9a\u4e49\u7f51\u7edc"},{"location":"Docker/#ping_1","text":"docker exec -it tomcat-net-01 ping 192.168.0.3 docker exec -it tomcat-net-01 ping tomcat-net-02 \u6b64\u65f6\u7528\u5bb9\u5668\u7684\u540d\u79f0\u53ef\u4ee5\u4e92\u76f8Ping\u901a\u4e86\u3002 \u81ea\u5b9a\u4e49\u7684\u7f51\u7edc\u4fee\u590d\u4e86docker0\u7684\u7f3a\u9677\u3002","title":"\u6d4b\u8bd5\u57df\u540dping"},{"location":"Docker/#_128","text":"\u7f51\u7edc\u8054\u901a\uff0c\u4f7f2\u5f20\u7f51\u4e0b\u7684\u5bb9\u5668\u4e5f\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\u3002 \u542f\u52a82\u4e2a\u5bb9\u5668\uff0c\u4e0d\u6307\u5b9a\u7f51\u7edc\u3002\u6d4b\u8bd52\u4e2a\u7f51\u7edc\u4e0b\u662f\u5426\u53ef\u4ee5\u4e92\u901a\u3002 docker run -d -P --name tomcat01 tomcat docker run -d -P --name tomcat02 tomcat #\u6d4b\u8bd5 docker exec -it tomcat01 ping tomcat-net-01 \u5982\u4f55\u6253\u901adocker0\u548c\u81ea\u5b9a\u4e49\u7684\u7f51\u7edc\uff1f \u7f51\u7edc\u4e4b\u95f4\u5982\u4f55\u4e92\u76f8\u6253\u901a\uff1f \u8fde\u63a51\u4e2a\u5bb9\u5668\u52301\u4e2a\u7f51\u7edc docker network --help \u67e5\u770b\u5e2e\u52a9\u4fe1\u606f docker network connect --help \u6d4b\u8bd5\u6253\u901a,\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f docker network connect nettest tomcat01 \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\uff0c\u8fde\u901a\u540e\u53d1\u751f\u4e86\u4ec0\u4e48\uff1f docker network inspect nettest \u8fde\u901a\u4e4b\u540e\u5c31\u5c06tomcat01\u653e\u5230\u4e86nettest\u7f51\u7edc\u4e0b\uff1f \u6d4b\u8bd5\u901a\u4fe1 \u5b98\u65b9\uff1a1\u4e2a\u5bb9\u56682\u4e2aIP \u65b9\u6cd5\uff1a\u5bb9\u5668\u548c\u7f51\u7edc\u6253\u901a\u89e3\u51b32\u5f20\u7f51\u7edc\u4e0b\u5bb9\u5668\u901a\u4fe1\u3002 \u6d4b\u8bd5tomcat02 tomcat02\u4e0e\u81ea\u5b9a\u4e49\u7f51\u7edcnettest\u6ca1\u6709\u6253\u901a\uff0c\u6240\u4ee5\u65e0\u6cd5ping\u901a\u3002 \u7ed3\u8bba\uff1a\u5047\u8bbe\u8981\u8de8\u7f51\u7edc\u901a\u4fe1\uff0c\u5c31\u9700\u8981\u4f7f\u7528docker network connect\u6253\u901a\uff01","title":"\u7f51\u7edc\u95f4\u901a\u4fe1"},{"location":"Docker/#redis","text":"\u5206\u7247+\u9ad8\u53ef\u7528+\u8d1f\u8f7d\u5747\u8861 \u5176\u4e2d\u4e00\u4e2a\u6302\u4e86\uff0c\u5907\u7528\u7684\u9876\u4e0a redis\u96c6\u7fa4 \u542f\u52a86\u4e2a\u5bb9\u5668","title":"\u90e8\u7f72Redis\u96c6\u7fa4"},{"location":"Docker/#redis_1","text":"docker network create redis --subnet 172.38.0.0/16 \u67e5\u770bredis\u7f51\u5361\u7684\u8be6\u7ec6\u4fe1\u606f docker network inspect redis","title":"\u521b\u5efaredis\u96c6\u7fa4\u7f51\u5361"},{"location":"Docker/#redis_2","text":"\u901a\u8fc7\u811a\u672c\u521b\u5efa6\u4e2aredis\u914d\u7f6e for port in $(seq 1 6); \\ do \\ mkdir -p /data/redis/node-${port}/conf touch /data/redis/node-${port}/conf/redis.conf cat << EOF >/data/redis/node-${port}/conf/redis.conf port 6379 bind 0.0.0.0 cluster-enabled yes cluster-config-file nodes.conf cluster-node-timeout 5000 cluster-announce-ip 172.38.0.1${port} cluster-announce-port 6379 cluster-announce-bus-port 16379 appendonly yes EOF done \u67e5\u770b\u521b\u5efa\u7684\u6587\u4ef6","title":"\u914d\u7f6eredis\u96c6\u7fa4"},{"location":"Docker/#_129","text":"#\u811a\u672c docker run -p 637${port}:6379 -p 1637${port}:16379 --name redis-${port} \\ -v /data/redis/node-${port}/data:/data \\ -v /data/redis/node-${port}/conf/redis.conf:/etc/redis/redis.conf \\ -d --net redis --ip 172.38.0.1${port} redis:5.0.10-alpine3.12 redis-server /etc/redis/redis.conf; \\ #\u624b\u52a8 docker run -p 6371:6379 -p 16371:16379 --name redis-1 -v /data/redis/node-1/data:/data -v /data/redis/node-1/conf/redis.conf:/etc/redis/redis.conf -d --net redis --ip 172.38.0.11 redis:5.0.10-alpine3.12 redis-server /etc/redis/redis.conf","title":"\u542f\u52a8\u5bb9\u5668"},{"location":"Docker/#_130","text":"docker ps","title":"\u67e5\u770b\u542f\u52a8\u5bb9\u5668"},{"location":"Docker/#redis_3","text":"redis\u4e2d\u6ca1\u6709bash\u547d\u4ee4\uff0credis\u8fdb\u5165\u4f7f\u7528/bin/sh docker exec -it IDNAME /bin/sh \u8fdb\u5165\u540e\u9ed8\u8ba4\u7684\u76ee\u5f55\u4e3a/data","title":"\u8fdb\u5165redis\u5bb9\u5668"},{"location":"Docker/#_131","text":"redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1 \u96c6\u7fa4\u521b\u5efa\u5b8c\u6bd5 #\u8fc7\u7a0b >>> Performing hash slots allocation on 6 nodes... Master[0] -> Slots 0 - 5460 Master[1] -> Slots 5461 - 10922 Master[2] -> Slots 10923 - 16383 Adding replica 172.38.0.15:6379 to 172.38.0.11:6379 Adding replica 172.38.0.16:6379 to 172.38.0.12:6379 Adding replica 172.38.0.14:6379 to 172.38.0.13:6379 M: 290353fdbf5a7345e66fee97be33fa4e352eadfb 172.38.0.11:6379 slots:[0-5460] (5461 slots) master M: 2d341c0a2aac0cd99a4cec112292bc7c48e608e2 172.38.0.12:6379 slots:[5461-10922] (5462 slots) master M: 4d1882d9fa8f86d794bfad393ae982be4350338c 172.38.0.13:6379 slots:[10923-16383] (5461 slots) master S: 8319c1e759a38114d5208ab329dc241b35289d28 172.38.0.14:6379 replicates 4d1882d9fa8f86d794bfad393ae982be4350338c S: 8b81002b5dcef5041c5ca70605c8cc30a53d05e0 172.38.0.15:6379 replicates 290353fdbf5a7345e66fee97be33fa4e352eadfb S: 530887eef54e59efe34b2a98f131fdc5cc6e1937 172.38.0.16:6379 replicates 2d341c0a2aac0cd99a4cec112292bc7c48e608e2 Can I set the above configuration? (type 'yes' to accept): yes >>> Nodes configuration updated >>> Assign a different config epoch to each node >>> Sending CLUSTER MEET messages to join the cluster Waiting for the cluster to join . >>> Performing Cluster Check (using node 172.38.0.11:6379) M: 290353fdbf5a7345e66fee97be33fa4e352eadfb 172.38.0.11:6379 slots:[0-5460] (5461 slots) master 1 additional replica(s) M: 2d341c0a2aac0cd99a4cec112292bc7c48e608e2 172.38.0.12:6379 slots:[5461-10922] (5462 slots) master 1 additional replica(s) M: 4d1882d9fa8f86d794bfad393ae982be4350338c 172.38.0.13:6379 slots:[10923-16383] (5461 slots) master 1 additional replica(s) S: 8319c1e759a38114d5208ab329dc241b35289d28 172.38.0.14:6379 slots: (0 slots) slave replicates 4d1882d9fa8f86d794bfad393ae982be4350338c S: 8b81002b5dcef5041c5ca70605c8cc30a53d05e0 172.38.0.15:6379 slots: (0 slots) slave replicates 290353fdbf5a7345e66fee97be33fa4e352eadfb S: 530887eef54e59efe34b2a98f131fdc5cc6e1937 172.38.0.16:6379 slots: (0 slots) slave replicates 2d341c0a2aac0cd99a4cec112292bc7c48e608e2 [OK] All nodes agree about slots configuration. >>> Check for open slots... >>> Check slots coverage... [OK] All 16384 slots covered.","title":"\u521b\u5efa\u96c6\u7fa4"},{"location":"Docker/#_132","text":"redis-cli -c \u67e5\u770b\u96c6\u7fa4\u4fe1\u606f 6379>cluster info \u67e5\u770b\u8282\u70b9\u4fe1\u606f 127.0.0.1:6379>cluster nodes \u6ce8\uff1a3\u4e3b3\u4ece set a b \u4e3b\u8282\u70b9\u5728\u5904\u7406 \u4ece\u673a\u5e94\u8be5\u4e5f\u6709\u4e00\u4e2a\u8fd9\u6837\u7684\u503c\uff0c\u4e3b\u8282\u70b9\u6302\u4e86\uff0c\u4ece\u8282\u70b9\u5e94\u8be5\u66ff\u4ee3\u4e0a\u6765\u3002\uff08\u9ad8\u53ef\u7528\uff09","title":"\u8fde\u63a5\u96c6\u7fa4"},{"location":"Docker/#_133","text":"docker ps","title":"\u67e5\u770b\u8fd0\u884c\u7684\u5bb9\u5668"},{"location":"Docker/#_134","text":"docker stop ID \u518d\u6b21get\u503c\uff0c\u8fde\u63a5\u8d85\u65f6 \u518d\u6b21\u8fde\u63a5\uff0cget a master\u5931\u8d25\uff0c\u4ece172.38.0.14\u4ece\u8282\u70b9\u81ea\u52a8\u5347\u4e3a\u4e3b\u8282\u70b9 Docker\u642d\u5efaredis\u96c6\u7fa4\u5b8c\u6210\uff01 \u4f7f\u7528docker\u4e4b\u540e\uff0c\u6240\u6709\u7684\u6280\u672f\u6162\u6162\u53d8\u7684\u7b80\u5355\u8d77\u6765\uff01","title":"\u505c\u6389\u4e3b\u8282\u70b9"},{"location":"Docker/#springbootdocker","text":"","title":"SpringBoot\u5fae\u670d\u52a1\u6253\u5305Docker\u955c\u50cf"},{"location":"Docker/#springboot","text":"","title":"\u6784\u5efaspringboot\u9879\u76ee"},{"location":"Docker/#_135","text":"","title":"\u6253\u5305\u5e94\u7528"},{"location":"Docker/#dockerfile_5","text":"","title":"\u7f16\u5199dockerfile"},{"location":"Docker/#_136","text":"","title":"\u6784\u5efa\u955c\u50cf"},{"location":"Docker/#_137","text":"","title":"\u53d1\u5e03\u8fd0\u884c"},{"location":"Docker/#_138","text":"","title":"\u7ed3\u8bed"},{"location":"Docker/#docker_16","text":"","title":"docker\u8fdb\u9636"},{"location":"Docker/#_139","text":"\u505c\u6b62docker systemctl stop docker \u5378\u8f7ddocker\u5f15\u64ce yum remove docker-ce docker-ce-cli containerd.io \u79fb\u9664docker\u76ee\u5f55 rm -rf /var/lib/docker/ /var/lib/docker/\u7684\u5185\u5bb9\uff0c\u5305\u62ec\u955c\u50cf\u3001\u5bb9\u5668\u3001\u5377\u548c\u7f51\u7edc\u3002Docker\u5f15\u64ce\u5305\u73b0\u5728\u79f0\u4e3aDocker -ce \u6d4b\u8bd5 [root@localhost ~]# docker ps -bash: /usr/bin/docker: No such file or directory [root@localhost ~]# \u6ce8\uff1a\u5df2\u7ecf\u6ca1\u6709\u76f8\u5173\u547d\u4ee4\u4e86 \u5378\u8f7d\u65e7\u7248\u672c yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine \u5982\u679cyum\u62a5\u544a\u6ca1\u6709\u5b89\u88c5\u8fd9\u4e9b\u5305\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002 [root@localhost ~]# yum remove docker \\ > docker-client \\ > docker-client-latest \\ > docker-common \\ > docker-latest \\ > docker-latest-logrotate \\ > docker-logrotate \\ > docker-engine Loaded plugins: fastestmirror No Match for argument: docker No Match for argument: docker-client No Match for argument: docker-client-latest No Match for argument: docker-common No Match for argument: docker-latest No Match for argument: docker-latest-logrotate No Match for argument: docker-logrotate No Match for argument: docker-engine No Packages marked for removal [root@localhost ~]# \u5b89\u88c5\u57fa\u7840\u5305 yum install -y yum-utils \u5b89\u88c5 yum-utils \u5305(\u5b83\u63d0\u4f9b yum-config-manager \u5b9e\u7528\u5de5\u5177)\u5e76\u8bbe\u7f6e\u7a33\u5b9a\u5b58\u50a8\u5e93\u3002 \u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93 \u9ed8\u8ba4\u56fd\u5916\u6e90\uff1a yum-config-manager \\ --add-repo \\ https://download.docker.com/linux/centos/docker-ce.repo \u963f\u91cc\u4e91\uff1a yum-config-manager \\ --add-repo \\ http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo \u66f4\u65b0yum\u8f6f\u4ef6\u5305\u7d22\u5f15 yum makecache fast \u5b89\u88c5 Docker\u5f15\u64ce yum install docker-ce docker-ce-cli containerd.io \u5b89\u88c5\u7279\u5b9a\u7248\u672c\u7684Docker\uff1a yum install docker-ce- docker-ce-cli- containerd.io \u542f\u52a8Docker systemctl start docker systemctl enable docker \u6d4b\u8bd5 docker version docker run hello-world docker images \u914d\u7f6e\u955c\u50cf\u52a0\u901f\u5668 sudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json <<-'EOF' { \"registry-mirrors\": [\"https://gnxq79wc.mirror.aliyuncs.com\"] } EOF sudo systemctl daemon-reload sudo systemctl restart docker","title":"\u73af\u5883\u51c6\u5907"},{"location":"Docker/#docker-compose","text":"","title":"Docker Compose"},{"location":"Docker/#docker-compose_1","text":"https://docs.docker.com/compose/ \u5b9a\u4e49\u591a\u4e2a\u5bb9\u5668\u4e00\u952e\u542f\u52a8\u6240\u6709\u5bb9\u5668\u3002 YAML \u914d\u7f6e\u6587\u4ef6 \u547d\u4ee4\u6709\u54ea\u4e9b\uff1f \u5b98\u65b9\u4ecb\u7ecd Compose\u662f\u4e00\u4e2a\u7528\u4e8e\u5b9a\u4e49\u548c\u8fd0\u884c\u591a\u5bb9\u5668Docker\u5e94\u7528\u7a0b\u5e8f\u7684\u5de5\u5177\u3002\u4f7f\u7528Compose\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2aYAML\u6587\u4ef6\u6765\u914d\u7f6e\u5e94\u7528\u7a0b\u5e8f\u7684\u670d\u52a1\u3002\u7136\u540e\uff0c\u4f7f\u7528\u4e00\u4e2a\u547d\u4ee4\uff0c\u60a8\u53ef\u4ee5\u4ece\u60a8\u7684\u914d\u7f6e\u4e2d\u521b\u5efa\u5e76\u542f\u52a8\u6240\u6709\u7684\u670d\u52a1\u3002\u8981\u4e86\u89e3\u6709\u5173Compose\u7684\u6240\u6709\u7279\u6027\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7279\u6027\u5217\u8868\u3002 \u5728\u6240\u6709\u73af\u5883\u4e2d\u7ec4\u5408\u5de5\u4f5c:\u751f\u4ea7\u3001\u5206\u6bb5\u3001\u5f00\u53d1\u3001\u6d4b\u8bd5\uff0c\u4ee5\u53caCI\u5de5\u4f5c\u6d41\u3002\u60a8\u53ef\u4ee5\u5728\u5e38\u89c1\u7528\u4f8b\u4e2d\u4e86\u89e3\u5173\u4e8e\u6bcf\u4e2a\u7528\u4f8b\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u4f7f\u7528Compose\u57fa\u672c\u4e0a\u6709\u4e09\u4e2a\u6b65\u9aa4: 1\u3001\u7528Dockerfile\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u7684\u73af\u5883\uff0c\u8fd9\u6837\u5b83\u5c31\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u590d\u5236\u3002 2\u3001\u5728docker-compose.yml\u4e2d\u5b9a\u4e49\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u670d\u52a1\uff0c\u4ee5\u4fbf\u5b83\u4eec\u53ef\u4ee5\u5728\u9694\u79bb\u7684\u73af\u5883\u4e2d\u4e00\u8d77\u8fd0\u884c\u3002 3\u3001\u8fd0\u884cdocker-compose up\u548cCompose starts\u5e76\u8fd0\u884c\u6574\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002 \u4f5c\u7528\uff1a\u6279\u91cf\u5bb9\u5668\u7f16\u6392\u3002 \u81ea\u5df1\u7406\u89e3\uff1a Comepose\u662fDocker\u5b98\u65b9\u7684\u5f00\u6e90\u9879\u76ee\uff0c\u9700\u8981\u5b89\u88c5\uff01 Dockerfile\u8ba9\u7a0b\u5e8f\u5728\u4efb\u4f55\u5730\u65b9\u8fd0\u884c\u3002web\u670d\u52a1\u3001redis\u3001nginx...\u591a\u4e2a\u5bb9\u5668\u3002 docker-compose.yml\u4f8b\u5b50\uff1a version: \"3.9\" services: web: build: . ports: - \"5000:5000\" volumes: - .:/code - logvolume01:/var/log links: - redis redis: image: redis volumes: logvolume01: {} docker compose up \u4e00\u6b21\u542f\u52a8\u591a\u4e2a\u670d\u52a1\u3002","title":"Docker Compose\u4ecb\u7ecd"},{"location":"Docker/#docker-compose_2","text":"Comepose:\u91cd\u8981\u6982\u5ff5 \u670d\u52a1services\uff0c\u5e94\u7528\uff08web\u3001redis\u3001mysql\uff09 \u9879\u76eeproject,\u4e00\u7ec4\u5173\u8054\u7684\u5bb9\u5668\u3002","title":"Docker Compose\u6982\u5ff5"},{"location":"Docker/#compose","text":"1\u3001\u4e0b\u8f7d \u5b98\u65b9\u5730\u5740\uff1a\u4e0b\u8f7d\u8f83\u6162 sudo curl -L \"https://github.com/docker/compose/releases/download/1.27.4/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose \u56fd\u5185\u955c\u50cf\u5730\u5740\uff1a curl -L https://get.daocloud.io/docker/compose/releases/download/1.27.4/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose 2\u3001\u589e\u52a0\u53ef\u6267\u884c\u6743\u9650 sudo chmod +x /usr/local/bin/docker-compose \u786e\u8ba4 [root@localhost ~]# docker-compose --version docker-compose version 1.27.4, build 40524192 [root@localhost ~]#","title":"Compose\u5b89\u88c5"},{"location":"Docker/#compose_1","text":"https://docs.docker.com/compose/gettingstarted/ \u5b98\u65b9\u8bf4\u660e \u5728\u8fd9\u4e2a\u9875\u9762\u4e0a\uff0c\u60a8\u6784\u5efa\u4e86\u4e00\u4e2a\u8fd0\u884c\u5728 Docker Compose \u4e0a\u7684\u7b80\u5355 Python web \u5e94\u7528\u7a0b\u5e8f\u3002\u8be5\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u4e86 Flask \u6846\u67b6\uff0c\u5e76\u5728 Redis \u7ef4\u62a4\u4e86\u4e00\u4e2a\u70b9\u51fb\u8ba1\u6570\u5668\u3002\u867d\u7136\u793a\u4f8b\u4f7f\u7528 Python\uff0c\u4f46\u8fd9\u91cc\u6f14\u793a\u7684\u6982\u5ff5\u5e94\u8be5\u662f\u53ef\u4ee5\u7406\u89e3\u7684\uff0c\u5373\u4f7f\u60a8\u4e0d\u719f\u6089\u5b83\u3002\u5148\u51b3\u6761\u4ef6\u786e\u4fdd\u60a8\u5df2\u7ecf\u5b89\u88c5\u4e86 Docker \u5f15\u64ce\u548c Docker Compose\u3002\u60a8\u4e0d\u9700\u8981\u5b89\u88c5 Python \u6216 Redis\uff0c\u56e0\u4e3a\u5b83\u4eec\u90fd\u662f\u7531 Docker \u6620\u50cf\u63d0\u4f9b\u7684\u3002 1\u3001\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u7684\u4f9d\u8d56\u9879\u3002\u4e3a\u9879\u76ee\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55 [root@localhost ~]# cd /data/ [root@localhost data]# mkdir composetest [root@localhost data]# cd composetest [root@localhost composetest]# 2\u3001\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aapp.py\u7684\u6587\u4ef6,\u5e76\u5c06\u4ee5\u4e0b\u5185\u5bb9\u7c98\u8d34\u5230\u6587\u4ef6\u4e2d import time import redis from flask import Flask app = Flask(__name__) cache = redis.Redis(host='redis', port=6379) def get_hit_count(): retries = 5 while True: try: return cache.incr('hits') except redis.exceptions.ConnectionError as exc: if retries == 0: raise exc retries -= 1 time.sleep(0.5) @app.route('/') def hello(): count = get_hit_count() return 'Hello World! I have been seen {} times.\\n'.format(count) \u5728\u6b64\u793a\u4f8b\u4e2d\uff0credis\u662f\u5e94\u7528\u7a0b\u5e8f\u7f51\u7edc\u4e0a\u7684redis\u5bb9\u5668\u7684\u4e3b\u673a\u540d\u3002\u6211\u4eec\u4e3aRedis\u4f7f\u7528\u9ed8\u8ba4\u7aef\u53e36379\u3002 \u6ce8\u610fget_hit_count\u51fd\u6570\u7684\u7f16\u5199\u65b9\u5f0f\u3002\u5982\u679credis\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u8fd9\u4e2a\u57fa\u672c\u7684\u91cd\u8bd5\u5faa\u73af\u5141\u8bb8\u6211\u4eec\u591a\u6b21\u5c1d\u8bd5\u8bf7\u6c42\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u4e0a\u7ebf\u65f6\uff0c\u8fd9\u5728\u542f\u52a8\u65f6\u5f88\u6709\u7528\uff0c\u4f46\u662f\u5982\u679c\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u751f\u547d\u5468\u671f\u5185\u9700\u8981\u91cd\u65b0\u542f\u52a8Redis\u670d\u52a1\uff0c\u8fd9\u4e5f\u4f7f\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u66f4\u6709\u5f39\u6027\u3002\u5728\u96c6\u7fa4\u4e2d\uff0c\u8fd9\u4e5f\u6709\u52a9\u4e8e\u5904\u7406\u8282\u70b9\u4e4b\u95f4\u7684\u77ac\u65f6\u8fde\u63a5\u4e2d\u65ad\u3002 3\u3001\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa\u53e6\u4e00\u4e2a\u540d\u4e3arequirements.txt\u7684\u6587\u4ef6\uff0c\u5e76\u5c06\u4ee5\u4e0b\u5185\u5bb9\u7c98\u8d34\u5230\u6587\u4ef6\u4e2d [root@localhost composetest]# cat requirements.txt flask redis [root@localhost composetest]#","title":"\u5f00\u59cbcompose"},{"location":"Docker/#dockerfile_6","text":"\u5728\u8fd9\u4e00\u6b65\u4e2d\uff0c\u60a8\u5c06\u7f16\u5199\u4e00\u4e2aDockerfile\u6765\u6784\u5efaDocker\u6620\u50cf\u3002\u56fe\u50cf\u5305\u542bPython\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u7684\u6240\u6709\u4f9d\u8d56\u9879\uff0c\u5305\u62ecPython\u672c\u8eab\u3002 \u5728\u9879\u76ee\u76ee\u5f55\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aDockerfile\u7684\u6587\u4ef6\u5e76\u7c98\u8d34\u4ee5\u4e0b\u5185\u5bb9\uff1a FROM python:3.7-alpine WORKDIR /code ENV FLASK_APP=app.py ENV FLASK_RUN_HOST=0.0.0.0 RUN apk add --no-cache gcc musl-dev linux-headers COPY requirements.txt requirements.txt RUN pip install -r requirements.txt EXPOSE 5000 COPY . . CMD [\"flask\", \"run\"] \u8fd9\u544a\u8bc9Docker\uff1a \u4ecepython3.7\u6620\u50cf\u5f00\u59cb\u6784\u5efa\u4e00\u4e2a\u6620\u50cf\u3002 \u5c06\u5de5\u4f5c\u76ee\u5f55\u8bbe\u7f6e\u4e3a/code\u3002 \u8bbe\u7f6eflask\u547d\u4ee4\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u3002 \u5b89\u88c5gcc\u548c\u5176\u4ed6\u4f9d\u8d56\u9879 \u590d\u5236\u8981\u6c42.txt\u5e76\u5b89\u88c5Python\u4f9d\u8d56\u9879\u3002 \u5411\u6620\u50cf\u6dfb\u52a0\u5143\u6570\u636e\uff0c\u4ee5\u8bf4\u660e\u5bb9\u5668\u6b63\u5728\u4fa6\u542c\u7aef\u53e35000 \u590d\u5236\u5f53\u524d\u76ee\u5f55\u3002\u5728\u5de5\u7a0b\u4e2d\u3002\u5728\u56fe\u50cf\u4e2d\u3002 \u5c06\u5bb9\u5668\u7684\u9ed8\u8ba4\u547d\u4ee4\u8bbe\u7f6e\u4e3aflask run\u3002","title":"\u521b\u5efaDockerfile"},{"location":"Docker/#_140","text":"1\u3001\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a\u540d\u4e3adocker-compose.yml\u7684\u6587\u4ef6\uff0c\u7136\u540e\u7c98\u8d34\u4ee5\u4e0b\u5185\u5bb9\uff1a version: \"3.9\" services: web: build: . ports: - \"5000:5000\" redis: image: \"redis:alpine\" \u8be5Compose\u6587\u4ef6\u5b9a\u4e49\u4e86\u4e24\u4e2a\u670d\u52a1\uff1aWeb\u548cRedis\u3002 Web\u670d\u52a1 web\u670d\u52a1\u4f7f\u7528\u4ece\u5f53\u524d\u76ee\u5f55\u4e2d\u7684Dockerfile\u6784\u5efa\u7684\u6620\u50cf\u3002\u7136\u540e\u5b83\u5c06\u5bb9\u5668\u548c\u4e3b\u673a\u7ed1\u5b9a\u5230\u516c\u5f00\u7684\u7aef\u53e35000\u3002\u6b64\u793a\u4f8b\u670d\u52a1\u4f7f\u7528Flask web\u670d\u52a1\u5668\u7684\u9ed8\u8ba4\u7aef\u53e35000\u3002 Redis\u670d\u52a1 redis\u670d\u52a1\u4f7f\u7528\u4eceDocker Hub\u6ce8\u518c\u8868\u4e2d\u63d0\u53d6\u7684\u516c\u5171redis\u6620\u50cf\u3002 \u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u76844\u4e2a\u6587\u4ef6\uff1a [root@localhost composetest]# ll total 16 -rw-r--r-- 1 root root 514 Dec 14 23:22 app.py -rw-r--r-- 1 root root 111 Dec 14 23:51 docker-compose.yml -rw-r--r-- 1 root root 252 Dec 14 23:25 Dockerfile -rw-r--r-- 1 root root 12 Dec 14 23:21 requirements.txt [root@localhost composetest]#","title":"\u5b9a\u4e49\u670d\u52a1"},{"location":"Docker/#_141","text":"\u4f7f\u7528Compose\u6784\u5efa\u548c\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u3002 1\u3001\u5728\u9879\u76ee\u76ee\u5f55\u4e2d\uff0c\u901a\u8fc7\u8fd0\u884cdocker-compose up\u6765\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\u3002 docker-compose up 1.\u5e94\u7528app.py 2.Dockerfile \u5e94\u7528\u6253\u5305\u4e3a\u955c\u50cf 3.Docker-compose.yaml\u6587\u4ef6\uff08\u5b9a\u4e49\u6574\u4e2a\u670d\u52a1\u9700\u8981\u7684\u73af\u5883\u3001web\u3001redis,\u5b8c\u6574\u7684\u4e0a\u7ebf\u670d\u52a1\uff09 4.\u542f\u52a8compose\u9879\u76ee\uff08docker-compose up\uff09","title":"\u6784\u5efa\u548c\u8fd0\u884c\u5e94\u7528"},{"location":"Docker/#_142","text":"\u6d41\u7a0b\uff1a \u521b\u5efa\u7f51\u7edc\u2014\u6267\u884cDocker-compose.yaml\u6587\u4ef6\u2014\u542f\u52a8\u670d\u52a1\u3002 \u4e2d\u9014\u62a5\u8b66\u63d0\u793a\u955c\u50cf\u4e0d\u5b58\u5728\uff0c\u6267\u884cdocker-compose build [root@localhost composetest]# docker-compose build redis uses an image, skipping Building web Step 1/10 : FROM python:3.7-alpine ---> 0ce5215b0b31 Step 2/10 : WORKDIR /code ---> Using cache ---> ba1f9f199b82 Step 3/10 : ENV FLASK_APP=app.py ---> Using cache ---> 2fc74b01a73d Step 4/10 : ENV FLASK_RUN_HOST=0.0.0.0 ---> Using cache ---> 32b4aa9e96e0 Step 5/10 : RUN apk add --no-cache gcc musl-dev linux-headers ---> Using cache ---> 950b055b2a97 Step 6/10 : COPY requirements.txt requirements.txt ---> Using cache ---> 7bf0bce3d7a9 Step 7/10 : RUN pip install -r requirements.txt ---> Using cache ---> e18eb5e5bafb Step 8/10 : EXPOSE 5000 ---> Using cache ---> a66622c4cc0f Step 9/10 : COPY . . ---> Using cache ---> 42114f1ec656 Step 10/10 : CMD [\"flask\", \"run\"] ---> Using cache ---> 0f443e7f92e4 Successfully built 0f443e7f92e4 Successfully tagged composetest_web:latest [root@localhost composetest]# \u518d\u6b21\u6267\u884cdocker-compose up\uff0c\u542f\u52a8\u6210\u529f [root@localhost composetest]# docker-compose up Starting composetest_redis_1 ... done Starting composetest_web_1 ... done Attaching to composetest_redis_1, composetest_web_1 redis_1 | 1:C 16 Dec 2020 04:22:40.307 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo redis_1 | 1:C 16 Dec 2020 04:22:40.307 # Redis version=6.0.9, bits=64, commit=00000000, modified=0, pid=1, just started redis_1 | 1:C 16 Dec 2020 04:22:40.307 # Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf redis_1 | 1:M 16 Dec 2020 04:22:40.307 * Running mode=standalone, port=6379. redis_1 | 1:M 16 Dec 2020 04:22:40.307 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128. redis_1 | 1:M 16 Dec 2020 04:22:40.307 # Server initialized redis_1 | 1:M 16 Dec 2020 04:22:40.307 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect. redis_1 | 1:M 16 Dec 2020 04:22:40.307 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo madvise > /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled (set to 'madvise' or 'never'). redis_1 | 1:M 16 Dec 2020 04:22:40.320 * Loading RDB produced by version 6.0.9 redis_1 | 1:M 16 Dec 2020 04:22:40.320 * RDB age 79370 seconds redis_1 | 1:M 16 Dec 2020 04:22:40.320 * RDB memory usage when created 0.77 Mb redis_1 | 1:M 16 Dec 2020 04:22:40.320 * DB loaded from disk: 0.012 seconds redis_1 | 1:M 16 Dec 2020 04:22:40.320 * Ready to accept connections web_1 | * Serving Flask app \"app.py\" web_1 | * Environment: production web_1 | WARNING: This is a development server. Do not use it in a production deployment. web_1 | Use a production WSGI server instead. web_1 | * Debug mode: off web_1 | * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit) \u8bbf\u95ee5000\u7aef\u53e3,\u8ba1\u6570\u5668\uff1a\u6bcf\u8bbf\u95ee\u4e00\u6b21\u52a0\u4e00\u3002 [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 1 times. [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 2 times. [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 3 times. [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 4 times. [root@localhost ~]# curl localhost:5000 Hello World! I have been seen 5 times. [root@localhost ~]# \u5bf9\u5e94\u524d\u9762\u6587\u4ef6app.py\u4e2d\u7684\u5185\u5bb9 import time import redis from flask import Flask app = Flask(__name__) cache = redis.Redis(host='redis', port=6379) def get_hit_count(): retries = 5 while True: try: return cache.incr('hits') except redis.exceptions.ConnectionError as exc: if retries == 0: raise exc retries -= 1 time.sleep(0.5) @app.route('/') def hello(): count = get_hit_count() return 'Hello World! I have been seen {} times.\\n'.format(count) \u67e5\u770b\u8fd0\u884c\u7684\u5bb9\u5668,\u670d\u52a1\u542f\u52a8\u6210\u529f\u3002 [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 4fbea3b1e5c1 composetest_web \"flask run\" 23 hours ago Up About a minute 0.0.0.0:5000->5000/tcp composetest_web_1 061c25816933 redis:alpine \"docker-entrypoint.s\u2026\" 23 hours ago Up About a minute 6379/tcp composetest_redis_1 [root@localhost ~]# \u67e5\u770b\u955c\u50cf [root@localhost ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE composetest_web latest 0f443e7f92e4 47 hours ago 196MB redis alpine f731cd48185c 5 days ago 31.6MB python 3.7-alpine 0ce5215b0b31 5 days ago 41.1MB hello-world latest bf756fb1ae65 11 months ago 13.3kB [root@localhost ~]# \u4ee5\u524d\u90fd\u9700\u8981run\u4e0b\u8f7d\u955c\u50cf\uff0c\u73b0\u5728\u901a\u8fc7docker-compose.yml\u4f1a\u81ea\u52a8\u6784\u5efa\u3002 composetest_web redis python","title":"\u544a\u8b66\u89e3\u51b3"},{"location":"Docker/#_143","text":"composetest_web_1 composetest_redis_1 \u6587\u4ef6\u540d _ _ \u670d\u52a1\u540d _ __num\u6570\u5b57 \u751f\u4ea7\u73af\u5883\uff1a \u591a\u4e2a\u670d\u52a1\u5668\u642d\u5efa\u96c6\u7fa4\u3002 \u96c6\u7fa4\u73af\u5883\uff1a \u670d\u52a1redis\u2014\u591a\u4e2a\u526f\u672c\uff0c\u670d\u52a1\u4e0d\u53ef\u80fd\u53ea\u6709\u4e00\u4e2a\u8fd0\u884c\u5b9e\u4f8b\uff0c\u771f\u5b9e\u73af\u5883\u90fd\u662f\u5f39\u6027\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u9ad8\u53ef\u7528\u3002","title":"\u670d\u52a1\u89c4\u5219"},{"location":"Docker/#_144","text":"\u56e0\u4e3a\u4e0d\u662f\u96c6\u7fa4\uff0c\u6240\u4ee5\u8be5\u547d\u4ee4\u65e0\u6cd5\u67e5\u770b\u670d\u52a1\u3002\u9700\u8981swarm\u96c6\u7fa4\u3002 [root@localhost ~]# docker service ls Error response from daemon: This node is not a swarm manager. Use \"docker swarm init\" or \"docker swarm join\" to connect this node to swarm and try again. [root@localhost ~]#","title":"\u67e5\u770b\u6240\u6709\u670d\u52a1"},{"location":"Docker/#_145","text":"[root@localhost ~]# docker network ls NETWORK ID NAME DRIVER SCOPE bea25d6732f1 bridge bridge local d2a12aac3c49 composetest_default bridge local 0638c33a175f host host local 943386457d17 none null local [root@localhost ~]# composetest_default: \u901a\u8fc7compose\u542f\u52a8\u5c31\u4f1a\u751f\u4ea7\u4e00\u4e2a\u81ea\u5df1\u7684\u7f51\u7edc\u3002 10\u4e2a\u670d\u52a1=>\u9879\u76ee \u9879\u76ee\u4e2d\u7684\u5185\u5bb9\u90fd\u5728\u540c\u4e00\u4e2a\u7f51\u7edc\u4e0b\uff0c\u57df\u540d\u8bbf\u95ee\u3002","title":"\u7f51\u7edc\u89c4\u5219"},{"location":"Docker/#_146","text":"[root@localhost ~]# docker network inspect composetest_default [ { \"Name\": \"composetest_default\", \"Id\": \"d2a12aac3c494f30b43bfbf1cac3668eb2fdfab004fba1de973ea053328e813b\", \"Created\": \"2020-12-14T23:58:05.062718888-05:00\", \"Scope\": \"local\", \"Driver\": \"bridge\", \"EnableIPv6\": false, \"IPAM\": { \"Driver\": \"default\", \"Options\": null, \"Config\": [ { \"Subnet\": \"172.18.0.0/16\", \"Gateway\": \"172.18.0.1\" } ] }, \"Internal\": false, \"Attachable\": true, \"Ingress\": false, \"ConfigFrom\": { \"Network\": \"\" }, \"ConfigOnly\": false, \"Containers\": { \"061c2581693361daca9dd9b1c8e613658e22233c5a327a3a8b01ceff78c276db\": { \"Name\": \"composetest_redis_1\", \"EndpointID\": \"da79080b268347d234943fa0c8e021010e32decde0a56a46a7eba4b61b2ae04c\", \"MacAddress\": \"02:42:ac:12:00:02\", \"IPv4Address\": \"172.18.0.2/16\", \"IPv6Address\": \"\" }, \"4fbea3b1e5c1f2eb880d73422f6af97121c47c13f706cef2dfc384aa8d66a26e\": { \"Name\": \"composetest_web_1\", \"EndpointID\": \"1b980f3b031dc64c76bd9b1fd7aeb9232fd1339f477813750e13866c4173c634\", \"MacAddress\": \"02:42:ac:12:00:03\", \"IPv4Address\": \"172.18.0.3/16\", \"IPv6Address\": \"\" } }, \"Options\": {}, \"Labels\": { \"com.docker.compose.network\": \"default\", \"com.docker.compose.project\": \"composetest\", \"com.docker.compose.version\": \"1.27.4\" } } ] [root@localhost ~]# \"Containers\": web\u548credis\u90fd\u5728\u540c\u4e00\u4e2a\u7f51\u7edc\u4e0b\uff0c\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u57df\u540d\u8bbf\u95ee\u3002 cache = redis.Redis(host='redis', port=6379) \u524d\u9762\u6587\u4ef6\u4e2d\u6ca1\u6709\u5199\u5b9e\u9645\u7684IP\uff0c\u800c\u662fhost='redis',\u8fd9\u6837\u505a\u7684\u597d\u5904\u5c31\u662f\u5047\u5982\u4e00\u4e2a\u670d\u52a1\u6302\u4e86\uff0c\u518d\u6b21\u62c9\u8d77\u4e00\u4e2a\u670d\u52a1\uff0c\u6b64\u65f6IP\u4f1a\u53d8\u66f4\uff0c\u800c\u91c7\u7528host\u8fd9\u79cd\u65b9\u5f0f\u670d\u52a1\u5373\u4f7f\u6302\u6389\u518d\u62c9\u8d77\u4e00\u4e2a\u540c\u6837\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u57df\u540d\u6765\u8bbf\u95ee\u3002","title":"\u67e5\u770b\u7f51\u7edc\u4fe1\u606f"},{"location":"Docker/#_147","text":"\u5fc5\u987b\u5728\u5f53\u524d\u6587\u4ef6\u76ee\u5f55\u4e0b docker-compose down \u6216\u5728\u5982\u4e0b\u9875\u9762 \u6309Ctrl+C \u4ee5\u524d\u90fd\u662f\u5355\u4e2adocker run\u542f\u52a8\u5bb9\u5668\u3002 \u73b0\u5728\u53ef\u4ee5\u901a\u8fc7 docker-compose\u7f16\u5199yaml\u914d\u7f6e\u6587\u4ef6\u7f16\u5199\u670d\u52a1\uff0c\u518d\u901a\u8fc7docker-compose up\u4e00\u952e\u542f\u52a8\u6216\u505c\u6b62\u6240\u6709\u670d\u52a1\u3002","title":"\u505c\u6b62\u670d\u52a1"},{"location":"Docker/#yaml","text":"https://docs.docker.com/compose/compose-file/ \u6838\u5fc3\uff1a3\u5c42\u3002 \u5b98\u7f51\u4f8b\u5b50\uff1a https://docs.docker.com/compose/compose-file/compose-file-v3/ version: \"3.9\" services: redis: image: redis:alpine ports: - \"6379\" networks: - frontend deploy: replicas: 2 update_config: parallelism: 2 delay: 10s restart_policy: condition: on-failure db: image: postgres:9.4 volumes: - db-data:/var/lib/postgresql/data networks: - backend deploy: placement: max_replicas_per_node: 1 constraints: - \"node.role==manager\" vote: image: dockersamples/examplevotingapp_vote:before ports: - \"5000:80\" networks: - frontend depends_on: - redis deploy: replicas: 2 update_config: parallelism: 2 restart_policy: condition: on-failure result: image: dockersamples/examplevotingapp_result:before ports: - \"5001:80\" networks: - backend depends_on: - db deploy: replicas: 1 update_config: parallelism: 2 delay: 10s restart_policy: condition: on-failure worker: image: dockersamples/examplevotingapp_worker networks: - frontend - backend deploy: mode: replicated replicas: 1 labels: [APP=VOTING] restart_policy: condition: on-failure delay: 10s max_attempts: 3 window: 120s placement: constraints: - \"node.role==manager\" visualizer: image: dockersamples/visualizer:stable ports: - \"8080:8080\" stop_grace_period: 1m30s volumes: - \"/var/run/docker.sock:/var/run/docker.sock\" deploy: placement: constraints: - \"node.role==manager\" networks: frontend: backend: volumes: db-data: \u7b2c\u4e00\u5c42\uff1aversion: \"3.9\" \u7b2c\u4e8c\u5c42\uff1aservices:\u4ee5\u53ca\u670d\u52a1\u7684\u914d\u7f6e \u670d\u52a1\u914d\u7f6e\u53c2\u8003\uff1ahttps://docs.docker.com/compose/compose-file/compose-file-v3/\u53f3\u8fb9\u3002 Service configuration reference build context dockerfile args cache_from labels network shm_size target cap_add, cap_drop cgroup_parent command configs Short syntax Long syntax container_name credential_spec Example gMSA configuration depends_on deploy endpoint_mode labels mode placement max_replicas_per_node replicas resources restart_policy rollback_config update_config Not supported for docker stack deploy devices dns dns_search entrypoint env_file environment expose external_links extra_hosts healthcheck image init isolation labels links logging network_mode networks aliases ipv4_address, ipv6_address pid ports Short syntax Long syntax restart secrets Short syntax Long syntax security_opt stop_grace_period stop_signal sysctls tmpfs ulimits userns_mode volumes Short syntax Long syntax Volumes for services, swarms, and stack files domainname, hostname, ipc, mac_address, privileged, read_only, shm_size, stdin_open, tty, user, working_dir Specifying durations Specifying byte values Volume configuration reference driver driver_opts external labels name Network configuration reference driver bridge overlay host or none driver_opts attachable enable_ipv6 ipam internal labels external name \u7b2c\u4e09\u5c42\uff1a\u5176\u4ed6\u914d\u7f6e\uff08volumes\u3001networks\u3001configs\uff09 depends_on \u4f9d\u8d56\uff0c\u786e\u4fdd\u670d\u52a1\u4f9d\u8d56\u5173\u7cfb\u6b63\u786e\u3002 web\u670d\u52a1\u4e2d\u5199depends on,web\u670d\u52a1\u4f9d\u8d56redis\u548cdb,\u6240\u4ee5\u4f1a\u4f18\u5148\u542f\u52a8\u5176\u4ed62\u4e2a\u670d\u52a1\u3002 deploy \u4e2d\u6709\u4e2areplicas: 6\u662f\u526f\u672c\u7684\u610f\u601d\u3002","title":"YAML\u7f16\u5199\u89c4\u5219"},{"location":"Docker/#_148","text":"\u4f20\u7edf\uff1a\u4e0b\u8f7d\u7a0b\u5e8f\uff0c\u5b89\u88c5\u6570\u636e\u5e93\uff0c\u914d\u7f6e... compose\u7f16\u5199\u5e94\u7528\uff0c\u4e00\u952e\u542f\u52a8\uff01 \u5b98\u7f51\u4f8b\u5b50\uff1ahttps://docs.docker.com/compose/wordpress/ WordPress\u662f\u4f7f\u7528 PHP \u8bed\u8a00\u5f00\u53d1\u7684\u535a\u5ba2\u5e73\u53f0\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u652f\u6301PHP\u548cMySQL\u6570\u636e\u5e93\u7684 \u670d\u52a1\u5668 \u4e0a\u67b6\u8bbe\u5c5e\u4e8e\u81ea\u5df1\u7684\u7f51\u7ad9\u3002\u4e5f\u53ef\u4ee5\u628a WordPress\u5f53\u4f5c\u4e00\u4e2a \u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf \uff08CMS\uff09\u6765\u4f7f\u7528\u3002 1.\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u9879\u76ee\u76ee\u5f55\u3002 [root@localhost ~]# cd /data/ [root@localhost data]# mkdir wordpress [root@localhost data]# ls composetest wordpress [root@localhost data]# 2.\u5207\u6362\u5230\u9879\u76ee\u76ee\u5f55\u3002 [root@localhost data]# cd wordpress/ [root@localhost wordpress]# ls [root@localhost wordpress]# 3.\u521b\u5efa\u4e00\u4e2a docker-compose\u3002\u4e00\u4e2a yml \u6587\u4ef6\uff0c\u7528\u4e8e\u542f\u52a8\u4f60\u7684 WordPress \u535a\u5ba2\u548c\u4e00\u4e2a\u72ec\u7acb\u7684 MySQL \u5b9e\u4f8b\uff0c\u5b83\u6709\u4e00\u4e2a\u6570\u636e\u6301\u4e45\u6027\u7684\u5377\u88c5\u8f7d. \u63d0\u793a: \u60a8\u53ef\u4ee5\u4e3a\u8fd9\u4e2a\u6587\u4ef6\u4f7f\u7528.yml \u6216.yaml \u6269\u5c55\u540d\uff0c\u90fd\u53ef\u4ee5\u5de5\u4f5c\u3002 [root@localhost wordpress]# vim docker-compose.yml version: '3.3' services: db: image: mysql:5.7 volumes: - db_data:/var/lib/mysql restart: always environment: MYSQL_ROOT_PASSWORD: somewordpress MYSQL_DATABASE: wordpress MYSQL_USER: wordpress MYSQL_PASSWORD: wordpress wordpress: depends_on: - db image: wordpress:latest ports: - \"8000:80\" restart: always environment: WORDPRESS_DB_HOST: db:3306 WORDPRESS_DB_USER: wordpress WORDPRESS_DB_PASSWORD: wordpress WORDPRESS_DB_NAME: wordpress volumes: db_data: {} \u5907\u6ce8\uff1a depends_on\uff1a\u4f9d\u8d56\u4e8e\u4e0a\u4e00\u4e2a environment:\u73af\u5883\u914d\u7f6e \u542f\u52a8\u4e00\u4e2awordpress\u4f9d\u8d56\u4e8emysql\u3002 4.\u4ece\u9879\u76ee\u76ee\u5f55\u8fd0\u884c docker-compose up -d docker-compose up -d:\u540e\u53f0\u542f\u52a8 \u542f\u52a8\u8fc7\u7a0b\uff1a [root@localhost wordpress]# docker-compose up -d Creating network \"wordpress_default\" with the default driver Creating volume \"wordpress_db_data\" with default driver Pulling db (mysql:5.7)... 5.7: Pulling from library/mysql 6ec7b7d162b2: Pull complete fedd960d3481: Pull complete 7ab947313861: Pull complete 64f92f19e638: Pull complete 3e80b17bff96: Pull complete 014e976799f9: Pull complete 59ae84fee1b3: Pull complete 7d1da2a18e2e: Pull complete 301a28b700b9: Pull complete 529dc8dbeaf3: Pull complete bc9d021dc13f: Pull complete Digest: sha256:c3a567d3e3ad8b05dfce401ed08f0f6bf3f3b64cc17694979d5f2e5d78e10173 Status: Downloaded newer image for mysql:5.7 Pulling wordpress (wordpress:latest)... latest: Pulling from library/wordpress 6ec7b7d162b2: Already exists db606474d60c: Pull complete afb30f0cd8e0: Pull complete 3bb2e8051594: Pull complete 4c761b44e2cc: Pull complete c2199db96575: Pull complete 1b9a9381eea8: Pull complete 50450ffc67ee: Pull complete 4d1e5a768e83: Pull complete 5e8be0d1df16: Pull complete 7a6395859d40: Pull complete 7306499d3dce: Pull complete fa6f0ba15ac6: Pull complete 308a9ead128f: Pull complete 2db781a8732e: Pull complete 63d3161e9e46: Pull complete a08dd591ed8a: Pull complete 931a26282f2a: Pull complete f5c6b405e809: Pull complete caf2bb847f73: Pull complete Digest: sha256:dadd8e9c2ef6dc2fe146cbc5f2edc0ed8ae1026ae252b52f25791be4d7d16600 Status: Downloaded newer image for wordpress:latest Creating wordpress_db_1 ... done Creating wordpress_wordpress_1 ... done [root@localhost wordpress]# docker-compose up -d wordpress_db_1 is up-to-date wordpress_wordpress_1 is up-to-date [root@localhost wordpress]# docker-compose up wordpress_db_1 is up-to-date wordpress_wordpress_1 is up-to-date Attaching to wordpress_db_1, wordpress_wordpress_1 db_1 | 2021-01-06 09:19:34+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.32-1debian10 started. db_1 | 2021-01-06 09:19:34+00:00 [Note] [Entrypoint]: Switching to dedicated user 'mysql' db_1 | 2021-01-06 09:19:34+00:00 [Note] [Entrypoint]: Entrypoint script for MySQL Server 5.7.32-1debian10 started. db_1 | 2021-01-06 09:19:34+00:00 [Note] [Entrypoint]: Initializing database files db_1 | 2021-01-06T09:19:35.000436Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). db_1 | 2021-01-06T09:19:35.482173Z 0 [Warning] InnoDB: New log files created, LSN=45790 db_1 | 2021-01-06T09:19:35.597659Z 0 [Warning] InnoDB: Creating foreign key constraint system tables. db_1 | 2021-01-06T09:19:35.678204Z 0 [Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: 4b32e97d-5000-11eb-8c6b-0242ac130002. db_1 | 2021-01-06T09:19:35.682249Z 0 [Warning] Gtid table is not ready to be used. Table 'mysql.gtid_executed' cannot be opened. db_1 | 2021-01-06T09:19:36.436871Z 0 [Warning] CA certificate ca.pem is self signed. db_1 | 2021-01-06T09:19:36.664740Z 1 [Warning] root@localhost is created with an empty password ! Please consider switching off the --initialize-insecure option. db_1 | 2021-01-06 09:19:38+00:00 [Note] [Entrypoint]: Database files initialized db_1 | 2021-01-06 09:19:38+00:00 [Note] [Entrypoint]: Starting temporary server db_1 | 2021-01-06 09:19:38+00:00 [Note] [Entrypoint]: Waiting for server startup db_1 | 2021-01-06T09:19:39.125099Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). db_1 | 2021-01-06T09:19:39.133047Z 0 [Note] mysqld (mysqld 5.7.32) starting as process 77 ... db_1 | 2021-01-06T09:19:39.176985Z 0 [Note] InnoDB: PUNCH HOLE support available db_1 | 2021-01-06T09:19:39.177009Z 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins db_1 | 2021-01-06T09:19:39.177012Z 0 [Note] InnoDB: Uses event mutexes db_1 | 2021-01-06T09:19:39.177014Z 0 [Note] InnoDB: GCC builtin __atomic_thread_fence() is used for memory barrier db_1 | 2021-01-06T09:19:39.177016Z 0 [Note] InnoDB: Compressed tables use zlib 1.2.11 db_1 | 2021-01-06T09:19:39.177019Z 0 [Note] InnoDB: Using Linux native AIO db_1 | 2021-01-06T09:19:39.177210Z 0 [Note] InnoDB: Number of pools: 1 db_1 | 2021-01-06T09:19:39.177390Z 0 [Note] InnoDB: Using CPU crc32 instructions db_1 | 2021-01-06T09:19:39.181520Z 0 [Note] InnoDB: Initializing buffer pool, total size = 128M, instances = 1, chunk size = 128M db_1 | 2021-01-06T09:19:39.194255Z 0 [Note] InnoDB: Completed initialization of buffer pool db_1 | 2021-01-06T09:19:39.202793Z 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority(). db_1 | 2021-01-06T09:19:39.222672Z 0 [Note] InnoDB: Highest supported file format is Barracuda. db_1 | 2021-01-06T09:19:39.260853Z 0 [Note] InnoDB: Creating shared tablespace for temporary tables db_1 | 2021-01-06T09:19:39.260954Z 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ... db_1 | 2021-01-06T09:19:39.312019Z 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB. db_1 | 2021-01-06T09:19:39.321067Z 0 [Note] InnoDB: 96 redo rollback segment(s) found. 96 redo rollback segment(s) are active. db_1 | 2021-01-06T09:19:39.321123Z 0 [Note] InnoDB: 32 non-redo rollback segment(s) are active. db_1 | 2021-01-06T09:19:39.325037Z 0 [Note] InnoDB: Waiting for purge to start db_1 | 2021-01-06T09:19:39.376297Z 0 [Note] InnoDB: 5.7.32 started; log sequence number 2746702 db_1 | 2021-01-06T09:19:39.378041Z 0 [Note] Plugin 'FEDERATED' is disabled. db_1 | 2021-01-06T09:19:39.387166Z 0 [Note] InnoDB: Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool db_1 | 2021-01-06T09:19:39.417925Z 0 [Note] InnoDB: Buffer pool(s) load completed at 210106 9:19:39 db_1 | 2021-01-06T09:19:39.426605Z 0 [Note] Found ca.pem, server-cert.pem and server-key.pem in data directory. Trying to enable SSL support using them. db_1 | 2021-01-06T09:19:39.426627Z 0 [Note] Skipping generation of SSL certificates as certificate files are present in data directory. db_1 | 2021-01-06T09:19:39.427642Z 0 [Warning] CA certificate ca.pem is self signed. db_1 | 2021-01-06T09:19:39.427726Z 0 [Note] Skipping generation of RSA key pair as key files are present in data directory. db_1 | 2021-01-06T09:19:39.431945Z 0 [Warning] Insecure configuration for --pid-file: Location '/var/run/mysqld' in the path is accessible to all OS users. Consider choosing a different directory. db_1 | 2021-01-06T09:19:39.443443Z 0 [Note] Event Scheduler: Loaded 0 events db_1 | 2021-01-06T09:19:39.443720Z 0 [Note] mysqld: ready for connections. db_1 | Version: '5.7.32' socket: '/var/run/mysqld/mysqld.sock' port: 0 MySQL Community Server (GPL) db_1 | 2021-01-06 09:19:39+00:00 [Note] [Entrypoint]: Temporary server started. db_1 | Warning: Unable to load '/usr/share/zoneinfo/iso3166.tab' as time zone. Skipping it. db_1 | Warning: Unable to load '/usr/share/zoneinfo/leap-seconds.list' as time zone. Skipping it. db_1 | Warning: Unable to load '/usr/share/zoneinfo/zone.tab' as time zone. Skipping it. db_1 | Warning: Unable to load '/usr/share/zoneinfo/zone1970.tab' as time zone. Skipping it. db_1 | 2021-01-06 09:19:41+00:00 [Note] [Entrypoint]: Creating database wordpress db_1 | 2021-01-06 09:19:41+00:00 [Note] [Entrypoint]: Creating user wordpress db_1 | 2021-01-06 09:19:41+00:00 [Note] [Entrypoint]: Giving user wordpress access to schema wordpress db_1 | db_1 | 2021-01-06 09:19:41+00:00 [Note] [Entrypoint]: Stopping temporary server db_1 | 2021-01-06T09:19:41.455747Z 0 [Note] Giving 0 client threads a chance to die gracefully db_1 | 2021-01-06T09:19:41.455763Z 0 [Note] Shutting down slave threads db_1 | 2021-01-06T09:19:41.455769Z 0 [Note] Forcefully disconnecting 0 remaining clients db_1 | 2021-01-06T09:19:41.455773Z 0 [Note] Event Scheduler: Purging the queue. 0 events db_1 | 2021-01-06T09:19:41.455919Z 0 [Note] Binlog end db_1 | 2021-01-06T09:19:41.456361Z 0 [Note] Shutting down plugin 'ngram' db_1 | 2021-01-06T09:19:41.456368Z 0 [Note] Shutting down plugin 'partition' db_1 | 2021-01-06T09:19:41.456370Z 0 [Note] Shutting down plugin 'BLACKHOLE' db_1 | 2021-01-06T09:19:41.456372Z 0 [Note] Shutting down plugin 'ARCHIVE' db_1 | 2021-01-06T09:19:41.456374Z 0 [Note] Shutting down plugin 'PERFORMANCE_SCHEMA' db_1 | 2021-01-06T09:19:41.456391Z 0 [Note] Shutting down plugin 'MRG_MYISAM' db_1 | 2021-01-06T09:19:41.456395Z 0 [Note] Shutting down plugin 'MyISAM' db_1 | 2021-01-06T09:19:41.456400Z 0 [Note] Shutting down plugin 'INNODB_SYS_VIRTUAL' db_1 | 2021-01-06T09:19:41.456402Z 0 [Note] Shutting down plugin 'INNODB_SYS_DATAFILES' db_1 | 2021-01-06T09:19:41.456404Z 0 [Note] Shutting down plugin 'INNODB_SYS_TABLESPACES' db_1 | 2021-01-06T09:19:41.456405Z 0 [Note] Shutting down plugin 'INNODB_SYS_FOREIGN_COLS' db_1 | 2021-01-06T09:19:41.456407Z 0 [Note] Shutting down plugin 'INNODB_SYS_FOREIGN' db_1 | 2021-01-06T09:19:41.456408Z 0 [Note] Shutting down plugin 'INNODB_SYS_FIELDS' db_1 | 2021-01-06T09:19:41.456410Z 0 [Note] Shutting down plugin 'INNODB_SYS_COLUMNS' db_1 | 2021-01-06T09:19:41.456411Z 0 [Note] Shutting down plugin 'INNODB_SYS_INDEXES' db_1 | 2021-01-06T09:19:41.456413Z 0 [Note] Shutting down plugin 'INNODB_SYS_TABLESTATS' db_1 | 2021-01-06T09:19:41.456414Z 0 [Note] Shutting down plugin 'INNODB_SYS_TABLES' db_1 | 2021-01-06T09:19:41.456416Z 0 [Note] Shutting down plugin 'INNODB_FT_INDEX_TABLE' db_1 | 2021-01-06T09:19:41.456417Z 0 [Note] Shutting down plugin 'INNODB_FT_INDEX_CACHE' db_1 | 2021-01-06T09:19:41.456419Z 0 [Note] Shutting down plugin 'INNODB_FT_CONFIG' db_1 | 2021-01-06T09:19:41.456420Z 0 [Note] Shutting down plugin 'INNODB_FT_BEING_DELETED' db_1 | 2021-01-06T09:19:41.456421Z 0 [Note] Shutting down plugin 'INNODB_FT_DELETED' db_1 | 2021-01-06T09:19:41.456423Z 0 [Note] Shutting down plugin 'INNODB_FT_DEFAULT_STOPWORD' db_1 | 2021-01-06T09:19:41.456424Z 0 [Note] Shutting down plugin 'INNODB_METRICS' db_1 | 2021-01-06T09:19:41.456425Z 0 [Note] Shutting down plugin 'INNODB_TEMP_TABLE_INFO' db_1 | 2021-01-06T09:19:41.456427Z 0 [Note] Shutting down plugin 'INNODB_BUFFER_POOL_STATS' db_1 | 2021-01-06T09:19:41.456429Z 0 [Note] Shutting down plugin 'INNODB_BUFFER_PAGE_LRU' db_1 | 2021-01-06T09:19:41.456430Z 0 [Note] Shutting down plugin 'INNODB_BUFFER_PAGE' db_1 | 2021-01-06T09:19:41.456431Z 0 [Note] Shutting down plugin 'INNODB_CMP_PER_INDEX_RESET' db_1 | 2021-01-06T09:19:41.456433Z 0 [Note] Shutting down plugin 'INNODB_CMP_PER_INDEX' db_1 | 2021-01-06T09:19:41.456434Z 0 [Note] Shutting down plugin 'INNODB_CMPMEM_RESET' db_1 | 2021-01-06T09:19:41.456435Z 0 [Note] Shutting down plugin 'INNODB_CMPMEM' db_1 | 2021-01-06T09:19:41.456437Z 0 [Note] Shutting down plugin 'INNODB_CMP_RESET' db_1 | 2021-01-06T09:19:41.456438Z 0 [Note] Shutting down plugin 'INNODB_CMP' db_1 | 2021-01-06T09:19:41.456439Z 0 [Note] Shutting down plugin 'INNODB_LOCK_WAITS' db_1 | 2021-01-06T09:19:41.456441Z 0 [Note] Shutting down plugin 'INNODB_LOCKS' db_1 | 2021-01-06T09:19:41.456442Z 0 [Note] Shutting down plugin 'INNODB_TRX' db_1 | 2021-01-06T09:19:41.456444Z 0 [Note] Shutting down plugin 'InnoDB' db_1 | 2021-01-06T09:19:41.456478Z 0 [Note] InnoDB: FTS optimize thread exiting. db_1 | 2021-01-06T09:19:41.456713Z 0 [Note] InnoDB: Starting shutdown... db_1 | 2021-01-06T09:19:41.558263Z 0 [Note] InnoDB: Dumping buffer pool(s) to /var/lib/mysql/ib_buffer_pool db_1 | 2021-01-06T09:19:41.560067Z 0 [Note] InnoDB: Buffer pool(s) dump completed at 210106 9:19:41 db_1 | 2021-01-06T09:19:43.273861Z 0 [Note] InnoDB: Shutdown completed; log sequence number 12617575 db_1 | 2021-01-06T09:19:43.275009Z 0 [Note] InnoDB: Removed temporary tablespace data file: \"ibtmp1\" db_1 | 2021-01-06T09:19:43.275028Z 0 [Note] Shutting down plugin 'MEMORY' db_1 | 2021-01-06T09:19:43.275037Z 0 [Note] Shutting down plugin 'CSV' db_1 | 2021-01-06T09:19:43.275041Z 0 [Note] Shutting down plugin 'sha256_password' db_1 | 2021-01-06T09:19:43.275043Z 0 [Note] Shutting down plugin 'mysql_native_password' db_1 | 2021-01-06T09:19:43.275124Z 0 [Note] Shutting down plugin 'binlog' db_1 | 2021-01-06T09:19:43.275626Z 0 [Note] mysqld: Shutdown complete db_1 | db_1 | 2021-01-06 09:19:43+00:00 [Note] [Entrypoint]: Temporary server stopped db_1 | db_1 | 2021-01-06 09:19:43+00:00 [Note] [Entrypoint]: MySQL init process done. Ready for start up. db_1 | db_1 | 2021-01-06T09:19:43.638878Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). db_1 | 2021-01-06T09:19:43.640547Z 0 [Note] mysqld (mysqld 5.7.32) starting as process 1 ... db_1 | 2021-01-06T09:19:43.644140Z 0 [Note] InnoDB: PUNCH HOLE support available db_1 | 2021-01-06T09:19:43.644167Z 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins db_1 | 2021-01-06T09:19:43.644171Z 0 [Note] InnoDB: Uses event mutexes db_1 | 2021-01-06T09:19:43.644237Z 0 [Note] InnoDB: GCC builtin __atomic_thread_fence() is used for memory barrier db_1 | 2021-01-06T09:19:43.644241Z 0 [Note] InnoDB: Compressed tables use zlib 1.2.11 db_1 | 2021-01-06T09:19:43.644246Z 0 [Note] InnoDB: Using Linux native AIO db_1 | 2021-01-06T09:19:43.644413Z 0 [Note] InnoDB: Number of pools: 1 db_1 | 2021-01-06T09:19:43.644521Z 0 [Note] InnoDB: Using CPU crc32 instructions db_1 | 2021-01-06T09:19:43.645817Z 0 [Note] InnoDB: Initializing buffer pool, total size = 128M, instances = 1, chunk size = 128M db_1 | 2021-01-06T09:19:43.652932Z 0 [Note] InnoDB: Completed initialization of buffer pool db_1 | 2021-01-06T09:19:43.654891Z 0 [Note] InnoDB: If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority(). db_1 | 2021-01-06T09:19:43.666791Z 0 [Note] InnoDB: Highest supported file format is Barracuda. db_1 | 2021-01-06T09:19:43.680623Z 0 [Note] InnoDB: Creating shared tablespace for temporary tables db_1 | 2021-01-06T09:19:43.680704Z 0 [Note] InnoDB: Setting file './ibtmp1' size to 12 MB. Physically writing the file full; Please wait ... db_1 | 2021-01-06T09:19:43.698427Z 0 [Note] InnoDB: File './ibtmp1' size is now 12 MB. db_1 | 2021-01-06T09:19:43.698911Z 0 [Note] InnoDB: 96 redo rollback segment(s) found. 96 redo rollback segment(s) are active. db_1 | 2021-01-06T09:19:43.698918Z 0 [Note] InnoDB: 32 non-redo rollback segment(s) are active. db_1 | 2021-01-06T09:19:43.699150Z 0 [Note] InnoDB: Waiting for purge to start db_1 | 2021-01-06T09:19:43.750903Z 0 [Note] InnoDB: 5.7.32 started; log sequence number 12617575 db_1 | 2021-01-06T09:19:43.752692Z 0 [Note] Plugin 'FEDERATED' is disabled. db_1 | 2021-01-06T09:19:43.763484Z 0 [Note] InnoDB: Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool db_1 | 2021-01-06T09:19:43.777047Z 0 [Note] InnoDB: Buffer pool(s) load completed at 210106 9:19:43 db_1 | 2021-01-06T09:19:43.778348Z 0 [Note] Found ca.pem, server-cert.pem and server-key.pem in data directory. Trying to enable SSL support using them. db_1 | 2021-01-06T09:19:43.778372Z 0 [Note] Skipping generation of SSL certificates as certificate files are present in data directory. db_1 | 2021-01-06T09:19:43.779331Z 0 [Warning] CA certificate ca.pem is self signed. db_1 | 2021-01-06T09:19:43.779426Z 0 [Note] Skipping generation of RSA key pair as key files are present in data directory. db_1 | 2021-01-06T09:19:43.781025Z 0 [Note] Server hostname (bind-address): '*'; port: 3306 db_1 | 2021-01-06T09:19:43.781193Z 0 [Note] IPv6 is available. db_1 | 2021-01-06T09:19:43.781211Z 0 [Note] - '::' resolves to '::'; db_1 | 2021-01-06T09:19:43.781254Z 0 [Note] Server socket created on IP: '::'. db_1 | 2021-01-06T09:19:43.783683Z 0 [Warning] Insecure configuration for --pid-file: Location '/var/run/mysqld' in the path is accessible to all OS users. Consider choosing a different directory. db_1 | 2021-01-06T09:19:43.792136Z 0 [Note] Event Scheduler: Loaded 0 events db_1 | 2021-01-06T09:19:43.792261Z 0 [Note] mysqld: ready for connections. db_1 | Version: '5.7.32' socket: '/var/run/mysqld/mysqld.sock' port: 3306 MySQL Community Server (GPL) wordpress_1 | WordPress not found in /var/www/html - copying now... wordpress_1 | Complete! WordPress has been successfully copied to /var/www/html wordpress_1 | [06-Jan-2021 09:19:37 UTC] PHP Warning: mysqli::__construct(): (HY000/2002): Connection refused in Standard input code on line 22 wordpress_1 | wordpress_1 | MySQL Connection Error: (2002) Connection refused wordpress_1 | wordpress_1 | MySQL Connection Error: (2002) Connection refused wordpress_1 | wordpress_1 | MySQL Connection Error: (2002) Connection refused wordpress_1 | AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.19.0.3. Set the 'ServerName' directive globally to suppress this message wordpress_1 | AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.19.0.3. Set the 'ServerName' directive globally to suppress this message wordpress_1 | [Wed Jan 06 09:19:46.171484 2021] [mpm_prefork:notice] [pid 1] AH00163: Apache/2.4.38 (Debian) PHP/7.4.13 configured -- resuming normal operations wordpress_1 | [Wed Jan 06 09:19:46.171532 2021] [core:notice] [pid 1] AH00094: Command line: 'apache2 -D FOREGROUND' Docker-compose up\uff1a \u8fd9\u5c06\u4ee5\u5206\u79bb\u6a21\u5f0f\u8fd0\u884c Docker-compose up\uff0c\u83b7\u53d6\u6240\u9700\u7684 Docker \u6620\u50cf\uff0c\u5e76\u542f\u52a8 wordpress \u548c\u6570\u636e\u5e93\u5bb9\u5668\u3002 docker-compose up -d:\u540e\u53f0\u542f\u52a8 docker-compose up --build:\u91cd\u65b0\u6784\u5efa 5.\u6d4b\u8bd5\u8bbf\u95ee http://IP:8000/ \u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528 Docker MACHINE\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c\u547d\u4ee4 Docker-MACHINE ip MACHINE _ vm \u6765\u83b7\u53d6\u673a\u5668\u5730\u5740\uff0c\u7136\u540e\u5728 web \u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 http://machine_vm_ip:8000\u3002 dockerfile:\u6784\u5efa\u955c\u50cf\u3002 docker-compose.yaml:\u5b9a\u4e49\u591a\u4e2a\u5bb9\u5668\u4e00\u952e\u542f\u52a8\u6240\u6709\u5bb9\u5668\u3002\u5b9a\u4e49\u591a\u4e2a\u5bb9\u5668\u4e00\u952e\u542f\u52a8\u6240\u6709\u5bb9\u5668\u3002","title":"\u642d\u5efa\u5f00\u6e90\u535a\u5ba2"},{"location":"Docker/#docker-swarm","text":"","title":"Docker Swarm"},{"location":"Docker/#_149","text":"\u51c6\u59074\u53f0\u865a\u62df\u673a\uff0c\u914d\u7f6e\u597d\u7f51\u7edc\uff0c\u53ef\u4ee5\u8bbf\u95ee\u5916\u7f51\u3002 4\u53f0\u670d\u52a1\u5668\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5b89\u88c5Docker\u3002 1.\u5b89\u88c5gcc\u76f8\u5173\u73af\u5883 yum -y install gcc yum -y install gcc-c++ 2.\u5378\u8f7d\u65e7\u7248\u672c yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine 3.\u5b89\u88c5\u57fa\u7840\u5305 yum install -y yum-utils 4.\u6dfb\u52a0\u955c\u50cf\u4ed3\u5e93 \u9ed8\u8ba4\u56fd\u5916\u6e90\uff1a yum-config-manager \\ --add-repo \\ https://download.docker.com/linux/centos/docker-ce.repo \u963f\u91cc\u4e91\uff1a yum-config-manager \\ --add-repo \\ http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo 5.\u66f4\u65b0yum\u8f6f\u4ef6\u5305\u7d22\u5f15 yum makecache fast 6.\u5b89\u88c5 Docker\u5f15\u64ce yum install -y docker-ce docker-ce-cli containerd.io 7.\u542f\u52a8\u5e76\u52a0\u5165\u5f00\u673a\u81ea\u542f\u52a8 systemctl start docker systemctl enable docker \u5224\u65ad\u662f\u5426\u5b89\u88c5\u6210\u529f\uff1a [root@localhost ~]# docker version Client: Docker Engine - Community Version: **19.03.13** API version: 1.40 Go version: **go1.13.15** Git commit: 4484c46d9d Built: Wed Sep 16 17:03:45 2020 OS/Arch: linux/amd64 Experimental: false **Server: Docker Engine - Community** Engine: Version: 19.03.13 API version: 1.40 (minimum version 1.12) Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:02:21 2020 OS/Arch: **linux/amd64** Experimental: false containerd: Version: 1.3.7 GitCommit: 8fba4e9a7d01810a393d5d25a3621dc101981175 runc: Version: 1.0.0-rc10 GitCommit: dc9208a3303feef5b3839f4323d9beb36df0a9dd docker-init: Version: 0.18.0 GitCommit: fec3683 [root@localhost ~]# 8.\u914d\u7f6e\u955c\u50cf\u52a0\u901f\u5668 \u9488\u5bf9Docker\u5ba2\u6237\u7aef\u7248\u672c\u5927\u4e8e 1.10.0 \u7684\u7528\u6237 \u60a8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539daemon\u914d\u7f6e\u6587\u4ef6/etc/docker/daemon.json\u6765\u4f7f\u7528\u52a0\u901f\u5668 sudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json <<-'EOF' { \"registry-mirrors\": [\"https://gnxq79wc.mirror.aliyuncs.com\"] } EOF sudo systemctl daemon-reload sudo systemctl restart docker","title":"\u73af\u5883\u642d\u5efa"},{"location":"Docker/#swarm","text":"\u6587\u6863\uff1ahttps://docs.docker.com/get-started/swarm-deploy/ Swarm\u6982\u8ff0\uff1a \u8981\u5728\u7fa4\u6a21\u5f0f\u4e0b\u4f7f\u7528 Docker\uff0c\u8bf7\u5b89\u88c5 Docker\u3002 \u5f53\u524d\u7248\u672c\u7684 Docker \u5305\u62ecSwarm\u6a21\u578b\uff0c\u7528\u4e8e\u7ba1\u7406\u4e00\u7ec4\u79f0\u4e3aSwarm\u6a21\u578b\u7684 Docker \u5f15\u64ce\u3002\u4f7f\u7528 dockercli \u521b\u5efa\u4e00\u4e2a\u7fa4\u4f53\uff0c\u5c06\u5e94\u7528\u670d\u52a1\u90e8\u7f72\u5230\u4e00\u4e2a\u7fa4\u4f53\uff0c\u5e76\u7ba1\u7406\u7fa4\u4f53\u884c\u4e3a\u3002 \u7279\u70b9\uff1a 1.\u96c6\u7fa4\u7ba1\u7406\u4e0e Docker \u5f15\u64ce\u96c6\u6210\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684\u7f16\u6392\u8f6f\u4ef6\u6765\u521b\u5efa\u6216\u7ba1\u7406\u7fa4\u3002 2.\u5206\u6563\u5f0f\u8bbe\u8ba1master\u4e0eworker 3.\u58f0\u660e\u6027\u670d\u52a1\u6a21\u578b: Docker Engine \u4f7f\u7528\u58f0\u660e\u6027\u65b9\u6cd5\u6765\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u5806\u6808\u4e2d\u5404\u79cd\u670d\u52a1\u7684\u671f\u671b\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u63cf\u8ff0\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u7531\u5177\u6709\u6d88\u606f\u6392\u961f\u670d\u52a1\u548c\u6570\u636e\u5e93\u540e\u7aef\u7684 web \u524d\u7aef\u670d\u52a1\u7ec4\u6210\u3002 4.\u4f38\u7f29\u6027: \u5bf9\u4e8e\u6bcf\u4e2a\u670d\u52a1\uff0c\u60a8\u53ef\u4ee5\u58f0\u660e\u60f3\u8981\u6267\u884c\u7684\u4efb\u52a1\u7684\u6570\u91cf\u3002\u5f53\u4f60\u5411\u4e0a\u6216\u5411\u4e0b\u6269\u5c55\u65f6\uff0c\u7fa4\u7ba1\u7406\u5668\u4f1a\u901a\u8fc7\u6dfb\u52a0\u6216\u5220\u9664\u4efb\u52a1\u6765\u81ea\u52a8\u8c03\u6574\u4ee5\u4fdd\u6301\u6240\u9700\u7684\u72b6\u6001\u3002 5.\u72b6\u6001\u534f\u8c03: \u7fa4\u7ba1\u7406\u5668\u8282\u70b9\u4e0d\u65ad\u76d1\u89c6\u96c6\u7fa4\u72b6\u6001\uff0c\u5e76\u534f\u8c03\u5b9e\u9645\u72b6\u6001\u548c\u60a8\u6240\u9700\u7684\u72b6\u6001\u4e4b\u95f4\u7684\u4efb\u4f55\u5dee\u5f02\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u670d\u52a1\u6765\u8fd0\u884c\u4e00\u4e2a\u5bb9\u5668\u768410\u4e2a\u526f\u672c\uff0c\u5e76\u4e14\u4e00\u4e2a\u5de5\u4f5c\u673a\u5668\u627f\u8f7d\u4e86\u5176\u4e2d\u7684\u4e24\u4e2a\u526f\u672c\u5d29\u6e83\uff0c\u90a3\u4e48\u7ba1\u7406\u5668\u5c06\u521b\u5efa\u4e24\u4e2a\u65b0\u7684\u526f\u672c\u6765\u66ff\u6362\u5d29\u6e83\u7684\u526f\u672c\u3002\u7ba1\u7406\u5668\u5c06\u65b0\u7684\u526f\u672c\u5206\u914d\u7ed9\u6240\u6709\u80fd\u591f\u6267\u884c\u4efb\u52a1\u7684\u5de5\u4f5c\u8005\u3002 6.\u591a\u4e3b\u673a\u7f51\u7edc: \u53ef\u4ee5\u4e3a\u60a8\u7684\u670d\u52a1\u6307\u5b9aoverlay\u7f51\u7edc\u3002\u5f53\u521d\u59cb\u5316\u6216\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0cSwarm manager\u4f1a\u81ea\u52a8\u4e3aoverlay\u7f51\u7edc\u4e0a\u7684\u5bb9\u5668\u5206\u914d\u5730\u5740\u3002 7.\u670d\u52a1\u53d1\u73b0: Swarm manager \u8282\u70b9\u4e3a\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u5206\u914d\u552f\u4e00\u7684 DNS \u540d\u79f0\u548c\u8fd0\u884c\u5bb9\u5668\u7684\u8d1f\u8f7d\u5e73\u8861\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u5d4c\u5165\u5728\u7fa4\u4f53\u4e2d\u7684 DNS \u670d\u52a1\u5668\u67e5\u8be2\u7fa4\u4f53\u4e2d\u8fd0\u884c\u7684\u6bcf\u4e2a\u5bb9\u5668\u3002 8.\u8d1f\u8f7d\u5747\u8861: \u5b9e\u73b0\u670d\u52a1\u526f\u672c\u8d1f\u8f7d\u5747\u8861\uff0c\u63d0\u4f9b\u5165\u53e3\u8bbf\u95ee\u3002\u4e5f\u53ef\u4ee5\u5c06\u670d\u52a1\u5165\u53e3\u66b4\u9732\u7ed9\u5916\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u518d\u6b21\u8d1f\u8f7d\u5747\u8861\u3002 9.\u5b89\u5168\u4f20\u8f93: \u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u5f3a\u5236\u4f7f\u7528TLS \u76f8\u4e92\u8ba4\u8bc1\u548c\u52a0\u5bc6\uff0c\u4ee5\u786e\u4fdd\u81ea\u8eab\u548c\u5176\u4ed6\u8282\u70b9\u4e4b\u95f4\u7684\u901a\u4fe1\u5b89\u5168\u3002\u60a8\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u6765\u81ea\u81ea\u5b9a\u4e49\u6839 CA \u7684\u81ea\u7b7e\u540d\u6839\u8bc1\u4e66\u6216\u8bc1\u4e66\u3002 10.\u6eda\u52a8\u66f4\u65b0: \u5728\u5347\u7ea7\u65f6\uff0c\u9010\u6b65\u5c06\u5e94\u7528\u66f4\u65b0\u5230\u65b0\u7684\u8282\u70b9\u3002Swarm\u5141\u8bb8\u60a8\u63a7\u5236\u4e0d\u540c\u8282\u70b9\u96c6\u7684\u670d\u52a1\u90e8\u7f72\u4e4b\u95f4\u7684\u5ef6\u8fdf\u3002\u5982\u679c\u51fa\u73b0\u4efb\u4f55\u95ee\u9898\uff0c\u60a8\u53ef\u4ee5\u56de\u6eda\u5230\u8be5\u670d\u52a1\u7684\u4ee5\u524d\u7248\u672c\u3002","title":"Swarm\u96c6\u7fa4\u642d\u5efa"},{"location":"Docker/#_150","text":"\u8282\u70b9\u662f\u5982\u4f55\u5de5\u4f5c\u7684? Docker Engine 1.12\u5f15\u5165\u4e86\u96c6\u7fa4\u6a21\u5f0f\uff0c\u4f7f\u60a8\u80fd\u591f\u521b\u5efa\u4e00\u4e2a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a Docker Engine \u7ec4\u6210\u7684\u96c6\u7fa4\uff0c\u79f0\u4e3aSwarm\u3002\u4e00\u4e2a\u96c6\u7fa4\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u8282\u70b9\u7ec4\u6210: \u5728\u96c6\u7fa4\u6a21\u5f0f\u4e0b\u8fd0\u884c Docker Engine 1.12\u6216\u66f4\u9ad8\u7248\u672c\u7684\u7269\u7406\u6216\u865a\u62df\u673a\u5668\u3002 \u8282\u70b9\u6709\u4e24\u79cd\u7c7b\u578b: managers and workers . Manager nodes\uff08\u7ba1\u7406\u5668\u8282\u70b9\uff09 \u7ba1\u7406\u5668\u8282\u70b9\u5904\u7406\u96c6\u7fa4\u7ba1\u7406\u4efb\u52a1: maintaining cluster state \u4fdd\u6301\u96c6\u7fa4\u72b6\u6001 scheduling services \u8c03\u5ea6\u670d\u52a1 serving swarm mode \u670d\u52a1\u7fa4\u6a21\u5f0f Raft\u4e00\u81f4\u6027\u7b97\u6cd5\uff08\u4fdd\u8bc1\u53ef\u7528\u6027\uff09 \u7ba1\u7406\u8005\u96c6\u7fa4\u6700\u591a\u53ea\u80fd\u5fcd\u53d7\u635f\u5931 (N-1)/2 managers. \u5efa\u8bae\u4e00\u4e2a\u96c6\u7fa4\u6700\u5c11\u67093\u53f0\u4e3b\u673a\u3002 \u5efa\u8bae\u4e00\u4e2a\u96c6\u7fa4\u6700\u591a\u6709\u4e03\u4e2a\u7ba1\u7406\u5668\u8282\u70b9\u3002 \u91cd\u8981\u63d0\u793a: \u6dfb\u52a0\u66f4\u591a\u7684\u7ba1\u7406\u5668\u5e76\u4e0d\u610f\u5473\u7740\u589e\u52a0\u53ef\u4f38\u7f29\u6027\u6216\u66f4\u9ad8\u7684\u6027\u80fd\u3002 Worker nodes \uff08\u5de5\u4f5c\u8282\u70b9\uff09 \u5de5\u4f5c\u8282\u70b9\u4e5f\u662f Docker Engine \u7684\u5b9e\u4f8b\uff0c\u5b83\u7684\u552f\u4e00\u76ee\u7684\u662f\u6267\u884c\u5bb9\u5668\u3002\u5de5\u4f5c\u8282\u70b9\u4e0d\u53c2\u4e0e Raft \u5206\u5e03\u5f0f\u72b6\u6001\uff0c\u4e0d\u505a\u8c03\u5ea6\u51b3\u7b56\uff0c\u4e5f\u4e0d\u670d\u52a1\u4e8e\u96c6\u7fa4\u6a21\u5f0f\u7684 HTTP API\u3002 \u60a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u7531\u4e00\u4e2a\u7ba1\u7406\u5668\u8282\u70b9\u7ec4\u6210\u7684\u7fa4\uff0c\u4f46\u662f\u5982\u679c\u6ca1\u6709\u81f3\u5c11\u4e00\u4e2a\u7ba1\u7406\u5668\u8282\u70b9\uff0c\u5c31\u4e0d\u80fd\u6709\u4e00\u4e2aworker\u8282\u70b9\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684\u7ba1\u7406\u8005\u90fd\u662fworker\u3002\u5728\u5355\u4e2a\u7ba1\u7406\u5668\u8282\u70b9\u96c6\u7fa4\u4e2d\uff0c\u60a8\u53ef\u4ee5\u8fd0\u884c\u8bf8\u5982 docker \u670d\u52a1 create \u4e4b\u7c7b\u7684\u547d\u4ee4\uff0c\u8c03\u5ea6\u7a0b\u5e8f\u5c06\u6240\u6709\u4efb\u52a1\u653e\u5728\u672c\u5730\u5f15\u64ce\u4e0a\u3002 \u82e5\u8981\u9632\u6b62\u8c03\u5ea6\u7a0b\u5e8f\u5c06\u4efb\u52a1\u653e\u5728\u591a\u8282\u70b9\u7fa4\u4e2d\u7684\u7ba1\u7406\u5668\u8282\u70b9\u4e0a\uff0c\u8bf7\u5c06\u7ba1\u7406\u5668\u8282\u70b9\u7684\u53ef\u7528\u6027\u8bbe\u7f6e\u4e3a Drain\u3002\u8c03\u5ea6\u7a0b\u5e8f\u5728 Drain \u6a21\u5f0f\u4e0b\u6b63\u5e38\u505c\u6b62\u8282\u70b9\u4e0a\u7684\u4efb\u52a1\uff0c\u5e76\u5728\u6d3b\u52a8\u8282\u70b9\u4e0a\u8c03\u5ea6\u4efb\u52a1\u3002\u8c03\u5ea6\u7a0b\u5e8f\u4e0d\u4f1a\u5c06\u65b0\u4efb\u52a1\u5206\u914d\u7ed9\u5177\u6709 Drain \u53ef\u7528\u6027\u7684\u8282\u70b9 \u670d\u52a1\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\uff1f \u8981\u5728 Docker Engine \u5904\u4e8e\u7fa4\u6a21\u5f0f\u65f6\u90e8\u7f72\u5e94\u7528\u7a0b\u5e8f\u6620\u50cf\uff0c\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u3002\u670d\u52a1\u901a\u5e38\u662f\u67d0\u4e2a\u8f83\u5927\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u4e2d\u5fae\u670d\u52a1\u7684\u6620\u50cf\u3002\u670d\u52a1\u7684\u793a\u4f8b\u53ef\u80fd\u5305\u62ec HTTP \u670d\u52a1\u5668\u3001\u6570\u636e\u5e93\u6216\u5e0c\u671b\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u8fd0\u884c\u7684\u4efb\u4f55\u5176\u4ed6\u7c7b\u578b\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u3002 Services\uff1a \u5f53\u60a8\u5c06\u670d\u52a1\u90e8\u7f72\u5230Swarm\u65f6\uff0cSwarm manager\u63a5\u53d7\u60a8\u7684\u670d\u52a1\u5b9a\u4e49\u4f5c\u4e3a\u670d\u52a1\u7684\u671f\u671b\u72b6\u6001\u3002\u7136\u540e\u5c06Swarm\u4e2d\u8282\u70b9\u4e0a\u7684\u670d\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a\u526f\u672c\u4efb\u52a1\u8fdb\u884c\u8c03\u5ea6\u3002\u8fd9\u4e9b\u4efb\u52a1\u5728\u7fa4\u4e2d\u7684\u8282\u70b9\u4e0a\u72ec\u7acb\u8fd0\u884c\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u60a8\u5e0c\u671b\u5728\u4e00\u4e2a HTTP \u4fa6\u542c\u5668\u7684\u4e09\u4e2a\u5b9e\u4f8b\u4e4b\u95f4\u8fdb\u884c\u8d1f\u8f7d\u5e73\u8861\u3002\u4e0b\u56fe\u663e\u793a\u4e86\u4e00\u4e2a\u5177\u6709\u4e09\u4e2a\u526f\u672c\u7684 HTTP \u4fa6\u542c\u5668\u670d\u52a1\u3002\u76d1\u542c\u5668\u7684\u4e09\u4e2a\u5b9e\u4f8b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u662f\u7fa4\u4e2d\u7684\u4e00\u4e2a\u4efb\u52a1\u3002 TASK\u548cScheduler: \u5bb9\u5668\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u8fc7\u7a0b\u3002\u5728\u7fa4\u6a21\u5f0f\u6a21\u578b\u4e2d\uff0c\u6bcf\u4e2a\u4efb\u52a1\u53ea\u8c03\u7528\u4e00\u4e2a\u5bb9\u5668\u3002\u4efb\u52a1\u7c7b\u4f3c\u4e8e\u8c03\u5ea6\u7a0b\u5e8f\u653e\u7f6e\u5bb9\u5668\u7684\u201c\u69fd\u201d\u3002\u4e00\u65e6\u5bb9\u5668\u5904\u4e8e\u6fc0\u6d3b\u72b6\u6001\uff0c\u8c03\u5ea6\u7a0b\u5e8f\u5c31\u4f1a\u8bc6\u522b\u51fa\u4efb\u52a1\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3002\u5982\u679c\u5bb9\u5668\u672a\u80fd\u901a\u8fc7\u5065\u5eb7\u68c0\u67e5\u6216\u7ec8\u6b62\uff0c\u5219\u4efb\u52a1\u7ec8\u6b62\u3002 \u4efb\u52a1\u662f\u96c6\u7fa4\u4e2d\u8c03\u5ea6\u7684\u539f\u5b50\u5355\u4f4d\u3002\u5f53\u60a8\u901a\u8fc7\u521b\u5efa\u6216\u66f4\u65b0\u670d\u52a1\u6765\u58f0\u660e\u6240\u9700\u7684\u670d\u52a1\u72b6\u6001\u65f6\uff0c\u534f\u8c03\u5668\u901a\u8fc7\u8c03\u5ea6\u4efb\u52a1\u6765\u5b9e\u73b0\u6240\u9700\u7684\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u60a8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u5b83\u6307\u793a\u534f\u8c03\u5668\u59cb\u7ec8\u8fd0\u884c HTTP \u4fa6\u542c\u5668\u7684\u4e09\u4e2a\u5b9e\u4f8b\u3002\u534f\u8c03\u8005\u901a\u8fc7\u521b\u5efa\u4e09\u4e2a\u4efb\u52a1\u6765\u8fdb\u884c\u54cd\u5e94\u3002\u6bcf\u4e2a\u4efb\u52a1\u90fd\u662f\u8c03\u5ea6\u7a0b\u5e8f\u901a\u8fc7\u751f\u6210\u5bb9\u5668\u586b\u5145\u7684\u69fd\u3002\u5bb9\u5668\u662f\u4efb\u52a1\u7684\u5b9e\u4f8b\u5316\u3002\u5982\u679c HTTP \u4fa6\u542c\u5668\u4efb\u52a1\u968f\u540e\u5931\u8d25\u6216\u5d29\u6e83\uff0c\u534f\u8c03\u5668\u5c06\u521b\u5efa\u4e00\u4e2a\u4ea7\u751f\u65b0\u5bb9\u5668\u7684\u65b0\u526f\u672c\u4efb\u52a1\u3002 \u4efb\u52a1\u662f\u4e00\u79cd\u5355\u5411\u673a\u5236\u3002\u5b83\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u72b6\u6001\u5355\u8c03\u5730\u8fdb\u884c: \u5206\u914d\u3001\u51c6\u5907\u3001\u8fd0\u884c\u7b49\u7b49\u3002\u5982\u679c\u4efb\u52a1\u5931\u8d25\uff0c\u534f\u8c03\u5668\u5c06\u5220\u9664\u4efb\u52a1\u53ca\u5176\u5bb9\u5668\uff0c\u7136\u540e\u6839\u636e\u670d\u52a1\u6307\u5b9a\u7684\u6240\u9700\u72b6\u6001\u521b\u5efa\u4e00\u4e2a\u65b0\u4efb\u52a1\u6765\u66ff\u6362\u5b83\u3002 Docker \u7fa4\u6a21\u5f0f\u7684\u57fa\u672c\u903b\u8f91\u662f\u4e00\u4e2a\u901a\u7528\u7684\u8c03\u5ea6\u5668\u548c\u534f\u8c03\u5668\u3002\u670d\u52a1\u548c\u4efb\u52a1\u62bd\u8c61\u672c\u8eab\u5e76\u4e0d\u77e5\u9053\u5b83\u4eec\u5b9e\u73b0\u7684\u5bb9\u5668\u3002\u5047\u8bbe\uff0c\u60a8\u53ef\u4ee5\u5b9e\u73b0\u5176\u4ed6\u7c7b\u578b\u7684\u4efb\u52a1\uff0c\u4f8b\u5982\u865a\u62df\u673a\u4efb\u52a1\u6216\u975e\u5bb9\u5668\u5316\u7684\u6d41\u7a0b\u4efb\u52a1\u3002\u8c03\u5ea6\u7a0b\u5e8f\u548c\u534f\u8c03\u5668\u5bf9\u4efb\u52a1\u7684\u7c7b\u578b\u4e0d\u77e5\u9053\u3002\u4f46\u662f\uff0c\u5f53\u524d\u7248\u672c\u7684 Docker \u53ea\u652f\u6301\u5bb9\u5668\u4efb\u52a1\u3002 \u4e0b\u56fe\u663e\u793a\u4e86\u7fa4\u6a21\u5f0f\u5982\u4f55\u63a5\u53d7\u670d\u52a1\u521b\u5efa\u8bf7\u6c42\u5e76\u5c06\u4efb\u52a1\u8c03\u5ea6\u5230\u5de5\u4f5c\u8282\u70b9\u3002 \u547d\u4ee4\u2014\u7ba1\u7406\u2014API\u2014\u8c03\u5ea6\u2014\u5de5\u4f5c\u8282\u70b9\uff08\u521b\u5efaTASK,\u5bb9\u5668\u90e8\u7f72\uff0c\u7ef4\u62a4\uff09 eplicated and global services: \u6709\u4e24\u79cd\u7c7b\u578b\u7684\u670d\u52a1\u90e8\u7f72\uff0c\u590d\u5236\u7684\u548c\u5168\u5c40\u7684\u3002 \u5bf9\u4e8e\u590d\u5236\u670d\u52a1\uff0c\u6307\u5b9a\u8981\u8fd0\u884c\u7684\u76f8\u540c\u4efb\u52a1\u7684\u6570\u91cf\u3002\u4f8b\u5982\uff0c\u60a8\u51b3\u5b9a\u4f7f\u7528\u4e09\u4e2a\u526f\u672c\u90e8\u7f72\u4e00\u4e2a HTTP \u670d\u52a1\uff0c\u6bcf\u4e2a\u526f\u672c\u63d0\u4f9b\u76f8\u540c\u7684\u5185\u5bb9\u3002 \u5168\u5c40\u670d\u52a1\u662f\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u4e00\u4e2a\u4efb\u52a1\u7684\u670d\u52a1\u3002\u6ca1\u6709\u9884\u5148\u6307\u5b9a\u7684\u4efb\u52a1\u6570\u91cf\u3002\u6bcf\u6b21\u5411\u7fa4\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u8282\u70b9\u65f6\uff0c\u534f\u8c03\u5668\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\uff0c\u8c03\u5ea6\u5668\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u65b0\u8282\u70b9\u3002\u5168\u7403\u670d\u52a1\u7684\u4f18\u79c0\u5019\u9009\u8005\u662f\u76d1\u63a7\u4ee3\u7406\u7a0b\u5e8f\u3001\u53cd\u75c5\u6bd2\u626b\u63cf\u7a0b\u5e8f\u6216\u5176\u4ed6\u7c7b\u578b\u7684\u5bb9\u5668\uff0c\u60a8\u5e0c\u671b\u5728\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u8fd9\u4e9b\u5bb9\u5668\u3002 \u4e0b\u56fe\u663e\u793a\u4e86\u4e00\u4e2a\u9ec4\u8272\u7684\u4e09\u670d\u52a1\u526f\u672c\u548c\u4e00\u4e2a\u7070\u8272\u7684\u5168\u5c40\u670d\u52a1\u3002 \u89e3\u91caReplicated and global \uff1a Replicated \u590d\u5236\uff1a\u6307\u5b9a\u8981\u8fd0\u884c\u7684\u8282\u70b9\u548c\u6570\u91cf\uff0c\u9ed8\u8ba4\u3002 global \u5168\u5c40\uff1a\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u4e00\u4e2a\u4efb\u52a1\u7684\u670d\u52a1\u3002\u6bcf\u589e\u52a0\u4e00\u4e2a\u65b0\u8282\u70b9\uff0c\u534f\u8c03\u5668\u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4efb\u52a1\uff0c\u8c03\u5ea6\u5668\u518d\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u65b0\u8282\u70b9\u3002 \u5177\u4f53\u65b9\u6cd5\uff1a --mode string Service mode (replicated or global)(default \"replicated\") docker service create --mode replicated --name mytom tomcat:7 \u9ed8\u8ba4 docker service create --mode global --name mytest alpine ping baidu.com \u573a\u666f\uff1f \u65e5\u5fd7\u6536\u96c6 \u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u6709\u81ea\u5df1\u7684\u65e5\u5fd7\u6536\u96c6\u5668\uff0c\u8fc7\u6ee4\uff0c\u628a\u6240\u6709\u65e5\u5fd7\u6700\u7ec8\u518d\u4f20\u7ed9\u65e5\u5fd7\u4e2d\u5fc3\u670d\u52a1\u76d1\u63a7\u72b6\u6001\u6027\u80fd\u3002","title":"\u5de5\u4f5c\u6a21\u5f0f"},{"location":"Docker/#swarm_1","text":"1.docker swarm --help [root@localhost ~]# docker swarm --help Usage: docker swarm COMMAND Manage Swarm Commands: ca Display and rotate the root CA init Initialize a swarm \u521d\u59cb\u5316\u4e00\u4e2a\u96c6\u7fa4 join Join a swarm as a node and/or manager \u52a0\u5165\u4e00\u4e2a\u96c6\u7fa4 join-token Manage join tokens \u521b\u5efa\u4e00\u4e2atoken leave Leave the swarm \u79bb\u5f00\u4e00\u4e2a\u96c6\u7fa4 unlock Unlock swarm unlock-key Manage the unlock key update Update the swarm \u66f4\u65b0\u4e00\u4e2a\u96c6\u7fa4 Run 'docker swarm COMMAND --help' for more information on a command. [root@localhost ~]# 2.docker swarm init --help [root@localhost ~]# docker swarm init --help Usage: docker swarm init [OPTIONS] Initialize a swarm Options: --advertise-addr string \u589e\u52a0\u5e7f\u64ad\u5730\u5740 Advertised address (format: <ip|interface>[:port]) --autolock Enable manager autolocking (requiring an unlock key to start a stopped manager) --availability string Availability of the node (\"active\"|\"pause\"|\"drain\") (default \"active\") --cert-expiry duration Validity period for node certificates (ns|us|ms|s|m|h) (default 2160h0m0s) --data-path-addr string Address or interface to use for data path traffic (format: <ip|interface>) --data-path-port uint32 Port number to use for data path traffic (1024 - 49151). If no value is set or is set to 0, the default port (4789) is used. --default-addr-pool ipNetSlice default address pool in CIDR format (default []) --default-addr-pool-mask-length uint32 default address pool subnet mask length (default 24) --dispatcher-heartbeat duration Dispatcher heartbeat period (ns|us|ms|s|m|h) (default 5s) --external-ca external-ca Specifications of one or more certificate signing endpoints --force-new-cluster Force create a new cluster from current state --listen-addr node-addr Listen address (format: <ip|interface>[:port]) (default 0.0.0.0:2377) --max-snapshots uint Number of additional Raft snapshots to retain --snapshot-interval uint Number of log entries between Raft snapshots (default 10000) --task-history-limit int Task history retention limit (default 5) [root@localhost ~]# --advertise-addr string\u5e7f\u64ad\u5730\u5740","title":"\u4f7f\u7528Swarm"},{"location":"Docker/#_151","text":"1.\u67e5\u770b\u4e3b\u673aIP\u4fe1\u606f [root@localhost ~]# ip a 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000 link/ether 00:0c:29:4c:20:77 brd ff:ff:ff:ff:ff:ff inet 192.168.100.103/24 brd 192.168.100.255 scope global noprefixroute eth0 valid_lft forever preferred_lft forever inet6 fe80::5ff3:633c:1e91:e523/64 scope link tentative noprefixroute dadfailed valid_lft forever preferred_lft forever inet6 fe80::4cb8:b4bd:811f:6064/64 scope link tentative noprefixroute dadfailed valid_lft forever preferred_lft forever inet6 fe80::da97:34b6:c534:91b8/64 scope link tentative noprefixroute dadfailed valid_lft forever preferred_lft forever 3: docker0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN group default link/ether 02:42:e7:a7:1e:81 brd ff:ff:ff:ff:ff:ff inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0 valid_lft forever preferred_lft forever [root@localhost ~]# 2.\u8ba9\u8be5\u4e3b\u673a\u6210\u4e3a\u4e3b\u8282\u70b9 docker swarm init --advertise-addr 192.168.100.100 [root@localhost ~]# docker swarm init --advertise-addr 192.168.100.100 Swarm initialized: current node (28fgw2e0nmc14greycbow7v9s) is now a manager. To add a worker to this swarm, run the following command: docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-303dpxlqb9vehlo7sox0wv56a 192.168.100.100:2377 To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions. [root@localhost ~]# 3.\u5f97\u5230\u4fe1\u606f \u5f53\u524d\u8282\u70b9\uff0828fgw2e0nmc14greycbow7v9s\uff09\u5df2\u52a0\u5165\u5230Swarm\u4e2d\uff0c\u73b0\u5728\u662f\u4e00\u4e2a\u7ba1\u7406\u5458\u3002 Swarm initialized: current node (28fgw2e0nmc14greycbow7v9s) is now a manager. \u8981\u5c06worker\u5de5\u4f5c\u8282\u70b9\u6dfb\u52a0\u5230\u8be5\u7fa4\u96c6\uff0c\u8bf7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4 docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-303dpxlqb9vehlo7sox0wv56a 192.168.100.100:2377 \u8981\u5c06\u7ba1\u7406\u5668\u6dfb\u52a0\u5230\u8be5\u96c6\u7fa4\uff0c\u8bf7\u8fd0\u884c\u201c docker swarm join-token manager\u201d\u5e76\u6309\u7167\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002 To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions. docker swarm init \u521d\u59cb\u5316\u8282\u70b9 docker swarm join \u52a0\u5165\u4e00\u4e2a\u8282\u70b9 \u83b7\u53d6\u4ee4\u724c\uff1a docker swarm join-token manager \u751f\u6210\u4e3b\u8282\u70b9\u4ee4\u724c docker swarm join-token worker \u751f\u6210\u52a0\u5165\u8282\u70b9\u4ee4\u724c \u5728\u4e3b\u8282\u70b9\u6267\u884c\u547d\u4ee4\u540e\u4f1a\u751f\u6210\u52a0\u5165\u547d\u4ee4\u3002","title":"\u521d\u59cb\u5316"},{"location":"Docker/#_152","text":"\u5728\u5de5\u4f5c\u8282\u70b9\u6267\u884c\u52a0\u5165\u96c6\u7fa4\u547d\u4ee4\uff1a docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-303dpxlqb9vehlo7sox0wv56a 192.168.100.100:2377 \u7ed3\u679c\uff1a\u6b64\u8282\u70b9\u4f5c\u4e3a\u5de5\u4f5c\u8282\u70b9\u5df2\u52a0\u5165\u96c6\u7fa4\u3002 [root@localhost ~]# docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-303dpxlqb9vehlo7sox0wv56a 192.168.100.100:2377 This node joined a swarm as a worker. [root@localhost ~]# \u67e5\u770b\u52a0\u5165\u7684\u8282\u70b9\u4fe1\u606f \u5728\u4e3b\u8282\u70b9\u6267\u884c\u5982\u4e0b\u547d\u4ee4: [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 28fgw2e0nmc14greycbow7v9s * localhost.localdomain Ready Active Leader 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u72b6\u6001\uff1aReady Active \u4e3b\u8282\u70b9\u9ed8\u8ba4\u6709Leader\u6807\u7b7e\u3002\u5de5\u4f5c\u8282\u70b9\u65e0\u3002 \u5c06\u6240\u6709\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\u540e\u518d\u67e5\u770b\u8282\u70b9\u4fe1\u606f [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 28fgw2e0nmc14greycbow7v9s * localhost.localdomain Ready Active Leader 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Ready Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Ready Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]#","title":"\u52a0\u5165\u96c6\u7fa4"},{"location":"Docker/#_153","text":"Error response from daemon: This node is already part of a swarm. Use \"docker swarm leave\" to leave this swarm and join another one. [root@localhost ~]# docker swarm leave Node left the swarm. [root@localhost ~]# \u5c06\u7b2c\u56db\u53f0\u4e3b\u673a\u6539\u4e3a\u4e3b\u8282\u70b9 \u4ece\u96c6\u7fa4\u4e2d\u79fb\u9664\u540e\uff0c\u5728\u4e3b\u8282\u70b9\u4e0a\u6267\u884cdocker swarm join-token manager\u5c06\u8be5\u7ba1\u7406\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\u3002 [root@localhost ~]# docker swarm join-token manager To add a manager to this swarm, run the following command: docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-bdcobfl71betmca8g1aci3hks 192.168.100.100:2377 [root@localhost ~]# \u751f\u6210\u52a0\u5165\u4ee4\u724c\u540e\u5728\u7b2c4\u53f0\u4e3b\u673a\u6267\u884c\u8be5\u547d\u4ee4\u3002 [root@localhost ~]# docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-bdcobfl71betmca8g1aci3hks 192.168.100.100:2377 This node joined a swarm as a manager. [root@localhost ~]# \u518d\u6b21\u5230\u4e3b\u8282\u70b9\u67e5\u770b\u96c6\u7fa4\u7684\u8282\u70b9\u4fe1\u606f [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s * localhost.localdomain Ready Active Leader 20.10.2 653jropyn5jpg6f1ytwye2xrr localhost.localdomain Ready Active Reachable 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Ready Active 20.10.2 \u52a0\u5165\u7684\u7ba1\u7406\u8282\u70b9\u5e26\u6709Reachable\u6807\u7b7e\u3002 \u53cc\u4e3b\u53cc\u4ece\u96c6\u7fa4\u642d\u5efa\u5b8c\u6bd5\u3002","title":"\u5220\u9664\u8282\u70b9"},{"location":"Docker/#raft","text":"\u5b9e\u9a8c \u53cc\u4e3b\u53cc\u4ece\uff1a\u5047\u8bbe\u4e00\u4e2a\u8282\u70b9\u6302\u6389\uff0c\u5176\u4ed6\u8282\u70b9\u662f\u5426\u53ef\u7528\uff1f \u505c\u6389docker-1,\u5728docker-4\u4e0a\u6267\u884c\u547d\u4ee4\u6d4b\u8bd5 docker-1 systemctl stop docker docker-4 docker node ls \u62a5\u9519\u4fe1\u606f\uff08\u6765\u81ea\u5b88\u62a4\u7a0b\u5e8f\u7684\u9519\u8bef\u54cd\u5e94\uff1arpc\u9519\u8bef\uff1a\uff09\uff1a [root@localhost ~]# docker node ls Error response from daemon: rpc error: code = DeadlineExceeded desc = context deadline exceeded [root@localhost ~]# \u518d\u6b21\u542f\u52a8docker-1\u4e3b\u8282\u70b9\uff0c\u67e5\u770b\u8282\u70b9\u4fe1\u606f\uff0c\u53ef\u4ee5\u7ee7\u7eed\u5de5\u4f5c \u53d1\u73b0\uff1a \u4e00\u4e2a\u4e3b\u8282\u70b9\u6302\u6389\uff0c\u518d\u6b21\u542f\u52a8\u540e\u8be5\u4e3b\u8282\u70b9\u53d8\u4e3a\u5de5\u4f5c\u8282\u70b9 [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s * localhost.localdomain Ready Active Reachable 20.10.2 653jropyn5jpg6f1ytwye2xrr localhost.localdomain Unknown Active Leader 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Unknown Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u5230docker-4\u8282\u70b9\u67e5\u770b\u4fe1\u606f\uff0c\u6b64\u65f6docker-4\u7ba1\u7406\u8282\u70b9\u53d8\u4e3aLeader\u7ba1\u7406\u8282\u70b9\u3002 [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s localhost.localdomain Ready Active Reachable 20.10.2 653jropyn5jpg6f1ytwye2xrr * localhost.localdomain Ready Active Leader 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Ready Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]#","title":"Raft\u4e00\u81f4\u6027\u534f\u8bae"},{"location":"Docker/#_154","text":"\u5b9e\u9a8c \u5c06docker-3\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\uff0c\u7531worker\u8282\u70b9\u4fee\u6539\u4e3amanager\u8282\u70b9\u3002 [root@localhost ~]# docker swarm leave Node left the swarm. [root@localhost ~]# docker swarm leave Error response from daemon: This node is not part of a swarm [root@localhost ~]# manager\u8282\u70b9\u67e5\u770b\u8282\u70b9\u4fe1\u606f \u79fb\u9664\u8282\u70b9\u540e\u518d\u67e5\u770b\u8282\u70b9\u4f1a\u53d8\u6210Dowm\u72b6\u6001\u3002 [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s localhost.localdomain Ready Active Reachable 20.10.2 653jropyn5jpg6f1ytwye2xrr * localhost.localdomain Ready Active Leader 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Down Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u7ba1\u7406\u8282\u70b9\u751f\u6210\u4ee4\u724c [root@localhost ~]# docker swarm join-token manager To add a manager to this swarm, run the following command: docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-bdcobfl71betmca8g1aci3hks 192.168.100.103:2377 [root@localhost ~]# \u5c06docker-3\u4ee5\u7ba1\u7406\u8282\u70b9\u52a0\u5165Swarm\u96c6\u7fa4 [root@localhost ~]# docker swarm leave Error response from daemon: This node is not part of a swarm [root@localhost ~]# docker swarm join --token SWMTKN-1-5v9a5z3i4fhtiodfho92en7rl9lxowxnz8nbvct9mhqs2843uh-bdcobfl71betmca8g1aci3hks 192.168.100.103:2377 This node joined a swarm as a manager. [root@localhost ~]# docker-3\u52a0\u5165\u7ba1\u7406\u8282\u70b9\u540e\u5728docker-3\u4e0b\u6267\u884cdocker node ls,\u8be5\u8282\u70b9\u4e5f\u88ab\u6253\u4e0aReachable\u6807\u7b7e\u3002 [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s localhost.localdomain Ready Active Reachable 20.10.2 653jropyn5jpg6f1ytwye2xrr localhost.localdomain Ready Active Leader 20.10.2 j8xhfzomjxqqq9m97n3rf0xk8 * localhost.localdomain Ready Active Reachable 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Down Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# worker\u8282\u70b9\u53ea\u7528\u6765\u5de5\u4f5c\uff0c\u65e0\u6cd5\u64cd\u4f5c\u96c6\u7fa4\u3002 manager\u7ba1\u7406\u8282\u70b9\u7528\u6765\u64cd\u4f5cSwarm\u96c6\u7fa4\u3002 \u6d4b\u8bd5\u5173\u95eddocker-1\u8282\u70b9 [root@localhost ~]# systemctl stop docker Warning: Stopping docker.service, but it can still be activated by: docker.socket [root@localhost ~]# docker-1\u8282\u70b9\u4f1a\u6253\u4e0aUnreachable\uff08\u65e0\u6cd5\u5230\u8fbe\uff09\u6807\u7b7e [root@localhost ~]# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS ENGINE VERSION 0rqyc7d4s43xw8d74iss5exnj localhost.localdomain Down Active 20.10.2 28fgw2e0nmc14greycbow7v9s localhost.localdomain Ready Active Unreachable 20.10.2 653jropyn5jpg6f1ytwye2xrr * localhost.localdomain Ready Active Leader 20.10.2 j8xhfzomjxqqq9m97n3rf0xk8 localhost.localdomain Ready Active Reachable 20.10.2 p6q951nif6cweywut097i1ex9 localhost.localdomain Down Active 20.10.2 syy3uuajc0dwpbsf9n3fevpqz localhost.localdomain Down Active 20.10.2 t1bastpik0mmtzartwvm4o8u4 localhost.localdomain Ready Active 20.10.2 [root@localhost ~]# \u4e09\u4e3b\u4e00\u4ece\uff0c\u6302\u63891\u53f0\u7ba1\u7406\u8282\u70b9\uff0c\u5176\u4ed62\u53f0\u7ba1\u7406\u8282\u70b9docker-3 docker-4\u7ba1\u7406\u8282\u70b9\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u3002 \u6d4b\u8bd5\u6302\u63892\u53f0\u7ba1\u7406\u8282\u70b9 \u518d\u505c\u63891\u53f0\u7ba1\u7406\u8282\u70b9docker-3,\u6d4b\u8bd5\u53ea\u5269docker-4\u7ba1\u7406\u8282\u70b9\u662f\u5426\u53ef\u7528\u3002 docker-3 [root@localhost ~]# systemctl stop docker Warning: Stopping docker.service, but it can still be activated by: docker.socket [root@localhost ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES [root@localhost ~]# docker-4\u7ba1\u7406\u8282\u70b9:\u65e0\u6cd5\u4f7f\u7528 [root@localhost ~]# docker node ls Error response from daemon: rpc error: code = Unknown desc = The swarm does not have a leader. It's possible that too few managers are online. Make sure more than half of the managers are online. [root@localhost ~]# \u96c6\u7fa4\u53ef\u7528\uff1a\u81f3\u5c11\u4fdd\u8bc1>3\u8282\u70b9\uff0c>1\u53f0\u7ba1\u7406\u8282\u70b9\u5b58\u6d3b\u3002 Raft\u534f\u8bae:\u4fdd\u8bc1\u5927\u591a\u6570\u8282\u70b9\u5b58\u6d3b\u624d\u53ef\u4ee5\u7528\uff0c\u9ad8\u53ef\u7528\u3002","title":"\u4e09\u4e3b\u8282\u70b9"},{"location":"Docker/#_155","text":"docker run \u5bb9\u5668\u542f\u52a8\uff0c\u4e0d\u5177\u5907\u6269\u7f29\u5bb9\u5668\uff01 docker service \u5177\u6709\u6269\u7f29\u5bb9\uff0c\u6eda\u52a8\u66f4\u65b0\uff01 [root@docker1 ~]# docker service --help Usage: docker service COMMAND Manage services Commands: create Create a new service inspect Display detailed information on one or more services logs Fetch the logs of a service or task ls List services ps List the tasks of one or more services rm Remove one or more services rollback Revert changes to a service's configuration scale Scale one or multiple replicated services update Update a service Run 'docker service COMMAND --help' for more information on a command. [root@docker1 ~]# rollback Revert changes to a service's configuration\uff08\u5c06\u66f4\u6539\u8fd8\u539f\u5230\u670d\u52a1\u7684\u914d\u7f6e\uff09\u2014\u56de\u6eda scale Scale one or multiple replicated services\uff08\u6269\u5c55\u4e00\u4e2a\u6216\u591a\u4e2a\u670d\u52a1\uff09\u2014\u52a8\u6001\u6269\u7f29\u5bb9 update Update a service\uff08\u66f4\u65b0\u670d\u52a1\uff09\u2014\u66f4\u65b0 \u521b\u5efa\u670d\u52a1\u2014\u52a8\u6001\u6269\u5c55\u670d\u52a1\u2014\u52a8\u6001\u66f4\u65b0\u670d\u52a1 create\u5e2e\u52a9\u547d\u4ee4 [root@docker1 ~]# docker service create --help Usage: docker service create [OPTIONS] IMAGE [COMMAND] [ARG...] Create a new service Options: --cap-add list Add Linux capabilities --cap-drop list Drop Linux capabilities --config config Specify configurations to expose to the service --constraint list Placement constraints --container-label list Container labels --credential-spec credential-spec Credential spec for managed service account (Windows only) -d, --detach Exit immediately instead of waiting for the service to converge --dns list Set custom DNS servers --dns-option list Set DNS options --dns-search list Set custom DNS search domains --endpoint-mode string Endpoint mode (vip or dnsrr) (default \"vip\") --entrypoint command Overwrite the default ENTRYPOINT of the image -e, --env list Set environment variables --env-file list Read in a file of environment variables --generic-resource list User defined resources --group list Set one or more supplementary user groups for the container --health-cmd string Command to run to check health --health-interval duration Time between running the check (ms|s|m|h) --health-retries int Consecutive failures needed to report unhealthy --health-start-period duration Start period for the container to initialize before counting retries towards unstable (ms|s|m|h) --health-timeout duration Maximum time to allow one check to run (ms|s|m|h) --host list Set one or more custom host-to-IP mappings (host:ip) --hostname string Container hostname --init Use an init inside each service container to forward signals and reap processes --isolation string Service container isolation mode -l, --label list Service labels --limit-cpu decimal Limit CPUs --limit-memory bytes Limit Memory --limit-pids int Limit maximum number of processes (default 0 = unlimited) --log-driver string Logging driver for service --log-opt list Logging driver options --max-concurrent uint Number of job tasks to run concurrently (default equal to --replicas) --mode string Service mode (replicated, global, replicated-job, or global-job) (default \"replicated\") --mount mount Attach a filesystem mount to the service --name string Service name --network network Network attachments --no-healthcheck Disable any container-specified HEALTHCHECK --no-resolve-image Do not query the registry to resolve image digest and supported platforms --placement-pref pref Add a placement preference -p, --publish port Publish a port as a node port -q, --quiet Suppress progress output --read-only Mount the container's root filesystem as read only --replicas uint Number of tasks --replicas-max-per-node uint Maximum number of tasks per node (default 0 = unlimited) --reserve-cpu decimal Reserve CPUs --reserve-memory bytes Reserve Memory --restart-condition string Restart when condition is met (\"none\"|\"on-failure\"|\"any\") (default \"any\") --restart-delay duration Delay between restart attempts (ns|us|ms|s|m|h) (default 5s) --restart-max-attempts uint Maximum number of restarts before giving up --restart-window duration Window used to evaluate the restart policy (ns|us|ms|s|m|h) --rollback-delay duration Delay between task rollbacks (ns|us|ms|s|m|h) (default 0s) --rollback-failure-action string Action on rollback failure (\"pause\"|\"continue\") (default \"pause\") --rollback-max-failure-ratio float Failure rate to tolerate during a rollback (default 0) --rollback-monitor duration Duration after each task rollback to monitor for failure (ns|us|ms|s|m|h) (default 5s) --rollback-order string Rollback order (\"start-first\"|\"stop-first\") (default \"stop-first\") --rollback-parallelism uint Maximum number of tasks rolled back simultaneously (0 to roll back all at once) (default 1) --secret secret Specify secrets to expose to the service --stop-grace-period duration Time to wait before force killing a container (ns|us|ms|s|m|h) (default 10s) --stop-signal string Signal to stop the container --sysctl list Sysctl options -t, --tty Allocate a pseudo-TTY --ulimit ulimit Ulimit options (default []) --update-delay duration Delay between updates (ns|us|ms|s|m|h) (default 0s) --update-failure-action string Action on update failure (\"pause\"|\"continue\"|\"rollback\") (default \"pause\") --update-max-failure-ratio float Failure rate to tolerate during an update (default 0) --update-monitor duration Duration after each task update to monitor for failure (ns|us|ms|s|m|h) (default 5s) --update-order string Update order (\"start-first\"|\"stop-first\") (default \"stop-first\") --update-parallelism uint Maximum number of tasks updated simultaneously (0 to update all at once) (default 1) -u, --user string Username or UID (format: <name|uid>[:<group|gid>]) --with-registry-auth Send registry authentication details to swarm agents -w, --workdir string Working directory inside the container [root@docker1 ~]# 1.\u521b\u5efa\u670d\u52a1 [root@docker1 ~]# docker service create -p 8888:80 --name my-nginx nginx t99km76mvfkrfx274gdopaux5 overall progress: 1 out of 1 tasks 1/1: running verify: Service converged [root@docker1 ~]# 2.\u67e5\u770b\u521b\u5efa\u7684\u670d\u52a1 REPLICAS:\u526f\u672c\u4e3a1 [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS t99km76mvfkr my-nginx replicated 1/1 nginx:latest *:8888->80/tcp [root@docker1 ~]# 3.\u67e5\u770b\u8fd0\u884c\u7684\u670d\u52a1 [root@docker1 ~]# docker service ps my-nginx ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS af2fbra1lyjx my-nginx.1 nginx:latest docker4 Running Running 4 minutes ago [root@docker1 ~]# \u5728docker1\u521b\u5efa\u7684\u670d\u52a1\u8dd1\u5728docker4\u4e0a NODE\uff1adocker4 [root@docker4 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 4b56584f6710 nginx:latest \"/docker-entrypoint.\u2026\" 10 minutes ago Up 10 minutes 80/tcp my-nginx.1.af2fbra1lyjxxmjor5821c4av [root@docker4 ~]# 4.\u67e5\u770b\u670d\u52a1\u8be6\u7ec6\u4fe1\u606f [root@docker1 ~]# docker service inspect my-nginx [ { \"ID\": \"t99km76mvfkrfx274gdopaux5\", \"Version\": { \"Index\": 78 }, \"CreatedAt\": \"2021-01-11T02:35:51.137685495Z\", \"UpdatedAt\": \"2021-01-11T02:35:51.287333784Z\", \"Spec\": { \"Name\": \"my-nginx\", \"Labels\": {}, \"TaskTemplate\": { \"ContainerSpec\": { \"Image\": \"nginx:latest@sha256:4cf620a5c81390ee209398ecc18e5fb9dd0f5155cd82adcbae532fec94006fb9\", \"Init\": false, \"StopGracePeriod\": 10000000000, \"DNSConfig\": {}, \"Isolation\": \"default\" }, \"Resources\": { \"Limits\": {}, \"Reservations\": {} }, \"RestartPolicy\": { \"Condition\": \"any\", \"Delay\": 5000000000, \"MaxAttempts\": 0 }, \"Placement\": { \"Platforms\": [ { \"Architecture\": \"amd64\", \"OS\": \"linux\" }, { \"OS\": \"linux\" }, { \"OS\": \"linux\" }, { \"Architecture\": \"arm64\", \"OS\": \"linux\" }, { \"Architecture\": \"386\", \"OS\": \"linux\" }, { \"Architecture\": \"mips64le\", \"OS\": \"linux\" }, { \"Architecture\": \"ppc64le\", \"OS\": \"linux\" }, { \"Architecture\": \"s390x\", \"OS\": \"linux\" } ] }, \"ForceUpdate\": 0, \"Runtime\": \"container\" }, \"Mode\": { \"Replicated\": { \"Replicas\": 1 } }, \"UpdateConfig\": { \"Parallelism\": 1, \"FailureAction\": \"pause\", \"Monitor\": 5000000000, \"MaxFailureRatio\": 0, \"Order\": \"stop-first\" }, \"RollbackConfig\": { \"Parallelism\": 1, \"FailureAction\": \"pause\", \"Monitor\": 5000000000, \"MaxFailureRatio\": 0, \"Order\": \"stop-first\" }, \"EndpointSpec\": { \"Mode\": \"vip\", \"Ports\": [ { \"Protocol\": \"tcp\", \"TargetPort\": 80, \"PublishedPort\": 8888, \"PublishMode\": \"ingress\" } ] } }, \"Endpoint\": { \"Spec\": { \"Mode\": \"vip\", \"Ports\": [ { \"Protocol\": \"tcp\", \"TargetPort\": 80, \"PublishedPort\": 8888, \"PublishMode\": \"ingress\" } ] }, \"Ports\": [ { \"Protocol\": \"tcp\", \"TargetPort\": 80, \"PublishedPort\": 8888, \"PublishMode\": \"ingress\" } ], \"VirtualIPs\": [ { \"NetworkID\": \"y06qj1nd1ebb7k2hfvdvkbepy\", \"Addr\": \"10.0.0.9/24\" } ] } } ] [root@docker1 ~]#","title":"\u5f39\u6027\u6269\u7f29\u5bb9"},{"location":"Docker/#_156","text":"\"PublishMode\": ingress:\u9ed8\u8ba4\uff08\u7279\u6b8a\u7684Overlay\u7f51\u7edc\uff0c\u5177\u5907\u8d1f\u8f7d\u5747\u8861\u7684\u529f\u80fd\uff1aIPVS/VIP\uff09 Overlay:\u8de8\u670d\u52a1\u5668\u7f51\u7edc Swarm\u91c7\u7528Overlay\u6a21\u5f0f [root@docker1 ~]# docker network ls NETWORK ID NAME DRIVER SCOPE c155108e2db2 bridge bridge local 72827bba54c0 docker_gwbridge bridge local b4006bd11662 host host local y06qj1nd1ebb ingress overlay swarm 44f671135a58 none null local [root@docker1 ~]# \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f [root@docker1 ~]# docker network inspect ingress [ { \"Name\": \"ingress\", \"Id\": \"y06qj1nd1ebb7k2hfvdvkbepy\", \"Created\": \"2021-01-08T03:47:18.963091326-05:00\", \"Scope\": \"swarm\", \"Driver\": \"overlay\", \"EnableIPv6\": false, \"IPAM\": { \"Driver\": \"default\", \"Options\": null, \"Config\": [ { \"Subnet\": \"10.0.0.0/24\", \"Gateway\": \"10.0.0.1\" } ] }, \"Internal\": false, \"Attachable\": false, \"Ingress\": true, \"ConfigFrom\": { \"Network\": \"\" }, \"ConfigOnly\": false, \"Containers\": { \"ingress-sbox\": { \"Name\": \"ingress-endpoint\", \"EndpointID\": \"0d906a438633c47c060ff4c83c057f45d56e47887679d6777c0342cee98a4201\", \"MacAddress\": \"02:42:0a:00:00:02\", \"IPv4Address\": \"10.0.0.2/24\", \"IPv6Address\": \"\" } }, \"Options\": { \"com.docker.network.driver.overlay.vxlanid_list\": \"4096\" }, \"Labels\": {}, \"Peers\": [ { \"Name\": \"30f2fbbc3dfd\", \"IP\": \"192.168.100.100\" }, { \"Name\": \"a77efb0227b7\", \"IP\": \"192.168.100.101\" }, { \"Name\": \"30078eb13cab\", \"IP\": \"192.168.100.103\" }, { \"Name\": \"79e62e9699f5\", \"IP\": \"192.168.100.102\" } ] } ] [root@docker1 ~]# \"Peers\": [ { \"Name\": \"30f2fbbc3dfd\", \"IP\": \"192.168.100.100\" }, { \"Name\": \"a77efb0227b7\", \"IP\": \"192.168.100.101\" }, { \"Name\": \"30078eb13cab\", \"IP\": \"192.168.100.103\" }, { \"Name\": \"79e62e9699f5\", \"IP\": \"192.168.100.102\" } ingress\uff1a\u5176\u5b9e\u662f\u7ed1\u5b9a\u4e864\u53f0\u4e3b\u673a\u7684\u7f51\u7edc\u4fe1\u606f\u3002 \u867d\u7136docker\u57284\u53f0\u4e3b\u673a\u4e0a\uff0c\u5b9e\u9645\u7f51\u7edc\u662f\u540c\u4e00\u4e2a\uff01ingress\u662f\u4e00\u4e2a\u7279\u6b8a\u7684Overlay\u7f51\u7edc\u3002 \u4e0d\u540c\u8282\u70b9\u7684IP\u662f\u4e0d\u540c\u7684\uff0c\u8282\u70b9\u4e4b\u95f4\u7684\u7f51\u7edc\u662f\u65e0\u6cd5\u901a\u4fe1\u7684\uff0c\u901a\u8fc7Overlay\u7f51\u7edc\u53ef\u4ee5\u6253\u901a\u8282\u70b9\u95f4\u7684\u8bbf\u95ee\u3002 \u8bbf\u95ee\u589e\u5927\uff0c\u589e\u52a0\u526f\u672c\u7f13\u89e3\u670d\u52a1\u5668\u538b\u529b\u3002 update\u5e2e\u52a9\u547d\u4ee4 --replicas uint Number of tasks\u521b\u5efa\u4efb\u52a1\u6570\uff08\u526f\u672c\uff09 [root@docker1 ~]# docker service update --help Usage: docker service update [OPTIONS] SERVICE Update a service Options: --args command Service command args --cap-add list Add Linux capabilities --cap-drop list Drop Linux capabilities --config-add config Add or update a config file on a service --config-rm list Remove a configuration file --constraint-add list Add or update a placement constraint --constraint-rm list Remove a constraint --container-label-add list Add or update a container label --container-label-rm list Remove a container label by its key --credential-spec credential-spec Credential spec for managed service account (Windows only) -d, --detach Exit immediately instead of waiting for the service to converge --dns-add list Add or update a custom DNS server --dns-option-add list Add or update a DNS option --dns-option-rm list Remove a DNS option --dns-rm list Remove a custom DNS server --dns-search-add list Add or update a custom DNS search domain --dns-search-rm list Remove a DNS search domain --endpoint-mode string Endpoint mode (vip or dnsrr) --entrypoint command Overwrite the default ENTRYPOINT of the image --env-add list Add or update an environment variable --env-rm list Remove an environment variable --force Force update even if no changes require it --generic-resource-add list Add a Generic resource --generic-resource-rm list Remove a Generic resource --group-add list Add an additional supplementary user group to the container --group-rm list Remove a previously added supplementary user group from the container --health-cmd string Command to run to check health --health-interval duration Time between running the check (ms|s|m|h) --health-retries int Consecutive failures needed to report unhealthy --health-start-period duration Start period for the container to initialize before counting retries towards unstable (ms|s|m|h) --health-timeout duration Maximum time to allow one check to run (ms|s|m|h) --host-add list Add a custom host-to-IP mapping (host:ip) --host-rm list Remove a custom host-to-IP mapping (host:ip) --hostname string Container hostname --image string Service image tag --init Use an init inside each service container to forward signals and reap processes --isolation string Service container isolation mode --label-add list Add or update a service label --label-rm list Remove a label by its key --limit-cpu decimal Limit CPUs --limit-memory bytes Limit Memory --limit-pids int Limit maximum number of processes (default 0 = unlimited) --log-driver string Logging driver for service --log-opt list Logging driver options --max-concurrent uint Number of job tasks to run concurrently (default equal to --replicas) --mount-add mount Add or update a mount on a service --mount-rm list Remove a mount by its target path --network-add network Add a network --network-rm list Remove a network --no-healthcheck Disable any container-specified HEALTHCHECK --no-resolve-image Do not query the registry to resolve image digest and supported platforms --placement-pref-add pref Add a placement preference --placement-pref-rm pref Remove a placement preference --publish-add port Add or update a published port --publish-rm port Remove a published port by its target port -q, --quiet Suppress progress output --read-only Mount the container's root filesystem as read only --replicas uint Number of tasks --replicas-max-per-node uint Maximum number of tasks per node (default 0 = unlimited) --reserve-cpu decimal Reserve CPUs --reserve-memory bytes Reserve Memory --restart-condition string Restart when condition is met (\"none\"|\"on-failure\"|\"any\") --restart-delay duration Delay between restart attempts (ns|us|ms|s|m|h) --restart-max-attempts uint Maximum number of restarts before giving up --restart-window duration Window used to evaluate the restart policy (ns|us|ms|s|m|h) --rollback Rollback to previous specification --rollback-delay duration Delay between task rollbacks (ns|us|ms|s|m|h) --rollback-failure-action string Action on rollback failure (\"pause\"|\"continue\") --rollback-max-failure-ratio float Failure rate to tolerate during a rollback --rollback-monitor duration Duration after each task rollback to monitor for failure (ns|us|ms|s|m|h) --rollback-order string Rollback order (\"start-first\"|\"stop-first\") --rollback-parallelism uint Maximum number of tasks rolled back simultaneously (0 to roll back all at once) --secret-add secret Add or update a secret on a service --secret-rm list Remove a secret --stop-grace-period duration Time to wait before force killing a container (ns|us|ms|s|m|h) --stop-signal string Signal to stop the container --sysctl-add list Add or update a Sysctl option --sysctl-rm list Remove a Sysctl option -t, --tty Allocate a pseudo-TTY --ulimit-add ulimit Add or update a ulimit option (default []) --ulimit-rm list Remove a ulimit option --update-delay duration Delay between updates (ns|us|ms|s|m|h) --update-failure-action string Action on update failure (\"pause\"|\"continue\"|\"rollback\") --update-max-failure-ratio float Failure rate to tolerate during an update --update-monitor duration Duration after each task update to monitor for failure (ns|us|ms|s|m|h) --update-order string Update order (\"start-first\"|\"stop-first\") --update-parallelism uint Maximum number of tasks updated simultaneously (0 to update all at once) -u, --user string Username or UID (format: <name|uid>[:<group|gid>]) --with-registry-auth Send registry authentication details to swarm agents -w, --workdir string Working directory inside the container [root@docker1 ~]# 5.\u521b\u5efa3\u4e2a\u526f\u672c [root@docker1 ~]# docker service update --replicas 3 my-nginx my-nginx overall progress: 3 out of 3 tasks 1/3: running 2/3: running 3/3: running verify: Service converged [root@docker1 ~]# 6.\u67e5\u770b\u521b\u5efa\u7684\u526f\u672c \u521b\u5efa\u7684\u526f\u672c\u8dd1\u5728docker1\u3001docker2\u3001docker4\u4e0a\u3002 [root@docker1 ~]# docker service ps my-nginx ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS af2fbra1lyjx my-nginx.1 nginx:latest docker4 Running Running 27 minutes ago aldb5980l82x my-nginx.2 nginx:latest docker2 Running Running 3 minutes ago lx0ylq7q7l5u my-nginx.3 nginx:latest docker1 Running Running 3 minutes ago [root@docker1 ~]# docker1 [root@docker1 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 12ea2cc33770 nginx:latest \"/docker-entrypoint.\u2026\" 5 minutes ago Up 5 minutes 80/tcp my-nginx.3.lx0ylq7q7l5ugxj79xqh9seku [root@docker1 ~]# docker2 [root@docker2 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 843c3d3519a4 nginx:latest \"/docker-entrypoint.\u2026\" 6 minutes ago Up 6 minutes 80/tcp my-nginx.2.aldb5980l82xeh13ik8yax3dq [root@docker2 ~]# docker4 [root@docker4 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 4b56584f6710 nginx:latest \"/docker-entrypoint.\u2026\" 30 minutes ago Up 30 minutes 80/tcp my-nginx.1.af2fbra1lyjxxmjor5821c4av [root@docker4 ~]# docker3\u4e0a\u6ca1\u6709 [root@docker3 ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES [root@docker3 ~]# 7.\u8bbf\u95ee\u6d4b\u8bd5 docker3\u6ca1\u6709\u8fd0\u884c\u5bb9\u5668\uff0c\u4f46\u5728\u96c6\u7fa4\u91cc\u9762\uff0c\u5b83\u7684IP\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95eenginx\u9879\u76ee! \u96c6\u7fa4\u4e2d\u4efb\u610f\u8282\u70b9\u90fd\u53ef\u4ee5\u8bbf\u95ee\uff0c\u670d\u52a1\u53ef\u4ee5\u6709\u591a\u4e2a\u526f\u672c\u52a8\u6001\u6269\u7f29\u5bb9\u5b9e\u73b0\u9ad8\u53ef\u7528\uff01 8.\u4e00\u6b21\u542f\u52a810\u4e2a\u526f\u672c [root@docker1 ~]# docker service update --replicas 10 my-nginx my-nginx overall progress: 10 out of 10 tasks 1/10: running 2/10: running 3/10: running 4/10: running 5/10: running 6/10: running 7/10: running 8/10: running 9/10: running 10/10: running verify: Service converged 9.\u67e5\u770b\u542f\u52a8\u7684\u526f\u672c [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS t99km76mvfkr my-nginx replicated 10/10 nginx:latest *:8888->80/tcp [root@docker1 ~]# 10.\u7f29\u5bb9\uff0c\u66f4\u65b0\u52301\u4e2a\u526f\u672c [root@docker1 ~]# docker service update --replicas 1 my-nginx my-nginx overall progress: 1 out of 1 tasks 1/1: verify: Service converged [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS t99km76mvfkr my-nginx replicated 1/1 nginx:latest *:8888->80/tcp [root@docker1 ~]# [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS t99km76mvfkr my-nginx replicated 1/1 nginx:latest *:8888->80/tcp [root@docker1 ~]# docker service ps my-nginx ID NAME IMAGE NODE DESIRED STATE CURRENT STATE ERROR PORTS af2fbra1lyjx my-nginx.1 nginx:latest docker4 Running Running 4 hours ago aldb5980l82x my-nginx.2 nginx:latest docker2 Shutdown Shutdown 4 hours ago lx0ylq7q7l5u my-nginx.3 nginx:latest docker1 Shutdown Shutdown 4 hours ago laaa1qqfcwzg my-nginx.4 nginx:latest docker2 Shutdown Shutdown 4 hours ago 88eb61egsn6q my-nginx.7 nginx:latest docker2 Shutdown Shutdown 4 hours ago kxli7w26dft9 my-nginx.8 nginx:latest docker1 Shutdown Shutdown 4 hours ago [root@docker1 ~]# \u5f39\u6027\u6269\u7f29\u5bb9\u3002 11.\u6269\u7f29\u5bb9\u547d\u4ee4 [root@docker1 ~]# docker service scale --help Usage: docker service scale SERVICE=REPLICAS [SERVICE=REPLICAS...] Scale one or multiple replicated services Options: -d, --detach Exit immediately instead of waiting for the service to converge [root@docker1 ~]# \u4f7f\u7528\u65b9\u6cd5\uff1a \u4e0e\u66f4\u65b0\u539f\u7406\u4e00\u81f4 [root@docker1 ~]# docker service scale my-nginx=5 my-nginx scaled to 5 overall progress: 5 out of 5 tasks 1/5: running 2/5: running 3/5: running 4/5: running 5/5: running verify: Service converged [root@docker1 ~]#","title":"\u7f51\u7edc\u6a21\u5f0f"},{"location":"Docker/#_157","text":"[root@docker1 ~]# docker service --help Usage: docker service COMMAND Manage services Commands: create Create a new service inspect Display detailed information on one or more services logs Fetch the logs of a service or task ls List services ps List the tasks of one or more services rm Remove one or more services rollback Revert changes to a service's configuration scale Scale one or multiple replicated services update Update a service Run 'docker service COMMAND --help' for more information on a command. [root@docker1 ~]# \u79fb\u9664my-nginx\u670d\u52a1 [root@docker1 ~]# docker service rm my-nginx my-nginx [root@docker1 ~]# docker service ps \"docker service ps\" requires at least 1 argument. See 'docker service ps --help'. Usage: docker service ps [OPTIONS] SERVICE [SERVICE...] List the tasks of one or more services [root@docker1 ~]# docker service ls ID NAME MODE REPLICAS IMAGE PORTS [root@docker1 ~]#","title":"\u79fb\u9664\u670d\u52a1"},{"location":"Docker/#swarm_2","text":"Swarm \u96c6\u7fa4\u7684\u7ba1\u7406\u548c\u7f16\u6392\u3002docker\u53ef\u4ee5\u521d\u59cb\u5316\u4e00\u4e2a\u96c6\u7fa4\uff0c\u5176\u4ed6\u8282\u70b9\u53ef\u4ee5\u4ee5\u7ba1\u7406\u8005\u6216\u5de5\u4f5c\u8005\u52a0\u5165\u96c6\u7fa4\u3002 Node \u5c31\u662f\u4e00\u4e2adocker\u8282\u70b9\u3002\u591a\u4e2a\u8282\u70b9\u5c31\u7ec4\u6210\u4e86\u4e00\u4e2a\u7f51\u7edc\u96c6\u7fa4\u3002 Service \u670d\u52a1\uff0c\u53ef\u4ee5\u5728\u7ba1\u7406\u8282\u70b9\u6216\u8005\u5de5\u4f5c\u8282\u70b9\u6765\u8fd0\u884c\uff0c\u6838\u5fc3\uff01 Task \u4efb\u52a1\uff0c\u4efb\u52a1\u662f\u96c6\u7fa4\u4e2d\u8c03\u5ea6\u7684\u539f\u5b50\u5355\u4f4d\u3002\u5f53\u60a8\u901a\u8fc7\u521b\u5efa\u6216\u66f4\u65b0\u670d\u52a1\u6765\u58f0\u660e\u6240\u9700\u7684\u670d\u52a1\u72b6\u6001\u65f6\uff0c\u534f\u8c03\u5668\u901a\u8fc7\u8c03\u5ea6\u4efb\u52a1\u6765\u5b9e\u73b0\u6240\u9700\u7684\u72b6\u6001\u3002","title":"Swarm\u6982\u5ff5\u5b66\u4e60"},{"location":"Docker/#docker-stack","text":"Docker-compose:\u5355\u673a\u90e8\u7f72\u9879\u76ee Docker Stack\uff1a\u96c6\u7fa4\u90e8\u7f72\u9879\u76ee #\u5355\u673a docker-compose up -d wordpress.yaml #\u96c6\u7fa4 docker stack deploy wordpres.yaml \u4f8b\uff1a version: '3' services: web: image: wordpress ports: - 8080:80 environment: WORDPRESS_DB_HOST: mysql WORDPRESS_DB_PASSWORD: root networks: - my-network depends_on: - mysql deploy: mode: replicated replicas: 3 restart_policy: condition: on-failure delay: 5s max_attempts: 3 update_config: parallelism: 1 delay: 10s mysql: image: mysql environment: MYSQL_ROOT_PASSWORD: root MYSQL_DATABASE: wordpress volumes: - mysql-data:/var/lib/mysql networks: - my-network deploy: mode: global placement: constraints: - node.role == manager volumes: mysql-data: networks: my-network: driver: overlay \u4e0d\u540c\u70b9: Docker stack\u4f1a\u5ffd\u7565\u4e86\u201c\u6784\u5efa\u201d\u6307\u4ee4\u3002 \u60a8\u65e0\u6cd5\u4f7f\u7528stack\u547d\u4ee4\u6784\u5efa\u65b0\u955c\u50cf\u3002 \u5b83\u662f\u9700\u8981\u955c\u50cf\u662f\u9884\u5148\u5df2\u7ecf\u6784\u5efa\u597d\u7684\u3002 \u6240\u4ee5docker-compose\u66f4\u9002\u5408\u4e8e\u5f00\u53d1\u573a\u666f\u3002 Docker Stack \u90e8\u7f72\u547d\u4ee4\uff1a docker stack deploy\uff1a \u7528\u4e8e\u6839\u636estack\u6587\u4ef6\u90e8\u7f72\u548c\u66f4\u65b0stack\u670d\u52a1 docker stack ls \uff1a\u5217\u51faswarm\u96c6\u7fa4\u4e2d\u6240\u6709\u7684stack docker stack ps: \u5217\u51fa\u67d0\u4e2a\u5df2\u7ecf\u90e8\u7f72\u7684stack\u7684\u76f8\u5173\u4fe1\u606f\u3002 docker stack rm\uff1a\u4eceswarm\u96c6\u7fa4\u4e2d\u79fb\u9664stack","title":"Docker Stack"},{"location":"Docker/#docker-secret","text":"\u5b89\u5168\uff0c\u914d\u7f6e\u5bc6\u7801\uff0c\u8bc1\u4e66\u3002 [root@docker1 ~]# docker secret --help Usage: docker secret COMMAND Manage Docker secrets Commands: create Create a secret from a file or STDIN as content inspect Display detailed information on one or more secrets ls List secrets rm Remove one or more secrets Run 'docker secret COMMAND --help' for more information on a command. [root@docker1 ~]#","title":"Docker Secret"},{"location":"Docker/#docker-config","text":"Usage: docker config COMMAND Manage Docker configs Commands: create Create a config from a file or STDIN inspect Display detailed information on one or more configs ls List configs rm Remove one or more configs Run 'docker config COMMAND --help' for more information on a command. [root@docker1 ~]# \u65b9\u6cd5\uff1a\u627e\u5168\u5957\u8bfe\u7a0b\u5b66\u4e60\u6848\u4f8b\u8fb9\u5b66\u8fb9\u7ec3\u5148\u8dd1\u8d77\u6765\u2014\u2014\u67e5\u770b\u547d\u4ee4\u5e2e\u52a9\u6587\u6863--help\u638c\u63e1\u7528\u6cd5\u2014\u2014\u5b98\u65b9\u67e5\u770b\u6587\u6863\uff0c\u5bf9\u5177\u4f53\u7684\u539f\u7406\u548c\u5de5\u4f5c\u65b9\u5f0f\u8fdb\u884c\u5b66\u4e60\u3002 \u76ee\u6807\uff1a\u4e91\u539f\u751fK8s\u3002 \u5b66\u4e60\u5185\u5bb9\uff1a GO\u8bed\u8a00 Docker\u3001K8s\u3001Etcd\u3001\u8c37\u6b4cV8\u5f15\u64ce\u90fd\u662fGO\u8bed\u8a00\u5f00\u53d1\u3002 \u6280\u672f\u5f00\u59cb\u8f6c\u5411GO\u65b9\u5411\u3002 \u5929\u751f\u7684\u5e76\u53d1\u8bed\u8a00\uff0c\u6548\u7387\u9ad8\u3002 Go \uff08\u53c8\u79f0 Golang \uff09\u662f Google \u7684 Robert Griesemer\uff0cRob Pike \u53ca Ken Thompson \u5f00\u53d1\u7684\u4e00\u79cd \u9759\u6001 \u5f3a\u7c7b\u578b \u3001 \u7f16\u8bd1\u578b\u8bed\u8a00 \u3002Go \u8bed\u8a00\u8bed\u6cd5\u4e0e C \u76f8\u8fd1\uff0c\u4f46\u529f\u80fd\u4e0a\u6709\uff1a\u5185\u5b58\u5b89\u5168\uff0c GC \uff08\u5783\u573e\u56de\u6536\uff09\uff0c \u7ed3\u6784\u5f62\u6001 \u53ca CSP-style \u5e76\u53d1\u8ba1\u7b97 \u3002 Kubernetes \u4e91\u539f\u751f\u3002","title":"Docker Config"}]}